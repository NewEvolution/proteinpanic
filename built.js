/*
 AngularJS v1.5.6
 (c) 2010-2016 Google, Inc. http://angularjs.org
 License: MIT
*/

/* Phaser v2.4.8 - http://phaser.io - @photonstorm - (c) 2016 Photon Storm Ltd. */

/*! @license Firebase v3.0.3
    Build: 3.0.3-rc.1
    Terms: https://developers.google.com/terms */

/*
 Portions of this code are from MochiKit, received by
 The Closure Authors under the MIT license. All other code is Copyright
 2005-2009 The Closure Authors. All Rights Reserved.
*/

/*!
 * AngularFire is the officially supported AngularJS binding for Firebase. Firebase
 * is a full backend so you don't need servers to build your Angular app. AngularFire
 * provides you with the $firebase service which allows you to easily keep your $scope
 * variables in sync with your Firebase backend.
 *
 * AngularFire 2.0.0
 * https://github.com/firebase/angularfire/
 * Date: 06/01/2016
 * License: MIT
 */

/**
 * @license AngularJS v1.5.6
 * (c) 2010-2016 Google, Inc. http://angularjs.org
 * License: MIT
 */

/**
 * Bunch of useful filters for angularJS(with no external dependencies!)
 * @version v0.5.7 - 2015-10-04 * @link https://github.com/a8m/angular-filter
 * @author Ariel Mashraki <ariel@mashraki.co.il>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */

(function(e){"use strict";function t(e){return function(){var t=arguments[0],n;n="["+(e?e+":":"")+t+"] http://errors.angularjs.org/1.5.6/"+(e?e+"/":"")+t;for(t=1;t<arguments.length;t++){n=n+(1==t?"?":"&")+"p"+(t-1)+"=";var r=encodeURIComponent,i;i=arguments[t],i="function"==typeof i?i.toString().replace(/ \{[\s\S]*$/,""):"undefined"==typeof i?"undefined":"string"!=typeof i?JSON.stringify(i):i,n+=r(i)}return Error(n)}}function n(e){if(null==e||N(e))return!1;if(si(e)||w(e)||Jr&&e instanceof Jr)return!0;var t="length"in Object(e)&&e.length;return E(t)&&(0<=t&&(t-1 in e||e instanceof Array)||"function"==typeof e.item)}function r(e,t,i){var s,o;if(e)if(x(e))for(s in e)"prototype"==s||"length"==s||"name"==s||e.hasOwnProperty&&!e.hasOwnProperty(s)||t.call(i,e[s],s,e);else if(si(e)||n(e)){var u="object"!=typeof e;s=0;for(o=e.length;s<o;s++)(u||s in e)&&t.call(i,e[s],s,e)}else if(e.forEach&&e.forEach!==r)e.forEach(t,i,e);else if(b(e))for(s in e)t.call(i,e[s],s,e);else if("function"==typeof e.hasOwnProperty)for(s in e)e.hasOwnProperty(s)&&t.call(i,e[s],s,e);else for(s in e)Wr.call(e,s)&&t.call(i,e[s],s,e);return e}function i(e,t,n){for(var r=Object.keys(e).sort(),i=0;i<r.length;i++)t.call(n,e[r[i]],r[i]);return r}function s(e){return function(t,n){e(n,t)}}function o(){return++ii}function u(e,t,n){for(var r=e.$$hashKey,i=0,s=t.length;i<s;++i){var o=t[i];if(y(o)||x(o))for(var a=Object.keys(o),f=0,l=a.length;f<l;f++){var c=a[f],h=o[c];n&&y(h)?S(h)?e[c]=new Date(h.valueOf()):T(h)?e[c]=new RegExp(h):h.nodeName?e[c]=h.cloneNode(!0):A(h)?e[c]=h.clone():(y(e[c])||(e[c]=si(h)?[]:{}),u(e[c],[h],!0)):e[c]=h}}return r?e.$$hashKey=r:delete e.$$hashKey,e}function a(e){return u(e,Qr.call(arguments,1),!1)}function f(e){return u(e,Qr.call(arguments,1),!0)}function l(e){return parseInt(e,10)}function c(e,t){return a(Object.create(e),t)}function h(){}function p(e){return e}function d(e){return function(){return e}}function v(e){return x(e.toString)&&e.toString!==Zr}function m(e){return"undefined"==typeof e}function g(e){return"undefined"!=typeof e}function y(e){return null!==e&&"object"==typeof e}function b(e){return null!==e&&"object"==typeof e&&!ei(e)}function w(e){return"string"==typeof e}function E(e){return"number"==typeof e}function S(e){return"[object Date]"===Zr.call(e)}function x(e){return"function"==typeof e}function T(e){return"[object RegExp]"===Zr.call(e)}function N(e){return e&&e.window===e}function C(e){return e&&e.$evalAsync&&e.$watch}function k(e){return"boolean"==typeof e}function L(e){return e&&E(e.length)&&oi.test(Zr.call(e))}function A(e){return!!e&&!!(e.nodeName||e.prop&&e.attr&&e.find)}function O(e){var t={};e=e.split(",");var n;for(n=0;n<e.length;n++)t[e[n]]=!0;return t}function M(e){return Xr(e.nodeName||e[0]&&e[0].nodeName)}function _(e,t){var n=e.indexOf(t);return 0<=n&&e.splice(n,1),n}function D(e,t){function n(e,t){var n=t.$$hashKey,r;if(si(e)){r=0;for(var s=e.length;r<s;r++)t.push(i(e[r]))}else if(b(e))for(r in e)t[r]=i(e[r]);else if(e&&"function"==typeof e.hasOwnProperty)for(r in e)e.hasOwnProperty(r)&&(t[r]=i(e[r]));else for(r in e)Wr.call(e,r)&&(t[r]=i(e[r]));return n?t.$$hashKey=n:delete t.$$hashKey,t}function i(e){if(!y(e))return e;var t=o.indexOf(e);if(-1!==t)return u[t];if(N(e)||C(e))throw ti("cpws");var t=!1,r=s(e);return void 0===r&&(r=si(e)?[]:Object.create(ei(e)),t=!0),o.push(e),u.push(r),t?n(e,r):r}function s(e){switch(Zr.call(e)){case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Float32Array]":case"[object Float64Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return new e.constructor(i(e.buffer));case"[object ArrayBuffer]":if(!e.slice){var t=new ArrayBuffer(e.byteLength);return(new Uint8Array(t)).set(new Uint8Array(e)),t}return e.slice(0);case"[object Boolean]":case"[object Number]":case"[object String]":case"[object Date]":return new e.constructor(e.valueOf());case"[object RegExp]":return t=new RegExp(e.source,e.toString().match(/[^\/]*$/)[0]),t.lastIndex=e.lastIndex,t;case"[object Blob]":return new e.constructor([e],{type:e.type})}if(x(e.cloneNode))return e.cloneNode(!0)}var o=[],u=[];if(t){if(L(t)||"[object ArrayBuffer]"===Zr.call(t))throw ti("cpta");if(e===t)throw ti("cpi");return si(t)?t.length=0:r(t,function(e,n){"$$hashKey"!==n&&delete t[n]}),o.push(e),u.push(t),n(e,t)}return i(e)}function P(e,t){if(si(e)){t=t||[];for(var n=0,r=e.length;n<r;n++)t[n]=e[n]}else if(y(e))for(n in t=t||{},e)if("$"!==n.charAt(0)||"$"!==n.charAt(1))t[n]=e[n];return t||e}function H(e,t){if(e===t)return!0;if(null===e||null===t)return!1;if(e!==e&&t!==t)return!0;var n=typeof e,r;if(n==typeof t&&"object"==n){if(!si(e)){if(S(e))return S(t)?H(e.getTime(),t.getTime()):!1;if(T(e))return T(t)?e.toString()==t.toString():!1;if(C(e)||C(t)||N(e)||N(t)||si(t)||S(t)||T(t))return!1;n=ut();for(r in e)if("$"!==r.charAt(0)&&!x(e[r])){if(!H(e[r],t[r]))return!1;n[r]=!0}for(r in t)if(!(r in n)&&"$"!==r.charAt(0)&&g(t[r])&&!x(t[r]))return!1;return!0}if(!si(t))return!1;if((n=e.length)==t.length){for(r=0;r<n;r++)if(!H(e[r],t[r]))return!1;return!0}}return!1}function B(e,t,n){return e.concat(Qr.call(t,n))}function j(e,t){var n=2<arguments.length?Qr.call(arguments,2):[];return!x(t)||t instanceof RegExp?t:n.length?function(){return arguments.length?t.apply(e,B(n,arguments,0)):t.apply(e,n)}:function(){return arguments.length?t.apply(e,arguments):t.call(e)}}function F(t,n){var r=n;return"string"==typeof t&&"$"===t.charAt(0)&&"$"===t.charAt(1)?r=void 0:N(n)?r="$WINDOW":n&&e.document===n?r="$DOCUMENT":C(n)&&(r="$SCOPE"),r}function I(e,t){if(!m(e))return E(t)||(t=t?2:null),JSON.stringify(e,F,t)}function q(e){return w(e)?JSON.parse(e):e}function R(e,t){e=e.replace(ci,"");var n=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return isNaN(n)?t:n}function U(e,t,n){n=n?-1:1;var r=e.getTimezoneOffset();return t=R(t,r),n*=t-r,e=new Date(e.getTime()),e.setMinutes(e.getMinutes()+n),e}function z(e){e=Jr(e).clone();try{e.empty()}catch(t){}var n=Jr("<div>").append(e).html();try{return e[0].nodeType===vi?Xr(n):n.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(e,t){return"<"+Xr(t)})}catch(r){return Xr(n)}}function W(e){try{return decodeURIComponent(e)}catch(t){}}function X(e){var t={};return r((e||"").split("&"),function(e){var n,r,i;e&&(r=e=e.replace(/\+/g,"%20"),n=e.indexOf("="),-1!==n&&(r=e.substring(0,n),i=e.substring(n+1)),r=W(r),g(r)&&(i=g(i)?W(i):!0,Wr.call(t,r)?si(t[r])?t[r].push(i):t[r]=[t[r],i]:t[r]=i))}),t}function V(e){var t=[];return r(e,function(e,n){si(e)?r(e,function(e){t.push(J(n,!0)+(!0===e?"":"="+J(e,!0)))}):t.push(J(n,!0)+(!0===e?"":"="+J(e,!0)))}),t.length?t.join("&"):""}function $(e){return J(e,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function J(e,t){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,t?"%20":"+")}function K(e,t){var n,r,i=hi.length;for(r=0;r<i;++r)if(n=hi[r]+t,w(n=e.getAttribute(n)))return n;return null}function Q(e,t){var n,i,s={};r(hi,function(t){t+="app",!n&&e.hasAttribute&&e.hasAttribute(t)&&(n=e,i=e.getAttribute(t))}),r(hi,function(t){t+="app";var r;!n&&(r=e.querySelector("["+t.replace(":","\\:")+"]"))&&(n=r,i=r.getAttribute(t))}),n&&(s.strictDi=null!==K(n,"strict-di"),t(n,i?[i]:[],s))}function G(t,n,i){y(i)||(i={}),i=a({strictDi:!1},i);var s=function(){t=Jr(t);if(t.injector()){var r=t[0]===e.document?"document":z(t);throw ti("btstrpd",r.replace(/</,"&lt;").replace(/>/,"&gt;"))}return n=n||[],n.unshift(["$provide",function(e){e.value("$rootElement",t)}]),i.debugInfoEnabled&&n.push(["$compileProvider",function(e){e.debugInfoEnabled(!0)}]),n.unshift("ng"),r=It(n,i.strictDi),r.invoke(["$rootScope","$rootElement","$compile","$injector",function(e,t,n,r){e.$apply(function(){t.data("$injector",r),n(t)(e)})}]),r},o=/^NG_ENABLE_DEBUG_INFO!/,u=/^NG_DEFER_BOOTSTRAP!/;e&&o.test(e.name)&&(i.debugInfoEnabled=!0,e.name=e.name.replace(o,""));if(e&&!u.test(e.name))return s();e.name=e.name.replace(u,""),ni.resumeBootstrap=function(e){return r(e,function(e){n.push(e)}),s()},x(ni.resumeDeferredBootstrap)&&ni.resumeDeferredBootstrap()}function Y(){e.name="NG_ENABLE_DEBUG_INFO!"+e.name,e.location.reload()}function Z(e){e=ni.element(e).injector();if(!e)throw ti("test");return e.get("$$testability")}function et(e,t){return t=t||"_",e.replace(pi,function(e,n){return(n?t:"")+e.toLowerCase()})}function tt(){var t;if(!di){var n=li();(Kr=m(n)?e.jQuery:n?e[n]:void 0)&&Kr.fn.on?(Jr=Kr,a(Kr.fn,{scope:Ai.scope,isolateScope:Ai.isolateScope,controller:Ai.controller,injector:Ai.injector,inheritedData:Ai.inheritedData}),t=Kr.cleanData,Kr.cleanData=function(e){for(var n,r=0,i;null!=(i=e[r]);r++)(n=Kr._data(i,"events"))&&n.$destroy&&Kr(i).triggerHandler("$destroy");t(e)}):Jr=dt,ni.element=Jr,di=!0}}function nt(e,t,n){if(!e)throw ti("areq",t||"?",n||"required");return e}function rt(e,t,n){return n&&si(e)&&(e=e[e.length-1]),nt(x(e),t,"not a function, got "+(e&&"object"==typeof e?e.constructor.name||"Object":typeof e)),e}function it(e,t){if("hasOwnProperty"===e)throw ti("badname",t)}function st(e,t,n){if(!t)return e;t=t.split(".");for(var r,i=e,s=t.length,o=0;o<s;o++)r=t[o],e&&(e=(i=e)[r]);return!n&&x(e)?j(i,e):e}function ot(e){for(var t=e[0],n=e[e.length-1],r,i=1;t!==n&&(t=t.nextSibling);i++)if(r||e[i]!==t)r||(r=Jr(Qr.call(e,0,i))),r.push(t);return r||e}function ut(){return Object.create(null)}function at(e){function n(e,t,n){return e[t]||(e[t]=n())}var r=t("$injector"),i=t("ng");return e=n(e,"angular",Object),e.$$minErr=e.$$minErr||t,n(e,"module",function(){var e={};return function(t,s,o){if("hasOwnProperty"===t)throw i("badname","module");return s&&e.hasOwnProperty(t)&&(e[t]=null),n(e,t,function(){function e(e,t,n,r){return r||(r=i),function(){return r[n||"push"]([e,t,arguments]),l}}function n(e,n){return function(r,s){return s&&x(s)&&(s.$$moduleName=t),i.push([e,n,arguments]),l}}if(!s)throw r("nomod",t);var i=[],u=[],a=[],f=e("$injector","invoke","push",u),l={_invokeQueue:i,_configBlocks:u,_runBlocks:a,requires:s,name:t,provider:n("$provide","provider"),factory:n("$provide","factory"),service:n("$provide","service"),value:e("$provide","value"),constant:e("$provide","constant","unshift"),decorator:n("$provide","decorator"),animation:n("$animateProvider","register"),filter:n("$filterProvider","register"),controller:n("$controllerProvider","register"),directive:n("$compileProvider","directive"),component:n("$compileProvider","component"),config:f,run:function(e){return a.push(e),this}};return o&&f(o),l})}})}function ft(n){a(n,{bootstrap:G,copy:D,extend:a,merge:f,equals:H,element:Jr,forEach:r,injector:It,noop:h,bind:j,toJson:I,fromJson:q,identity:p,isUndefined:m,isDefined:g,isString:w,isFunction:x,isObject:y,isNumber:E,isElement:A,isArray:si,version:mi,isDate:S,lowercase:Xr,uppercase:Vr,callbacks:{counter:0},getTestability:Z,$$minErr:t,$$csp:fi,reloadWithDebugInfo:Y}),ri=at(e),ri("ng",["ngLocale"],["$provide",function(e){e.provider({$$sanitizeUri:Yn}),e.provider("$compile",Jt).directive({a:Ps,input:Gs,textarea:Gs,form:Fs,script:Ro,select:Wo,style:Vo,option:Xo,ngBind:eo,ngBindHtml:no,ngBindTemplate:to,ngClass:io,ngClassEven:oo,ngClassOdd:so,ngCloak:uo,ngController:ao,ngForm:Is,ngHide:Po,ngIf:co,ngInclude:ho,ngInit:vo,ngNonBindable:ko,ngPluralize:Mo,ngRepeat:_o,ngShow:Do,ngStyle:Ho,ngSwitch:Bo,ngSwitchWhen:jo,ngSwitchDefault:Fo,ngOptions:Oo,ngTransclude:qo,ngModel:To,ngList:mo,ngChange:ro,pattern:Jo,ngPattern:Jo,required:$o,ngRequired:$o,minlength:Qo,ngMinlength:Qo,maxlength:Ko,ngMaxlength:Ko,ngValue:Zs,ngModelOptions:Co}).directive({ngInclude:po}).directive(Hs).directive(fo),e.provider({$anchorScroll:qt,$animate:zi,$animateCss:Vi,$$animateJs:Ri,$$animateQueue:Ui,$$AnimateRunner:Xi,$$animateAsyncRun:Wi,$browser:Xt,$cacheFactory:Vt,$controller:en,$document:tn,$exceptionHandler:nn,$filter:hr,$$forceReflow:Yi,$interpolate:vn,$interval:mn,$http:cn,$httpParamSerializer:sn,$httpParamSerializerJQLike:on,$httpBackend:pn,$xhrFactory:hn,$location:Ln,$log:An,$parse:Vn,$rootScope:Gn,$q:$n,$$q:Jn,$sce:nr,$sceDelegate:tr,$sniffer:rr,$templateCache:$t,$templateRequest:ir,$$testability:sr,$timeout:or,$window:fr,$$rAF:Qn,$$jqLite:Pt,$$HashMap:Di,$$cookieReader:cr})}])}function lt(e){return e.replace(bi,function(e,t,n,r){return r?n.toUpperCase():n}).replace(wi,"Moz$1")}function ct(e){return e=e.nodeType,1===e||!e||9===e}function ht(e,t){var n,i,s=t.createDocumentFragment(),o=[];if(Ti.test(e)){n=n||s.appendChild(t.createElement("div")),i=(Ni.exec(e)||["",""])[1].toLowerCase(),i=ki[i]||ki._default,n.innerHTML=i[1]+e.replace(Ci,"<$1></$2>")+i[2];for(i=i[0];i--;)n=n.lastChild;o=B(o,n.childNodes),n=s.firstChild,n.textContent=""}else o.push(t.createTextNode(e));return s.textContent="",s.innerHTML="",r(o,function(e){s.appendChild(e)}),s}function pt(e,t){var n=e.parentNode;n&&n.replaceChild(t,e),t.appendChild(e)}function dt(t){if(t instanceof dt)return t;var n;w(t)&&(t=ui(t),n=!0);if(!(this instanceof dt)){if(n&&"<"!=t.charAt(0))throw Si("nosel");return new dt(t)}if(n){n=e.document;var r;t=(r=xi.exec(t))?[n.createElement(r[1])]:(r=ht(t,n))?r.childNodes:[]}Tt(this,t)}function vt(e){return e.cloneNode(!0)}function mt(e,t){t||yt(e);if(e.querySelectorAll)for(var n=e.querySelectorAll("*"),r=0,i=n.length;r<i;r++)yt(n[r])}function gt(e,t,n,i){if(g(i))throw Si("offargs");var s=(i=bt(e))&&i.events,o=i&&i.handle;if(o)if(t){var u=function(t){var r=s[t];g(n)&&_(r||[],n),g(n)&&r&&0<r.length||(e.removeEventListener(t,o,!1),delete s[t])};r(t.split(" "),function(e){u(e),Ei[e]&&u(Ei[e])})}else for(t in s)"$destroy"!==t&&e.removeEventListener(t,o,!1),delete s[t]}function yt(e,t){var n=e.ng339,r=n&&gi[n];r&&(t?delete r.data[t]:(r.handle&&(r.events.$destroy&&r.handle({},"$destroy"),gt(e)),delete gi[n],e.ng339=void 0))}function bt(e,t){var n=e.ng339,n=n&&gi[n];return t&&!n&&(e.ng339=n=++yi,n=gi[n]={events:{},data:{},handle:void 0}),n}function wt(e,t,n){if(ct(e)){var r=g(n),i=!r&&t&&!y(t),s=!t;e=(e=bt(e,!i))&&e.data;if(r)e[t]=n;else{if(s)return e;if(i)return e&&e[t];a(e,t)}}}function Et(e,t){return e.getAttribute?-1<(" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+t+" "):!1}function St(e,t){t&&e.setAttribute&&r(t.split(" "),function(t){e.setAttribute("class",ui((" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+ui(t)+" "," ")))})}function xt(e,t){if(t&&e.setAttribute){var n=(" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");r(t.split(" "),function(e){e=ui(e),-1===n.indexOf(" "+e+" ")&&(n+=e+" ")}),e.setAttribute("class",ui(n))}}function Tt(e,t){if(t)if(t.nodeType)e[e.length++]=t;else{var n=t.length;if("number"==typeof n&&t.window!==t){if(n)for(var r=0;r<n;r++)e[e.length++]=t[r]}else e[e.length++]=t}}function Nt(e,t){return Ct(e,"$"+(t||"ngController")+"Controller")}function Ct(e,t,n){9==e.nodeType&&(e=e.documentElement);for(t=si(t)?t:[t];e;){for(var r=0,i=t.length;r<i;r++)if(g(n=Jr.data(e,t[r])))return n;e=e.parentNode||11===e.nodeType&&e.host}}function kt(e){for(mt(e,!0);e.firstChild;)e.removeChild(e.firstChild)}function Lt(e,t){t||mt(e);var n=e.parentNode;n&&n.removeChild(e)}function At(t,n){n=n||e,"complete"===n.document.readyState?n.setTimeout(t):Jr(n).on("load",t)}function Ot(e,t){var n=Oi[t.toLowerCase()];return n&&Mi[M(e)]&&n}function Mt(e,t){var n=function(n,r){n.isDefaultPrevented=function(){return n.defaultPrevented};var i=t[r||n.type],s=i?i.length:0;if(s){if(m(n.immediatePropagationStopped)){var o=n.stopImmediatePropagation;n.stopImmediatePropagation=function(){n.immediatePropagationStopped=!0,n.stopPropagation&&n.stopPropagation(),o&&o.call(n)}}n.isImmediatePropagationStopped=function(){return!0===n.immediatePropagationStopped};var u=i.specialHandlerWrapper||_t;1<s&&(i=P(i));for(var a=0;a<s;a++)n.isImmediatePropagationStopped()||u(e,n,i[a])}};return n.elem=e,n}function _t(e,t,n){n.call(e,t)}function Dt(e,t,n){var r=t.relatedTarget;r&&(r===e||Li.call(e,r))||n.call(e,t)}function Pt(){this.$get=function(){return a(dt,{hasClass:function(e,t){return e.attr&&(e=e[0]),Et(e,t)},addClass:function(e,t){return e.attr&&(e=e[0]),xt(e,t)},removeClass:function(e,t){return e.attr&&(e=e[0]),St(e,t)}})}}function Ht(e,t){var n=e&&e.$$hashKey;return n?("function"==typeof n&&(n=e.$$hashKey()),n):(n=typeof e,n="function"==n||"object"==n&&null!==e?e.$$hashKey=n+":"+(t||o)():n+":"+e)}function Bt(e,t){if(t){var n=0;this.nextUid=function(){return++n}}r(e,this.put,this)}function jt(e){return e=(Function.prototype.toString.call(e)+" ").replace(Fi,""),e.match(Pi)||e.match(Hi)}function Ft(e){return(e=jt(e))?"function("+(e[1]||"").replace(/[\s\r\n]+/," ")+")":"fn"}function It(e,t){function n(e){return function(t,n){if(!y(t))return e(t,n);r(t,s(e))}}function i(e,t){it(e,"service");if(x(t)||si(t))t=v.instantiate(t);if(!t.$get)throw Ii("pget",e);return p[e+"Provider"]=t}function o(e,t){return function(){var n=E.invoke(t,this);if(m(n))throw Ii("undef",e);return n}}function u(e,t,n){return i(e,{$get:!1!==n?o(e,t):t})}function a(e){nt(m(e)||si(e),"modulesToLoad","not an array");var t=[],n;return r(e,function(e){function r(e){var t,n;t=0;for(n=e.length;t<n;t++){var r=e[t],i=v.get(r[0]);i[r[1]].apply(i,r[2])}}if(!h.get(e)){h.put(e,!0);try{w(e)?(n=ri(e),t=t.concat(a(n.requires)).concat(n._runBlocks),r(n._invokeQueue),r(n._configBlocks)):x(e)?t.push(v.invoke(e)):si(e)?t.push(v.invoke(e)):rt(e,"module")}catch(i){throw si(e)&&(e=e[e.length-1]),i.message&&i.stack&&-1==i.stack.indexOf(i.message)&&(i=i.message+"\n"+i.stack),Ii("modulerr",e,i.stack||i.message||i)}}}),t}function f(e,n){function r(t,r){if(e.hasOwnProperty(t)){if(e[t]===l)throw Ii("cdep",t+" <- "+c.join(" <- "));return e[t]}try{return c.unshift(t),e[t]=l,e[t]=n(t,r)}catch(i){throw e[t]===l&&delete e[t],i}finally{c.shift()}}function i(e,n,i){var s=[];e=It.$$annotate(e,t,i);for(var o=0,u=e.length;o<u;o++){var a=e[o];if("string"!=typeof a)throw Ii("itkn",a);s.push(n&&n.hasOwnProperty(a)?n[a]:r(a,i))}return s}return{invoke:function(e,t,n,r){return"string"==typeof n&&(r=n,n=null),n=i(e,n,r),si(e)&&(e=e[e.length-1]),r=11>=$r?!1:"function"==typeof e&&/^(?:class\s|constructor\()/.test(Function.prototype.toString.call(e)+" "),r?(n.unshift(null),new(Function.prototype.bind.apply(e,n))):e.apply(t,n)},instantiate:function(e,t,n){var r=si(e)?e[e.length-1]:e;return e=i(e,t,n),e.unshift(null),new(Function.prototype.bind.apply(r,e))},get:r,annotate:It.$$annotate,has:function(t){return p.hasOwnProperty(t+"Provider")||e.hasOwnProperty(t)}}}t=!0===t;var l={},c=[],h=new Bt([],!0),p={$provide:{provider:n(i),factory:n(u),service:n(function(e,t){return u(e,["$injector",function(e){return e.instantiate(t)}])}),value:n(function(e,t){return u(e,d(t),!1)}),constant:n(function(e,t){it(e,"constant"),p[e]=t,g[e]=t}),decorator:function(e,t){var n=v.get(e+"Provider"),r=n.$get;n.$get=function(){var e=E.invoke(r,n);return E.invoke(t,null,{$delegate:e})}}}},v=p.$injector=f(p,function(e,t){throw ni.isString(t)&&c.push(t),Ii("unpr",c.join(" <- "))}),g={},b=f(g,function(e,t){var n=v.get(e+"Provider",t);return E.invoke(n.$get,n,void 0,e)}),E=b;p.$injectorProvider={$get:d(b)};var S=a(e),E=b.get("$injector");return E.strictDi=t,r(S,function(e){e&&E.invoke(e)}),E}function qt(){var e=!0;this.disableAutoScrolling=function(){e=!1},this.$get=["$window","$location","$rootScope",function(t,n,r){function i(e){var t=null;return Array.prototype.some.call(e,function(e){if("a"===M(e))return t=e,!0}),t}function s(e){if(e){e.scrollIntoView();var n;n=o.yOffset,x(n)?n=n():A(n)?(n=n[0],n="fixed"!==t.getComputedStyle(n).position?0:n.getBoundingClientRect().bottom):E(n)||(n=0),n&&(e=e.getBoundingClientRect().top,t.scrollBy(0,e-n))}else t.scrollTo(0,0)}function o(e){e=w(e)?e:n.hash();var t;e?(t=u.getElementById(e))?s(t):(t=i(u.getElementsByName(e)))?s(t):"top"===e&&s(null):s(null)}var u=t.document;return e&&r.$watch(function(){return n.hash()},function(e,t){e===t&&""===e||At(function(){r.$evalAsync(o)})}),o}]}function Rt(e,t){return!e&&!t?"":e?t?(si(e)&&(e=e.join(" ")),si(t)&&(t=t.join(" ")),e+" "+t):e:t}function Ut(e){w(e)&&(e=e.split(" "));var t=ut();return r(e,function(e){e.length&&(t[e]=!0)}),t}function zt(e){return y(e)?e:{}}function Wt(e,t,n,i){function s(e){try{e.apply(null,Qr.call(arguments,1))}finally{if(g--,0===g)for(;y.length;)try{y.pop()()}catch(t){n.error(t)}}}function o(){x=null,u(),a()}function u(){b=T(),b=m(b)?null:b,H(b,k)&&(b=k),k=b}function a(){if(E!==f.url()||w!==b)E=f.url(),w=b,r(N,function(e){e(f.url(),b)})}var f=this,l=e.location,c=e.history,p=e.setTimeout,d=e.clearTimeout,v={};f.isMock=!1;var g=0,y=[];f.$$completeOutstandingRequest=s,f.$$incOutstandingRequestCount=function(){g++},f.notifyWhenNoOutstandingRequests=function(e){0===g?e():y.push(e)};var b,w,E=l.href,S=t.find("base"),x=null,T=i.history?function(){try{return c.state}catch(e){}}:h;u(),w=b,f.url=function(t,n,r){m(r)&&(r=null),l!==e.location&&(l=e.location),c!==e.history&&(c=e.history);if(t){var s=w===r;if(E===t&&(!i.history||s))return f;var o=E&&En(E)===En(t);return E=t,w=r,!i.history||o&&s?(o||(x=t),n?l.replace(t):o?(n=l,r=t.indexOf("#"),r=-1===r?"":t.substr(r),n.hash=r):l.href=t,l.href!==t&&(x=t)):(c[n?"replaceState":"pushState"](r,"",t),u(),w=b),x&&(x=t),f}return x||l.href.replace(/%27/g,"'")},f.state=function(){return b};var N=[],C=!1,k=null;f.onUrlChange=function(t){return C||(i.history&&Jr(e).on("popstate",o),Jr(e).on("hashchange",o),C=!0),N.push(t),t},f.$$applicationDestroyed=function(){Jr(e).off("hashchange popstate",o)},f.$$checkUrlChange=a,f.baseHref=function(){var e=S.attr("href");return e?e.replace(/^(https?\:)?\/\/[^\/]*/,""):""},f.defer=function(e,t){var n;return g++,n=p(function(){delete v[n],s(e)},t||0),v[n]=!0,n},f.defer.cancel=function(e){return v[e]?(delete v[e],d(e),s(h),!0):!1}}function Xt(){this.$get=["$window","$log","$sniffer","$document",function(e,t,n,r){return new Wt(e,r,t,n)}]}function Vt(){this.$get=function(){function e(e,r){function i(e){e!=h&&(p?p==e&&(p=e.n):p=e,s(e.n,e.p),s(e,h),h=e,h.n=null)}function s(e,t){e!=t&&(e&&(e.p=t),t&&(t.n=e))}if(e in n)throw t("$cacheFactory")("iid",e);var o=0,u=a({},r,{id:e}),f=ut(),l=r&&r.capacity||Number.MAX_VALUE,c=ut(),h=null,p=null;return n[e]={put:function(e,t){if(!m(t)){if(l<Number.MAX_VALUE){var n=c[e]||(c[e]={key:e});i(n)}return e in f||o++,f[e]=t,o>l&&this.remove(p.key),t}},get:function(e){if(l<Number.MAX_VALUE){var t=c[e];if(!t)return;i(t)}return f[e]},remove:function(e){if(l<Number.MAX_VALUE){var t=c[e];if(!t)return;t==h&&(h=t.p),t==p&&(p=t.n),s(t.n,t.p),delete c[e]}e in f&&(delete f[e],o--)},removeAll:function(){f=ut(),o=0,c=ut(),h=p=null},destroy:function(){c=u=f=null,delete n[e]},info:function(){return a({},u,{size:o})}}}var n={};return e.info=function(){var e={};return r(n,function(t,n){e[n]=t.info()}),e},e.get=function(e){return n[e]},e}}function $t(){this.$get=["$cacheFactory",function(e){return e("templates")}]}function Jt(t,n){function i(e,t,n){var i=/^\s*([@&<]|=(\*?))(\??)\s*(\w*)\s*$/,s=ut();return r(e,function(e,r){if(e in T)s[r]=T[e];else{var o=e.match(i);if(!o)throw $i("iscp",t,r,e,n?"controller bindings definition":"isolate scope definition");s[r]={mode:o[1][0],collection:"*"===o[2],optional:"?"===o[3],attrName:o[4]||r},o[4]&&(T[e]=s[r])}}),s}function o(e){var t=e.charAt(0);if(!t||t!==Xr(t))throw $i("baddir",e);if(e!==e.trim())throw $i("baddir",e)}function u(e){var t=e.require||e.controller&&e.name;return!si(t)&&y(t)&&r(t,function(e,n){var r=e.match(E);e.substring(r[0].length)||(t[n]=r[0]+n)}),t}var f={},l=/^\s*directive\:\s*([\w\-]+)\s+(.*)$/,v=/(([\w\-]+)(?:\:([^;]+))?;?)/,b=O("ngSrc,ngSrcset,src,srcset"),E=/^(?:(\^\^?)?(\?)?(\^\^?)?)?/,S=/^(on[a-z]+|formaction)$/,T=ut();this.directive=function A(e,n){return it(e,"directive"),w(e)?(o(e),nt(n,"directiveFactory"),f.hasOwnProperty(e)||(f[e]=[],t.factory(e+"Directive",["$injector","$exceptionHandler",function(t,n){var i=[];return r(f[e],function(r,s){try{var o=t.invoke(r);x(o)?o={compile:d(o)}:!o.compile&&o.link&&(o.compile=d(o.link)),o.priority=o.priority||0,o.index=s,o.name=o.name||e,o.require=u(o),o.restrict=o.restrict||"EA",o.$$moduleName=r.$$moduleName,i.push(o)}catch(a){n(a)}}),i}])),f[e].push(n)):r(e,s(A)),this},this.component=function(e,t){function n(e){function n(t){return x(t)||si(t)?function(n,r){return e.invoke(t,this,{$element:n,$attrs:r})}:t}var s=t.template||t.templateUrl?t.template:"",o={controller:i,controllerAs:Zt(t.controller)||t.controllerAs||"$ctrl",template:n(s),templateUrl:n(t.templateUrl),transclude:t.transclude,scope:{},bindToController:t.bindings||{},restrict:"E",require:t.require};return r(t,function(e,t){"$"===t.charAt(0)&&(o[t]=e)}),o}var i=t.controller||function(){};return r(t,function(e,t){"$"===t.charAt(0)&&(n[t]=e,x(i)&&(i[t]=e))}),n.$inject=["$injector"],this.directive(e,n)},this.aHrefSanitizationWhitelist=function(e){return g(e)?(n.aHrefSanitizationWhitelist(e),this):n.aHrefSanitizationWhitelist()},this.imgSrcSanitizationWhitelist=function(e){return g(e)?(n.imgSrcSanitizationWhitelist(e),this):n.imgSrcSanitizationWhitelist()};var N=!0;this.debugInfoEnabled=function(e){return g(e)?(N=e,this):N};var L=10;this.onChangesTtl=function(e){return arguments.length?(L=e,this):L},this.$get=["$injector","$interpolate","$exceptionHandler","$templateRequest","$parse","$controller","$rootScope","$sce","$animate","$$sanitizeUri",function(t,n,s,o,u,d,T,A,O,D){function P(){try{if(!--bt)throw wt=void 0,$i("infchng",L);T.$apply(function(){for(var e=0,t=wt.length;e<t;++e)wt[e]();wt=void 0})}finally{bt++}}function B(e,t){if(t){var n=Object.keys(t),r,i,s;r=0;for(i=n.length;r<i;r++)s=n[r],this[s]=t[s]}else this.$attr={};this.$$element=e}function F(e,t,n){yt.innerHTML="<span "+t+">",t=yt.firstChild.attributes;var r=t[0];t.removeNamedItem(r.name),r.value=n,e.attributes.setNamedItem(r)}function I(e,t){try{e.addClass(t)}catch(n){}}function q(t,n,r,i,s){t instanceof Jr||(t=Jr(t));for(var o=/\S+/,u=0,a=t.length;u<a;u++){var f=t[u];f.nodeType===vi&&f.nodeValue.match(o)&&pt(f,t[u]=e.document.createElement("span"))}var l=R(t,n,t,r,i,s);q.$$addScopeClass(t);var c=null;return function(e,n,r){nt(e,"scope"),s&&s.needsNewScope&&(e=e.$parent.$new()),r=r||{};var i=r.parentBoundTranscludeFn,o=r.transcludeControllers;r=r.futureParentElement,i&&i.$$boundTransclude&&(i=i.$$boundTransclude),c||(c=(r=r&&r[0])?"foreignobject"!==M(r)&&Zr.call(r).match(/SVG/)?"svg":"html":"html"),r="html"!==c?Jr(at(c,Jr("<div>").append(t).html())):n?Ai.clone.call(t):t;if(o)for(var u in o)r.data("$"+u+"Controller",o[u].instance);return q.$$addScopeInfo(r,e),n&&n(r,e),l&&l(e,r,r,i),r}}function R(e,t,n,r,i,s){function o(e,n,r,i){var s,o,a,f,l,c,p;if(h)for(p=Array(n.length),f=0;f<u.length;f+=3)s=u[f],p[s]=n[s];else p=n;f=0;for(l=u.length;f<l;)o=p[u[f++]],n=u[f++],s=u[f++],n?(n.scope?(a=e.$new(),q.$$addScopeInfo(Jr(o),a)):a=e,c=n.transcludeOnThisElement?U(e,n.transclude,i):!n.templateOnThisElement&&i?i:!i&&t?U(e,t):null,n(s,a,o,r,c)):s&&s(e,o.childNodes,void 0,i)}for(var u=[],a,f,l,c,h,p=0;p<e.length;p++){a=new B,f=W(e[p],[],a,0===p?r:void 0,i),(s=f.length?J(f,e[p],a,t,n,null,[],[],s):null)&&s.scope&&q.$$addScopeClass(a.$$element),a=s&&s.terminal||!(l=e[p].childNodes)||!l.length?null:R(l,s?(s.transcludeOnThisElement||!s.templateOnThisElement)&&s.transclude:t);if(s||a)u.push(p,s,a),c=!0,h=h||s;s=null}return c?o:null}function U(e,t,n){function r(r,i,s,o,u){return r||(r=e.$new(!1,u),r.$$transcluded=!0),t(r,i,{parentBoundTranscludeFn:n,transcludeControllers:s,futureParentElement:o})}var i=r.$$slots=ut(),s;for(s in t.$$slots)i[s]=t.$$slots[s]?U(e,t.$$slots[s],n):null;return r}function W(e,t,n,r,i){var s=n.$attr,o;switch(e.nodeType){case 1:Y(t,Qt(M(e)),"E",r,i);for(var u,a,f,c=e.attributes,h=0,p=c&&c.length;h<p;h++){var d=!1,m=!1;u=c[h],o=u.name,a=ui(u.value),u=Qt(o);if(f=Tt.test(u))o=o.replace(Ki,"").substr(8).replace(/_(.)/g,function(e,t){return t.toUpperCase()});(u=u.match(Nt))&&Z(u[1])&&(d=o,m=o.substr(0,o.length-5)+"end",o=o.substr(0,o.length-6)),u=Qt(o.toLowerCase()),s[u]=o;if(f||!n.hasOwnProperty(u))n[u]=a,Ot(e,u)&&(n[u]=!0);lt(e,t,a,u,f),Y(t,u,"A",r,i,d,m)}e=e.className,y(e)&&(e=e.animVal);if(w(e)&&""!==e)for(;o=v.exec(e);)u=Qt(o[2]),Y(t,u,"C",r,i)&&(n[u]=ui(o[3])),e=e.substr(o.index+o[0].length);break;case vi:if(11===$r)for(;e.parentNode&&e.nextSibling&&e.nextSibling.nodeType===vi;)e.nodeValue+=e.nextSibling.nodeValue,e.parentNode.removeChild(e.nextSibling);ot(t,e.nodeValue);break;case 8:try{if(o=l.exec(e.nodeValue))u=Qt(o[1]),Y(t,u,"M",r,i)&&(n[u]=ui(o[2]))}catch(g){}}return t.sort(it),t}function X(e,t,n){var r=[],i=0;if(t&&e.hasAttribute&&e.hasAttribute(t)){do{if(!e)throw $i("uterdir",t,n);1==e.nodeType&&(e.hasAttribute(t)&&i++,e.hasAttribute(n)&&i--),r.push(e),e=e.nextSibling}while(0<i)}else r.push(e);return Jr(r)}function V(e,t,n){return function(r,i,s,o,u){return i=X(i[0],t,n),e(r,i,s,o,u)}}function $(e,t,n,r,i,s){var o;return e?q(t,n,r,i,s):function(){return o||(o=q(t,n,r,i,s),t=n=s=null),o.apply(this,arguments)}}function J(e,t,n,i,o,u,f,l,c){function h(e,t,n,r){if(e){n&&(e=V(e,n,r)),e.require=L.require,e.directiveName=A;if(b===L||L.$$isolateScope)e=ht(e,{isolateScope:!0});f.push(e)}if(t){n&&(t=V(t,n,r)),t.require=L.require,t.directiveName=A;if(b===L||L.$$isolateScope)t=ht(t,{isolateScope:!0});l.push(t)}}function p(e,i,s,o,u){function c(e,t,n,r){var i;C(e)||(r=n,n=t,t=e,e=void 0),N&&(i=T),n||(n=N?L.parent():L);if(!r)return u(e,t,i,n,M);var s=u.$$slots[r];if(s)return s(e,t,i,n,M);if(m(s))throw $i("noslot",r,z(L))}var h,p,d,E,S,T,k,L;t===s?(o=n,L=n.$$element):(L=Jr(s),o=new B(L,n)),S=i,b?E=i.$new(!0):v&&(S=i.$parent),u&&(k=c,k.$$boundTransclude=u,k.isSlotFilled=function(e){return!!u.$$slots[e]}),g&&(T=Q(L,o,k,g,E,i,b)),b&&(q.$$addScopeInfo(L,E,!0,!w||w!==b&&w!==b.$$originalDirective),q.$$addScopeClass(L,!0),E.$$isolateBindings=b.$$isolateBindings,p=mt(i,o,E,E.$$isolateBindings,b),p.removeWatches&&E.$on("$destroy",p.removeWatches));for(h in T){p=g[h],d=T[h];var A=p.$$bindings.bindToController;d.bindingInfo=d.identifier&&A?mt(S,o,d.instance,A,p):{};var O=d();O!==d.instance&&(d.instance=O,L.data("$"+p.name+"Controller",O),d.bindingInfo.removeWatches&&d.bindingInfo.removeWatches(),d.bindingInfo=mt(S,o,d.instance,A,p))}r(g,function(e,t){var n=e.require;e.bindToController&&!si(n)&&y(n)&&a(T[t].instance,K(t,n,L,T))}),r(T,function(e){var t=e.instance;x(t.$onChanges)&&t.$onChanges(e.bindingInfo.initialChanges),x(t.$onInit)&&t.$onInit(),x(t.$onDestroy)&&S.$on("$destroy",function(){t.$onDestroy()})}),h=0;for(p=f.length;h<p;h++)d=f[h],dt(d,d.isolateScope?E:i,L,o,d.require&&K(d.directiveName,d.require,L,T),k);var M=i;b&&(b.template||null===b.templateUrl)&&(M=E),e&&e(M,s.childNodes,void 0,u);for(h=l.length-1;0<=h;h--)d=l[h],dt(d,d.isolateScope?E:i,L,o,d.require&&K(d.directiveName,d.require,L,T),k);r(T,function(e){e=e.instance,x(e.$postLink)&&e.$postLink()})}c=c||{};for(var d=-Number.MAX_VALUE,v=c.newScopeDirective,g=c.controllerDirectives,b=c.newIsolateScopeDirective,w=c.templateDirective,E=c.nonTlbTranscludeDirective,S=!1,T=!1,N=c.hasElementTranscludeDirective,k=n.$$element=Jr(t),L,A,O,_=i,D,P=!1,H=!1,F,I=0,R=e.length;I<R;I++){L=e[I];var U=L.$$start,J=L.$$end;U&&(k=X(t,U,J)),O=void 0;if(d>L.priority)break;if(F=L.scope)L.templateUrl||(y(F)?(st("new/isolated scope",b||v,L,k),b=L):st("new/isolated scope",b,L,k)),v=v||L;A=L.name;if(!P&&(L.replace&&(L.templateUrl||L.template)||L.transclude&&!L.$$tlb)){for(F=I+1;P=e[F++];)if(P.transclude&&!P.$$tlb||P.replace&&(P.templateUrl||P.template)){H=!0;break}P=!0}!L.templateUrl&&L.controller&&(F=L.controller,g=g||ut(),st("'"+A+"' controller",g[A],L,k),g[A]=L);if(F=L.transclude)if(S=!0,L.$$tlb||(st("transclusion",E,L,k),E=L),"element"==F)N=!0,d=L.priority,O=k,k=n.$$element=Jr(q.$$createComment(A,n[A])),t=k[0],ct(o,Qr.call(O,0),t),O[0].$$parentNode=O[0].parentNode,_=$(H,O,i,d,u&&u.name,{nonTlbTranscludeDirective:E});else{var Y=ut();O=Jr(vt(t)).contents();if(y(F)){O=[];var Z=ut(),et=ut();r(F,function(e,t){var n="?"===e.charAt(0);e=n?e.substring(1):e,Z[e]=t,Y[t]=null,et[t]=n}),r(k.contents(),function(e){var t=Z[Qt(M(e))];t?(et[t]=!0,Y[t]=Y[t]||[],Y[t].push(e)):O.push(e)}),r(et,function(e,t){if(!e)throw $i("reqslot",t)});for(var nt in Y)Y[nt]&&(Y[nt]=$(H,Y[nt],i))}k.empty(),_=$(H,O,i,void 0,void 0,{needsNewScope:L.$$isolateScope||L.$$newScope}),_.$$slots=Y}if(L.template)if(T=!0,st("template",w,L,k),w=L,F=x(L.template)?L.template(k,n):L.template,F=xt(F),L.replace){u=L,O=Ti.test(F)?Yt(at(L.templateNamespace,ui(F))):[],t=O[0];if(1!=O.length||1!==t.nodeType)throw $i("tplrt",A,"");ct(o,k,t),R={$attr:{}},F=W(t,[],R);var it=e.splice(I+1,e.length-(I+1));(b||v)&&G(F,b,v),e=e.concat(F).concat(it),tt(n,R),R=e.length}else k.html(F);if(L.templateUrl)T=!0,st("template",w,L,k),w=L,L.replace&&(u=L),p=rt(e.splice(I,e.length-I),k,n,o,S&&_,f,l,{controllerDirectives:g,newScopeDirective:v!==L&&v,newIsolateScopeDirective:b,templateDirective:w,nonTlbTranscludeDirective:E}),R=e.length;else if(L.compile)try{D=L.compile(k,n,_);var ot=L.$$originalDirective||L;x(D)?h(null,j(ot,D),U,J):D&&h(j(ot,D.pre),j(ot,D.post),U,J)}catch(ft){s(ft,z(k))}L.terminal&&(p.terminal=!0,d=Math.max(d,L.priority))}return p.scope=v&&!0===v.scope,p.transcludeOnThisElement=S,p.templateOnThisElement=T,p.transclude=_,c.hasElementTranscludeDirective=N,p}function K(e,t,n,i){var s;if(w(t)){var o=t.match(E);t=t.substring(o[0].length);var u=o[1]||o[3],o="?"===o[2];"^^"===u?n=n.parent():s=(s=i&&i[t])&&s.instance;if(!s){var a="$"+t+"Controller";s=u?n.inheritedData(a):n.data(a)}if(!s&&!o)throw $i("ctreq",t,e)}else if(si(t))for(s=[],u=0,o=t.length;u<o;u++)s[u]=K(e,t[u],n,i);else y(t)&&(s={},r(t,function(t,r){s[r]=K(e,t,n,i)}));return s||null}function Q(e,t,n,r,i,s,o){var u=ut(),a;for(a in r){var f=r[a],l={$scope:f===o||f.$$isolateScope?i:s,$element:e,$attrs:t,$transclude:n},c=f.controller;"@"==c&&(c=t[f.name]),l=d(c,l,!0,f.controllerAs),u[f.name]=l,e.data("$"+f.name+"Controller",l.instance)}return u}function G(e,t,n){for(var r=0,i=e.length;r<i;r++)e[r]=c(e[r],{$$isolateScope:t,$$newScope:n})}function Y(e,n,r,o,u,a,l){if(n===u)return null;u=null;if(f.hasOwnProperty(n)){var h;n=t.get(n+"Directive");for(var p=0,d=n.length;p<d;p++)try{if(h=n[p],(m(o)||o>h.priority)&&-1!=h.restrict.indexOf(r)){a&&(h=c(h,{$$start:a,$$end:l}));if(!h.$$bindings){var v=h,g=h,b=h.name,w={isolateScope:null,bindToController:null};y(g.scope)&&(!0===g.bindToController?(w.bindToController=i(g.scope,b,!0),w.isolateScope={}):w.isolateScope=i(g.scope,b,!1)),y(g.bindToController)&&(w.bindToController=i(g.bindToController,b,!0));if(y(w.bindToController)){var E=g.controller,S=g.controllerAs;if(!E)throw $i("noctrl",b);if(!Zt(E,S))throw $i("noident",b)}var x=v.$$bindings=w;y(x.isolateScope)&&(h.$$isolateBindings=x.isolateScope)}e.push(h),u=h}}catch(T){s(T)}}return u}function Z(e){if(f.hasOwnProperty(e))for(var n=t.get(e+"Directive"),r=0,i=n.length;r<i;r++)if(e=n[r],e.multiElement)return!0;return!1}function tt(e,t){var n=t.$attr,i=e.$attr,s=e.$$element;r(e,function(r,i){"$"!=i.charAt(0)&&(t[i]&&t[i]!==r&&(r+=("style"===i?";":" ")+t[i]),e.$set(i,r,!0,n[i]))}),r(t,function(t,r){"class"==r?(I(s,t),e["class"]=(e["class"]?e["class"]+" ":"")+t):"style"==r?(s.attr("style",s.attr("style")+";"+t),e.style=(e.style?e.style+";":"")+t):"$"==r.charAt(0)||e.hasOwnProperty(r)||(e[r]=t,i[r]=n[r])})}function rt(e,t,n,i,s,u,a,f){var l=[],h,p,d=t[0],v=e.shift(),m=c(v,{templateUrl:null,transclude:null,replace:null,$$originalDirective:v}),g=x(v.templateUrl)?v.templateUrl(t,n):v.templateUrl,b=v.templateNamespace;return t.empty(),o(g).then(function(o){var c,w;o=xt(o);if(v.replace){o=Ti.test(o)?Yt(at(b,ui(o))):[],c=o[0];if(1!=o.length||1!==c.nodeType)throw $i("tplrt",v.name,g);o={$attr:{}},ct(i,t,c);var E=W(c,[],o);y(v.scope)&&G(E,!0),e=E.concat(e),tt(n,o)}else c=d,t.html(o);e.unshift(m),h=J(e,c,n,s,t,v,u,a,f),r(i,function(e,n){e==c&&(i[n]=t[0])});for(p=R(t[0].childNodes,s);l.length;){o=l.shift(),w=l.shift();var S=l.shift(),x=l.shift(),E=t[0];if(!o.$$destroyed){if(w!==d){var T=w.className;f.hasElementTranscludeDirective&&v.replace||(E=vt(c)),ct(S,Jr(w),E),I(Jr(E),T)}w=h.transcludeOnThisElement?U(o,h.transclude,x):x,h(p,o,E,i,w)}}l=null}),function(e,t,n,r,i){e=i,t.$$destroyed||(l?l.push(t,n,r,e):(h.transcludeOnThisElement&&(e=U(t,h.transclude,i)),h(p,t,n,r,e)))}}function it(e,t){var n=t.priority-e.priority;return 0!==n?n:e.name!==t.name?e.name<t.name?-1:1:e.index-t.index}function st(e,t,n,r){function i(e){return e?" (module: "+e+")":""}if(t)throw $i("multidir",t.name,i(t.$$moduleName),n.name,i(n.$$moduleName),e,z(r))}function ot(e,t){var r=n(t,!0);r&&e.push({priority:0,compile:function(e){e=e.parent();var t=!!e.length;return t&&q.$$addBindingClass(e),function(e,n){var i=n.parent();t||q.$$addBindingClass(i),q.$$addBindingInfo(i,r.expressions),e.$watch(r,function(e){n[0].nodeValue=e})}}})}function at(t,n){t=Xr(t||"html");switch(t){case"svg":case"math":var r=e.document.createElement("div");return r.innerHTML="<"+t+">"+n+"</"+t+">",r.childNodes[0].childNodes;default:return n}}function ft(e,t){if("srcdoc"==t)return A.HTML;var n=M(e);if("xlinkHref"==t||"form"==n&&"action"==t||"img"!=n&&("src"==t||"ngSrc"==t))return A.RESOURCE_URL}function lt(e,t,r,i,s){var o=ft(e,i);s=b[i]||s;var u=n(r,!0,o,s);if(u){if("multiple"===i&&"select"===M(e))throw $i("selmulti",z(e));t.push({priority:100,compile:function(){return{pre:function(e,t,a){t=a.$$observers||(a.$$observers=ut());if(S.test(i))throw $i("nodomevents");var f=a[i];f!==r&&(u=f&&n(f,!0,o,s),r=f),u&&(a[i]=u(e),(t[i]||(t[i]=[])).$$inter=!0,(a.$$observers&&a.$$observers[i].$$scope||e).$watch(u,function(e,t){"class"===i&&e!=t?a.$updateClass(e,t):a.$set(i,e)}))}}}})}}function ct(t,n,r){var i=n[0],s=n.length,o=i.parentNode,u,a;if(t)for(u=0,a=t.length;u<a;u++)if(t[u]==i){t[u++]=r,a=u+s-1;for(var f=t.length;u<f;u++,a++)a<f?t[u]=t[a]:delete t[u];t.length-=s-1,t.context===i&&(t.context=r);break}o&&o.replaceChild(r,i),t=e.document.createDocumentFragment();for(u=0;u<s;u++)t.appendChild(n[u]);Jr.hasData(i)&&(Jr.data(r,Jr.data(i)),Jr(i).off("$destroy")),Jr.cleanData(t.querySelectorAll("*"));for(u=1;u<s;u++)delete n[u];n[0]=r,n.length=1}function ht(e,t){return a(function(){return e.apply(null,arguments)},e,t)}function dt(e,t,n,r,i,o){try{e(t,n,r,i,o)}catch(u){s(u,z(n))}}function mt(e,t,i,s,o){function a(t,n,r){x(i.$onChanges)&&n!==r&&(wt||(e.$$postDigest(P),wt=[]),p||(p={},wt.push(f)),p[t]&&(r=p[t].previousValue),p[t]=new Kt(r,n))}function f(){i.$onChanges(p),p=void 0}var l=[],c={},p;return r(s,function(r,s){var f=r.attrName,p=r.optional,d,v,m,g;switch(r.mode){case"@":p||Wr.call(t,f)||(i[s]=t[f]=void 0),t.$observe(f,function(e){if(w(e)||k(e))a(s,e,i[s]),i[s]=e}),t.$$observers[f].$$scope=e,d=t[f],w(d)?i[s]=n(d)(e):k(d)&&(i[s]=d),c[s]=new Kt(Ji,i[s]);break;case"=":if(!Wr.call(t,f)){if(p)break;t[f]=void 0}if(p&&!t[f])break;v=u(t[f]),g=v.literal?H:function(e,t){return e===t||e!==e&&t!==t},m=v.assign||function(){throw d=i[s]=v(e),$i("nonassign",t[f],f,o.name)},d=i[s]=v(e),p=function(t){return g(t,i[s])||(g(t,d)?m(e,t=i[s]):i[s]=t),d=t},p.$stateful=!0,p=r.collection?e.$watchCollection(t[f],p):e.$watch(u(t[f],p),null,v.literal),l.push(p);break;case"<":if(!Wr.call(t,f)){if(p)break;t[f]=void 0}if(p&&!t[f])break;v=u(t[f]);var y=i[s]=v(e);c[s]=new Kt(Ji,i[s]),p=e.$watch(v,function(e,t){if(t===e){if(t===y)return;t=y}a(s,e,t),i[s]=e},v.literal),l.push(p);break;case"&":v=t.hasOwnProperty(f)?u(t[f]):h;if(v===h&&p)break;i[s]=function(t){return v(e,t)}}}),{initialChanges:c,removeWatches:l.length&&function(){for(var e=0,t=l.length;e<t;++e)l[e]()}}}var gt=/^\w/,yt=e.document.createElement("div"),bt=L,wt;B.prototype={$normalize:Qt,$addClass:function(e){e&&0<e.length&&O.addClass(this.$$element,e)},$removeClass:function(e){e&&0<e.length&&O.removeClass(this.$$element,e)},$updateClass:function(e,t){var n=Gt(e,t);n&&n.length&&O.addClass(this.$$element,n),(n=Gt(t,e))&&n.length&&O.removeClass(this.$$element,n)},$set:function(e,t,n,i){var o=Ot(this.$$element[0],e),u=_i[e],a=e;o?(this.$$element.prop(e,t),i=o):u&&(this[u]=t,a=u),this[e]=t,i?this.$attr[e]=i:(i=this.$attr[e])||(this.$attr[e]=i=et(e,"-")),o=M(this.$$element);if("a"===o&&("href"===e||"xlinkHref"===e)||"img"===o&&"src"===e)this[e]=t=D(t,"src"===e);else if("img"===o&&"srcset"===e&&g(t)){for(var o="",u=ui(t),f=/(\s+\d+x\s*,|\s+\d+w\s*,|\s+,|,\s+)/,f=/\s/.test(u)?f:/(,)/,u=u.split(f),f=Math.floor(u.length/2),l=0;l<f;l++)var c=2*l,o=o+D(ui(u[c]),!0),o=o+(" "+ui(u[c+1]));u=ui(u[2*l]).split(/\s/),o+=D(ui(u[0]),!0),2===u.length&&(o+=" "+ui(u[1])),this[e]=t=o}!1!==n&&(null===t||m(t)?this.$$element.removeAttr(i):gt.test(i)?this.$$element.attr(i,t):F(this.$$element[0],i,t)),(e=this.$$observers)&&r(e[a],function(e){try{e(t)}catch(n){s(n)}})},$observe:function(e,t){var n=this,r=n.$$observers||(n.$$observers=ut()),i=r[e]||(r[e]=[]);return i.push(t),T.$evalAsync(function(){i.$$inter||!n.hasOwnProperty(e)||m(n[e])||t(n[e])}),function(){_(i,t)}}};var Et=n.startSymbol(),St=n.endSymbol(),xt="{{"==Et&&"}}"==St?p:function(e){return e.replace(/\{\{/g,Et).replace(/}}/g,St)},Tt=/^ngAttr[A-Z]/,Nt=/^(.+)Start$/;return q.$$addBindingInfo=N?function(e,t){var n=e.data("$binding")||[];si(t)?n=n.concat(t):n.push(t),e.data("$binding",n)}:h,q.$$addBindingClass=N?function(e){I(e,"ng-binding")}:h,q.$$addScopeInfo=N?function(e,t,n,r){e.data(n?r?"$isolateScopeNoTemplate":"$isolateScope":"$scope",t)}:h,q.$$addScopeClass=N?function(e,t){I(e,t?"ng-isolate-scope":"ng-scope")}:h,q.$$createComment=function(t,n){var r="";return N&&(r=" "+(t||"")+": ",n&&(r+=n+" ")),e.document.createComment(r)},q}]}function Kt(e,t){this.previousValue=e,this.currentValue=t}function Qt(e){return lt(e.replace(Ki,""))}function Gt(e,t){var n="",r=e.split(/\s+/),i=t.split(/\s+/),s=0;e:for(;s<r.length;s++){for(var o=r[s],u=0;u<i.length;u++)if(o==i[u])continue e;n+=(0<n.length?" ":"")+o}return n}function Yt(e){e=Jr(e);var t=e.length;if(1>=t)return e;for(;t--;)8===e[t].nodeType&&Gr.call(e,t,1);return e}function Zt(e,t){if(t&&w(t))return t;if(w(e)){var n=Gi.exec(e);if(n)return n[3]}}function en(){var e={},n=!1;this.has=function(t){return e.hasOwnProperty(t)},this.register=function(t,n){it(t,"controller"),y(t)?a(e,t):e[t]=n},this.allowGlobals=function(){n=!0},this.$get=["$injector","$window",function(r,i){function s(e,n,r,i){if(!e||!y(e.$scope))throw t("$controller")("noscp",i,n);e.$scope[n]=r}return function(t,o,u,f){var l,c,h;u=!0===u,f&&w(f)&&(h=f);if(w(t)){f=t.match(Gi);if(!f)throw Qi("ctrlfmt",t);c=f[1],h=h||f[3],t=e.hasOwnProperty(c)?e[c]:st(o.$scope,c,!0)||(n?st(i,c,!0):void 0),rt(t,c,!0)}return u?(u=(si(t)?t[t.length-1]:t).prototype,l=Object.create(u||null),h&&s(o,h,l,c||t.name),a(function(){var e=r.invoke(t,l,o,c);return e!==l&&(y(e)||x(e))&&(l=e,h&&s(o,h,l,c||t.name)),l},{instance:l,identifier:h})):(l=r.instantiate(t,o,c),h&&s(o,h,l,c||t.name),l)}}]}function tn(){this.$get=["$window",function(e){return Jr(e.document)}]}function nn(){this.$get=["$log",function(e){return function(t,n){e.error.apply(e,arguments)}}]}function rn(e){return y(e)?S(e)?e.toISOString():I(e):e}function sn(){this.$get=function(){return function(e){if(!e)return"";var t=[];return i(e,function(e,n){null===e||m(e)||(si(e)?r(e,function(e){t.push(J(n)+"="+J(rn(e)))}):t.push(J(n)+"="+J(rn(e))))}),t.join("&")}}}function on(){this.$get=function(){return function(e){function t(e,s,o){null===e||m(e)||(si(e)?r(e,function(e,n){t(e,s+"["+(y(e)?n:"")+"]")}):y(e)&&!S(e)?i(e,function(e,n){t(e,s+(o?"":"[")+n+(o?"":"]"))}):n.push(J(s)+"="+J(rn(e))))}if(!e)return"";var n=[];return t(e,"",!0),n.join("&")}}}function un(e,t){if(w(e)){var n=e.replace(rs,"").trim();if(n){var r=t("Content-Type");(r=r&&0===r.indexOf(Zi))||(r=(r=n.match(ts))&&ns[r[0]].test(n)),r&&(e=q(n))}}return e}function an(e){var t=ut(),n;return w(e)?r(e.split("\n"),function(e){n=e.indexOf(":");var r=Xr(ui(e.substr(0,n)));e=ui(e.substr(n+1)),r&&(t[r]=t[r]?t[r]+", "+e:e)}):y(e)&&r(e,function(e,n){var r=Xr(n),i=ui(e);r&&(t[r]=t[r]?t[r]+", "+i:i)}),t}function fn(e){var t;return function(n){return t||(t=an(e)),n?(n=t[Xr(n)],void 0===n&&(n=null),n):t}}function ln(e,t,n,i){return x(i)?i(e,t,n):(r(i,function(r){e=r(e,t,n)}),e)}function cn(){var e=this.defaults={transformResponse:[un],transformRequest:[function(e){return y(e)&&"[object File]"!==Zr.call(e)&&"[object Blob]"!==Zr.call(e)&&"[object FormData]"!==Zr.call(e)?I(e):e}],headers:{common:{Accept:"application/json, text/plain, */*"},post:P(es),put:P(es),patch:P(es)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",paramSerializer:"$httpParamSerializer"},n=!1;this.useApplyAsync=function(e){return g(e)?(n=!!e,this):n};var i=!0;this.useLegacyPromiseExtensions=function(e){return g(e)?(i=!!e,this):i};var s=this.interceptors=[];this.$get=["$httpBackend","$$cookieReader","$cacheFactory","$rootScope","$q","$injector",function(o,u,f,l,c,h){function p(n){function s(e){var t=a({},e);return t.data=ln(e.data,e.headers,e.status,u.transformResponse),e=e.status,200<=e&&300>e?t:c.reject(t)}function o(e,t){var n,i={};return r(e,function(e,r){x(e)?(n=e(t),null!=n&&(i[r]=n)):i[r]=e}),i}if(!y(n))throw t("$http")("badreq",n);if(!w(n.url))throw t("$http")("badreq",n.url);var u=a({method:"get",transformRequest:e.transformRequest,transformResponse:e.transformResponse,paramSerializer:e.paramSerializer},n);u.headers=function(t){var n=e.headers,r=a({},t.headers),i,s,u,n=a({},n.common,n[Xr(t.method)]);e:for(i in n){s=Xr(i);for(u in r)if(Xr(u)===s)continue e;r[i]=n[i]}return o(r,P(t))}(n),u.method=Vr(u.method),u.paramSerializer=w(u.paramSerializer)?h.get(u.paramSerializer):u.paramSerializer;var f=[function(t){var n=t.headers,i=ln(t.data,fn(n),void 0,t.transformRequest);return m(i)&&r(n,function(e,t){"content-type"===Xr(t)&&delete n[t]}),m(t.withCredentials)&&!m(e.withCredentials)&&(t.withCredentials=e.withCredentials),d(t,i).then(s,s)},void 0],l=c.when(u);for(r(E,function(e){(e.request||e.requestError)&&f.unshift(e.request,e.requestError),(e.response||e.responseError)&&f.push(e.response,e.responseError)});f.length;){n=f.shift();var p=f.shift(),l=l.then(n,p)}return i?(l.success=function(e){return rt(e,"fn"),l.then(function(t){e(t.data,t.status,t.headers,u)}),l},l.error=function(e){return rt(e,"fn"),l.then(null,function(t){e(t.data,t.status,t.headers,u)}),l}):(l.success=ss("success"),l.error=ss("error")),l}function d(t,i){function s(e){if(e){var t={};return r(e,function(e,r){t[r]=function(t){function r(){e(t)}n?l.$applyAsync(r):l.$$phase?r():l.$apply(r)}}),t}}function a(e,t,r,i){function s(){f(t,e,r,i)}S&&(200<=e&&300>e?S.put(C,[e,t,an(r),i]):S.remove(C)),n?l.$applyAsync(s):(s(),l.$$phase||l.$apply())}function f(e,n,r,i){n=-1<=n?n:0,(200<=n&&300>n?w.resolve:w.reject)({data:e,status:n,headers:fn(r),config:t,statusText:i})}function h(e){f(e.data,e.status,P(e.headers()),e.statusText)}function d(){var e=p.pendingRequests.indexOf(t);-1!==e&&p.pendingRequests.splice(e,1)}var w=c.defer(),E=w.promise,S,T,N=t.headers,C=v(t.url,t.paramSerializer(t.params));return p.pendingRequests.push(t),E.then(d,d),!t.cache&&!e.cache||!1===t.cache||"GET"!==t.method&&"JSONP"!==t.method||(S=y(t.cache)?t.cache:y(e.cache)?e.cache:b),S&&(T=S.get(C),g(T)?T&&x(T.then)?T.then(h,h):si(T)?f(T[1],T[0],P(T[2]),T[3]):f(T,200,{},"OK"):S.put(C,E)),m(T)&&((T=ar(t.url)?u()[t.xsrfCookieName||e.xsrfCookieName]:void 0)&&(N[t.xsrfHeaderName||e.xsrfHeaderName]=T),o(t.method,C,i,a,N,t.timeout,t.withCredentials,t.responseType,s(t.eventHandlers),s(t.uploadEventHandlers))),E}function v(e,t){return 0<t.length&&(e+=(-1==e.indexOf("?")?"?":"&")+t),e}var b=f("$http");e.paramSerializer=w(e.paramSerializer)?h.get(e.paramSerializer):e.paramSerializer;var E=[];return r(s,function(e){E.unshift(w(e)?h.get(e):h.invoke(e))}),p.pendingRequests=[],function(e){r(arguments,function(e){p[e]=function(t,n){return p(a({},n||{},{method:e,url:t}))}})}("get","delete","head","jsonp"),function(e){r(arguments,function(e){p[e]=function(t,n,r){return p(a({},r||{},{method:e,url:t,data:n}))}})}("post","put","patch"),p.defaults=e,p}]}function hn(){this.$get=function(){return function(){return new e.XMLHttpRequest}}}function pn(){this.$get=["$browser","$window","$document","$xhrFactory",function(e,t,n,r){return dn(e,r,e.defer,t.angular.callbacks,n[0])}]}function dn(e,t,n,i,s){function o(e,t,n){var r=s.createElement("script"),o=null;return r.type="text/javascript",r.src=e,r.async=!0,o=function(e){r.removeEventListener("load",o,!1),r.removeEventListener("error",o,!1),s.body.removeChild(r),r=null;var u=-1,a="unknown";e&&("load"!==e.type||i[t].called||(e={type:"error"}),a=e.type,u="error"===e.type?404:200),n&&n(u,a)},r.addEventListener("load",o,!1),r.addEventListener("error",o,!1),s.body.appendChild(r),o}return function(s,u,a,f,l,c,p,d,v,y){function b(){S&&S(),T&&T.abort()}function w(t,r,i,s,o){g(C)&&n.cancel(C),S=T=null,t(r,i,s,o),e.$$completeOutstandingRequest(h)}e.$$incOutstandingRequestCount(),u=u||e.url();if("jsonp"==Xr(s)){var E="_"+(i.counter++).toString(36);i[E]=function(e){i[E].data=e,i[E].called=!0};var S=o(u.replace("JSON_CALLBACK","angular.callbacks."+E),E,function(e,t){w(f,e,i[E].data,"",t),i[E]=h})}else{var T=t(s,u);T.open(s,u,!0),r(l,function(e,t){g(e)&&T.setRequestHeader(t,e)}),T.onload=function(){var e=T.statusText||"",t="response"in T?T.response:T.responseText,n=1223===T.status?204:T.status;0===n&&(n=t?200:"file"==ur(u).protocol?404:0),w(f,n,t,T.getAllResponseHeaders(),e)},s=function(){w(f,-1,null,null,"")},T.onerror=s,T.onabort=s,r(v,function(e,t){T.addEventListener(t,e)}),r(y,function(e,t){T.upload.addEventListener(t,e)}),p&&(T.withCredentials=!0);if(d)try{T.responseType=d}catch(N){if("json"!==d)throw N}T.send(m(a)?null:a)}if(0<c)var C=n(b,c);else c&&x(c.then)&&c.then(b)}}function vn(){var e="{{",t="}}";this.startSymbol=function(t){return t?(e=t,this):e},this.endSymbol=function(e){return e?(t=e,this):t},this.$get=["$parse","$exceptionHandler","$sce",function(n,r,i){function s(e){return"\\\\\\"+e}function o(n){return n.replace(h,e).replace(p,t)}function u(e,t,n,r){var i;return i=e.$watch(function(e){return i(),r(e)},t,n)}function f(s,f,h,p){function v(e){try{var t=e;e=h?i.getTrusted(h,t):i.valueOf(t);var n;if(p&&!g(e))n=e;else if(null==e)n="";else{switch(typeof e){case"string":break;case"number":e=""+e;break;default:e=I(e)}n=e}return n}catch(o){r(os.interr(s,o))}}if(!s.length||-1===s.indexOf(e)){var y;return f||(f=o(s),y=d(f),y.exp=s,y.expressions=[],y.$$watchDelegate=u),y}p=!!p;var b,w,E=0,S=[],T=[];y=s.length;for(var N=[],C=[];E<y;){if(-1==(b=s.indexOf(e,E))||-1==(w=s.indexOf(t,b+l))){E!==y&&N.push(o(s.substring(E)));break}E!==b&&N.push(o(s.substring(E,b))),E=s.substring(b+l,w),S.push(E),T.push(n(E,v)),E=w+c,C.push(N.length),N.push("")}h&&1<N.length&&os.throwNoconcat(s);if(!f||S.length){var k=function(e){for(var t=0,n=S.length;t<n;t++){if(p&&m(e[t]))return;N[C[t]]=e[t]}return N.join("")};return a(function(e){var t=0,n=S.length,i=Array(n);try{for(;t<n;t++)i[t]=T[t](e);return k(i)}catch(o){r(os.interr(s,o))}},{exp:s,expressions:S,$$watchDelegate:function(e,t){var n;return e.$watchGroup(T,function(r,i){var s=k(r);x(t)&&t.call(this,s,r!==i?n:s,e),n=s})}})}}var l=e.length,c=t.length,h=new RegExp(e.replace(/./g,s),"g"),p=new RegExp(t.replace(/./g,s),"g");return f.startSymbol=function(){return e},f.endSymbol=function(){return t},f}]}function mn(){this.$get=["$rootScope","$window","$q","$$q","$browser",function(e,t,n,r,i){function s(s,u,a,f){function l(){c?s.apply(null,h):s(v)}var c=4<arguments.length,h=c?Qr.call(arguments,4):[],p=t.setInterval,d=t.clearInterval,v=0,m=g(f)&&!f,y=(m?r:n).defer(),b=y.promise;return a=g(a)?a:0,b.$$intervalId=p(function(){m?i.defer(l):e.$evalAsync(l),y.notify(v++),0<a&&v>=a&&(y.resolve(v),d(b.$$intervalId),delete o[b.$$intervalId]),m||e.$apply()},u),o[b.$$intervalId]=y,b}var o={};return s.cancel=function(e){return e&&e.$$intervalId in o?(o[e.$$intervalId].reject("canceled"),t.clearInterval(e.$$intervalId),delete o[e.$$intervalId],!0):!1},s}]}function gn(e){e=e.split("/");for(var t=e.length;t--;)e[t]=$(e[t]);return e.join("/")}function yn(e,t){var n=ur(e);t.$$protocol=n.protocol,t.$$host=n.hostname,t.$$port=l(n.port)||as[n.protocol]||null}function bn(e,t){var n="/"!==e.charAt(0);n&&(e="/"+e);var r=ur(e);t.$$path=decodeURIComponent(n&&"/"===r.pathname.charAt(0)?r.pathname.substring(1):r.pathname),t.$$search=X(r.search),t.$$hash=decodeURIComponent(r.hash),t.$$path&&"/"!=t.$$path.charAt(0)&&(t.$$path="/"+t.$$path)}function wn(e,t){if(0===t.lastIndexOf(e,0))return t.substr(e.length)}function En(e){var t=e.indexOf("#");return-1==t?e:e.substr(0,t)}function Sn(e){return e.replace(/(#.+)|#$/,"$1")}function xn(e,t,n){this.$$html5=!0,n=n||"",yn(e,this),this.$$parse=function(e){var n=wn(t,e);if(!w(n))throw fs("ipthprfx",e,t);bn(n,this),this.$$path||(this.$$path="/"),this.$$compose()},this.$$compose=function(){var e=V(this.$$search),n=this.$$hash?"#"+$(this.$$hash):"";this.$$url=gn(this.$$path)+(e?"?"+e:"")+n,this.$$absUrl=t+this.$$url.substr(1)},this.$$parseLinkUrl=function(r,i){if(i&&"#"===i[0])return this.hash(i.slice(1)),!0;var s,o;return g(s=wn(e,r))?(o=s,o=g(s=wn(n,s))?t+(wn("/",s)||s):e+o):g(s=wn(t,r))?o=t+s:t==r+"/"&&(o=t),o&&this.$$parse(o),!!o}}function Tn(e,t,n){yn(e,this),this.$$parse=function(r){var i=wn(e,r)||wn(t,r),s;m(i)||"#"!==i.charAt(0)?this.$$html5?s=i:(s="",m(i)&&(e=r,this.replace())):(s=wn(n,i),m(s)&&(s=i)),bn(s,this),r=this.$$path;var i=e,o=/^\/[A-Z]:(\/.*)/;0===s.lastIndexOf(i,0)&&(s=s.replace(i,"")),o.exec(s)||(r=(s=o.exec(r))?s[1]:r),this.$$path=r,this.$$compose()},this.$$compose=function(){var t=V(this.$$search),r=this.$$hash?"#"+$(this.$$hash):"";this.$$url=gn(this.$$path)+(t?"?"+t:"")+r,this.$$absUrl=e+(this.$$url?n+this.$$url:"")},this.$$parseLinkUrl=function(t,n){return En(e)==En(t)?(this.$$parse(t),!0):!1}}function Nn(e,t,n){this.$$html5=!0,Tn.apply(this,arguments),this.$$parseLinkUrl=function(r,i){if(i&&"#"===i[0])return this.hash(i.slice(1)),!0;var s,o;return e==En(r)?s=r:(o=wn(t,r))?s=e+n+o:t===r+"/"&&(s=t),s&&this.$$parse(s),!!s},this.$$compose=function(){var t=V(this.$$search),r=this.$$hash?"#"+$(this.$$hash):"";this.$$url=gn(this.$$path)+(t?"?"+t:"")+r,this.$$absUrl=e+n+this.$$url}}function Cn(e){return function(){return this[e]}}function kn(e,t){return function(n){return m(n)?this[e]:(this[e]=t(n),this.$$compose(),this)}}function Ln(){var e="",t={enabled:!1,requireBase:!0,rewriteLinks:!0};this.hashPrefix=function(t){return g(t)?(e=t,this):e},this.html5Mode=function(e){return k(e)?(t.enabled=e,this):y(e)?(k(e.enabled)&&(t.enabled=e.enabled),k(e.requireBase)&&(t.requireBase=e.requireBase),k(e.rewriteLinks)&&(t.rewriteLinks=e.rewriteLinks),this):t},this.$get=["$rootScope","$browser","$sniffer","$rootElement","$window",function(n,r,i,s,o){function u(e,t,n){var i=f.url(),s=f.$$state;try{r.url(e,t,n),f.$$state=r.state()}catch(o){throw f.url(i),f.$$state=s,o}}function a(e,t){n.$broadcast("$locationChangeSuccess",f.absUrl(),e,f.$$state,t)}var f,l;l=r.baseHref();var c=r.url(),h;if(t.enabled){if(!l&&t.requireBase)throw fs("nobase");h=c.substring(0,c.indexOf("/",c.indexOf("//")+2))+(l||"/"),l=i.history?xn:Nn}else h=En(c),l=Tn;var p=h.substr(0,En(h).lastIndexOf("/")+1);f=new l(h,p,"#"+e),f.$$parseLinkUrl(c,c),f.$$state=r.state();var d=/^\s*(javascript|mailto):/i;s.on("click",function(e){if(t.rewriteLinks&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&2!=e.which&&2!=e.button){for(var i=Jr(e.target);"a"!==M(i[0]);)if(i[0]===s[0]||!(i=i.parent())[0])return;var u=i.prop("href"),a=i.attr("href")||i.attr("xlink:href");y(u)&&"[object SVGAnimatedString]"===u.toString()&&(u=ur(u.animVal).href),d.test(u)||!u||i.attr("target")||e.isDefaultPrevented()||!f.$$parseLinkUrl(u,a)||(e.preventDefault(),f.absUrl()!=r.url()&&(n.$apply(),o.angular["ff-684208-preventDefault"]=!0))}}),Sn(f.absUrl())!=Sn(c)&&r.url(f.absUrl(),!0);var v=!0;return r.onUrlChange(function(e,t){m(wn(p,e))?o.location.href=e:(n.$evalAsync(function(){var r=f.absUrl(),i=f.$$state,s;e=Sn(e),f.$$parse(e),f.$$state=t,s=n.$broadcast("$locationChangeStart",e,r,t,i).defaultPrevented,f.absUrl()===e&&(s?(f.$$parse(r),f.$$state=i,u(r,!1,i)):(v=!1,a(r,i)))}),n.$$phase||n.$digest())}),n.$watch(function(){var e=Sn(r.url()),t=Sn(f.absUrl()),s=r.state(),o=f.$$replace,l=e!==t||f.$$html5&&i.history&&s!==f.$$state;if(v||l)v=!1,n.$evalAsync(function(){var t=f.absUrl(),r=n.$broadcast("$locationChangeStart",t,e,f.$$state,s).defaultPrevented;f.absUrl()===t&&(r?(f.$$parse(e),f.$$state=s):(l&&u(t,o,s===f.$$state?null:f.$$state),a(e,s)))});f.$$replace=!1}),f}]}function An(){var e=!0,t=this;this.debugEnabled=function(t){return g(t)?(e=t,this):e},this.$get=["$window",function(n){function i(e){return e instanceof Error&&(e.stack?e=e.message&&-1===e.stack.indexOf(e.message)?"Error: "+e.message+"\n"+e.stack:e.stack:e.sourceURL&&(e=e.message+"\n"+e.sourceURL+":"+e.line)),e}function s(e){var t=n.console||{},s=t[e]||t.log||h;e=!1;try{e=!!s.apply}catch(o){}return e?function(){var e=[];return r(arguments,function(t){e.push(i(t))}),s.apply(t,e)}:function(e,t){s(e,null==t?"":t)}}return{log:s("log"),info:s("info"),warn:s("warn"),error:s("error"),debug:function(){var n=s("debug");return function(){e&&n.apply(t,arguments)}}()}}]}function On(e,t){if("__defineGetter__"===e||"__defineSetter__"===e||"__lookupGetter__"===e||"__lookupSetter__"===e||"__proto__"===e)throw cs("isecfld",t);return e}function Mn(e){return e+""}function _n(e,t){if(e){if(e.constructor===e)throw cs("isecfn",t);if(e.window===e)throw cs("isecwindow",t);if(e.children&&(e.nodeName||e.prop&&e.attr&&e.find))throw cs("isecdom",t);if(e===Object)throw cs("isecobj",t)}return e}function Dn(e,t){if(e){if(e.constructor===e)throw cs("isecfn",t);if(e===hs||e===ps||e===ds)throw cs("isecff",t)}}function Pn(e,t){if(e&&(e===0..constructor||e===(!1).constructor||e==="".constructor||e==={}.constructor||e===[].constructor||e===Function.constructor))throw cs("isecaf",t)}function Hn(e,t){return"undefined"!=typeof e?e:t}function Bn(e,t){return"undefined"==typeof e?t:"undefined"==typeof t?e:e+t}function jn(e,t){var n,i;switch(e.type){case ys.Program:n=!0,r(e.body,function(e){jn(e.expression,t),n=n&&e.expression.constant}),e.constant=n;break;case ys.Literal:e.constant=!0,e.toWatch=[];break;case ys.UnaryExpression:jn(e.argument,t),e.constant=e.argument.constant,e.toWatch=e.argument.toWatch;break;case ys.BinaryExpression:jn(e.left,t),jn(e.right,t),e.constant=e.left.constant&&e.right.constant,e.toWatch=e.left.toWatch.concat(e.right.toWatch);break;case ys.LogicalExpression:jn(e.left,t),jn(e.right,t),e.constant=e.left.constant&&e.right.constant,e.toWatch=e.constant?[]:[e];break;case ys.ConditionalExpression:jn(e.test,t),jn(e.alternate,t),jn(e.consequent,t),e.constant=e.test.constant&&e.alternate.constant&&e.consequent.constant,e.toWatch=e.constant?[]:[e];break;case ys.Identifier:e.constant=!1,e.toWatch=[e];break;case ys.MemberExpression:jn(e.object,t),e.computed&&jn(e.property,t),e.constant=e.object.constant&&(!e.computed||e.property.constant),e.toWatch=[e];break;case ys.CallExpression:n=e.filter?!t(e.callee.name).$stateful:!1,i=[],r(e.arguments,function(e){jn(e,t),n=n&&e.constant,e.constant||i.push.apply(i,e.toWatch)}),e.constant=n,e.toWatch=e.filter&&!t(e.callee.name).$stateful?i:[e];break;case ys.AssignmentExpression:jn(e.left,t),jn(e.right,t),e.constant=e.left.constant&&e.right.constant,e.toWatch=[e];break;case ys.ArrayExpression:n=!0,i=[],r(e.elements,function(e){jn(e,t),n=n&&e.constant,e.constant||i.push.apply(i,e.toWatch)}),e.constant=n,e.toWatch=i;break;case ys.ObjectExpression:n=!0,i=[],r(e.properties,function(e){jn(e.value,t),n=n&&e.value.constant&&!e.computed,e.value.constant||i.push.apply(i,e.value.toWatch)}),e.constant=n,e.toWatch=i;break;case ys.ThisExpression:e.constant=!1,e.toWatch=[];break;case ys.LocalsExpression:e.constant=!1,e.toWatch=[]}}function Fn(e){if(1==e.length){e=e[0].expression;var t=e.toWatch;return 1!==t.length?t:t[0]!==e?t:void 0}}function In(e){return e.type===ys.Identifier||e.type===ys.MemberExpression}function qn(e){if(1===e.body.length&&In(e.body[0].expression))return{type:ys.AssignmentExpression,left:e.body[0].expression,right:{type:ys.NGValueParameter},operator:"="}}function Rn(e){return 0===e.body.length||1===e.body.length&&(e.body[0].expression.type===ys.Literal||e.body[0].expression.type===ys.ArrayExpression||e.body[0].expression.type===ys.ObjectExpression)}function Un(e,t){this.astBuilder=e,this.$filter=t}function zn(e,t){this.astBuilder=e,this.$filter=t}function Wn(e){return"constructor"==e}function Xn(e){return x(e.valueOf)?e.valueOf():ws.call(e)}function Vn(){var e=ut(),t=ut(),n={"true":!0,"false":!1,"null":null,"undefined":void 0},i,s;this.addLiteral=function(e,t){n[e]=t},this.setIdentifierFns=function(e,t){return i=e,s=t,this},this.$get=["$filter",function(o){function u(n,r,i){var s,u,f;i=i||w;switch(typeof n){case"string":f=n=n.trim();var m=i?t:e;s=m[f];if(!s){":"===n.charAt(0)&&":"===n.charAt(1)&&(u=!0,n=n.substring(2)),s=i?b:y;var g=new gs(s);s=(new bs(g,o,s)).parse(n),s.constant?s.$$watchDelegate=d:u?s.$$watchDelegate=s.literal?p:c:s.inputs&&(s.$$watchDelegate=l),i&&(s=a(s)),m[f]=s}return v(s,r);case"function":return v(n,r);default:return v(h,r)}}function a(e){function t(t,n,r,i){var s=w;w=!0;try{return e(t,n,r,i)}finally{w=s}}if(!e)return e;t.$$watchDelegate=e.$$watchDelegate,t.assign=a(e.assign),t.constant=e.constant,t.literal=e.literal;for(var n=0;e.inputs&&n<e.inputs.length;++n)e.inputs[n]=a(e.inputs[n]);return t.inputs=e.inputs,t}function f(e,t){return null==e||null==t?e===t:"object"==typeof e&&(e=Xn(e),"object"==typeof e)?!1:e===t||e!==e&&t!==t}function l(e,t,n,r,i){var s=r.inputs,o;if(1===s.length){var u=f,s=s[0];return e.$watch(function(e){var t=s(e);return f(t,u)||(o=r(e,void 0,void 0,[t]),u=t&&Xn(t)),o},t,n,i)}for(var a=[],l=[],c=0,h=s.length;c<h;c++)a[c]=f,l[c]=null;return e.$watch(function(e){for(var t=!1,n=0,i=s.length;n<i;n++){var u=s[n](e);if(t||(t=!f(u,a[n])))l[n]=u,a[n]=u&&Xn(u)}return t&&(o=r(e,void 0,void 0,l)),o},t,n,i)}function c(e,t,n,r){var i,s;return i=e.$watch(function(e){return r(e)},function(e,n,r){s=e,x(t)&&t.apply(this,arguments),g(e)&&r.$$postDigest(function(){g(s)&&i()})},n)}function p(e,t,n,i){function s(e){var t=!0;return r(e,function(e){g(e)||(t=!1)}),t}var o,u;return o=e.$watch(function(e){return i(e)},function(e,n,r){u=e,x(t)&&t.call(this,e,n,r),s(e)&&r.$$postDigest(function(){s(u)&&o()})},n)}function d(e,t,n,r){var i;return i=e.$watch(function(e){return i(),r(e)},t,n)}function v(e,t){if(!t)return e;var n=e.$$watchDelegate,r=!1,n=n!==p&&n!==c?function(n,i,s,o){return s=r&&o?o[0]:e(n,i,s,o),t(s,n,i)}:function(n,r,i,s){return i=e(n,r,i,s),n=t(i,n,r),g(i)?n:i};return e.$$watchDelegate&&e.$$watchDelegate!==l?n.$$watchDelegate=e.$$watchDelegate:t.$stateful||(n.$$watchDelegate=l,r=!e.inputs,n.inputs=e.inputs?e.inputs:[e]),n}var m=fi().noUnsafeEval,y={csp:m,expensiveChecks:!1,literals:D(n),isIdentifierStart:x(i)&&i,isIdentifierContinue:x(s)&&s},b={csp:m,expensiveChecks:!0,literals:D(n),isIdentifierStart:x(i)&&i,isIdentifierContinue:x(s)&&s},w=!1;return u.$$runningExpensiveChecks=function(){return w},u}]}function $n(){this.$get=["$rootScope","$exceptionHandler",function(e,t){return Kn(function(t){e.$evalAsync(t)},t)}]}function Jn(){this.$get=["$browser","$exceptionHandler",function(e,t){return Kn(function(t){e.defer(t)},t)}]}function Kn(e,n){function i(){this.$$state={status:0}}function s(e,t){return function(n){t.call(e,n)}}function o(t){!t.processScheduled&&t.pending&&(t.processScheduled=!0,e(function(){var e,r,i;i=t.pending,t.processScheduled=!1,t.pending=void 0;for(var s=0,o=i.length;s<o;++s){r=i[s][0],e=i[s][t.status];try{x(e)?r.resolve(e(t.value)):1===t.status?r.resolve(t.value):r.reject(t.value)}catch(u){r.reject(u),n(u)}}}))}function u(){this.promise=new i}var f=t("$q",TypeError);a(i.prototype,{then:function(e,t,n){if(m(e)&&m(t)&&m(n))return this;var r=new u;return this.$$state.pending=this.$$state.pending||[],this.$$state.pending.push([r,e,t,n]),0<this.$$state.status&&o(this.$$state),r.promise},"catch":function(e){return this.then(null,e)},"finally":function(e,t){return this.then(function(t){return c(t,!0,e)},function(t){return c(t,!1,e)},t)}}),a(u.prototype,{resolve:function(e){this.promise.$$state.status||(e===this.promise?this.$$reject(f("qcycle",e)):this.$$resolve(e))},$$resolve:function(e){function t(e){a||(a=!0,u.$$resolve(e))}function r(e){a||(a=!0,u.$$reject(e))}var i,u=this,a=!1;try{if(y(e)||x(e))i=e&&e.then;x(i)?(this.promise.$$state.status=-1,i.call(e,t,r,s(this,this.notify))):(this.promise.$$state.value=e,this.promise.$$state.status=1,o(this.promise.$$state))}catch(f){r(f),n(f)}},reject:function(e){this.promise.$$state.status||this.$$reject(e)},$$reject:function(e){this.promise.$$state.value=e,this.promise.$$state.status=2,o(this.promise.$$state)},notify:function(t){var r=this.promise.$$state.pending;0>=this.promise.$$state.status&&r&&r.length&&e(function(){for(var e,i,s=0,o=r.length;s<o;s++){i=r[s][0],e=r[s][3];try{i.notify(x(e)?e(t):t)}catch(u){n(u)}}})}});var l=function(e,t){var n=new u;return t?n.resolve(e):n.reject(e),n.promise},c=function(e,t,n){var r=null;try{x(n)&&(r=n())}catch(i){return l(i,!1)}return r&&x(r.then)?r.then(function(){return l(e,t)},function(e){return l(e,!1)}):l(e,t)},h=function(e,t,n,r){var i=new u;return i.resolve(e),i.promise.then(t,n,r)},p=function(e){if(!x(e))throw f("norslvr",e);var t=new u;return e(function(e){t.resolve(e)},function(e){t.reject(e)}),t.promise};return p.prototype=i.prototype,p.defer=function(){var e=new u;return e.resolve=s(e,e.resolve),e.reject=s(e,e.reject),e.notify=s(e,e.notify),e},p.reject=function(e){var t=new u;return t.reject(e),t.promise},p.when=h,p.resolve=h,p.all=function(e){var t=new u,n=0,i=si(e)?[]:{};return r(e,function(e,r){n++,h(e).then(function(e){i.hasOwnProperty(r)||(i[r]=e,--n||t.resolve(i))},function(e){i.hasOwnProperty(r)||t.reject(e)})}),0===n&&t.resolve(i),t.promise},p}function Qn(){this.$get=["$window","$timeout",function(e,t){var n=e.requestAnimationFrame||e.webkitRequestAnimationFrame,r=e.cancelAnimationFrame||e.webkitCancelAnimationFrame||e.webkitCancelRequestAnimationFrame,i=!!n,s=i?function(e){var t=n(e);return function(){r(t)}}:function(e){var n=t(e,16.66,!1);return function(){t.cancel(n)}};return s.supported=i,s}]}function Gn(){function e(e){function t(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$id=++ii,this.$$ChildScope=null}return t.prototype=e,t}var i=10,s=t("$rootScope"),o=null,u=null;this.digestTtl=function(e){return arguments.length&&(i=e),i},this.$get=["$exceptionHandler","$parse","$browser",function(t,a,f){function l(e){e.currentScope.$$destroyed=!0}function c(e){9===$r&&(e.$$childHead&&c(e.$$childHead),e.$$nextSibling&&c(e.$$nextSibling)),e.$parent=e.$$nextSibling=e.$$prevSibling=e.$$childHead=e.$$childTail=e.$root=e.$$watchers=null}function p(){this.$id=++ii,this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this.$root=this,this.$$destroyed=!1,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$$isolateBindings=null}function d(e){if(S.$$phase)throw s("inprog",S.$$phase);S.$$phase=e}function v(e,t){do e.$$watchersCount+=t;while(e=e.$parent)}function g(e,t,n){do e.$$listenerCount[n]-=t,0===e.$$listenerCount[n]&&delete e.$$listenerCount[n];while(e=e.$parent)}function b(){}function w(){for(;C.length;)try{C.shift()()}catch(e){t(e)}u=null}function E(){null===u&&(u=f.defer(function(){S.$apply(w)}))}p.prototype={constructor:p,$new:function(t,n){var r;return n=n||this,t?(r=new p,r.$root=this.$root):(this.$$ChildScope||(this.$$ChildScope=e(this)),r=new this.$$ChildScope),r.$parent=n,r.$$prevSibling=n.$$childTail,n.$$childHead?(n.$$childTail.$$nextSibling=r,n.$$childTail=r):n.$$childHead=n.$$childTail=r,(t||n!=this)&&r.$on("$destroy",l),r},$watch:function(e,t,n,r){var i=a(e);if(i.$$watchDelegate)return i.$$watchDelegate(this,t,n,i,e);var s=this,u=s.$$watchers,f={fn:t,last:b,get:i,exp:r||e,eq:!!n};return o=null,x(t)||(f.fn=h),u||(u=s.$$watchers=[]),u.unshift(f),v(this,1),function(){0<=_(u,f)&&v(s,-1),o=null}},$watchGroup:function(e,t){function n(){a=!1,f?(f=!1,t(s,s,u)):t(s,i,u)}var i=Array(e.length),s=Array(e.length),o=[],u=this,a=!1,f=!0;if(!e.length){var l=!0;return u.$evalAsync(function(){l&&t(s,s,u)}),function(){l=!1}}return 1===e.length?this.$watch(e[0],function(e,n,r){s[0]=e,i[0]=n,t(s,e===n?s:i,r)}):(r(e,function(e,t){var r=u.$watch(e,function(e,r){s[t]=e,i[t]=r,a||(a=!0,u.$evalAsync(n))});o.push(r)}),function(){for(;o.length;)o.shift()()})},$watchCollection:function(e,t){function r(e){s=e;var t,r,i,u;if(!m(s)){if(y(s))if(n(s))for(o!==h&&(o=h,v=o.length=0,l++),e=s.length,v!==e&&(l++,o.length=v=e),t=0;t<e;t++)u=o[t],i=s[t],r=u!==u&&i!==i,r||u===i||(l++,o[t]=i);else{o!==p&&(o=p={},v=0,l++),e=0;for(t in s)Wr.call(s,t)&&(e++,i=s[t],u=o[t],t in o?(r=u!==u&&i!==i,r||u===i||(l++,o[t]=i)):(v++,o[t]=i,l++));if(v>e)for(t in l++,o)Wr.call(s,t)||(v--,delete o[t])}else o!==s&&(o=s,l++);return l}}r.$stateful=!0;var i=this,s,o,u,f=1<t.length,l=0,c=a(e,r),h=[],p={},d=!0,v=0;return this.$watch(c,function(){d?(d=!1,t(s,s,i)):t(s,u,i);if(f)if(y(s))if(n(s)){u=Array(s.length);for(var e=0;e<s.length;e++)u[e]=s[e]}else for(e in u={},s)Wr.call(s,e)&&(u[e]=s[e]);else u=s})},$digest:function(){var e,n,r,a,l,c,h,p,v=i,m,g=[],y,E;d("$digest"),f.$$checkUrlChange(),this===S&&null!==u&&(f.defer.cancel(u),w()),o=null;do{p=!1,m=this;for(c=0;c<T.length;c++){try{E=T[c],E.scope.$eval(E.expression,E.locals)}catch(C){t(C)}o=null}T.length=0;e:do{if(c=m.$$watchers)for(h=c.length;h--;)try{if(e=c[h])if(l=e.get,(n=l(m))!==(r=e.last)&&!(e.eq?H(n,r):"number"==typeof n&&"number"==typeof r&&isNaN(n)&&isNaN(r)))p=!0,o=e,e.last=e.eq?D(n,null):n,a=e.fn,a(n,r===b?n:r,m),5>v&&(y=4-v,g[y]||(g[y]=[]),g[y].push({msg:x(e.exp)?"fn: "+(e.exp.name||e.exp.toString()):e.exp,newVal:n,oldVal:r}));else if(e===o){p=!1;break e}}catch(L){t(L)}if(!(c=m.$$watchersCount&&m.$$childHead||m!==this&&m.$$nextSibling))for(;m!==this&&!(c=m.$$nextSibling);)m=m.$parent}while(m=c);if((p||T.length)&&!(v--))throw S.$$phase=null,s("infdig",i,g)}while(p||T.length);for(S.$$phase=null;k<N.length;)try{N[k++]()}catch(A){t(A)}N.length=k=0},$destroy:function(){if(!this.$$destroyed){var e=this.$parent;this.$broadcast("$destroy"),this.$$destroyed=!0,this===S&&f.$$applicationDestroyed(),v(this,-this.$$watchersCount);for(var t in this.$$listenerCount)g(this,this.$$listenerCount[t],t);e&&e.$$childHead==this&&(e.$$childHead=this.$$nextSibling),e&&e.$$childTail==this&&(e.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$destroy=this.$digest=this.$apply=this.$evalAsync=this.$applyAsync=h,this.$on=this.$watch=this.$watchGroup=function(){return h},this.$$listeners={},this.$$nextSibling=null,c(this)}},$eval:function(e,t){return a(e)(this,t)},$evalAsync:function(e,t){S.$$phase||T.length||f.defer(function(){T.length&&S.$digest()}),T.push({scope:this,expression:a(e),locals:t})},$$postDigest:function(e){N.push(e)},$apply:function(e){try{d("$apply");try{return this.$eval(e)}finally{S.$$phase=null}}catch(n){t(n)}finally{try{S.$digest()}catch(r){throw t(r),r}}},$applyAsync:function(e){function t(){n.$eval(e)}var n=this;e&&C.push(t),e=a(e),E()},$on:function(e,t){var n=this.$$listeners[e];n||(this.$$listeners[e]=n=[]),n.push(t);var r=this;do r.$$listenerCount[e]||(r.$$listenerCount[e]=0),r.$$listenerCount[e]++;while(r=r.$parent);var i=this;return function(){var r=n.indexOf(t);-1!==r&&(n[r]=null,g(i,1,e))}},$emit:function(e,n){var r=[],i,s=this,o=!1,u={name:e,targetScope:s,stopPropagation:function(){o=!0},preventDefault:function(){u.defaultPrevented=!0},defaultPrevented:!1},a=B([u],arguments,1),f,l;do{i=s.$$listeners[e]||r,u.currentScope=s,f=0;for(l=i.length;f<l;f++)if(i[f])try{i[f].apply(null,a)}catch(c){t(c)}else i.splice(f,1),f--,l--;if(o)return u.currentScope=null,u;s=s.$parent}while(s);return u.currentScope=null,u},$broadcast:function(e,n){var r=this,i=this,s={name:e,targetScope:this,preventDefault:function(){s.defaultPrevented=!0},defaultPrevented:!1};if(!this.$$listenerCount[e])return s;for(var o=B([s],arguments,1),u,a;r=i;){s.currentScope=r,i=r.$$listeners[e]||[],u=0;for(a=i.length;u<a;u++)if(i[u])try{i[u].apply(null,o)}catch(f){t(f)}else i.splice(u,1),u--,a--;if(!(i=r.$$listenerCount[e]&&r.$$childHead||r!==this&&r.$$nextSibling))for(;r!==this&&!(i=r.$$nextSibling);)r=r.$parent}return s.currentScope=null,s}};var S=new p,T=S.$$asyncQueue=[],N=S.$$postDigestQueue=[],C=S.$$applyAsyncQueue=[],k=0;return S}]}function Yn(){var e=/^\s*(https?|ftp|mailto|tel|file):/,t=/^\s*((https?|ftp|file|blob):|data:image\/)/;this.aHrefSanitizationWhitelist=function(t){return g(t)?(e=t,this):e},this.imgSrcSanitizationWhitelist=function(e){return g(e)?(t=e,this):t},this.$get=function(){return function(n,r){var i=r?t:e,s;return s=ur(n).href,""===s||s.match(i)?n:"unsafe:"+s}}}function Zn(e){if("self"===e)return e;if(w(e)){if(-1<e.indexOf("***"))throw Es("iwcard",e);return e=ai(e).replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*"),new RegExp("^"+e+"$")}if(T(e))return new RegExp("^"+e.source+"$");throw Es("imatcher")}function er(e){var t=[];return g(e)&&r(e,function(e){t.push(Zn(e))}),t}function tr(){this.SCE_CONTEXTS=Ss;var e=["self"],t=[];this.resourceUrlWhitelist=function(t){return arguments.length&&(e=er(t)),e},this.resourceUrlBlacklist=function(e){return arguments.length&&(t=er(e)),t},this.$get=["$injector",function(n){function r(e,t){return"self"===e?ar(t):!!e.exec(t.href)}function i(e){var t=function(e){this.$$unwrapTrustedValue=function(){return e}};return e&&(t.prototype=new e),t.prototype.valueOf=function(){return this.$$unwrapTrustedValue()},t.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()},t}var s=function(e){throw Es("unsafe")};n.has("$sanitize")&&(s=n.get("$sanitize"));var o=i(),u={};return u[Ss.HTML]=i(o),u[Ss.CSS]=i(o),u[Ss.URL]=i(o),u[Ss.JS]=i(o),u[Ss.RESOURCE_URL]=i(u[Ss.URL]),{trustAs:function(e,t){var n=u.hasOwnProperty(e)?u[e]:null;if(!n)throw Es("icontext",e,t);if(null===t||m(t)||""===t)return t;if("string"!=typeof t)throw Es("itype",e);return new n(t)},getTrusted:function(n,i){if(null===i||m(i)||""===i)return i;var o=u.hasOwnProperty(n)?u[n]:null;if(o&&i instanceof o)return i.$$unwrapTrustedValue();if(n===Ss.RESOURCE_URL){var o=ur(i.toString()),a,f,l=!1;a=0;for(f=e.length;a<f;a++)if(r(e[a],o)){l=!0;break}if(l)for(a=0,f=t.length;a<f;a++)if(r(t[a],o)){l=!1;break}if(l)return i;throw Es("insecurl",i.toString())}if(n===Ss.HTML)return s(i);throw Es("unsafe")},valueOf:function(e){return e instanceof o?e.$$unwrapTrustedValue():e}}}]}function nr(){var e=!0;this.enabled=function(t){return arguments.length&&(e=!!t),e},this.$get=["$parse","$sceDelegate",function(t,n){if(e&&8>$r)throw Es("iequirks");var i=P(Ss);i.isEnabled=function(){return e},i.trustAs=n.trustAs,i.getTrusted=n.getTrusted,i.valueOf=n.valueOf,e||(i.trustAs=i.getTrusted=function(e,t){return t},i.valueOf=p),i.parseAs=function(e,n){var r=t(n);return r.literal&&r.constant?r:t(n,function(t){return i.getTrusted(e,t)})};var s=i.parseAs,o=i.getTrusted,u=i.trustAs;return r(Ss,function(e,t){var n=Xr(t);i[lt("parse_as_"+n)]=function(t){return s(e,t)},i[lt("get_trusted_"+n)]=function(t){return o(e,t)},i[lt("trust_as_"+n)]=function(t){return u(e,t)}}),i}]}function rr(){this.$get=["$window","$document",function(e,t){var n={},r=!(e.chrome&&e.chrome.app&&e.chrome.app.runtime)&&e.history&&e.history.pushState,i=l((/android (\d+)/.exec(Xr((e.navigator||{}).userAgent))||[])[1]),s=/Boxee/i.test((e.navigator||{}).userAgent),o=t[0]||{},u,a=/^(Moz|webkit|ms)(?=[A-Z])/,f=o.body&&o.body.style,c=!1,h=!1;if(f){for(var p in f)if(c=a.exec(p)){u=c[0],u=u[0].toUpperCase()+u.substr(1);break}u||(u="WebkitOpacity"in f&&"webkit"),c="transition"in f||u+"Transition"in f,h="animation"in f||u+"Animation"in f,!i||c&&h||(c=w(f.webkitTransition),h=w(f.webkitAnimation))}return{history:!(!r||4>i||s),hasEvent:function(e){if("input"===e&&11>=$r)return!1;if(m(n[e])){var t=o.createElement("div");n[e]="on"+e in t}return n[e]},csp:fi(),vendorPrefix:u,transitions:c,animations:h,android:i}}]}function ir(){var e;this.httpOptions=function(t){return t?(e=t,this):e},this.$get=["$templateCache","$http","$q","$sce",function(t,n,r,i){function s(o,u){s.totalPendingRequests++;if(!w(o)||m(t.get(o)))o=i.getTrustedResourceUrl(o);var f=n.defaults&&n.defaults.transformResponse;return si(f)?f=f.filter(function(e){return e!==un}):f===un&&(f=null),n.get(o,a({cache:t,transformResponse:f},e))["finally"](function(){s.totalPendingRequests--}).then(function(e){return t.put(o,e.data),e.data},function(e){if(!u)throw xs("tpload",o,e.status,e.statusText);return r.reject(e)})}return s.totalPendingRequests=0,s}]}function sr(){this.$get=["$rootScope","$browser","$location",function(e,t,n){return{findBindings:function(e,t,n){e=e.getElementsByClassName("ng-binding");var i=[];return r(e,function(e){var s=ni.element(e).data("$binding");s&&r(s,function(r){n?(new RegExp("(^|\\s)"+ai(t)+"(\\s|\\||$)")).test(r)&&i.push(e):-1!=r.indexOf(t)&&i.push(e)})}),i},findModels:function(e,t,n){for(var r=["ng-","data-ng-","ng\\:"],i=0;i<r.length;++i){var s=e.querySelectorAll("["+r[i]+"model"+(n?"=":"*=")+'"'+t+'"]');if(s.length)return s}},getLocation:function(){return n.url()},setLocation:function(t){t!==n.url()&&(n.url(t),e.$digest())},whenStable:function(e){t.notifyWhenNoOutstandingRequests(e)}}}]}function or(){this.$get=["$rootScope","$browser","$q","$$q","$exceptionHandler",function(e,t,n,r,i){function s(s,u,a){x(s)||(a=u,u=s,s=h);var f=Qr.call(arguments,3),l=g(a)&&!a,c=(l?r:n).defer(),p=c.promise,d;return d=t.defer(function(){try{c.resolve(s.apply(null,f))}catch(t){c.reject(t),i(t)}finally{delete o[p.$$timeoutId]}l||e.$apply()},u),p.$$timeoutId=d,o[d]=c,p}var o={};return s.cancel=function(e){return e&&e.$$timeoutId in o?(o[e.$$timeoutId].reject("canceled"),delete o[e.$$timeoutId],t.defer.cancel(e.$$timeoutId)):!1},s}]}function ur(e){return $r&&(Ts.setAttribute("href",e),e=Ts.href),Ts.setAttribute("href",e),{href:Ts.href,protocol:Ts.protocol?Ts.protocol.replace(/:$/,""):"",host:Ts.host,search:Ts.search?Ts.search.replace(/^\?/,""):"",hash:Ts.hash?Ts.hash.replace(/^#/,""):"",hostname:Ts.hostname,port:Ts.port,pathname:"/"===Ts.pathname.charAt(0)?Ts.pathname:"/"+Ts.pathname}}function ar(e){return e=w(e)?ur(e):e,e.protocol===Ns.protocol&&e.host===Ns.host}function fr(){this.$get=d(e)}function lr(e){function t(e){try{return decodeURIComponent(e)}catch(t){return e}}var n=e[0]||{},r={},i="";return function(){var e,s,o,u,a;e=n.cookie||"";if(e!==i)for(i=e,e=i.split("; "),r={},o=0;o<e.length;o++)s=e[o],u=s.indexOf("="),0<u&&(a=t(s.substring(0,u)),m(r[a])&&(r[a]=t(s.substring(u+1))));return r}}function cr(){this.$get=lr}function hr(e){function t(n,i){if(y(n)){var s={};return r(n,function(e,n){s[n]=t(n,e)}),s}return e.factory(n+"Filter",i)}this.register=t,this.$get=["$injector",function(e){return function(t){return e.get(t+"Filter")}}],t("currency",gr),t("date",Lr),t("filter",pr),t("json",Ar),t("limitTo",Or),t("lowercase",_s),t("number",yr),t("orderBy",Mr),t("uppercase",Ds)}function pr(){return function(e,r,i){if(!n(e)){if(null==e)return e;throw t("filter")("notarray",e)}var s;switch(mr(r)){case"function":break;case"boolean":case"null":case"number":case"string":s=!0;case"object":r=dr(r,i,s);break;default:return e}return Array.prototype.filter.call(e,r)}}function dr(e,t,n){var r=y(e)&&"$"in e;return!0===t?t=H:x(t)||(t=function(e,t){return m(e)?!1:null===e||null===t?e===t:y(t)||y(e)&&!v(e)?!1:(e=Xr(""+e),t=Xr(""+t),-1!==e.indexOf(t))}),function(i){return r&&!y(i)?vr(i,e.$,t,!1):vr(i,e,t,n)}}function vr(e,t,n,r,i){var s=mr(e),o=mr(t);if("string"===o&&"!"===t.charAt(0))return!vr(e,t.substring(1),n,r);if(si(e))return e.some(function(e){return vr(e,t,n,r)});switch(s){case"object":var u;if(r){for(u in e)if("$"!==u.charAt(0)&&vr(e[u],t,n,!0))return!0;return i?!1:vr(e,t,n,!1)}if("object"===o){for(u in t)if(i=t[u],!x(i)&&!m(i)&&(s="$"===u,!vr(s?e:e[u],i,n,s,s)))return!1;return!0}return n(e,t);case"function":return!1;default:return n(e,t)}}function mr(e){return null===e?"null":typeof e}function gr(e){var t=e.NUMBER_FORMATS;return function(e,n,r){return m(n)&&(n=t.CURRENCY_SYM),m(r)&&(r=t.PATTERNS[1].maxFrac),null==e?e:Er(e,t.PATTERNS[1],t.GROUP_SEP,t.DECIMAL_SEP,r).replace(/\u00A4/g,n)}}function yr(e){var t=e.NUMBER_FORMATS;return function(e,n){return null==e?e:Er(e,t.PATTERNS[0],t.GROUP_SEP,t.DECIMAL_SEP,n)}}function br(e){var t=0,n,r,i,s,o;-1<(r=e.indexOf(ks))&&(e=e.replace(ks,"")),0<(i=e.search(/e/i))?(0>r&&(r=i),r+=+e.slice(i+1),e=e.substring(0,i)):0>r&&(r=e.length);for(i=0;e.charAt(i)==Ls;i++);if(i==(o=e.length))n=[0],r=1;else{for(o--;e.charAt(o)==Ls;)o--;r-=i,n=[];for(s=0;i<=o;i++,s++)n[s]=+e.charAt(i)}return r>Cs&&(n=n.splice(0,Cs-1),t=r-1,r=1),{d:n,e:t,i:r}}function wr(e,t,n,r){var i=e.d,s=i.length-e.i;t=m(t)?Math.min(Math.max(n,s),r):+t,n=t+e.i,r=i[n];if(0<n){i.splice(Math.max(e.i,n));for(var o=n;o<i.length;o++)i[o]=0}else for(s=Math.max(0,s),e.i=1,i.length=Math.max(1,n=t+1),i[0]=0,o=1;o<n;o++)i[o]=0;if(5<=r)if(0>n-1){for(r=0;r>n;r--)i.unshift(0),e.i++;i.unshift(1),e.i++}else i[n-1]++;for(;s<Math.max(0,t);s++)i.push(0);if(t=i.reduceRight(function(e,t,n,r){return t+=e,r[n]=t%10,Math.floor(t/10)},0))i.unshift(t),e.i++}function Er(e,t,n,r,i){if(!w(e)&&!E(e)||isNaN(e))return"";var s=!isFinite(e),o=!1,u=Math.abs(e)+"",a="";if(s)a="∞";else{o=br(u),wr(o,i,t.minFrac,t.maxFrac),a=o.d,u=o.i,i=o.e,s=[];for(o=a.reduce(function(e,t){return e&&!t},!0);0>u;)a.unshift(0),u++;0<u?s=a.splice(u,a.length):(s=a,a=[0]),u=[];for(a.length>=t.lgSize&&u.unshift(a.splice(-t.lgSize,a.length).join(""));a.length>t.gSize;)u.unshift(a.splice(-t.gSize,a.length).join(""));a.length&&u.unshift(a.join("")),a=u.join(n),s.length&&(a+=r+s.join("")),i&&(a+="e+"+i)}return 0>e&&!o?t.negPre+a+t.negSuf:t.posPre+a+t.posSuf}function Sr(e,t,n,r){var i="";if(0>e||r&&0>=e)r?e=-e+1:(e=-e,i="-");for(e=""+e;e.length<t;)e=Ls+e;return n&&(e=e.substr(e.length-t)),i+e}function xr(e,t,n,r,i){return n=n||0,function(s){s=s["get"+e]();if(0<n||s>-n)s+=n;return 0===s&&-12==n&&(s=12),Sr(s,t,r,i)}}function Tr(e,t,n){return function(r,i){var s=r["get"+e](),o=Vr((n?"STANDALONE":"")+(t?"SHORT":"")+e);return i[o][s]}}function Nr(e){var t=(new Date(e,0,1)).getDay();return new Date(e,0,(4>=t?5:12)-t)}function Cr(e){return function(t){var n=Nr(t.getFullYear());return t=+(new Date(t.getFullYear(),t.getMonth(),t.getDate()+(4-t.getDay())))- +n,t=1+Math.round(t/6048e5),Sr(t,e)}}function kr(e,t){return 0>=e.getFullYear()?t.ERAS[0]:t.ERAS[1]}function Lr(e){function t(e){var t;if(t=e.match(n)){e=new Date(0);var r=0,i=0,s=t[8]?e.setUTCFullYear:e.setFullYear,o=t[8]?e.setUTCHours:e.setHours;t[9]&&(r=l(t[9]+t[10]),i=l(t[9]+t[11])),s.call(e,l(t[1]),l(t[2])-1,l(t[3])),r=l(t[4]||0)-r,i=l(t[5]||0)-i,s=l(t[6]||0),t=Math.round(1e3*parseFloat("0."+(t[7]||0))),o.call(e,r,i,s,t)}return e}var n=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(n,i,s){var o="",u=[],a,f;i=i||"mediumDate",i=e.DATETIME_FORMATS[i]||i,w(n)&&(n=Ms.test(n)?l(n):t(n)),E(n)&&(n=new Date(n));if(!S(n)||!isFinite(n.getTime()))return n;for(;i;)(f=Os.exec(i))?(u=B(u,f,1),i=u.pop()):(u.push(i),i=null);var c=n.getTimezoneOffset();return s&&(c=R(s,c),n=U(n,s,!0)),r(u,function(t){a=As[t],o+=a?a(n,e.DATETIME_FORMATS,c):"''"===t?"'":t.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),o}}function Ar(){return function(e,t){return m(t)&&(t=2),I(e,t)}}function Or(){return function(e,t,n){return t=Infinity===Math.abs(Number(t))?Number(t):l(t),isNaN(t)?e:(E(e)&&(e=e.toString()),!si(e)&&!w(e)?e:(n=!n||isNaN(n)?0:l(n),n=0>n?Math.max(0,e.length+n):n,0<=t?e.slice(n,n+t):0===n?e.slice(t,e.length):e.slice(Math.max(0,n+t),n)))}}function Mr(e){function r(t,n){return n=n?-1:1,t.map(function(t){var r=1,i=p;if(x(t))i=t;else if(w(t)){if("+"==t.charAt(0)||"-"==t.charAt(0))r="-"==t.charAt(0)?-1:1,t=t.substring(1);if(""!==t&&(i=e(t),i.constant))var s=i(),i=function(e){return e[s]}}return{get:i,descending:r*n}})}function i(e){switch(typeof e){case"number":case"boolean":case"string":return!0;default:return!1}}return function(e,s,o){if(null==e)return e;if(!n(e))throw t("orderBy")("notarray",e);si(s)||(s=[s]),0===s.length&&(s=["+"]);var u=r(s,o);return u.push({get:function(){return{}},descending:o?-1:1}),e=Array.prototype.map.call(e,function(e,t){return{value:e,predicateValues:u.map(function(n){var r=n.get(e);n=typeof r;if(null===r)n="string",r="null";else if("string"===n)r=r.toLowerCase();else if("object"===n)e:{if("function"==typeof r.valueOf&&(r=r.valueOf(),i(r)))break e;if(v(r)&&(r=r.toString(),i(r)))break e;r=t}return{value:r,type:n}})}}),e.sort(function(e,t){for(var n=0,r=0,i=u.length;r<i;++r){var n=e.predicateValues[r],s=t.predicateValues[r],o=0;n.type===s.type?n.value!==s.value&&(o=n.value<s.value?-1:1):o=n.type<s.type?-1:1;if(n=o*u[r].descending)break}return n}),e=e.map(function(e){return e.value})}}function _r(e){return x(e)&&(e={link:e}),e.restrict=e.restrict||"AC",d(e)}function Dr(e,t,n,i,s){var o=this,u=[];o.$error={},o.$$success={},o.$pending=void 0,o.$name=s(t.name||t.ngForm||"")(n),o.$dirty=!1,o.$pristine=!0,o.$valid=!0,o.$invalid=!1,o.$submitted=!1,o.$$parentForm=Bs,o.$rollbackViewValue=function(){r(u,function(e){e.$rollbackViewValue()})},o.$commitViewValue=function(){r(u,function(e){e.$commitViewValue()})},o.$addControl=function(e){it(e.$name,"input"),u.push(e),e.$name&&(o[e.$name]=e),e.$$parentForm=o},o.$$renameControl=function(e,t){var n=e.$name;o[n]===e&&delete o[n],o[t]=e,e.$name=t},o.$removeControl=function(e){e.$name&&o[e.$name]===e&&delete o[e.$name],r(o.$pending,function(t,n){o.$setValidity(n,null,e)}),r(o.$error,function(t,n){o.$setValidity(n,null,e)}),r(o.$$success,function(t,n){o.$setValidity(n,null,e)}),_(u,e),e.$$parentForm=Bs},Rr({ctrl:this,$element:e,set:function(e,t,n){var r=e[t];r?-1===r.indexOf(n)&&r.push(n):e[t]=[n]},unset:function(e,t,n){var r=e[t];r&&(_(r,n),0===r.length&&delete e[t])},$animate:i}),o.$setDirty=function(){i.removeClass(e,bo),i.addClass(e,wo),o.$dirty=!0,o.$pristine=!1,o.$$parentForm.$setDirty()},o.$setPristine=function(){i.setClass(e,bo,wo+" ng-submitted"),o.$dirty=!1,o.$pristine=!0,o.$submitted=!1,r(u,function(e){e.$setPristine()})},o.$setUntouched=function(){r(u,function(e){e.$setUntouched()})},o.$setSubmitted=function(){i.addClass(e,"ng-submitted"),o.$submitted=!0,o.$$parentForm.$setSubmitted()}}function Pr(e){e.$formatters.push(function(t){return e.$isEmpty(t)?t:t.toString()})}function Hr(e,t,n,r,i,s){var o=Xr(t[0].type);if(!i.android){var u=!1;t.on("compositionstart",function(){u=!0}),t.on("compositionend",function(){u=!1,f()})}var a,f=function(e){a&&(s.defer.cancel(a),a=null);if(!u){var i=t.val();e=e&&e.type,"password"===o||n.ngTrim&&"false"===n.ngTrim||(i=ui(i)),(r.$viewValue!==i||""===i&&r.$$hasNativeValidators)&&r.$setViewValue(i,e)}};if(i.hasEvent("input"))t.on("input",f);else{var l=function(e,t,n){a||(a=s.defer(function(){a=null,t&&t.value===n||f(e)}))};t.on("keydown",function(e){var t=e.keyCode;91===t||15<t&&19>t||37<=t&&40>=t||l(e,this,this.value)}),i.hasEvent("paste")&&t.on("paste cut",l)}t.on("change",f),Ks[o]&&r.$$hasNativeValidators&&o===n.type&&t.on("keydown wheel mousedown",function(e){if(!a){var t=this.validity,n=t.badInput,r=t.typeMismatch;a=s.defer(function(){a=null,t.badInput===n&&t.typeMismatch===r||f(e)})}}),r.$render=function(){var e=r.$isEmpty(r.$viewValue)?"":r.$viewValue;t.val()!==e&&t.val(e)}}function Br(e,t){return function(n,i){var s,o;if(S(n))return n;if(w(n)){'"'==n.charAt(0)&&'"'==n.charAt(n.length-1)&&(n=n.substring(1,n.length-1));if(qs.test(n))return new Date(n);e.lastIndex=0;if(s=e.exec(n))return s.shift(),o=i?{yyyy:i.getFullYear(),MM:i.getMonth()+1,dd:i.getDate(),HH:i.getHours(),mm:i.getMinutes(),ss:i.getSeconds(),sss:i.getMilliseconds()/1e3}:{yyyy:1970,MM:1,dd:1,HH:0,mm:0,ss:0,sss:0},r(s,function(e,n){n<t.length&&(o[t[n]]=+e)}),new Date(o.yyyy,o.MM-1,o.dd,o.HH,o.mm,o.ss||0,1e3*o.sss||0)}return NaN}}function jr(e,t,n,r){return function(i,s,o,u,a,f,l){function c(e){return e&&(!e.getTime||e.getTime()===e.getTime())}function h(e){return g(e)&&!S(e)?n(e)||void 0:e}Fr(i,s,o,u),Hr(i,s,o,u,a,f);var p=u&&u.$options&&u.$options.timezone,d;u.$$parserName=e,u.$parsers.push(function(e){if(u.$isEmpty(e))return null;if(t.test(e))return e=n(e,d),p&&(e=U(e,p)),e}),u.$formatters.push(function(e){if(e&&!S(e))throw So("datefmt",e);return c(e)?((d=e)&&p&&(d=U(d,p,!0)),l("date")(e,r,p)):(d=null,"")});if(g(o.min)||o.ngMin){var v;u.$validators.min=function(e){return!c(e)||m(v)||n(e)>=v},o.$observe("min",function(e){v=h(e),u.$validate()})}if(g(o.max)||o.ngMax){var y;u.$validators.max=function(e){return!c(e)||m(y)||n(e)<=y},o.$observe("max",function(e){y=h(e),u.$validate()})}}}function Fr(e,t,n,r){(r.$$hasNativeValidators=y(t[0].validity))&&r.$parsers.push(function(e){var n=t.prop("validity")||{};return n.badInput||n.typeMismatch?void 0:e})}function Ir(e,t,n,r,i){if(g(r)){e=e(r);if(!e.constant)throw So("constexpr",n,r);return e(t)}return i}function qr(e,t){return e="ngClass"+e,["$animate",function(n){function i(e,t){var n=[],r=0;e:for(;r<e.length;r++){for(var i=e[r],s=0;s<t.length;s++)if(i==t[s])continue e;n.push(i)}return n}function s(e){var t=[];return si(e)?(r(e,function(e){t=t.concat(s(e))}),t):w(e)?e.split(" "):y(e)?(r(e,function(e,n){e&&(t=t.concat(n.split(" ")))}),t):e}return{restrict:"AC",link:function(o,u,a){function f(e){e=l(e,1),a.$addClass(e)}function l(e,t){var n=u.data("$classCounts")||ut(),i=[];return r(e,function(e){if(0<t||n[e])n[e]=(n[e]||0)+t,n[e]===+(0<t)&&i.push(e)}),u.data("$classCounts",n),i.join(" ")}function c(e,t){var r=i(t,e),s=i(e,t),r=l(r,1),s=l(s,-1);r&&r.length&&n.addClass(u,r),s&&s.length&&n.removeClass(u,s)}function h(e){if(!0===t||(o.$index&1)===t){var n=s(e||[]);if(!p)f(n);else if(!H(e,p)){var r=s(p);c(r,n)}}p=si(e)?e.map(function(e){return P(e)}):P(e)}var p;o.$watch(a[e],h,!0),a.$observe("class",function(t){h(o.$eval(a[e]))}),"ngClass"!==e&&o.$watch("$index",function(n,r){var i=n&1;if(i!==(r&1)){var u=s(o.$eval(a[e]));i===t?f(u):(i=l(u,-1),a.$removeClass(i))}})}}}]}function Rr(e){function t(e,t){t&&!s[e]?(a.addClass(i,e),s[e]=!0):!t&&s[e]&&(a.removeClass(i,e),s[e]=!1)}function n(e,n){e=e?"-"+et(e,"-"):"",t(go+e,!0===n),t(yo+e,!1===n)}var r=e.ctrl,i=e.$element,s={},o=e.set,u=e.unset,a=e.$animate;s[yo]=!(s[go]=i.hasClass(go)),r.$setValidity=function(e,i,s){m(i)?(r.$pending||(r.$pending={}),o(r.$pending,e,s)):(r.$pending&&u(r.$pending,e,s),Ur(r.$pending)&&(r.$pending=void 0)),k(i)?i?(u(r.$error,e,s),o(r.$$success,e,s)):(o(r.$error,e,s),u(r.$$success,e,s)):(u(r.$error,e,s),u(r.$$success,e,s)),r.$pending?(t(Eo,!0),r.$valid=r.$invalid=void 0,n("",null)):(t(Eo,!1),r.$valid=Ur(r.$error),r.$invalid=!r.$valid,n("",r.$valid)),i=r.$pending&&r.$pending[e]?void 0:r.$error[e]?!1:r.$$success[e]?!0:null,n(e,i),r.$$parentForm.$setValidity(e,i,r)}}function Ur(e){if(e)for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}var zr=/^\/(.+)\/([a-z]*)$/,Wr=Object.prototype.hasOwnProperty,Xr=function(e){return w(e)?e.toLowerCase():e},Vr=function(e){return w(e)?e.toUpperCase():e},$r,Jr,Kr,Qr=[].slice,Gr=[].splice,Yr=[].push,Zr=Object.prototype.toString,ei=Object.getPrototypeOf,ti=t("ng"),ni=e.angular||(e.angular={}),ri,ii=0;$r=e.document.documentMode,h.$inject=[],p.$inject=[];var si=Array.isArray,oi=/^\[object (?:Uint8|Uint8Clamped|Uint16|Uint32|Int8|Int16|Int32|Float32|Float64)Array\]$/,ui=function(e){return w(e)?e.trim():e},ai=function(e){return e.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},fi=function(){if(!g(fi.rules)){var t=e.document.querySelector("[ng-csp]")||e.document.querySelector("[data-ng-csp]");if(t){var n=t.getAttribute("ng-csp")||t.getAttribute("data-ng-csp");fi.rules={noUnsafeEval:!n||-1!==n.indexOf("no-unsafe-eval"),noInlineStyle:!n||-1!==n.indexOf("no-inline-style")}}else{t=fi;try{new Function(""),n=!1}catch(r){n=!0}t.rules={noUnsafeEval:n,noInlineStyle:!1}}}return fi.rules},li=function(){if(g(li.name_))return li.name_;var t,n,r=hi.length,i,s;for(n=0;n<r;++n)if(i=hi[n],t=e.document.querySelector("["+i.replace(":","\\:")+"jq]")){s=t.getAttribute(i+"jq");break}return li.name_=s},ci=/:/g,hi=["ng-","data-ng-","ng:","x-ng-"],pi=/[A-Z]/g,di=!1,vi=3,mi={full:"1.5.6",major:1,minor:5,dot:6,codeName:"arrow-stringification"};dt.expando="ng339";var gi=dt.cache={},yi=1;dt._data=function(e){return this.cache[e[this.expando]]||{}};var bi=/([\:\-\_]+(.))/g,wi=/^moz([A-Z])/,Ei={mouseleave:"mouseout",mouseenter:"mouseover"},Si=t("jqLite"),xi=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,Ti=/<|&#?\w+;/,Ni=/<([\w:-]+)/,Ci=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,ki={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ki.optgroup=ki.option,ki.tbody=ki.tfoot=ki.colgroup=ki.caption=ki.thead,ki.th=ki.td;var Li=e.Node.prototype.contains||function(e){return!!(this.compareDocumentPosition(e)&16)},Ai=dt.prototype={ready:function(t){function n(){r||(r=!0,t())}var r=!1;"complete"===e.document.readyState?e.setTimeout(n):(this.on("DOMContentLoaded",n),dt(e).on("load",n))},toString:function(){var e=[];return r(this,function(t){e.push(""+t)}),"["+e.join(", ")+"]"},eq:function(e){return 0<=e?Jr(this[e]):Jr(this[this.length+e])},length:0,push:Yr,sort:[].sort,splice:[].splice},Oi={};r("multiple selected checked disabled readOnly required open".split(" "),function(e){Oi[Xr(e)]=e});var Mi={};r("input select option textarea button form details".split(" "),function(e){Mi[e]=!0});var _i={ngMinlength:"minlength",ngMaxlength:"maxlength",ngMin:"min",ngMax:"max",ngPattern:"pattern"};r({data:wt,removeData:yt,hasData:function(e){for(var t in gi[e.ng339])return!0;return!1},cleanData:function(e){for(var t=0,n=e.length;t<n;t++)yt(e[t])}},function(e,t){dt[t]=e}),r({data:wt,inheritedData:Ct,scope:function(e){return Jr.data(e,"$scope")||Ct(e.parentNode||e,["$isolateScope","$scope"])},isolateScope:function(e){return Jr.data(e,"$isolateScope")||Jr.data(e,"$isolateScopeNoTemplate")},controller:Nt,injector:function(e){return Ct(e,"$injector")},removeAttr:function(e,t){e.removeAttribute(t)},hasClass:Et,css:function(e,t,n){t=lt(t);if(!g(n))return e.style[t];e.style[t]=n},attr:function(e,t,n){var r=e.nodeType;if(r!==vi&&2!==r&&8!==r)if(r=Xr(t),Oi[r]){if(!g(n))return e[t]||(e.attributes.getNamedItem(t)||h).specified?r:void 0;n?(e[t]=!0,e.setAttribute(t,r)):(e[t]=!1,e.removeAttribute(r))}else if(g(n))e.setAttribute(t,n);else if(e.getAttribute)return e=e.getAttribute(t,2),null===e?void 0:e},prop:function(e,t,n){if(!g(n))return e[t];e[t]=n},text:function(){function e(e,t){if(m(t)){var n=e.nodeType;return 1===n||n===vi?e.textContent:""}e.textContent=t}return e.$dv="",e}(),val:function(e,t){if(m(t)){if(e.multiple&&"select"===M(e)){var n=[];return r(e.options,function(e){e.selected&&n.push(e.value||e.text)}),0===n.length?null:n}return e.value}e.value=t},html:function(e,t){if(m(t))return e.innerHTML;mt(e,!0),e.innerHTML=t},empty:kt},function(e,t){dt.prototype[t]=function(t,n){var r,i,s=this.length;if(e!==kt&&m(2==e.length&&e!==Et&&e!==Nt?t:n)){if(y(t)){for(r=0;r<s;r++)if(e===wt)e(this[r],t);else for(i in t)e(this[r],i,t[i]);return this}r=e.$dv,s=m(r)?Math.min(s,1):s;for(i=0;i<s;i++){var o=e(this[i],t,n);r=r?r+o:o}return r}for(r=0;r<s;r++)e(this[r],t,n);return this}}),r({removeData:yt,on:function(e,t,n,r){if(g(r))throw Si("onargs");if(ct(e)){r=bt(e,!0);var i=r.events,s=r.handle;s||(s=r.handle=Mt(e,i)),r=0<=t.indexOf(" ")?t.split(" "):[t];for(var o=r.length,u=function(t,r,o){var u=i[t];u||(u=i[t]=[],u.specialHandlerWrapper=r,"$destroy"===t||o||e.addEventListener(t,s,!1)),u.push(n)};o--;)t=r[o],Ei[t]?(u(Ei[t],Dt),u(t,void 0,!0)):u(t)}},off:gt,one:function(e,t,n){e=Jr(e),e.on(t,function r(){e.off(t,n),e.off(t,r)}),e.on(t,n)},replaceWith:function(e,t){var n,i=e.parentNode;mt(e),r(new dt(t),function(t){n?i.insertBefore(t,n.nextSibling):i.replaceChild(t,e),n=t})},children:function(e){var t=[];return r(e.childNodes,function(e){1===e.nodeType&&t.push(e)}),t},contents:function(e){return e.contentDocument||e.childNodes||[]},append:function(e,t){var n=e.nodeType;if(1===n||11===n){t=new dt(t);for(var n=0,r=t.length;n<r;n++)e.appendChild(t[n])}},prepend:function(e,t){if(1===e.nodeType){var n=e.firstChild;r(new dt(t),function(t){e.insertBefore(t,n)})}},wrap:function(e,t){pt(e,Jr(t).eq(0).clone()[0])},remove:Lt,detach:function(e){Lt(e,!0)},after:function(e,t){var n=e,r=e.parentNode;t=new dt(t);for(var i=0,s=t.length;i<s;i++){var o=t[i];r.insertBefore(o,n.nextSibling),n=o}},addClass:xt,removeClass:St,toggleClass:function(e,t,n){t&&r(t.split(" "),function(t){var r=n;m(r)&&(r=!Et(e,t)),(r?xt:St)(e,t)})},parent:function(e){return(e=e.parentNode)&&11!==e.nodeType?e:null},next:function(e){return e.nextElementSibling},find:function(e,t){return e.getElementsByTagName?e.getElementsByTagName(t):[]},clone:vt,triggerHandler:function(e,t,n){var i,s,o=t.type||t,u=bt(e);if(u=(u=u&&u.events)&&u[o])i={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return!0===this.defaultPrevented},stopImmediatePropagation:function(){this.immediatePropagationStopped=!0},isImmediatePropagationStopped:function(){return!0===this.immediatePropagationStopped},stopPropagation:h,type:o,target:e},t.type&&(i=a(i,t)),t=P(u),s=n?[i].concat(n):[i],r(t,function(t){i.isImmediatePropagationStopped()||t.apply(e,s)})}},function(e,t){dt.prototype[t]=function(t,n,r){for(var i,s=0,o=this.length;s<o;s++)m(i)?(i=e(this[s],t,n,r),g(i)&&(i=Jr(i))):Tt(i,e(this[s],t,n,r));return g(i)?i:this},dt.prototype.bind=dt.prototype.on,dt.prototype.unbind=dt.prototype.off}),Bt.prototype={put:function(e,t){this[Ht(e,this.nextUid)]=t},get:function(e){return this[Ht(e,this.nextUid)]},remove:function(e){var t=this[e=Ht(e,this.nextUid)];return delete this[e],t}};var Di=[function(){this.$get=[function(){return Bt}]}],Pi=/^([^\(]+?)=>/,Hi=/^[^\(]*\(\s*([^\)]*)\)/m,Bi=/,/,ji=/^\s*(_?)(\S+?)\1\s*$/,Fi=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg,Ii=t("$injector");It.$$annotate=function(e,t,n){var i;if("function"==typeof e){if(!(i=e.$inject)){i=[];if(e.length){if(t)throw w(n)&&n||(n=e.name||Ft(e)),Ii("strictdi",n);t=jt(e),r(t[1].split(Bi),function(e){e.replace(ji,function(e,t,n){i.push(n)})})}e.$inject=i}}else si(e)?(t=e.length-1,rt(e[t],"fn"),i=e.slice(0,t)):rt(e,"fn",!0);return i};var qi=t("$animate"),Ri=function(){this.$get=h},Ui=function(){var e=new Bt,t=[];this.$get=["$$AnimateRunner","$rootScope",function(n,i){function s(e,t,n){var i=!1;return t&&(t=w(t)?t.split(" "):si(t)?t:[],r(t,function(t){t&&(i=!0,e[t]=n)})),i}function o(){r(t,function(t){var n=e.get(t);if(n){var i=Ut(t.attr("class")),s="",o="";r(n,function(e,t){e!==!!i[t]&&(e?s+=(s.length?" ":"")+t:o+=(o.length?" ":"")+t)}),r(t,function(e){s&&xt(e,s),o&&St(e,o)}),e.remove(t)}}),t.length=0}return{enabled:h,on:h,off:h,pin:h,push:function(r,u,a,f){f&&f(),a=a||{},a.from&&r.css(a.from),a.to&&r.css(a.to);if(a.addClass||a.removeClass)if(u=a.addClass,f=a.removeClass,a=e.get(r)||{},u=s(a,u,!0),f=s(a,f,!1),u||f)e.put(r,a),t.push(r),1===t.length&&i.$$postDigest(o);return r=new n,r.complete(),r}}}]},zi=["$provide",function(e){var t=this;this.$$registeredAnimations=Object.create(null),this.register=function(n,r){if(n&&"."!==n.charAt(0))throw qi("notcsel",n);var i=n+"-animation";t.$$registeredAnimations[n.substr(1)]=i,e.factory(i,r)},this.classNameFilter=function(e){if(1===arguments.length&&(this.$$classNameFilter=e instanceof RegExp?e:null)&&/(\s+|\/)ng-animate(\s+|\/)/.test(this.$$classNameFilter.toString()))throw qi("nongcls","ng-animate");return this.$$classNameFilter},this.$get=["$$animateQueue",function(e){function t(e,t,n){if(n){var r;e:{for(r=0;r<n.length;r++){var i=n[r];if(1===i.nodeType){r=i;break e}}r=void 0}!r||r.parentNode||r.previousElementSibling||(n=null)}n?n.after(e):t.prepend(e)}return{on:e.on,off:e.off,pin:e.pin,enabled:e.enabled,cancel:function(e){e.end&&e.end()},enter:function(n,r,i,s){return r=r&&Jr(r),i=i&&Jr(i),r=r||i.parent(),t(n,r,i),e.push(n,"enter",zt(s))},move:function(n,r,i,s){return r=r&&Jr(r),i=i&&Jr(i),r=r||i.parent(),t(n,r,i),e.push(n,"move",zt(s))},leave:function(t,n){return e.push(t,"leave",zt(n),function(){t.remove()})},addClass:function(t,n,r){return r=zt(r),r.addClass=Rt(r.addclass,n),e.push(t,"addClass",r)},removeClass:function(t,n,r){return r=zt(r),r.removeClass=Rt(r.removeClass,n),e.push(t,"removeClass",r)},setClass:function(t,n,r,i){return i=zt(i),i.addClass=Rt(i.addClass,n),i.removeClass=Rt(i.removeClass,r),e.push(t,"setClass",i)},animate:function(t,n,r,i,s){return s=zt(s),s.from=s.from?a(s.from,n):n,s.to=s.to?a(s.to,r):r,s.tempClasses=Rt(s.tempClasses,i||"ng-inline-animate"),e.push(t,"animate",s)}}}]}],Wi=function(){this.$get=["$$rAF",function(e){function t(t){n.push(t),1<n.length||e(function(){for(var e=0;e<n.length;e++)n[e]();n=[]})}var n=[];return function(){var e=!1;return t(function(){e=!0}),function(n){e?n():t(n)}}}]},Xi=function(){this.$get=["$q","$sniffer","$$animateAsyncRun","$document","$timeout",function(e,t,n,i,s){function o(e){this.setHost(e);var t=n();this._doneCallbacks=[],this._tick=function(e){var n=i[0];n&&n.hidden?s(e,0,!1):t(e)},this._state=0}return o.chain=function(e,t){function n(){r===e.length?t(!0):e[r](function(e){!1===e?t(!1):(r++,n())})}var r=0;n()},o.all=function(e,t){function n(n){s=s&&n,++i===e.length&&t(s)}var i=0,s=!0;r(e,function(e){e.done(n)})},o.prototype={setHost:function(e){this.host=e||{}},done:function(e){2===this._state?e():this._doneCallbacks.push(e)},progress:h,getPromise:function(){if(!this.promise){var t=this;this.promise=e(function(e,n){t.done(function(t){!1===t?n():e()})})}return this.promise},then:function(e,t){return this.getPromise().then(e,t)},"catch":function(e){return this.getPromise()["catch"](e)},"finally":function(e){return this.getPromise()["finally"](e)},pause:function(){this.host.pause&&this.host.pause()},resume:function(){this.host.resume&&this.host.resume()},end:function(){this.host.end&&this.host.end(),this._resolve(!0)},cancel:function(){this.host.cancel&&this.host.cancel(),this._resolve(!1)},complete:function(e){var t=this;0===t._state&&(t._state=1,t._tick(function(){t._resolve(e)}))},_resolve:function(e){2!==this._state&&(r(this._doneCallbacks,function(t){t(e)}),this._doneCallbacks.length=0,this._state=2)}},o}]},Vi=function(){this.$get=["$$rAF","$q","$$AnimateRunner",function(e,t,n){return function(t,r){function i(){return e(function(){s.addClass&&(t.addClass(s.addClass),s.addClass=null),s.removeClass&&(t.removeClass(s.removeClass),s.removeClass=null),s.to&&(t.css(s.to),s.to=null),o||u.complete(),o=!0}),u}var s=r||{};s.$$prepared||(s=D(s)),s.cleanupStyles&&(s.from=s.to=null),s.from&&(t.css(s.from),s.from=null);var o,u=new n;return{start:i,end:i}}}]},$i=t("$compile"),Ji=new function(){};Jt.$inject=["$provide","$$sanitizeUriProvider"],Kt.prototype.isFirstChange=function(){return this.previousValue===Ji};var Ki=/^((?:x|data)[\:\-_])/i,Qi=t("$controller"),Gi=/^(\S+)(\s+as\s+([\w$]+))?$/,Yi=function(){this.$get=["$document",function(e){return function(t){return t?!t.nodeType&&t instanceof Jr&&(t=t[0]):t=e[0].body,t.offsetWidth+1}}]},Zi="application/json",es={"Content-Type":Zi+";charset=utf-8"},ts=/^\[|^\{(?!\{)/,ns={"[":/]$/,"{":/}$/},rs=/^\)\]\}',?\n/,is=t("$http"),ss=function(e){return function(){throw is("legacy",e)}},os=ni.$interpolateMinErr=t("$interpolate");os.throwNoconcat=function(e){throw os("noconcat",e)},os.interr=function(e,t){return os("interr",e,t.toString())};var us=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,as={http:80,https:443,ftp:21},fs=t("$location"),ls={$$html5:!1,$$replace:!1,absUrl:Cn("$$absUrl"),url:function(e){if(m(e))return this.$$url;var t=us.exec(e);return(t[1]||""===e)&&this.path(decodeURIComponent(t[1])),(t[2]||t[1]||""===e)&&this.search(t[3]||""),this.hash(t[5]||""),this},protocol:Cn("$$protocol"),host:Cn("$$host"),port:Cn("$$port"),path:kn("$$path",function(e){return e=null!==e?e.toString():"","/"==e.charAt(0)?e:"/"+e}),search:function(e,t){switch(arguments.length){case 0:return this.$$search;case 1:if(w(e)||E(e))e=e.toString(),this.$$search=X(e);else{if(!y(e))throw fs("isrcharg");e=D(e,{}),r(e,function(t,n){null==t&&delete e[n]}),this.$$search=e}break;default:m(t)||null===t?delete this.$$search[e]:this.$$search[e]=t}return this.$$compose(),this},hash:kn("$$hash",function(e){return null!==e?e.toString():""}),replace:function(){return this.$$replace=!0,this}};r([Nn,Tn,xn],function(e){e.prototype=Object.create(ls),e.prototype.state=function(t){if(!arguments.length)return this.$$state;if(e!==xn||!this.$$html5)throw fs("nostate");return this.$$state=m(t)?null:t,this}});var cs=t("$parse"),hs=Function.prototype.call,ps=Function.prototype.apply,ds=Function.prototype.bind,vs=ut();r("+ - * / % === !== == != < > <= >= && || ! = |".split(" "),function(e){vs[e]=!0});var ms={n:"\n",f:"\f",r:"\r",t:"	",v:"","'":"'",'"':'"'},gs=function(e){this.options=e};gs.prototype={constructor:gs,lex:function(e){this.text=e,this.index=0;for(this.tokens=[];this.index<this.text.length;)if(e=this.text.charAt(this.index),'"'===e||"'"===e)this.readString(e);else if(this.isNumber(e)||"."===e&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdentifierStart(this.peekMultichar()))this.readIdent();else if(this.is(e,"(){}[].,;:?"))this.tokens.push({index:this.index,text:e}),this.index++;else if(this.isWhitespace(e))this.index++;else{var t=e+this.peek(),n=t+this.peek(2),r=vs[t],i=vs[n];vs[e]||r||i?(e=i?n:r?t:e,this.tokens.push({index:this.index,text:e,operator:!0}),this.index+=e.length):this.throwError("Unexpected next character ",this.index,this.index+1)}return this.tokens},is:function(e,t){return-1!==t.indexOf(e)},peek:function(e){return e=e||1,this.index+e<this.text.length?this.text.charAt(this.index+e):!1},isNumber:function(e){return"0"<=e&&"9">=e&&"string"==typeof e},isWhitespace:function(e){return" "===e||"\r"===e||"	"===e||"\n"===e||""===e||" "===e},isIdentifierStart:function(e){return this.options.isIdentifierStart?this.options.isIdentifierStart(e,this.codePointAt(e)):this.isValidIdentifierStart(e)},isValidIdentifierStart:function(e){return"a"<=e&&"z">=e||"A"<=e&&"Z">=e||"_"===e||"$"===e},isIdentifierContinue:function(e){return this.options.isIdentifierContinue?this.options.isIdentifierContinue(e,this.codePointAt(e)):this.isValidIdentifierContinue(e)},isValidIdentifierContinue:function(e,t){return this.isValidIdentifierStart(e,t)||this.isNumber(e)},codePointAt:function(e){return 1===e.length?e.charCodeAt(0):(e.charCodeAt(0)<<10)+e.charCodeAt(1)-56613888},peekMultichar:function(){var e=this.text.charAt(this.index),t=this.peek();if(!t)return e;var n=e.charCodeAt(0),r=t.charCodeAt(0);return 55296<=n&&56319>=n&&56320<=r&&57343>=r?e+t:e},isExpOperator:function(e){return"-"===e||"+"===e||this.isNumber(e)},throwError:function(e,t,n){throw n=n||this.index,t=g(t)?"s "+t+"-"+this.index+" ["+this.text.substring(t,n)+"]":" "+n,cs("lexerr",e,t,this.text)},readNumber:function(){for(var e="",t=this.index;this.index<this.text.length;){var n=Xr(this.text.charAt(this.index));if("."==n||this.isNumber(n))e+=n;else{var r=this.peek();if("e"==n&&this.isExpOperator(r))e+=n;else if(this.isExpOperator(n)&&r&&this.isNumber(r)&&"e"==e.charAt(e.length-1))e+=n;else{if(!this.isExpOperator(n)||r&&this.isNumber(r)||"e"!=e.charAt(e.length-1))break;this.throwError("Invalid exponent")}}this.index++}this.tokens.push({index:t,text:e,constant:!0,value:Number(e)})},readIdent:function(){var e=this.index;for(this.index+=this.peekMultichar().length;this.index<this.text.length;){var t=this.peekMultichar();if(!this.isIdentifierContinue(t))break;this.index+=t.length}this.tokens.push({index:e,text:this.text.slice(e,this.index),identifier:!0})},readString:function(e){var t=this.index;this.index++;for(var n="",r=e,i=!1;this.index<this.text.length;){var s=this.text.charAt(this.index),r=r+s;if(i)"u"===s?(i=this.text.substring(this.index+1,this.index+5),i.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+i+"]"),this.index+=4,n+=String.fromCharCode(parseInt(i,16))):n+=ms[s]||s,i=!1;else if("\\"===s)i=!0;else{if(s===e){this.index++,this.tokens.push({index:t,text:r,constant:!0,value:n});return}n+=s}this.index++}this.throwError("Unterminated quote",t)}};var ys=function(e,t){this.lexer=e,this.options=t};ys.Program="Program",ys.ExpressionStatement="ExpressionStatement",ys.AssignmentExpression="AssignmentExpression",ys.ConditionalExpression="ConditionalExpression",ys.LogicalExpression="LogicalExpression",ys.BinaryExpression="BinaryExpression",ys.UnaryExpression="UnaryExpression",ys.CallExpression="CallExpression",ys.MemberExpression="MemberExpression",ys.Identifier="Identifier",ys.Literal="Literal",ys.ArrayExpression="ArrayExpression",ys.Property="Property",ys.ObjectExpression="ObjectExpression",ys.ThisExpression="ThisExpression",ys.LocalsExpression="LocalsExpression",ys.NGValueParameter="NGValueParameter",ys.prototype={ast:function(e){return this.text=e,this.tokens=this.lexer.lex(e),e=this.program(),0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),e},program:function(){for(var e=[];;)if(0<this.tokens.length&&!this.peek("}",")",";","]")&&e.push(this.expressionStatement()),!this.expect(";"))return{type:ys.Program,body:e}},expressionStatement:function(){return{type:ys.ExpressionStatement,expression:this.filterChain()}},filterChain:function(){for(var e=this.expression();this.expect("|");)e=this.filter(e);return e},expression:function(){return this.assignment()},assignment:function(){var e=this.ternary();return this.expect("=")&&(e={type:ys.AssignmentExpression,left:e,right:this.assignment(),operator:"="}),e},ternary:function(){var e=this.logicalOR(),t,n;return this.expect("?")&&(t=this.expression(),this.consume(":"))?(n=this.expression(),{type:ys.ConditionalExpression,test:e,alternate:t,consequent:n}):e},logicalOR:function(){for(var e=this.logicalAND();this.expect("||");)e={type:ys.LogicalExpression,operator:"||",left:e,right:this.logicalAND()};return e},logicalAND:function(){for(var e=this.equality();this.expect("&&");)e={type:ys.LogicalExpression,operator:"&&",left:e,right:this.equality()};return e},equality:function(){for(var e=this.relational(),t;t=this.expect("==","!=","===","!==");)e={type:ys.BinaryExpression,operator:t.text,left:e,right:this.relational()};return e},relational:function(){for(var e=this.additive(),t;t=this.expect("<",">","<=",">=");)e={type:ys.BinaryExpression,operator:t.text,left:e,right:this.additive()};return e},additive:function(){for(var e=this.multiplicative(),t;t=this.expect("+","-");)e={type:ys.BinaryExpression,operator:t.text,left:e,right:this.multiplicative()};return e},multiplicative:function(){for(var e=this.unary(),t;t=this.expect("*","/","%");)e={type:ys.BinaryExpression,operator:t.text,left:e,right:this.unary()};return e},unary:function(){var e;return(e=this.expect("+","-","!"))?{type:ys.UnaryExpression,operator:e.text,prefix:!0,argument:this.unary()}:this.primary()},primary:function(){var e;this.expect("(")?(e=this.filterChain(),this.consume(")")):this.expect("[")?e=this.arrayDeclaration():this.expect("{")?e=this.object():this.selfReferential.hasOwnProperty(this.peek().text)?e=D(this.selfReferential[this.consume().text]):this.options.literals.hasOwnProperty(this.peek().text)?e={type:ys.Literal,value:this.options.literals[this.consume().text]}:this.peek().identifier?e=this.identifier():this.peek().constant?e=this.constant():this.throwError("not a primary expression",this.peek());for(var t;t=this.expect("(","[",".");)"("===t.text?(e={type:ys.CallExpression,callee:e,arguments:this.parseArguments()},this.consume(")")):"["===t.text?(e={type:ys.MemberExpression,object:e,property:this.expression(),computed:!0},this.consume("]")):"."===t.text?e={type:ys.MemberExpression,object:e,property:this.identifier(),computed:!1}:this.throwError("IMPOSSIBLE");return e},filter:function(e){e=[e];for(var t={type:ys.CallExpression,callee:this.identifier(),arguments:e,filter:!0};this.expect(":");)e.push(this.expression());return t},parseArguments:function(){var e=[];if(")"!==this.peekToken().text)do e.push(this.expression());while(this.expect(","));return e},identifier:function(){var e=this.consume();return e.identifier||this.throwError("is not a valid identifier",e),{type:ys.Identifier,name:e.text}},constant:function(){return{type:ys.Literal,value:this.consume().value}},arrayDeclaration:function(){var e=[];if("]"!==this.peekToken().text)do{if(this.peek("]"))break;e.push(this.expression())}while(this.expect(","));return this.consume("]"),{type:ys.ArrayExpression,elements:e}},object:function(){var e=[],t;if("}"!==this.peekToken().text)do{if(this.peek("}"))break;t={type:ys.Property,kind:"init"},this.peek().constant?(t.key=this.constant(),t.computed=!1,this.consume(":"),t.value=this.expression()):this.peek().identifier?(t.key=this.identifier(),t.computed=!1,this.peek(":")?(this.consume(":"),t.value=this.expression()):t.value=t.key):this.peek("[")?(this.consume("["),t.key=this.expression(),this.consume("]"),t.computed=!0,this.consume(":"),t.value=this.expression()):this.throwError("invalid key",this.peek()),e.push(t)}while(this.expect(","));return this.consume("}"),{type:ys.ObjectExpression,properties:e}},throwError:function(e,t){throw cs("syntax",t.text,e,t.index+1,this.text,this.text.substring(t.index))},consume:function(e){if(0===this.tokens.length)throw cs("ueoe",this.text);var t=this.expect(e);return t||this.throwError("is unexpected, expecting ["+e+"]",this.peek()),t},peekToken:function(){if(0===this.tokens.length)throw cs("ueoe",this.text);return this.tokens[0]},peek:function(e,t,n,r){return this.peekAhead(0,e,t,n,r)},peekAhead:function(e,t,n,r,i){if(this.tokens.length>e){e=this.tokens[e];var s=e.text;if(s===t||s===n||s===r||s===i||!(t||n||r||i))return e}return!1},expect:function(e,t,n,r){return(e=this.peek(e,t,n,r))?(this.tokens.shift(),e):!1},selfReferential:{"this":{type:ys.ThisExpression},$locals:{type:ys.LocalsExpression}}},Un.prototype={compile:function(e,t){var n=this,i=this.astBuilder.ast(e);this.state={nextId:0,filters:{},expensiveChecks:t,fn:{vars:[],body:[],own:{}},assign:{vars:[],body:[],own:{}},inputs:[]},jn(i,n.$filter);var s="",o;this.stage="assign";if(o=qn(i))this.state.computing="assign",s=this.nextId(),this.recurse(o,s),this.return_(s),s="fn.assign="+this.generateFunction("assign","s,v,l");return o=Fn(i.body),n.stage="inputs",r(o,function(e,t){var r="fn"+t;n.state[r]={vars:[],body:[],own:{}},n.state.computing=r;var i=n.nextId();n.recurse(e,i),n.return_(i),n.state.inputs.push(r),e.watchId=t}),this.state.computing="fn",this.stage="main",this.recurse(i),s='"'+this.USE+" "+this.STRICT+'";\n'+this.filterPrefix()+"var fn="+this.generateFunction("fn","s,l,a,i")+s+this.watchFns()+"return fn;",s=(new Function("$filter","ensureSafeMemberName","ensureSafeObject","ensureSafeFunction","getStringValue","ensureSafeAssignContext","ifDefined","plus","text",s))(this.$filter,On,_n,Dn,Mn,Pn,Hn,Bn,e),this.state=this.stage=void 0,s.literal=Rn(i),s.constant=i.constant,s},USE:"use",STRICT:"strict",watchFns:function(){var e=[],t=this.state.inputs,n=this;return r(t,function(t){e.push("var "+t+"="+n.generateFunction(t,"s"))}),t.length&&e.push("fn.inputs=["+t.join(",")+"];"),e.join("")},generateFunction:function(e,t){return"function("+t+"){"+this.varsPrefix(e)+this.body(e)+"};"},filterPrefix:function(){var e=[],t=this;return r(this.state.filters,function(n,r){e.push(n+"=$filter("+t.escape(r)+")")}),e.length?"var "+e.join(",")+";":""},varsPrefix:function(e){return this.state[e].vars.length?"var "+this.state[e].vars.join(",")+";":""},body:function(e){return this.state[e].body.join("")},recurse:function(e,t,n,i,s,o){var u,a,f=this,l,c,p;i=i||h;if(!o&&g(e.watchId))t=t||this.nextId(),this.if_("i",this.lazyAssign(t,this.computedMember("i",e.watchId)),this.lazyRecurse(e,t,n,i,s,!0));else switch(e.type){case ys.Program:r(e.body,function(t,n){f.recurse(t.expression,void 0,void 0,function(e){a=e}),n!==e.body.length-1?f.current().body.push(a,";"):f.return_(a)});break;case ys.Literal:c=this.escape(e.value),this.assign(t,c),i(c);break;case ys.UnaryExpression:this.recurse(e.argument,void 0,void 0,function(e){a=e}),c=e.operator+"("+this.ifDefined(a,0)+")",this.assign(t,c),i(c);break;case ys.BinaryExpression:this.recurse(e.left,void 0,void 0,function(e){u=e}),this.recurse(e.right,void 0,void 0,function(e){a=e}),c="+"===e.operator?this.plus(u,a):"-"===e.operator?this.ifDefined(u,0)+e.operator+this.ifDefined(a,0):"("+u+")"+e.operator+"("+a+")",this.assign(t,c),i(c);break;case ys.LogicalExpression:t=t||this.nextId(),f.recurse(e.left,t),f.if_("&&"===e.operator?t:f.not(t),f.lazyRecurse(e.right,t)),i(t);break;case ys.ConditionalExpression:t=t||this.nextId(),f.recurse(e.test,t),f.if_(t,f.lazyRecurse(e.alternate,t),f.lazyRecurse(e.consequent,t)),i(t);break;case ys.Identifier:t=t||this.nextId(),n&&(n.context="inputs"===f.stage?"s":this.assign(this.nextId(),this.getHasOwnProperty("l",e.name)+"?l:s"),n.computed=!1,n.name=e.name),On(e.name),f.if_("inputs"===f.stage||f.not(f.getHasOwnProperty("l",e.name)),function(){f.if_("inputs"===f.stage||"s",function(){s&&1!==s&&f.if_(f.not(f.nonComputedMember("s",e.name)),f.lazyAssign(f.nonComputedMember("s",e.name),"{}")),f.assign(t,f.nonComputedMember("s",e.name))})},t&&f.lazyAssign(t,f.nonComputedMember("l",e.name))),(f.state.expensiveChecks||Wn(e.name))&&f.addEnsureSafeObject(t),i(t);break;case ys.MemberExpression:u=n&&(n.context=this.nextId())||this.nextId(),t=t||this.nextId(),f.recurse(e.object,u,void 0,function(){f.if_(f.notNull(u),function(){s&&1!==s&&f.addEnsureSafeAssignContext(u);if(e.computed)a=f.nextId(),f.recurse(e.property,a),f.getStringValue(a),f.addEnsureSafeMemberName(a),s&&1!==s&&f.if_(f.not(f.computedMember(u,a)),f.lazyAssign(f.computedMember(u,a),"{}")),c=f.ensureSafeObject(f.computedMember(u,a)),f.assign(t,c),n&&(n.computed=!0,n.name=a);else{On(e.property.name),s&&1!==s&&f.if_(f.not(f.nonComputedMember(u,e.property.name)),f.lazyAssign(f.nonComputedMember(u,e.property.name),"{}")),c=f.nonComputedMember(u,e.property.name);if(f.state.expensiveChecks||Wn(e.property.name))c=f.ensureSafeObject(c);f.assign(t,c),n&&(n.computed=!1,n.name=e.property.name)}},function(){f.assign(t,"undefined")}),i(t)},!!s);break;case ys.CallExpression:t=t||this.nextId(),e.filter?(a=f.filter(e.callee.name),l=[],r(e.arguments,function(e){var t=f.nextId();f.recurse(e,t),l.push(t)}),c=a+"("+l.join(",")+")",f.assign(t,c),i(t)):(a=f.nextId(),u={},l=[],f.recurse(e.callee,a,u,function(){f.if_(f.notNull(a),function(){f.addEnsureSafeFunction(a),r(e.arguments,function(e){f.recurse(e,f.nextId(),void 0,function(e){l.push(f.ensureSafeObject(e))})}),u.name?(f.state.expensiveChecks||f.addEnsureSafeObject(u.context),c=f.member(u.context,u.name,u.computed)+"("+l.join(",")+")"):c=a+"("+l.join(",")+")",c=f.ensureSafeObject(c),f.assign(t,c)},function(){f.assign(t,"undefined")}),i(t)}));break;case ys.AssignmentExpression:a=this.nextId(),u={};if(!In(e.left))throw cs("lval");this.recurse(e.left,void 0,u,function(){f.if_(f.notNull(u.context),function(){f.recurse(e.right,a),f.addEnsureSafeObject(f.member(u.context,u.name,u.computed)),f.addEnsureSafeAssignContext(u.context),c=f.member(u.context,u.name,u.computed)+e.operator+a,f.assign(t,c),i(t||c)})},1);break;case ys.ArrayExpression:l=[],r(e.elements,function(e){f.recurse(e,f.nextId(),void 0,function(e){l.push(e)})}),c="["+l.join(",")+"]",this.assign(t,c),i(c);break;case ys.ObjectExpression:l=[],p=!1,r(e.properties,function(e){e.computed&&(p=!0)}),p?(t=t||this.nextId(),this.assign(t,"{}"),r(e.properties,function(e){e.computed?(u=f.nextId(),f.recurse(e.key,u)):u=e.key.type===ys.Identifier?e.key.name:""+e.key.value,a=f.nextId(),f.recurse(e.value,a),f.assign(f.member(t,u,e.computed),a)})):(r(e.properties,function(t){f.recurse(t.value,e.constant?void 0:f.nextId(),void 0,function(e){l.push(f.escape(t.key.type===ys.Identifier?t.key.name:""+t.key.value)+":"+e)})}),c="{"+l.join(",")+"}",this.assign(t,c)),i(t||c);break;case ys.ThisExpression:this.assign(t,"s"),i("s");break;case ys.LocalsExpression:this.assign(t,"l"),i("l");break;case ys.NGValueParameter:this.assign(t,"v"),i("v")}},getHasOwnProperty:function(e,t){var n=e+"."+t,r=this.current().own;return r.hasOwnProperty(n)||(r[n]=this.nextId(!1,e+"&&("+this.escape(t)+" in "+e+")")),r[n]},assign:function(e,t){if(e)return this.current().body.push(e,"=",t,";"),e},filter:function(e){return this.state.filters.hasOwnProperty(e)||(this.state.filters[e]=this.nextId(!0)),this.state.filters[e]},ifDefined:function(e,t){return"ifDefined("+e+","+this.escape(t)+")"},plus:function(e,t){return"plus("+e+","+t+")"},return_:function(e){this.current().body.push("return ",e,";")},if_:function(e,t,n){if(!0===e)t();else{var r=this.current().body;r.push("if(",e,"){"),t(),r.push("}"),n&&(r.push("else{"),n(),r.push("}"))}},not:function(e){return"!("+e+")"},notNull:function(e){return e+"!=null"},nonComputedMember:function(e,t){var n=/[^$_a-zA-Z0-9]/g;return/[$_a-zA-Z][$_a-zA-Z0-9]*/.test(t)?e+"."+t:e+'["'+t.replace(n,this.stringEscapeFn)+'"]'},computedMember:function(e,t){return e+"["+t+"]"},member:function(e,t,n){return n?this.computedMember(e,t):this.nonComputedMember(e,t)},addEnsureSafeObject:function(e){this.current().body.push(this.ensureSafeObject(e),";")},addEnsureSafeMemberName:function(e){this.current().body.push(this.ensureSafeMemberName(e),";")},addEnsureSafeFunction:function(e){this.current().body.push(this.ensureSafeFunction(e),";")},addEnsureSafeAssignContext:function(e){this.current().body.push(this.ensureSafeAssignContext(e),";")},ensureSafeObject:function(e){return"ensureSafeObject("+e+",text)"},ensureSafeMemberName:function(e){return"ensureSafeMemberName("+e+",text)"},ensureSafeFunction:function(e){return"ensureSafeFunction("+e+",text)"},getStringValue:function(e){this.assign(e,"getStringValue("+e+")")},ensureSafeAssignContext:function(e){return"ensureSafeAssignContext("+e+",text)"},lazyRecurse:function(e,t,n,r,i,s){var o=this;return function(){o.recurse(e,t,n,r,i,s)}},lazyAssign:function(e,t){var n=this;return function(){n.assign(e,t)}},stringEscapeRegex:/[^ a-zA-Z0-9]/g,stringEscapeFn:function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)},escape:function(e){if(w(e))return"'"+e.replace(this.stringEscapeRegex,this.stringEscapeFn)+"'";if(E(e))return e.toString();if(!0===e)return"true";if(!1===e)return"false";if(null===e)return"null";if("undefined"==typeof e)return"undefined";throw cs("esc")},nextId:function(e,t){var n="v"+this.state.nextId++;return e||this.current().vars.push(n+(t?"="+t:"")),n},current:function(){return this.state[this.state.computing]}},zn.prototype={compile:function(e,t){var n=this,i=this.astBuilder.ast(e);this.expression=e,this.expensiveChecks=t,jn(i,n.$filter);var s,o;if(s=qn(i))o=this.recurse(s);s=Fn(i.body);var u;s&&(u=[],r(s,function(e,t){var r=n.recurse(e);e.input=r,u.push(r),e.watchId=t}));var a=[];return r(i.body,function(e){a.push(n.recurse(e.expression))}),s=0===i.body.length?h:1===i.body.length?a[0]:function(e,t){var n;return r(a,function(r){n=r(e,t)}),n},o&&(s.assign=function(e,t,n){return o(e,n,t)}),u&&(s.inputs=u),s.literal=Rn(i),s.constant=i.constant,s},recurse:function(e,t,n){var i,s,o=this,u;if(e.input)return this.inputs(e.input,e.watchId);switch(e.type){case ys.Literal:return this.value(e.value,t);case ys.UnaryExpression:return s=this.recurse(e.argument),this["unary"+e.operator](s,t);case ys.BinaryExpression:return i=this.recurse(e.left),s=this.recurse(e.right),this["binary"+e.operator](i,s,t);case ys.LogicalExpression:return i=this.recurse(e.left),s=this.recurse(e.right),this["binary"+e.operator](i,s,t);case ys.ConditionalExpression:return this["ternary?:"](this.recurse(e.test),this.recurse(e.alternate),this.recurse(e.consequent),t);case ys.Identifier:return On(e.name,o.expression),o.identifier(e.name,o.expensiveChecks||Wn(e.name),t,n,o.expression);case ys.MemberExpression:return i=this.recurse(e.object,!1,!!n),e.computed||(On(e.property.name,o.expression),s=e.property.name),e.computed&&(s=this.recurse(e.property)),e.computed?this.computedMember(i,s,t,n,o.expression):this.nonComputedMember(i,s,o.expensiveChecks,t,n,o.expression);case ys.CallExpression:return u=[],r(e.arguments,function(e){u.push(o.recurse(e))}),e.filter&&(s=this.$filter(e.callee.name)),e.filter||(s=this.recurse(e.callee,!0)),e.filter?function(e,n,r,i){for(var o=[],a=0;a<u.length;++a)o.push(u[a](e,n,r,i));return e=s.apply(void 0,o,i),t?{context:void 0,name:void 0,value:e}:e}:function(e,n,r,i){var a=s(e,n,r,i),f;if(null!=a.value){_n(a.context,o.expression),Dn(a.value,o.expression),f=[];for(var l=0;l<u.length;++l)f.push(_n(u[l](e,n,r,i),o.expression));f=_n(a.value.apply(a.context,f),o.expression)}return t?{value:f}:f};case ys.AssignmentExpression:return i=this.recurse(e.left,!0,1),s=this.recurse(e.right),function(e,n,r,u){var a=i(e,n,r,u);return e=s(e,n,r,u),_n(a.value,o.expression),Pn(a.context),a.context[a.name]=e,t?{value:e}:e};case ys.ArrayExpression:return u=[],r(e.elements,function(e){u.push(o.recurse(e))}),function(e,n,r,i){for(var s=[],o=0;o<u.length;++o)s.push(u[o](e,n,r,i));return t?{value:s}:s};case ys.ObjectExpression:return u=[],r(e.properties,function(e){e.computed?u.push({key:o.recurse(e.key),computed:!0,value:o.recurse(e.value)}):u.push({key:e.key.type===ys.Identifier?e.key.name:""+e.key.value,computed:!1,value:o.recurse(e.value)})}),function(e,n,r,i){for(var s={},o=0;o<u.length;++o)u[o].computed?s[u[o].key(e,n,r,i)]=u[o].value(e,n,r,i):s[u[o].key]=u[o].value(e,n,r,i);return t?{value:s}:s};case ys.ThisExpression:return function(e){return t?{value:e}:e};case ys.LocalsExpression:return function(e,n){return t?{value:n}:n};case ys.NGValueParameter:return function(e,n,r){return t?{value:r}:r}}},"unary+":function(e,t){return function(n,r,i,s){return n=e(n,r,i,s),n=g(n)?+n:0,t?{value:n}:n}},"unary-":function(e,t){return function(n,r,i,s){return n=e(n,r,i,s),n=g(n)?-n:0,t?{value:n}:n}},"unary!":function(e,t){return function(n,r,i,s){return n=!e(n,r,i,s),t?{value:n}:n}},"binary+":function(e,t,n){return function(r,i,s,o){var u=e(r,i,s,o);return r=t(r,i,s,o),u=Bn(u,r),n?{value:u}:u}},"binary-":function(e,t,n){return function(r,i,s,o){var u=e(r,i,s,o);return r=t(r,i,s,o),u=(g(u)?u:0)-(g(r)?r:0),n?{value:u}:u}},"binary*":function(e,t,n){return function(r,i,s,o){return r=e(r,i,s,o)*t(r,i,s,o),n?{value:r}:r}},"binary/":function(e,t,n){return function(r,i,s,o){return r=e(r,i,s,o)/t(r,i,s,o),n?{value:r}:r}},"binary%":function(e,t,n){return function(r,i,s,o){return r=e(r,i,s,o)%t(r,i,s,o),n?{value:r}:r}},"binary===":function(e,t,n){return function(r,i,s,o){return r=e(r,i,s,o)===t(r,i,s,o),n?{value:r}:r}},"binary!==":function(e,t,n){return function(r,i,s,o){return r=e(r,i,s,o)!==t(r,i,s,o),n?{value:r}:r}},"binary==":function(e,t,n){return function(r,i,s,o){return r=e(r,i,s,o)==t(r,i,s,o),n?{value:r}:r}},"binary!=":function(e,t,n){return function(r,i,s,o){return r=e(r,i,s,o)!=t(r,i,s,o),n?{value:r}:r}},"binary<":function(e,t,n){return function(r,i,s,o){return r=e(r,i,s,o)<t(r,i,s,o),n?{value:r}:r}},"binary>":function(e,t,n){return function(r,i,s,o){return r=e(r,i,s,o)>t(r,i,s,o),n?{value:r}:r}},"binary<=":function(e,t,n){return function(r,i,s,o){return r=e(r,i,s,o)<=t(r,i,s,o),n?{value:r}:r}},"binary>=":function(e,t,n){return function(r,i,s,o){return r=e(r,i,s,o)>=t(r,i,s,o),n?{value:r}:r}},"binary&&":function(e,t,n){return function(r,i,s,o){return r=e(r,i,s,o)&&t(r,i,s,o),n?{value:r}:r}},"binary||":function(e,t,n){return function(r,i,s,o){return r=e(r,i,s,o)||t(r,i,s,o),n?{value:r}:r}},"ternary?:":function(e,t,n,r){return function(i,s,o,u){return i=e(i,s,o,u)?t(i,s,o,u):n(i,s,o,u),r?{value:i}:i}},value:function(e,t){return function(){return t?{context:void 0,name:void 0,value:e}:e}},identifier:function(e,t,n,r,i){return function(s,o,u,a){return s=o&&e in o?o:s,r&&1!==r&&s&&!s[e]&&(s[e]={}),o=s?s[e]:void 0,t&&_n(o,i),n?{context:s,name:e,value:o}:o}},computedMember:function(e,t,n,r,i){return function(s,o,u,a){var f=e(s,o,u,a),l,c;return null!=f&&(l=t(s,o,u,a),l+="",On(l,i),r&&1!==r&&(Pn(f),f&&!f[l]&&(f[l]={})),c=f[l],_n(c,i)),n?{context:f,name:l,value:c}:c}},nonComputedMember:function(e,t,n,r,i,s){return function(o,u,a,f){return o=e(o,u,a,f),i&&1!==i&&(Pn(o),o&&!o[t]&&(o[t]={})),u=null!=o?o[t]:void 0,(n||Wn(t))&&_n(u,s),r?{context:o,name:t,value:u}:u}},inputs:function(e,t){return function(n,r,i,s){return s?s[t]:e(n,r,i)}}};var bs=function(e,t,n){this.lexer=e,this.$filter=t,this.options=n,this.ast=new ys(e,n),this.astCompiler=n.csp?new zn(this.ast,t):new Un(this.ast,t)};bs.prototype={constructor:bs,parse:function(e){return this.astCompiler.compile(e,this.options.expensiveChecks)}};var ws=Object.prototype.valueOf,Es=t("$sce"),Ss={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},xs=t("$compile"),Ts=e.document.createElement("a"),Ns=ur(e.location.href);lr.$inject=["$document"],hr.$inject=["$provide"];var Cs=22,ks=".",Ls="0";gr.$inject=["$locale"],yr.$inject=["$locale"];var As={yyyy:xr("FullYear",4,0,!1,!0),yy:xr("FullYear",2,0,!0,!0),y:xr("FullYear",1,0,!1,!0),MMMM:Tr("Month"),MMM:Tr("Month",!0),MM:xr("Month",2,1),M:xr("Month",1,1),LLLL:Tr("Month",!1,!0),dd:xr("Date",2),d:xr("Date",1),HH:xr("Hours",2),H:xr("Hours",1),hh:xr("Hours",2,-12),h:xr("Hours",1,-12),mm:xr("Minutes",2),m:xr("Minutes",1),ss:xr("Seconds",2),s:xr("Seconds",1),sss:xr("Milliseconds",3),EEEE:Tr("Day"),EEE:Tr("Day",!0),a:function(e,t){return 12>e.getHours()?t.AMPMS[0]:t.AMPMS[1]},Z:function(e,t,n){return e=-1*n,e=(0<=e?"+":"")+(Sr(Math[0<e?"floor":"ceil"](e/60),2)+Sr(Math.abs(e%60),2))},ww:Cr(2),w:Cr(1),G:kr,GG:kr,GGG:kr,GGGG:function(e,t){return 0>=e.getFullYear()?t.ERANAMES[0]:t.ERANAMES[1]}},Os=/((?:[^yMLdHhmsaZEwG']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|L+|d+|H+|h+|m+|s+|a|Z|G+|w+))(.*)/,Ms=/^\-?\d+$/;Lr.$inject=["$locale"];var _s=d(Xr),Ds=d(Vr);Mr.$inject=["$parse"];var Ps=d({restrict:"E",compile:function(e,t){if(!t.href&&!t.xlinkHref)return function(e,t){if("a"===t[0].nodeName.toLowerCase()){var n="[object SVGAnimatedString]"===Zr.call(t.prop("href"))?"xlink:href":"href";t.on("click",function(e){t.attr(n)||e.preventDefault()})}}}}),Hs={};r(Oi,function(e,t){function n(e,n,i){e.$watch(i[r],function(e){i.$set(t,!!e)})}if("multiple"!=e){var r=Qt("ng-"+t),i=n;"checked"===e&&(i=function(e,t,i){i.ngModel!==i[r]&&n(e,t,i)}),Hs[r]=function(){return{restrict:"A",priority:100,link:i}}}}),r(_i,function(e,t){Hs[t]=function(){return{priority:100,link:function(e,n,r){if("ngPattern"===t&&"/"==r.ngPattern.charAt(0)&&(n=r.ngPattern.match(zr))){r.$set("ngPattern",new RegExp(n[1],n[2]));return}e.$watch(r[t],function(e){r.$set(t,e)})}}}}),r(["src","srcset","href"],function(e){var t=Qt("ng-"+e);Hs[t]=function(){return{priority:99,link:function(n,r,i){var s=e,o=e;"href"===e&&"[object SVGAnimatedString]"===Zr.call(r.prop("href"))&&(o="xlinkHref",i.$attr[o]="xlink:href",s=null),i.$observe(t,function(t){t?(i.$set(o,t),$r&&s&&r.prop(s,i[o])):"href"===e&&i.$set(o,null)})}}}});var Bs={$addControl:h,$$renameControl:function(e,t){e.$name=t},$removeControl:h,$setValidity:h,$setDirty:h,$setPristine:h,$setSubmitted:h};Dr.$inject=["$element","$attrs","$scope","$animate","$interpolate"];var js=function(e){return["$timeout","$parse",function(t,n){function r(e){return""===e?n('this[""]').assign:n(e).assign||h}return{name:"form",restrict:e?"EAC":"E",require:["form","^^?form"],controller:Dr,compile:function(n,i){n.addClass(bo).addClass(go);var s=i.name?"name":e&&i.ngForm?"ngForm":!1;return{pre:function(e,n,i,o){var u=o[0];if(!("action"in i)){var f=function(t){e.$apply(function(){u.$commitViewValue(),u.$setSubmitted()}),t.preventDefault()};n[0].addEventListener("submit",f,!1),n.on("$destroy",function(){t(function(){n[0].removeEventListener("submit",f,!1)},0,!1)})}(o[1]||u.$$parentForm).$addControl(u);var l=s?r(u.$name):h;s&&(l(e,u),i.$observe(s,function(t){u.$name!==t&&(l(e,void 0),u.$$parentForm.$$renameControl(u,t),l=r(u.$name),l(e,u))})),n.on("$destroy",function(){u.$$parentForm.$removeControl(u),l(e,void 0),a(u,Bs)})}}}}}]},Fs=js(),Is=js(!0),qs=/^\d{4,}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+(?:[+-][0-2]\d:[0-5]\d|Z)$/,Rs=/^[a-z][a-z\d.+-]*:\/*(?:[^:@]+(?::[^@]+)?@)?(?:[^\s:/?#]+|\[[a-f\d:]+\])(?::\d+)?(?:\/[^?#]*)?(?:\?[^#]*)?(?:#.*)?$/i,Us=/^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i,zs=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))([eE][+-]?\d+)?\s*$/,Ws=/^(\d{4,})-(\d{2})-(\d{2})$/,Xs=/^(\d{4,})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,Vs=/^(\d{4,})-W(\d\d)$/,$s=/^(\d{4,})-(\d\d)$/,Js=/^(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,Ks=ut();r(["date","datetime-local","month","time","week"],function(e){Ks[e]=!0});var Qs={text:function(e,t,n,r,i,s){Hr(e,t,n,r,i,s),Pr(r)},date:jr("date",Ws,Br(Ws,["yyyy","MM","dd"]),"yyyy-MM-dd"),"datetime-local":jr("datetimelocal",Xs,Br(Xs,"yyyy MM dd HH mm ss sss".split(" ")),"yyyy-MM-ddTHH:mm:ss.sss"),time:jr("time",Js,Br(Js,["HH","mm","ss","sss"]),"HH:mm:ss.sss"),week:jr("week",Vs,function(e,t){if(S(e))return e;if(w(e)){Vs.lastIndex=0;var n=Vs.exec(e);if(n){var r=+n[1],i=+n[2],s=n=0,o=0,u=0,a=Nr(r),i=7*(i-1);return t&&(n=t.getHours(),s=t.getMinutes(),o=t.getSeconds(),u=t.getMilliseconds()),new Date(r,0,a.getDate()+i,n,s,o,u)}}return NaN},"yyyy-Www"),month:jr("month",$s,Br($s,["yyyy","MM"]),"yyyy-MM"),number:function(e,t,n,r,i,s){Fr(e,t,n,r),Hr(e,t,n,r,i,s),r.$$parserName="number",r.$parsers.push(function(e){if(r.$isEmpty(e))return null;if(zs.test(e))return parseFloat(e)}),r.$formatters.push(function(e){if(!r.$isEmpty(e)){if(!E(e))throw So("numfmt",e);e=e.toString()}return e});if(g(n.min)||n.ngMin){var o;r.$validators.min=function(e){return r.$isEmpty(e)||m(o)||e>=o},n.$observe("min",function(e){g(e)&&!E(e)&&(e=parseFloat(e,10)),o=E(e)&&!isNaN(e)?e:void 0,r.$validate()})}if(g(n.max)||n.ngMax){var u;r.$validators.max=function(e){return r.$isEmpty(e)||m(u)||e<=u},n.$observe("max",function(e){g(e)&&!E(e)&&(e=parseFloat(e,10)),u=E(e)&&!isNaN(e)?e:void 0,r.$validate()})}},url:function(e,t,n,r,i,s){Hr(e,t,n,r,i,s),Pr(r),r.$$parserName="url",r.$validators.url=function(e,t){var n=e||t;return r.$isEmpty(n)||Rs.test(n)}},email:function(e,t,n,r,i,s){Hr(e,t,n,r,i,s),Pr(r),r.$$parserName="email",r.$validators.email=function(e,t){var n=e||t;return r.$isEmpty(n)||Us.test(n)}},radio:function(e,t,n,r){m(n.name)&&t.attr("name",++ii),t.on("click",function(e){t[0].checked&&r.$setViewValue(n.value,e&&e.type)}),r.$render=function(){t[0].checked=n.value==r.$viewValue},n.$observe("value",r.$render)},checkbox:function(e,t,n,r,i,s,o,u){var a=Ir(u,e,"ngTrueValue",n.ngTrueValue,!0),f=Ir(u,e,"ngFalseValue",n.ngFalseValue,!1);t.on("click",function(e){r.$setViewValue(t[0].checked,e&&e.type)}),r.$render=function(){t[0].checked=r.$viewValue},r.$isEmpty=function(e){return!1===e},r.$formatters.push(function(e){return H(e,a)}),r.$parsers.push(function(e){return e?a:f})},hidden:h,button:h,submit:h,reset:h,file:h},Gs=["$browser","$sniffer","$filter","$parse",function(e,t,n,r){return{restrict:"E",require:["?ngModel"],link:{pre:function(i,s,o,u){u[0]&&(Qs[Xr(o.type)]||Qs.text)(i,s,o,u[0],t,e,n,r)}}}}],Ys=/^(true|false|\d+)$/,Zs=function(){return{restrict:"A",priority:100,compile:function(e,t){return Ys.test(t.ngValue)?function(e,t,n){n.$set("value",e.$eval(n.ngValue))}:function(e,t,n){e.$watch(n.ngValue,function(e){n.$set("value",e)})}}}},eo=["$compile",function(e){return{restrict:"AC",compile:function(t){return e.$$addBindingClass(t),function(t,n,r){e.$$addBindingInfo(n,r.ngBind),n=n[0],t.$watch(r.ngBind,function(e){n.textContent=m(e)?"":e})}}}}],to=["$interpolate","$compile",function(e,t){return{compile:function(n){return t.$$addBindingClass(n),function(n,r,i){n=e(r.attr(i.$attr.ngBindTemplate)),t.$$addBindingInfo(r,n.expressions),r=r[0],i.$observe("ngBindTemplate",function(e){r.textContent=m(e)?"":e})}}}}],no=["$sce","$parse","$compile",function(e,t,n){return{restrict:"A",compile:function(r,i){var s=t(i.ngBindHtml),o=t(i.ngBindHtml,function(t){return e.valueOf(t)});return n.$$addBindingClass(r),function(t,r,i){n.$$addBindingInfo(r,i.ngBindHtml),t.$watch(o,function(){var n=s(t);r.html(e.getTrustedHtml(n)||"")})}}}}],ro=d({restrict:"A",require:"ngModel",link:function(e,t,n,r){r.$viewChangeListeners.push(function(){e.$eval(n.ngChange)})}}),io=qr("",!0),so=qr("Odd",0),oo=qr("Even",1),uo=_r({compile:function(e,t){t.$set("ngCloak",void 0),e.removeClass("ng-cloak")}}),ao=[function(){return{restrict:"A",scope:!0,controller:"@",priority:500}}],fo={},lo={blur:!0,focus:!0};r("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(e){var t=Qt("ng-"+e);fo[t]=["$parse","$rootScope",function(n,r){return{restrict:"A",compile:function(i,s){var o=n(s[t],null,!0);return function(t,n){n.on(e,function(n){var i=function(){o(t,{$event:n})};lo[e]&&r.$$phase?t.$evalAsync(i):t.$apply(i)})}}}}]});var co=["$animate","$compile",function(e,t){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(n,r,i,s,o){var u,a,f;n.$watch(i.ngIf,function(n){n?a||o(function(n,s){a=s,n[n.length++]=t.$$createComment("end ngIf",i.ngIf),u={clone:n},e.enter(n,r.parent(),r)}):(f&&(f.remove(),f=null),a&&(a.$destroy(),a=null),u&&(f=ot(u.clone),e.leave(f).then(function(){f=null}),u=null))})}}}],ho=["$templateRequest","$anchorScroll","$animate",function(e,t,n){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:ni.noop,compile:function(r,i){var s=i.ngInclude||i.src,o=i.onload||"",u=i.autoscroll;return function(r,i,a,f,l){var c=0,h,p,d,v=function(){p&&(p.remove(),p=null),h&&(h.$destroy(),h=null),d&&(n.leave(d).then(function(){p=null}),p=d,d=null)};r.$watch(s,function(s){var a=function(){!g(u)||u&&!r.$eval(u)||t()},p=++c;s?(e(s,!0).then(function(e){if(!r.$$destroyed&&p===c){var t=r.$new();f.template=e,e=l(t,function(e){v(),n.enter(e,null,i).then(a)}),h=t,d=e,h.$emit("$includeContentLoaded",s),r.$eval(o)}},function(){r.$$destroyed||p!==c||(v(),r.$emit("$includeContentError",s))}),r.$emit("$includeContentRequested",s)):(v(),f.template=null)})}}}}],po=["$compile",function(t){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(n,r,i,s){Zr.call(r[0]).match(/SVG/)?(r.empty(),t(ht(s.template,e.document).childNodes)(n,function(e){r.append(e)},{futureParentElement:r})):(r.html(s.template),t(r.contents())(n))}}}],vo=_r({priority:450,compile:function(){return{pre:function(e,t,n){e.$eval(n.ngInit)}}}}),mo=function(){return{restrict:"A",priority:100,require:"ngModel",link:function(e,t,n,i){var s=t.attr(n.$attr.ngList)||", ",o="false"!==n.ngTrim,u=o?ui(s):s;i.$parsers.push(function(e){if(!m(e)){var t=[];return e&&r(e.split(u),function(e){e&&t.push(o?ui(e):e)}),t}}),i.$formatters.push(function(e){if(si(e))return e.join(s)}),i.$isEmpty=function(e){return!e||!e.length}}}},go="ng-valid",yo="ng-invalid",bo="ng-pristine",wo="ng-dirty",Eo="ng-pending",So=t("ngModel"),xo=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate","$timeout","$rootScope","$q","$interpolate",function(e,t,n,i,s,o,u,a,f,l){this.$modelValue=this.$viewValue=Number.NaN,this.$$rawModelValue=void 0,this.$validators={},this.$asyncValidators={},this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$untouched=!0,this.$touched=!1,this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$error={},this.$$success={},this.$pending=void 0,this.$name=l(n.name||"",!1)(e),this.$$parentForm=Bs;var c=s(n.ngModel),p=c.assign,d=c,v=p,y=null,b,w=this;this.$$setOptions=function(e){if((w.$options=e)&&e.getterSetter){var t=s(n.ngModel+"()"),r=s(n.ngModel+"($$$p)");d=function(e){var n=c(e);return x(n)&&(n=t(e)),n},v=function(e,t){x(c(e))?r(e,{$$$p:t}):p(e,t)}}else if(!c.assign)throw So("nonassign",n.ngModel,z(i))},this.$render=h,this.$isEmpty=function(e){return m(e)||""===e||null===e||e!==e},this.$$updateEmptyClasses=function(e){w.$isEmpty(e)?(o.removeClass(i,"ng-not-empty"),o.addClass(i,"ng-empty")):(o.removeClass(i,"ng-empty"),o.addClass(i,"ng-not-empty"))};var S=0;Rr({ctrl:this,$element:i,set:function(e,t){e[t]=!0},unset:function(e,t){delete e[t]},$animate:o}),this.$setPristine=function(){w.$dirty=!1,w.$pristine=!0,o.removeClass(i,wo),o.addClass(i,bo)},this.$setDirty=function(){w.$dirty=!0,w.$pristine=!1,o.removeClass(i,bo),o.addClass(i,wo),w.$$parentForm.$setDirty()},this.$setUntouched=function(){w.$touched=!1,w.$untouched=!0,o.setClass(i,"ng-untouched","ng-touched")},this.$setTouched=function(){w.$touched=!0,w.$untouched=!1,o.setClass(i,"ng-touched","ng-untouched")},this.$rollbackViewValue=function(){u.cancel(y),w.$viewValue=w.$$lastCommittedViewValue,w.$render()},this.$validate=function(){if(!E(w.$modelValue)||!isNaN(w.$modelValue)){var e=w.$$rawModelValue,t=w.$valid,n=w.$modelValue,r=w.$options&&w.$options.allowInvalid;w.$$runValidators(e,w.$$lastCommittedViewValue,function(i){r||t===i||(w.$modelValue=i?e:void 0,w.$modelValue!==n&&w.$$writeModelToScope())})}},this.$$runValidators=function(e,t,n){function i(){var n=!0;return r(w.$validators,function(r,i){var s=r(e,t);n=n&&s,o(i,s)}),n?!0:(r(w.$asyncValidators,function(e,t){o(t,null)}),!1)}function s(){var n=[],i=!0;r(w.$asyncValidators,function(r,s){var u=r(e,t);if(!u||!x(u.then))throw So("nopromise",u);o(s,void 0),n.push(u.then(function(){o(s,!0)},function(){i=!1,o(s,!1)}))}),n.length?f.all(n).then(function(){u(i)},h):u(!0)}function o(e,t){a===S&&w.$setValidity(e,t)}function u(e){a===S&&n(e)}S++;var a=S;(function(){var e=w.$$parserName||"parse";return m(b)?(o(e,null),!0):(b||(r(w.$validators,function(e,t){o(t,null)}),r(w.$asyncValidators,function(e,t){o(t,null)})),o(e,b),b)})()?i()?s():u(!1):u(!1)},this.$commitViewValue=function(){var e=w.$viewValue;u.cancel(y);if(w.$$lastCommittedViewValue!==e||""===e&&w.$$hasNativeValidators)w.$$updateEmptyClasses(e),w.$$lastCommittedViewValue=e,w.$pristine&&this.$setDirty(),this.$$parseAndValidate()},this.$$parseAndValidate=function(){var t=w.$$lastCommittedViewValue;if(b=m(t)?void 0:!0)for(var n=0;n<w.$parsers.length;n++)if(t=w.$parsers[n](t),m(t)){b=!1;break}E(w.$modelValue)&&isNaN(w.$modelValue)&&(w.$modelValue=d(e));var r=w.$modelValue,i=w.$options&&w.$options.allowInvalid;w.$$rawModelValue=t,i&&(w.$modelValue=t,w.$modelValue!==r&&w.$$writeModelToScope()),w.$$runValidators(t,w.$$lastCommittedViewValue,function(e){i||(w.$modelValue=e?t:void 0,w.$modelValue!==r&&w.$$writeModelToScope())})},this.$$writeModelToScope=function(){v(e,w.$modelValue),r(w.$viewChangeListeners,function(e){try{e()}catch(n){t(n)}})},this.$setViewValue=function(e,t){w.$viewValue=e,w.$options&&!w.$options.updateOnDefault||w.$$debounceViewValueCommit(t)},this.$$debounceViewValueCommit=function(t){var n=0,r=w.$options;r&&g(r.debounce)&&(r=r.debounce,E(r)?n=r:E(r[t])?n=r[t]:E(r["default"])&&(n=r["default"])),u.cancel(y),n?y=u(function(){w.$commitViewValue()},n):a.$$phase?w.$commitViewValue():e.$apply(function(){w.$commitViewValue()})},e.$watch(function(){var t=d(e);if(t!==w.$modelValue&&(w.$modelValue===w.$modelValue||t===t)){w.$modelValue=w.$$rawModelValue=t,b=void 0;for(var n=w.$formatters,r=n.length,i=t;r--;)i=n[r](i);w.$viewValue!==i&&(w.$$updateEmptyClasses(i),w.$viewValue=w.$$lastCommittedViewValue=i,w.$render(),w.$$runValidators(t,i,h))}return t})}],To=["$rootScope",function(e){return{restrict:"A",require:["ngModel","^?form","^?ngModelOptions"],controller:xo,priority:1,compile:function(t){return t.addClass(bo).addClass("ng-untouched").addClass(go),{pre:function(e,t,n,r){var i=r[0];t=r[1]||i.$$parentForm,i.$$setOptions(r[2]&&r[2].$options),t.$addControl(i),n.$observe("name",function(e){i.$name!==e&&i.$$parentForm.$$renameControl(i,e)}),e.$on("$destroy",function(){i.$$parentForm.$removeControl(i)})},post:function(t,n,r,i){var s=i[0];s.$options&&s.$options.updateOn&&n.on(s.$options.updateOn,function(e){s.$$debounceViewValueCommit(e&&e.type)}),n.on("blur",function(){s.$touched||(e.$$phase?t.$evalAsync(s.$setTouched):t.$apply(s.$setTouched))})}}}}}],No=/(\s+|^)default(\s+|$)/,Co=function(){return{restrict:"A",controller:["$scope","$attrs",function(e,t){var n=this;this.$options=D(e.$eval(t.ngModelOptions)),g(this.$options.updateOn)?(this.$options.updateOnDefault=!1,this.$options.updateOn=ui(this.$options.updateOn.replace(No,function(){return n.$options.updateOnDefault=!0," "}))):this.$options.updateOnDefault=!0}]}},ko=_r({terminal:!0,priority:1e3}),Lo=t("ngOptions"),Ao=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?(?:\s+disable\s+when\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,Oo=["$compile","$document","$parse",function(t,i,s){function o(e,t,r){function i(e,t,n,r,i){this.selectValue=e,this.viewValue=t,this.label=n,this.group=r,this.disabled=i}function o(e){var t;if(!f&&n(e))t=e;else{t=[];for(var r in e)e.hasOwnProperty(r)&&"$"!==r.charAt(0)&&t.push(r)}return t}var u=e.match(Ao);if(!u)throw Lo("iexp",e,z(t));var a=u[5]||u[7],f=u[6];e=/ as /.test(u[0])&&u[1];var l=u[9];t=s(u[2]?u[1]:a);var c=e&&s(e)||t,h=l&&s(l),p=l?function(e,t){return h(r,t)}:function(e){return Ht(e)},d=function(e,t){return p(e,w(e,t))},v=s(u[2]||u[1]),m=s(u[3]||""),g=s(u[4]||""),y=s(u[8]),b={},w=f?function(e,t){return b[f]=t,b[a]=e,b}:function(e){return b[a]=e,b};return{trackBy:l,getTrackByValue:d,getWatchables:s(y,function(e){var t=[];e=e||[];for(var n=o(e),i=n.length,s=0;s<i;s++){var a=e===n?s:n[s],f=e[a],a=w(f,a),f=p(f,a);t.push(f);if(u[2]||u[1])f=v(r,a),t.push(f);u[4]&&(a=g(r,a),t.push(a))}return t}),getOptions:function(){for(var e=[],t={},n=y(r)||[],s=o(n),u=s.length,a=0;a<u;a++){var f=n===s?a:s[a],h=w(n[f],f),b=c(r,h),f=p(b,h),E=v(r,h),S=m(r,h),h=g(r,h),b=new i(f,b,E,S,h);e.push(b),t[f]=b}return{items:e,selectValueMap:t,getOptionFromViewValue:function(e){return t[d(e)]},getViewValueFromOption:function(e){return l?ni.copy(e.viewValue):e.viewValue}}}}}var u=e.document.createElement("option"),a=e.document.createElement("optgroup");return{restrict:"A",terminal:!0,require:["select","ngModel"],link:{pre:function(e,t,n,r){r[0].registerOption=h},post:function(e,n,s,f){function l(e,t){e.element=t,t.disabled=e.disabled,e.label!==t.label&&(t.label=e.label,t.textContent=e.label),e.value!==t.value&&(t.value=e.selectValue)}function c(){var e=E&&h.readValue();if(E)for(var t=E.items.length-1;0<=t;t--){var r=E.items[t];r.group?Lt(r.element.parentNode):Lt(r.element)}E=S.getOptions();var i={};b&&n.prepend(v),E.items.forEach(function(e){var t;if(g(e.group)){t=i[e.group],t||(t=a.cloneNode(!1),x.appendChild(t),t.label=e.group,i[e.group]=t);var n=u.cloneNode(!1)}else t=x,n=u.cloneNode(!1);t.appendChild(n),l(e,n)}),n[0].appendChild(x),p.$render(),p.$isEmpty(e)||(t=h.readValue(),(S.trackBy||d?H(e,t):e===t)||(p.$setViewValue(t),p.$render()))}var h=f[0],p=f[1],d=s.multiple,v;f=0;for(var m=n.children(),y=m.length;f<y;f++)if(""===m[f].value){v=m.eq(f);break}var b=!!v,w=Jr(u.cloneNode(!1));w.val("?");var E,S=o(s.ngOptions,n,e),x=i[0].createDocumentFragment();d?(p.$isEmpty=function(e){return!e||0===e.length},h.writeValue=function(e){E.items.forEach(function(e){e.element.selected=!1}),e&&e.forEach(function(e){if(e=E.getOptionFromViewValue(e))e.element.selected=!0})},h.readValue=function(){var e=n.val()||[],t=[];return r(e,function(e){(e=E.selectValueMap[e])&&!e.disabled&&t.push(E.getViewValueFromOption(e))}),t},S.trackBy&&e.$watchCollection(function(){if(si(p.$viewValue))return p.$viewValue.map(function(e){return S.getTrackByValue(e)})},function(){p.$render()})):(h.writeValue=function(e){var t=E.getOptionFromViewValue(e);t?(n[0].value!==t.selectValue&&(w.remove(),b||v.remove(),n[0].value=t.selectValue,t.element.selected=!0),t.element.setAttribute("selected","selected")):null===e||b?(w.remove(),b||n.prepend(v),n.val(""),v.prop("selected",!0),v.attr("selected",!0)):(b||v.remove(),n.prepend(w),n.val("?"),w.prop("selected",!0),w.attr("selected",!0))},h.readValue=function(){var e=E.selectValueMap[n.val()];return e&&!e.disabled?(b||v.remove(),w.remove(),E.getViewValueFromOption(e)):null},S.trackBy&&e.$watch(function(){return S.getTrackByValue(p.$viewValue)},function(){p.$render()})),b?(v.remove(),t(v)(e),v.removeClass("ng-scope")):v=Jr(u.cloneNode(!1)),n.empty(),c(),e.$watchCollection(S.getWatchables,c)}}}}],Mo=["$locale","$interpolate","$log",function(e,t,n){var i=/{}/g,s=/^when(Minus)?(.+)$/;return{link:function(o,u,a){function f(e){u.text(e||"")}var l=a.count,c=a.$attr.when&&u.attr(a.$attr.when),p=a.offset||0,d=o.$eval(c)||{},v={},g=t.startSymbol(),y=t.endSymbol(),b=g+l+"-"+p+y,w=ni.noop,S;r(a,function(e,t){var n=s.exec(t);n&&(n=(n[1]?"-":"")+Xr(n[2]),d[n]=u.attr(a.$attr[t]))}),r(d,function(e,n){v[n]=t(e.replace(i,b))}),o.$watch(l,function(t){var r=parseFloat(t),i=isNaN(r);i||r in d||(r=e.pluralCat(r-p)),r===S||i&&E(S)&&isNaN(S)||(w(),i=v[r],m(i)?(null!=t&&n.debug("ngPluralize: no rule defined for '"+r+"' in "+c),w=h,f()):w=o.$watch(i,f),S=r)})}}}],_o=["$parse","$animate","$compile",function(e,i,s){var o=t("ngRepeat"),u=function(e,t,n,r,i,s,o){e[n]=r,i&&(e[i]=s),e.$index=t,e.$first=0===t,e.$last=t===o-1,e.$middle=!e.$first&&!e.$last,e.$odd=!(e.$even=0===(t&1))};return{restrict:"A",multiElement:!0,transclude:"element",priority:1e3,terminal:!0,$$tlb:!0,compile:function(t,a){var f=a.ngRepeat,l=s.$$createComment("end ngRepeat",f),c=f.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);if(!c)throw o("iexp",f);var h=c[1],p=c[2],d=c[3],v=c[4],c=h.match(/^(?:(\s*[\$\w]+)|\(\s*([\$\w]+)\s*,\s*([\$\w]+)\s*\))$/);if(!c)throw o("iidexp",h);var m=c[3]||c[1],g=c[2];if(d&&(!/^[$a-zA-Z_][$a-zA-Z0-9_]*$/.test(d)||/^(null|undefined|this|\$index|\$first|\$middle|\$last|\$even|\$odd|\$parent|\$root|\$id)$/.test(d)))throw o("badident",d);var y,b,w,E,S={$id:Ht};return v?y=e(v):(w=function(e,t){return Ht(t)},E=function(e){return e}),function(e,t,s,a,c){y&&(b=function(t,n,r){return g&&(S[g]=t),S[m]=n,S.$index=r,y(e,S)});var h=ut();e.$watchCollection(p,function(s){var a,p,v=t[0],y,S=ut(),x,T,N,C,k,L,A;d&&(e[d]=s);if(n(s))k=s,p=b||w;else for(A in p=b||E,k=[],s)Wr.call(s,A)&&"$"!==A.charAt(0)&&k.push(A);x=k.length,A=Array(x);for(a=0;a<x;a++)if(T=s===k?a:k[a],N=s[T],C=p(T,N,a),h[C])L=h[C],delete h[C],S[C]=L,A[a]=L;else{if(S[C])throw r(A,function(e){e&&e.scope&&(h[e.id]=e)}),o("dupes",f,C,N);A[a]={id:C,scope:void 0,clone:void 0},S[C]=!0}for(y in h){L=h[y],C=ot(L.clone),i.leave(C);if(C[0].parentNode)for(a=0,p=C.length;a<p;a++)C[a].$$NG_REMOVED=!0;L.scope.$destroy()}for(a=0;a<x;a++)if(T=s===k?a:k[a],N=s[T],L=A[a],L.scope){y=v;do y=y.nextSibling;while(y&&y.$$NG_REMOVED);L.clone[0]!=y&&i.move(ot(L.clone),null,v),v=L.clone[L.clone.length-1],u(L.scope,a,m,N,g,T,x)}else c(function(e,t){L.scope=t;var n=l.cloneNode(!1);e[e.length++]=n,i.enter(e,null,v),v=n,L.clone=e,S[L.id]=L,u(L.scope,a,m,N,g,T,x)});h=S})}}}}],Do=["$animate",function(e){return{restrict:"A",multiElement:!0,link:function(t,n,r){t.$watch(r.ngShow,function(t){e[t?"removeClass":"addClass"](n,"ng-hide",{tempClasses:"ng-hide-animate"})})}}}],Po=["$animate",function(e){return{restrict:"A",multiElement:!0,link:function(t,n,r){t.$watch(r.ngHide,function(t){e[t?"addClass":"removeClass"](n,"ng-hide",{tempClasses:"ng-hide-animate"})})}}}],Ho=_r(function(e,t,n){e.$watch(n.ngStyle,function(e,n){n&&e!==n&&r(n,function(e,n){t.css(n,"")}),e&&t.css(e)},!0)}),Bo=["$animate","$compile",function(e,t){return{require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(n,i,s,o){var u=[],a=[],f=[],l=[],c=function(e,t){return function(){e.splice(t,1)}};n.$watch(s.ngSwitch||s.on,function(n){var i,s;i=0;for(s=f.length;i<s;++i)e.cancel(f[i]);i=f.length=0;for(s=l.length;i<s;++i){var h=ot(a[i].clone);l[i].$destroy(),(f[i]=e.leave(h)).then(c(f,i))}a.length=0,l.length=0,(u=o.cases["!"+n]||o.cases["?"])&&r(u,function(n){n.transclude(function(r,i){l.push(i);var s=n.element;r[r.length++]=t.$$createComment("end ngSwitchWhen"),a.push({clone:r}),e.enter(r,s.parent(),s)})})})}}}],jo=_r({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(e,t,n,r,i){r.cases["!"+n.ngSwitchWhen]=r.cases["!"+n.ngSwitchWhen]||[],r.cases["!"+n.ngSwitchWhen].push({transclude:i,element:t})}}),Fo=_r({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(e,t,n,r,i){r.cases["?"]=r.cases["?"]||[],r.cases["?"].push({transclude:i,element:t})}}),Io=t("ngTransclude"),qo=_r({restrict:"EAC",link:function(e,t,n,r,i){n.ngTransclude===n.$attr.ngTransclude&&(n.ngTransclude="");if(!i)throw Io("orphan",z(t));i(function(e){e.length&&(t.empty(),t.append(e))},null,n.ngTransclude||n.ngTranscludeSlot)}}),Ro=["$templateCache",function(e){return{restrict:"E",terminal:!0,compile:function(t,n){"text/ng-template"==n.type&&e.put(n.id,t[0].text)}}}],Uo={$setViewValue:h,$render:h},zo=["$element","$scope",function(t,n){var r=this,i=new Bt;r.ngModelCtrl=Uo,r.unknownOption=Jr(e.document.createElement("option")),r.renderUnknownOption=function(e){e="? "+Ht(e)+" ?",r.unknownOption.val(e),t.prepend(r.unknownOption),t.val(e)},n.$on("$destroy",function(){r.renderUnknownOption=h}),r.removeUnknownOption=function(){r.unknownOption.parent()&&r.unknownOption.remove()},r.readValue=function(){return r.removeUnknownOption(),t.val()},r.writeValue=function(e){r.hasOption(e)?(r.removeUnknownOption(),t.val(e),""===e&&r.emptyOption.prop("selected",!0)):null==e&&r.emptyOption?(r.removeUnknownOption(),t.val("")):r.renderUnknownOption(e)},r.addOption=function(e,t){if(8!==t[0].nodeType){it(e,'"option value"'),""===e&&(r.emptyOption=t);var n=i.get(e)||0;i.put(e,n+1),r.ngModelCtrl.$render(),t[0].hasAttribute("selected")&&(t[0].selected=!0)}},r.removeOption=function(e){var t=i.get(e);t&&(1===t?(i.remove(e),""===e&&(r.emptyOption=void 0)):i.put(e,t-1))},r.hasOption=function(e){return!!i.get(e)},r.registerOption=function(e,t,n,i,s){if(i){var o;n.$observe("value",function(e){g(o)&&r.removeOption(o),o=e,r.addOption(e,t)})}else s?e.$watch(s,function(e,i){n.$set("value",e),i!==e&&r.removeOption(i),r.addOption(e,t)}):r.addOption(n.value,t);t.on("$destroy",function(){r.removeOption(n.value),r.ngModelCtrl.$render()})}}],Wo=function(){return{restrict:"E",require:["select","?ngModel"],controller:zo,priority:1,link:{pre:function(e,t,n,i){var s=i[1];if(s){var o=i[0];o.ngModelCtrl=s,t.on("change",function(){e.$apply(function(){s.$setViewValue(o.readValue())})});if(n.multiple){o.readValue=function(){var e=[];return r(t.find("option"),function(t){t.selected&&e.push(t.value)}),e},o.writeValue=function(e){var n=new Bt(e);r(t.find("option"),function(e){e.selected=g(n.get(e.value))})};var u,a=NaN;e.$watch(function(){a!==s.$viewValue||H(u,s.$viewValue)||(u=P(s.$viewValue),s.$render()),a=s.$viewValue}),s.$isEmpty=function(e){return!e||0===e.length}}}},post:function(e,t,n,r){var i=r[1];if(i){var s=r[0];i.$render=function(){s.writeValue(i.$viewValue)}}}}}},Xo=["$interpolate",function(e){return{restrict:"E",priority:100,compile:function(t,n){if(g(n.value))var r=e(n.value,!0);else{var i=e(t.text(),!0);i||n.$set("value",t.text())}return function(e,t,n){var s=t.parent();(s=s.data("$selectController")||s.parent().data("$selectController"))&&s.registerOption(e,t,n,r,i)}}}}],Vo=d({restrict:"E",terminal:!1}),$o=function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,r){r&&(n.required=!0,r.$validators.required=function(e,t){return!n.required||!r.$isEmpty(t)},n.$observe("required",function(){r.$validate()}))}}},Jo=function(){return{restrict:"A",require:"?ngModel",link:function(e,n,r,i){if(i){var s,o=r.ngPattern||r.pattern;r.$observe("pattern",function(e){w(e)&&0<e.length&&(e=new RegExp("^"+e+"$"));if(e&&!e.test)throw t("ngPattern")("noregexp",o,e,z(n));s=e||void 0,i.$validate()}),i.$validators.pattern=function(e,t){return i.$isEmpty(t)||m(s)||s.test(t)}}}}},Ko=function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,r){if(r){var i=-1;n.$observe("maxlength",function(e){e=l(e),i=isNaN(e)?-1:e,r.$validate()}),r.$validators.maxlength=function(e,t){return 0>i||r.$isEmpty(t)||t.length<=i}}}}},Qo=function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,r){if(r){var i=0;n.$observe("minlength",function(e){i=l(e)||0,r.$validate()}),r.$validators.minlength=function(e,t){return r.$isEmpty(t)||t.length>=i}}}}};e.angular.bootstrap?e.console&&console.log("WARNING: Tried to load angular more than once."):(tt(),ft(ni),ni.module("ngLocale",[],["$provide",function(e){function t(e){e+="";var t=e.indexOf(".");return-1==t?0:e.length-t-1}e.value("$locale",{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),ERANAMES:["Before Christ","Anno Domini"],ERAS:["BC","AD"],FIRSTDAYOFWEEK:6,MONTH:"January February March April May June July August September October November December".split(" "),SHORTDAY:"Sun Mon Tue Wed Thu Fri Sat".split(" "),SHORTMONTH:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),STANDALONEMONTH:"January February March April May June July August September October November December".split(" "),WEEKENDRANGE:[5,6],fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",medium:"MMM d, y h:mm:ss a",mediumDate:"MMM d, y",mediumTime:"h:mm:ss a","short":"M/d/yy h:mm a",shortDate:"M/d/yy",shortTime:"h:mm a"},NUMBER_FORMATS:{CURRENCY_SYM:"$",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-¤",negSuf:"",posPre:"¤",posSuf:""}]},id:"en-us",localeID:"en_US",pluralCat:function(e,n){var r=e|0,i=n;return void 0===i&&(i=Math.min(t(e),3)),Math.pow(10,i),1==r&&0==i?"one":"other"}})}]),Jr(e.document).ready(function(){Q(e.document,G)}))})(window),!window.angular.$$csp().noInlineStyle&&window.angular.element(document.head).prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\\:form{display:block;}.ng-animate-shim{visibility:hidden;}.ng-anchor{position:absolute;}</style>'),define("angular",function(e){return function(){var t,n;return t||e.angular}}(this)),!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define,1){var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.p2=e()}else define("phaser",e)}(function(){return function e(t,n,r){function i(o,u){if(!n[o]){if(!t[o]){var l="function"==typeof require&&require;if(!u&&l)return l(o,!0);if(s)return s(o,!0);throw new Error("Cannot find module '"+o+"'")}var h=n[o]={exports:{}};t[o][0].call(h.exports,function(e){var n=t[o][1][e];return i(n?n:e)},h,h.exports,e,t,n,r)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,n){function r(){}var i=e("./Scalar");t.exports=r,r.lineInt=function(e,t,n){n=n||0;var r,s,o,u,a,f,l,c=[0,0];return r=e[1][1]-e[0][1],s=e[0][0]-e[1][0],o=r*e[0][0]+s*e[0][1],u=t[1][1]-t[0][1],a=t[0][0]-t[1][0],f=u*t[0][0]+a*t[0][1],l=r*a-u*s,i.eq(l,0,n)||(c[0]=(a*o-s*f)/l,c[1]=(r*f-u*o)/l),c},r.segmentsIntersect=function(e,t,n,r){var i=t[0]-e[0],s=t[1]-e[1],o=r[0]-n[0],u=r[1]-n[1];if(o*s-u*i==0)return!1;var a=(i*(n[1]-e[1])+s*(e[0]-n[0]))/(o*s-u*i),f=(o*(e[1]-n[1])+u*(n[0]-e[0]))/(u*i-o*s);return a>=0&&1>=a&&f>=0&&1>=f}},{"./Scalar":4}],2:[function(e,t,n){function r(){}t.exports=r,r.area=function(e,t,n){return(t[0]-e[0])*(n[1]-e[1])-(n[0]-e[0])*(t[1]-e[1])},r.left=function(e,t,n){return r.area(e,t,n)>0},r.leftOn=function(e,t,n){return r.area(e,t,n)>=0},r.right=function(e,t,n){return r.area(e,t,n)<0},r.rightOn=function(e,t,n){return r.area(e,t,n)<=0};var i=[],s=[];r.collinear=function(e,t,n,o){if(o){var u=i,a=s;u[0]=t[0]-e[0],u[1]=t[1]-e[1],a[0]=n[0]-t[0],a[1]=n[1]-t[1];var l=u[0]*a[0]+u[1]*a[1],c=Math.sqrt(u[0]*u[0]+u[1]*u[1]),h=Math.sqrt(a[0]*a[0]+a[1]*a[1]),p=Math.acos(l/(c*h));return o>p}return 0==r.area(e,t,n)},r.sqdist=function(e,t){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r}},{}],3:[function(e,t,n){function r(){this.vertices=[]}function i(e,t,n,r,i){i=i||0;var s=t[1]-e[1],o=e[0]-t[0],a=s*e[0]+o*e[1],f=r[1]-n[1],l=n[0]-r[0],c=f*n[0]+l*n[1],p=s*l-f*o;return u.eq(p,0,i)?[0,0]:[(l*a-o*c)/p,(s*c-f*a)/p]}var s=e("./Line"),o=e("./Point"),u=e("./Scalar");t.exports=r,r.prototype.at=function(e){var t=this.vertices,n=t.length;return t[0>e?e%n+n:e%n]},r.prototype.first=function(){return this.vertices[0]},r.prototype.last=function(){return this.vertices[this.vertices.length-1]},r.prototype.clear=function(){this.vertices.length=0},r.prototype.append=function(e,t,n){if("undefined"==typeof t)throw new Error("From is not given!");if("undefined"==typeof n)throw new Error("To is not given!");if(t>n-1)throw new Error("lol1");if(n>e.vertices.length)throw new Error("lol2");if(0>t)throw new Error("lol3");for(var r=t;n>r;r++)this.vertices.push(e.vertices[r])},r.prototype.makeCCW=function(){for(var e=0,t=this.vertices,n=1;n<this.vertices.length;++n)(t[n][1]<t[e][1]||t[n][1]==t[e][1]&&t[n][0]>t[e][0])&&(e=n);o.left(this.at(e-1),this.at(e),this.at(e+1))||this.reverse()},r.prototype.reverse=function(){for(var e=[],t=0,n=this.vertices.length;t!==n;t++)e.push(this.vertices.pop());this.vertices=e},r.prototype.isReflex=function(e){return o.right(this.at(e-1),this.at(e),this.at(e+1))};var a=[],f=[];r.prototype.canSee=function(e,t){var n,r,i=a,u=f;if(o.leftOn(this.at(e+1),this.at(e),this.at(t))&&o.rightOn(this.at(e-1),this.at(e),this.at(t)))return!1;r=o.sqdist(this.at(e),this.at(t));for(var l=0;l!==this.vertices.length;++l)if((l+1)%this.vertices.length!==e&&l!==e&&o.leftOn(this.at(e),this.at(t),this.at(l+1))&&o.rightOn(this.at(e),this.at(t),this.at(l))&&(i[0]=this.at(e),i[1]=this.at(t),u[0]=this.at(l),u[1]=this.at(l+1),n=s.lineInt(i,u),o.sqdist(this.at(e),n)<r))return!1;return!0},r.prototype.copy=function(e,t,n){var i=n||new r;if(i.clear(),t>e)for(var s=e;t>=s;s++)i.vertices.push(this.vertices[s]);else{for(var s=0;t>=s;s++)i.vertices.push(this.vertices[s]);for(var s=e;s<this.vertices.length;s++)i.vertices.push(this.vertices[s])}return i},r.prototype.getCutEdges=function(){for(var e=[],t=[],n=[],i=new r,s=Number.MAX_VALUE,o=0;o<this.vertices.length;++o)if(this.isReflex(o))for(var u=0;u<this.vertices.length;++u)if(this.canSee(o,u)){t=this.copy(o,u,i).getCutEdges(),n=this.copy(u,o,i).getCutEdges();for(var a=0;a<n.length;a++)t.push(n[a]);t.length<s&&(e=t,s=t.length,e.push([this.at(o),this.at(u)]))}return e},r.prototype.decomp=function(){var e=this.getCutEdges();return e.length>0?this.slice(e):[this]},r.prototype.slice=function(e){if(0==e.length)return[this];if(e instanceof Array&&e.length&&e[0]instanceof Array&&2==e[0].length&&e[0][0]instanceof Array){for(var t=[this],n=0;n<e.length;n++)for(var r=e[n],i=0;i<t.length;i++){var s=t[i],o=s.slice(r);if(o){t.splice(i,1),t.push(o[0],o[1]);break}}return t}var r=e,n=this.vertices.indexOf(r[0]),i=this.vertices.indexOf(r[1]);return-1!=n&&-1!=i?[this.copy(n,i),this.copy(i,n)]:!1},r.prototype.isSimple=function(){for(var e=this.vertices,t=0;t<e.length-1;t++)for(var n=0;t-1>n;n++)if(s.segmentsIntersect(e[t],e[t+1],e[n],e[n+1]))return!1;for(var t=1;t<e.length-2;t++)if(s.segmentsIntersect(e[0],e[e.length-1],e[t],e[t+1]))return!1;return!0},r.prototype.quickDecomp=function(e,t,n,s,u,a){u=u||100,a=a||0,s=s||25,e="undefined"!=typeof e?e:[],t=t||[],n=n||[];var f=[0,0],l=[0,0],c=[0,0],h=0,p=0,v=0,m=0,y=0,b=0,w=0,E=new r,S=new r,x=this,T=this.vertices;if(T.length<3)return e;if(a++,a>u)return console.warn("quickDecomp: max level ("+u+") reached."),e;for(var N=0;N<this.vertices.length;++N)if(x.isReflex(N)){t.push(x.vertices[N]),h=p=Number.MAX_VALUE;for(var C=0;C<this.vertices.length;++C)o.left(x.at(N-1),x.at(N),x.at(C))&&o.rightOn(x.at(N-1),x.at(N),x.at(C-1))&&(c=i(x.at(N-1),x.at(N),x.at(C),x.at(C-1)),o.right(x.at(N+1),x.at(N),c)&&(v=o.sqdist(x.vertices[N],c),p>v&&(p=v,l=c,b=C))),o.left(x.at(N+1),x.at(N),x.at(C+1))&&o.rightOn(x.at(N+1),x.at(N),x.at(C))&&(c=i(x.at(N+1),x.at(N),x.at(C),x.at(C+1)),o.left(x.at(N-1),x.at(N),c)&&(v=o.sqdist(x.vertices[N],c),h>v&&(h=v,f=c,y=C)));if(b==(y+1)%this.vertices.length)c[0]=(l[0]+f[0])/2,c[1]=(l[1]+f[1])/2,n.push(c),y>N?(E.append(x,N,y+1),E.vertices.push(c),S.vertices.push(c),0!=b&&S.append(x,b,x.vertices.length),S.append(x,0,N+1)):(0!=N&&E.append(x,N,x.vertices.length),E.append(x,0,y+1),E.vertices.push(c),S.vertices.push(c),S.append(x,b,N+1));else{if(b>y&&(y+=this.vertices.length),m=Number.MAX_VALUE,b>y)return e;for(var C=b;y>=C;++C)o.leftOn(x.at(N-1),x.at(N),x.at(C))&&o.rightOn(x.at(N+1),x.at(N),x.at(C))&&(v=o.sqdist(x.at(N),x.at(C)),m>v&&(m=v,w=C%this.vertices.length));w>N?(E.append(x,N,w+1),0!=w&&S.append(x,w,T.length),S.append(x,0,N+1)):(0!=N&&E.append(x,N,T.length),E.append(x,0,w+1),S.append(x,w,N+1))}return E.vertices.length<S.vertices.length?(E.quickDecomp(e,t,n,s,u,a),S.quickDecomp(e,t,n,s,u,a)):(S.quickDecomp(e,t,n,s,u,a),E.quickDecomp(e,t,n,s,u,a)),e}return e.push(this),e},r.prototype.removeCollinearPoints=function(e){for(var t=0,n=this.vertices.length-1;this.vertices.length>3&&n>=0;--n)o.collinear(this.at(n-1),this.at(n),this.at(n+1),e)&&(this.vertices.splice(n%this.vertices.length,1),n--,t++);return t}},{"./Line":1,"./Point":2,"./Scalar":4}],4:[function(e,t,n){function r(){}t.exports=r,r.eq=function(e,t,n){return n=n||0,Math.abs(e-t)<n}},{}],5:[function(e,t,n){t.exports={Polygon:e("./Polygon"),Point:e("./Point")}},{"./Point":2,"./Polygon":3}],6:[function(e,t,n){t.exports={name:"p2",version:"0.7.0",description:"A JavaScript 2D physics engine.",author:"Stefan Hedman <schteppe@gmail.com> (http://steffe.se)",keywords:["p2.js","p2","physics","engine","2d"],main:"./src/p2.js",engines:{node:"*"},repository:{type:"git",url:"https://github.com/schteppe/p2.js.git"},bugs:{url:"https://github.com/schteppe/p2.js/issues"},licenses:[{type:"MIT"}],devDependencies:{grunt:"^0.4.5","grunt-contrib-jshint":"^0.11.2","grunt-contrib-nodeunit":"^0.4.1","grunt-contrib-uglify":"~0.4.0","grunt-contrib-watch":"~0.5.0","grunt-browserify":"~2.0.1","grunt-contrib-concat":"^0.4.0"},dependencies:{"poly-decomp":"0.1.0"}}},{}],7:[function(e,t,n){function r(e){this.lowerBound=i.create(),e&&e.lowerBound&&i.copy(this.lowerBound,e.lowerBound),this.upperBound=i.create(),e&&e.upperBound&&i.copy(this.upperBound,e.upperBound)}var i=e("../math/vec2");e("../utils/Utils"),t.exports=r;var s=i.create();r.prototype.setFromPoints=function(e,t,n,r){var o=this.lowerBound,u=this.upperBound;"number"!=typeof n&&(n=0),0!==n?i.rotate(o,e[0],n):i.copy(o,e[0]),i.copy(u,o);for(var a=Math.cos(n),l=Math.sin(n),c=1;c<e.length;c++){var h=e[c];if(0!==n){var p=h[0],d=h[1];s[0]=a*p-l*d,s[1]=l*p+a*d,h=s}for(var v=0;2>v;v++)h[v]>u[v]&&(u[v]=h[v]),h[v]<o[v]&&(o[v]=h[v])}t&&(i.add(this.lowerBound,this.lowerBound,t),i.add(this.upperBound,this.upperBound,t)),r&&(this.lowerBound[0]-=r,this.lowerBound[1]-=r,this.upperBound[0]+=r,this.upperBound[1]+=r)},r.prototype.copy=function(e){i.copy(this.lowerBound,e.lowerBound),i.copy(this.upperBound,e.upperBound)},r.prototype.extend=function(e){for(var t=2;t--;){var n=e.lowerBound[t];this.lowerBound[t]>n&&(this.lowerBound[t]=n);var r=e.upperBound[t];this.upperBound[t]<r&&(this.upperBound[t]=r)}},r.prototype.overlaps=function(e){var t=this.lowerBound,n=this.upperBound,r=e.lowerBound,i=e.upperBound;return(r[0]<=n[0]&&n[0]<=i[0]||t[0]<=i[0]&&i[0]<=n[0])&&(r[1]<=n[1]&&n[1]<=i[1]||t[1]<=i[1]&&i[1]<=n[1])},r.prototype.containsPoint=function(e){var t=this.lowerBound,n=this.upperBound;return t[0]<=e[0]&&e[0]<=n[0]&&t[1]<=e[1]&&e[1]<=n[1]},r.prototype.overlapsRay=function(e){var t=1/e.direction[0],n=1/e.direction[1],r=(this.lowerBound[0]-e.from[0])*t,i=(this.upperBound[0]-e.from[0])*t,s=(this.lowerBound[1]-e.from[1])*n,o=(this.upperBound[1]-e.from[1])*n,u=Math.max(Math.max(Math.min(r,i),Math.min(s,o))),a=Math.min(Math.min(Math.max(r,i),Math.max(s,o)));return 0>a?-1:u>a?-1:u}},{"../math/vec2":30,"../utils/Utils":57}],8:[function(e,t,n){function r(e){this.type=e,this.result=[],this.world=null,this.boundingVolumeType=r.AABB}var i=e("../math/vec2"),s=e("../objects/Body");t.exports=r,r.AABB=1,r.BOUNDING_CIRCLE=2,r.prototype.setWorld=function(e){this.world=e},r.prototype.getCollisionPairs=function(e){};var o=i.create();r.boundingRadiusCheck=function(e,t){i.sub(o,e.position,t.position);var n=i.squaredLength(o),r=e.boundingRadius+t.boundingRadius;return r*r>=n},r.aabbCheck=function(e,t){return e.getAABB().overlaps(t.getAABB())},r.prototype.boundingVolumeCheck=function(e,t){var n;switch(this.boundingVolumeType){case r.BOUNDING_CIRCLE:n=r.boundingRadiusCheck(e,t);break;case r.AABB:n=r.aabbCheck(e,t);break;default:throw new Error("Bounding volume type not recognized: "+this.boundingVolumeType)}return n},r.canCollide=function(e,t){var n=s.KINEMATIC,r=s.STATIC;return e.type===r&&t.type===r?!1:e.type===n&&t.type===r||e.type===r&&t.type===n?!1:e.type===n&&t.type===n?!1:e.sleepState===s.SLEEPING&&t.sleepState===s.SLEEPING?!1:e.sleepState===s.SLEEPING&&t.type===r||t.sleepState===s.SLEEPING&&e.type===r?!1:!0},r.NAIVE=1,r.SAP=2},{"../math/vec2":30,"../objects/Body":31}],9:[function(e,t,n){function r(){i.call(this,i.NAIVE)}var i=(e("../shapes/Circle"),e("../shapes/Plane"),e("../shapes/Shape"),e("../shapes/Particle"),e("../collision/Broadphase"));e("../math/vec2"),t.exports=r,r.prototype=new i,r.prototype.constructor=r,r.prototype.getCollisionPairs=function(e){var t=e.bodies,n=this.result;n.length=0;for(var r=0,s=t.length;r!==s;r++)for(var o=t[r],u=0;r>u;u++){var a=t[u];i.canCollide(o,a)&&this.boundingVolumeCheck(o,a)&&n.push(o,a)}return n},r.prototype.aabbQuery=function(e,t,n){n=n||[];for(var r=e.bodies,i=0;i<r.length;i++){var s=r[i];s.aabbNeedsUpdate&&s.updateAABB(),s.aabb.overlaps(t)&&n.push(s)}return n}},{"../collision/Broadphase":8,"../math/vec2":30,"../shapes/Circle":39,"../shapes/Particle":43,"../shapes/Plane":44,"../shapes/Shape":45}],10:[function(e,t,n){function r(){this.contactEquations=[],this.frictionEquations=[],this.enableFriction=!0,this.enabledEquations=!0,this.slipForce=10,this.frictionCoefficient=.3,this.surfaceVelocity=0,this.contactEquationPool=new l({size:32}),this.frictionEquationPool=new c({size:64}),this.restitution=0,this.stiffness=p.DEFAULT_STIFFNESS,this.relaxation=p.DEFAULT_RELAXATION,this.frictionStiffness=p.DEFAULT_STIFFNESS,this.frictionRelaxation=p.DEFAULT_RELAXATION,this.enableFrictionReduction=!0,this.collidingBodiesLastStep=new h,this.contactSkinSize=.01}function i(e,t){o.set(e.vertices[0],.5*-t.length,-t.radius),o.set(e.vertices[1],.5*t.length,-t.radius),o.set(e.vertices[2],.5*t.length,t.radius),o.set(e.vertices[3],.5*-t.length,t.radius)}function s(e,t,n,r){for(var i=X,s=V,f=$,l=J,c=e,h=t.vertices,p=null,d=0;d!==h.length+1;d++){var v=h[d%h.length],m=h[(d+1)%h.length];o.rotate(i,v,r),o.rotate(s,m,r),a(i,i,n),a(s,s,n),u(f,i,c),u(l,s,c);var g=o.crossLength(f,l);if(null===p&&(p=g),0>=g*p)return!1;p=g}return!0}var o=e("../math/vec2"),u=o.sub,a=o.add,f=o.dot,l=(e("../utils/Utils"),e("../utils/ContactEquationPool")),c=e("../utils/FrictionEquationPool"),h=e("../utils/TupleDictionary"),p=e("../equations/Equation"),d=(e("../equations/ContactEquation"),e("../equations/FrictionEquation"),e("../shapes/Circle")),v=e("../shapes/Convex"),m=e("../shapes/Shape"),g=(e("../objects/Body"),e("../shapes/Box"));t.exports=r;var y=o.fromValues(0,1),b=o.fromValues(0,0),w=o.fromValues(0,0),E=o.fromValues(0,0),S=o.fromValues(0,0),x=o.fromValues(0,0),T=o.fromValues(0,0),N=o.fromValues(0,0),C=o.fromValues(0,0),k=o.fromValues(0,0),L=o.fromValues(0,0),A=o.fromValues(0,0),O=o.fromValues(0,0),M=o.fromValues(0,0),_=o.fromValues(0,0),D=o.fromValues(0,0),P=o.fromValues(0,0),H=o.fromValues(0,0),B=o.fromValues(0,0),j=[],F=o.create(),I=o.create();r.prototype.bodiesOverlap=function(e,t){for(var n=F,r=I,i=0,s=e.shapes.length;i!==s;i++){var o=e.shapes[i];e.toWorldFrame(n,o.position);for(var u=0,a=t.shapes.length;u!==a;u++){var f=t.shapes[u];if(t.toWorldFrame(r,f.position),this[o.type|f.type](e,o,n,o.angle+e.angle,t,f,r,f.angle+t.angle,!0))return!0}}return!1},r.prototype.collidedLastStep=function(e,t){var n=0|e.id,r=0|t.id;return!!this.collidingBodiesLastStep.get(n,r)},r.prototype.reset=function(){this.collidingBodiesLastStep.reset();for(var e=this.contactEquations,t=e.length;t--;){var n=e[t],r=n.bodyA.id,i=n.bodyB.id;this.collidingBodiesLastStep.set(r,i,!0)}for(var s=this.contactEquations,o=this.frictionEquations,u=0;u<s.length;u++)this.contactEquationPool.release(s[u]);for(var u=0;u<o.length;u++)this.frictionEquationPool.release(o[u]);this.contactEquations.length=this.frictionEquations.length=0},r.prototype.createContactEquation=function(e,t,n,r){var i=this.contactEquationPool.get();return i.bodyA=e,i.bodyB=t,i.shapeA=n,i.shapeB=r,i.restitution=this.restitution,i.firstImpact=!this.collidedLastStep(e,t),i.stiffness=this.stiffness,i.relaxation=this.relaxation,i.needsUpdate=!0,i.enabled=this.enabledEquations,i.offset=this.contactSkinSize,i},r.prototype.createFrictionEquation=function(e,t,n,r){var i=this.frictionEquationPool.get();return i.bodyA=e,i.bodyB=t,i.shapeA=n,i.shapeB=r,i.setSlipForce(this.slipForce),i.frictionCoefficient=this.frictionCoefficient,i.relativeVelocity=this.surfaceVelocity,i.enabled=this.enabledEquations,i.needsUpdate=!0,i.stiffness=this.frictionStiffness,i.relaxation=this.frictionRelaxation,i.contactEquations.length=0,i},r.prototype.createFrictionFromContact=function(e){var t=this.createFrictionEquation(e.bodyA,e.bodyB,e.shapeA,e.shapeB);return o.copy(t.contactPointA,e.contactPointA),o.copy(t.contactPointB,e.contactPointB),o.rotate90cw(t.t,e.normalA),t.contactEquations.push(e),t},r.prototype.createFrictionFromAverage=function(e){var t=this.contactEquations[this.contactEquations.length-1],n=this.createFrictionEquation(t.bodyA,t.bodyB,t.shapeA,t.shapeB),r=t.bodyA;t.bodyB,o.set(n.contactPointA,0,0),o.set(n.contactPointB,0,0),o.set(n.t,0,0);for(var i=0;i!==e;i++)t=this.contactEquations[this.contactEquations.length-1-i],t.bodyA===r?(o.add(n.t,n.t,t.normalA),o.add(n.contactPointA,n.contactPointA,t.contactPointA),o.add(n.contactPointB,n.contactPointB,t.contactPointB)):(o.sub(n.t,n.t,t.normalA),o.add(n.contactPointA,n.contactPointA,t.contactPointB),o.add(n.contactPointB,n.contactPointB,t.contactPointA)),n.contactEquations.push(t);var s=1/e;return o.scale(n.contactPointA,n.contactPointA,s),o.scale(n.contactPointB,n.contactPointB,s),o.normalize(n.t,n.t),o.rotate90cw(n.t,n.t),n},r.prototype[m.LINE|m.CONVEX]=r.prototype.convexLine=function(e,t,n,r,i,s,o,u,a){return a?!1:0},r.prototype[m.LINE|m.BOX]=r.prototype.lineBox=function(e,t,n,r,i,s,o,u,a){return a?!1:0};var q=new g({width:1,height:1}),R=o.create();r.prototype[m.CAPSULE|m.CONVEX]=r.prototype[m.CAPSULE|m.BOX]=r.prototype.convexCapsule=function(e,t,n,r,s,u,a,f,l){var c=R;o.set(c,u.length/2,0),o.rotate(c,c,f),o.add(c,c,a);var h=this.circleConvex(s,u,c,f,e,t,n,r,l,u.radius);o.set(c,-u.length/2,0),o.rotate(c,c,f),o.add(c,c,a);var p=this.circleConvex(s,u,c,f,e,t,n,r,l,u.radius);if(l&&(h||p))return!0;var d=q;i(d,u);var v=this.convexConvex(e,t,n,r,s,d,a,f,l);return v+h+p},r.prototype[m.CAPSULE|m.LINE]=r.prototype.lineCapsule=function(e,t,n,r,i,s,o,u,a){return a?!1:0};var U=o.create(),z=o.create(),W=new g({width:1,height:1});r.prototype[m.CAPSULE|m.CAPSULE]=r.prototype.capsuleCapsule=function(e,t,n,r,s,u,a,f,l){for(var c,h=U,p=z,d=0,v=0;2>v;v++){o.set(h,(0===v?-1:1)*t.length/2,0),o.rotate(h,h,r),o.add(h,h,n);for(var m=0;2>m;m++){o.set(p,(0===m?-1:1)*u.length/2,0),o.rotate(p,p,f),o.add(p,p,a),this.enableFrictionReduction&&(c=this.enableFriction,this.enableFriction=!1);var g=this.circleCircle(e,t,h,r,s,u,p,f,l,t.radius,u.radius);if(this.enableFrictionReduction&&(this.enableFriction=c),l&&g)return!0;d+=g}}this.enableFrictionReduction&&(c=this.enableFriction,this.enableFriction=!1);var y=W;i(y,t);var b=this.convexCapsule(e,y,n,r,s,u,a,f,l);if(this.enableFrictionReduction&&(this.enableFriction=c),l&&b)return!0;if(d+=b,this.enableFrictionReduction){var c=this.enableFriction;this.enableFriction=!1}i(y,u);var w=this.convexCapsule(s,y,a,f,e,t,n,r,l);return this.enableFrictionReduction&&(this.enableFriction=c),l&&w?!0:(d+=w,this.enableFrictionReduction&&d&&this.enableFriction&&this.frictionEquations.push(this.createFrictionFromAverage(d)),d)},r.prototype[m.LINE|m.LINE]=r.prototype.lineLine=function(e,t,n,r,i,s,o,u,a){return a?!1:0},r.prototype[m.PLANE|m.LINE]=r.prototype.planeLine=function(e,t,n,r,i,s,l,c,h){var p=b,d=w,v=E,m=S,g=x,L=T,A=N,O=C,M=k,_=j,D=0;o.set(p,-s.length/2,0),o.set(d,s.length/2,0),o.rotate(v,p,c),o.rotate(m,d,c),a(v,v,l),a(m,m,l),o.copy(p,v),o.copy(d,m),u(g,d,p),o.normalize(L,g),o.rotate90cw(M,L),o.rotate(O,y,r),_[0]=p,_[1]=d;for(var P=0;P<_.length;P++){var H=_[P];u(A,H,n);var B=f(A,O);if(0>B){if(h)return!0;var F=this.createContactEquation(e,i,t,s);D++,o.copy(F.normalA,O),o.normalize(F.normalA,F.normalA),o.scale(A,O,B),u(F.contactPointA,H,A),u(F.contactPointA,F.contactPointA,e.position),u(F.contactPointB,H,l),a(F.contactPointB,F.contactPointB,l),u(F.contactPointB,F.contactPointB,i.position),this.contactEquations.push(F),this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(F))}}return h?!1:(this.enableFrictionReduction||D&&this.enableFriction&&this.frictionEquations.push(this.createFrictionFromAverage(D)),D)},r.prototype[m.PARTICLE|m.CAPSULE]=r.prototype.particleCapsule=function(e,t,n,r,i,s,o,u,a){return this.circleLine(e,t,n,r,i,s,o,u,a,s.radius,0)},r.prototype[m.CIRCLE|m.LINE]=r.prototype.circleLine=function(e,t,n,r,i,s,l,c,h,p,d){var p=p||0,d="undefined"!=typeof d?d:t.radius,v=b,m=w,g=E,y=S,D=x,P=T,H=N,B=C,F=k,I=L,q=A,R=O,U=M,z=_,W=j;o.set(B,-s.length/2,0),o.set(F,s.length/2,0),o.rotate(I,B,c),o.rotate(q,F,c),a(I,I,l),a(q,q,l),o.copy(B,I),o.copy(F,q),u(P,F,B),o.normalize(H,P),o.rotate90cw(D,H),u(R,n,B);var X=f(R,D);u(y,B,l),u(U,n,l);var V=d+p;if(Math.abs(X)<V){o.scale(v,D,X),u(g,n,v),o.scale(m,D,f(D,U)),o.normalize(m,m),o.scale(m,m,p),a(g,g,m);var $=f(H,g),J=f(H,B),K=f(H,F);if($>J&&K>$){if(h)return!0;var Q=this.createContactEquation(e,i,t,s);return o.scale(Q.normalA,v,-1),o.normalize(Q.normalA,Q.normalA),o.scale(Q.contactPointA,Q.normalA,d),a(Q.contactPointA,Q.contactPointA,n),u(Q.contactPointA,Q.contactPointA,e.position),u(Q.contactPointB,g,l),a(Q.contactPointB,Q.contactPointB,l),u(Q.contactPointB,Q.contactPointB,i.position),this.contactEquations.push(Q),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(Q)),1}}W[0]=B,W[1]=F;for(var G=0;G<W.length;G++){var Y=W[G];if(u(R,Y,n),o.squaredLength(R)<Math.pow(V,2)){if(h)return!0;var Q=this.createContactEquation(e,i,t,s);return o.copy(Q.normalA,R),o.normalize(Q.normalA,Q.normalA),o.scale(Q.contactPointA,Q.normalA,d),a(Q.contactPointA,Q.contactPointA,n),u(Q.contactPointA,Q.contactPointA,e.position),u(Q.contactPointB,Y,l),o.scale(z,Q.normalA,-p),a(Q.contactPointB,Q.contactPointB,z),a(Q.contactPointB,Q.contactPointB,l),u(Q.contactPointB,Q.contactPointB,i.position),this.contactEquations.push(Q),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(Q)),1}}return 0},r.prototype[m.CIRCLE|m.CAPSULE]=r.prototype.circleCapsule=function(e,t,n,r,i,s,o,u,a){return this.circleLine(e,t,n,r,i,s,o,u,a,s.radius)},r.prototype[m.CIRCLE|m.CONVEX]=r.prototype[m.CIRCLE|m.BOX]=r.prototype.circleConvex=function(e,t,n,r,i,f,l,c,h,p){for(var p="number"==typeof p?p:t.radius,d=b,v=w,m=E,g=S,y=x,T=L,N=A,C=M,k=_,O=D,H=P,B=!1,j=Number.MAX_VALUE,F=f.vertices,I=0;I!==F.length+1;I++){var q=F[I%F.length],R=F[(I+1)%F.length];if(o.rotate(d,q,c),o.rotate(v,R,c),a(d,d,l),a(v,v,l),u(m,v,d),o.normalize(g,m),o.rotate90cw(y,g),o.scale(k,y,-t.radius),a(k,k,n),s(k,f,l,c)){o.sub(O,d,k);var U=Math.abs(o.dot(O,y));j>U&&(o.copy(H,k),j=U,o.scale(C,y,U),o.add(C,C,k),B=!0)}}if(B){if(h)return!0;var z=this.createContactEquation(e,i,t,f);return o.sub(z.normalA,H,n),o.normalize(z.normalA,z.normalA),o.scale(z.contactPointA,z.normalA,p),a(z.contactPointA,z.contactPointA,n),u(z.contactPointA,z.contactPointA,e.position),u(z.contactPointB,C,l),a(z.contactPointB,z.contactPointB,l),u(z.contactPointB,z.contactPointB,i.position),this.contactEquations.push(z),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(z)),1}if(p>0)for(var I=0;I<F.length;I++){var W=F[I];if(o.rotate(N,W,c),a(N,N,l),u(T,N,n),o.squaredLength(T)<Math.pow(p,2)){if(h)return!0;var z=this.createContactEquation(e,i,t,f);return o.copy(z.normalA,T),o.normalize(z.normalA,z.normalA),o.scale(z.contactPointA,z.normalA,p),a(z.contactPointA,z.contactPointA,n),u(z.contactPointA,z.contactPointA,e.position),u(z.contactPointB,N,l),a(z.contactPointB,z.contactPointB,l),u(z.contactPointB,z.contactPointB,i.position),this.contactEquations.push(z),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(z)),1}}return 0};var X=o.create(),V=o.create(),$=o.create(),J=o.create();r.prototype[m.PARTICLE|m.CONVEX]=r.prototype[m.PARTICLE|m.BOX]=r.prototype.particleConvex=function(e,t,n,r,i,l,c,h,p){var d=b,v=w,m=E,g=S,y=x,C=T,k=N,A=L,O=M,_=H,D=B,P=Number.MAX_VALUE,j=!1,F=l.vertices;if(!s(n,l,c,h))return 0;if(p)return!0;for(var I=0;I!==F.length+1;I++){var q=F[I%F.length],R=F[(I+1)%F.length];o.rotate(d,q,h),o.rotate(v,R,h),a(d,d,c),a(v,v,c),u(m,v,d),o.normalize(g,m),o.rotate90cw(y,g),u(A,n,d),f(A,y),u(C,d,c),u(k,n,c),o.sub(_,d,n);var U=Math.abs(o.dot(_,y));P>U&&(P=U,o.scale(O,y,U),o.add(O,O,n),o.copy(D,y),j=!0)}if(j){var z=this.createContactEquation(e,i,t,l);return o.scale(z.normalA,D,-1),o.normalize(z.normalA,z.normalA),o.set(z.contactPointA,0,0),a(z.contactPointA,z.contactPointA,n),u(z.contactPointA,z.contactPointA,e.position),u(z.contactPointB,O,c),a(z.contactPointB,z.contactPointB,c),u(z.contactPointB,z.contactPointB,i.position),this.contactEquations.push(z),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(z)),1}return 0},r.prototype[m.CIRCLE]=r.prototype.circleCircle=function(e,t,n,r,i,s,f,l,c,h,p){var d=b,h=h||t.radius,p=p||s.radius;u(d,n,f);var v=h+p;if(o.squaredLength(d)>Math.pow(v,2))return 0;if(c)return!0;var m=this.createContactEquation(e,i,t,s);return u(m.normalA,f,n),o.normalize(m.normalA,m.normalA),o.scale(m.contactPointA,m.normalA,h),o.scale(m.contactPointB,m.normalA,-p),a(m.contactPointA,m.contactPointA,n),u(m.contactPointA,m.contactPointA,e.position),a(m.contactPointB,m.contactPointB,f),u(m.contactPointB,m.contactPointB,i.position),this.contactEquations.push(m),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(m)),1},r.prototype[m.PLANE|m.CONVEX]=r.prototype[m.PLANE|m.BOX]=r.prototype.planeConvex=function(e,t,n,r,i,s,l,c,h){var p=b,d=w,v=E,m=0;o.rotate(d,y,r);for(var g=0;g!==s.vertices.length;g++){var S=s.vertices[g];if(o.rotate(p,S,c),a(p,p,l),u(v,p,n),f(v,d)<=0){if(h)return!0;m++;var x=this.createContactEquation(e,i,t,s);u(v,p,n),o.copy(x.normalA,d);var T=f(v,x.normalA);o.scale(v,x.normalA,T),u(x.contactPointB,p,i.position),u(x.contactPointA,p,v),u(x.contactPointA,x.contactPointA,e.position),this.contactEquations.push(x),this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(x))}}return this.enableFrictionReduction&&this.enableFriction&&m&&this.frictionEquations.push(this.createFrictionFromAverage(m)),m},r.prototype[m.PARTICLE|m.PLANE]=r.prototype.particlePlane=function(e,t,n,r,i,s,a,l,c){var h=b,p=w;l=l||0,u(h,n,a),o.rotate(p,y,l);var d=f(h,p);if(d>0)return 0;if(c)return!0;var v=this.createContactEquation(i,e,s,t);return o.copy(v.normalA,p),o.scale(h,v.normalA,d),u(v.contactPointA,n,h),u(v.contactPointA,v.contactPointA,i.position),u(v.contactPointB,n,e.position),this.contactEquations.push(v),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(v)),1},r.prototype[m.CIRCLE|m.PARTICLE]=r.prototype.circleParticle=function(e,t,n,r,i,s,f,l,c){var h=b;if(u(h,f,n),o.squaredLength(h)>Math.pow(t.radius,2))return 0;if(c)return!0;var p=this.createContactEquation(e,i,t,s);return o.copy(p.normalA,h),o.normalize(p.normalA,p.normalA),o.scale(p.contactPointA,p.normalA,t.radius),a(p.contactPointA,p.contactPointA,n),u(p.contactPointA,p.contactPointA,e.position),u(p.contactPointB,f,i.position),this.contactEquations.push(p),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(p)),1};var K=new d({radius:1}),Q=o.create(),G=o.create();o.create(),r.prototype[m.PLANE|m.CAPSULE]=r.prototype.planeCapsule=function(e,t,n,r,i,s,u,f,l){var c=Q,h=G,p=K;o.set(c,-s.length/2,0),o.rotate(c,c,f),a(c,c,u),o.set(h,s.length/2,0),o.rotate(h,h,f),a(h,h,u),p.radius=s.radius;var d;this.enableFrictionReduction&&(d=this.enableFriction,this.enableFriction=!1);var v=this.circlePlane(i,p,c,0,e,t,n,r,l),m=this.circlePlane(i,p,h,0,e,t,n,r,l);if(this.enableFrictionReduction&&(this.enableFriction=d),l)return v||m;var g=v+m;return this.enableFrictionReduction&&g&&this.frictionEquations.push(this.createFrictionFromAverage(g)),g},r.prototype[m.CIRCLE|m.PLANE]=r.prototype.circlePlane=function(e,t,n,r,i,s,l,c,h){var p=e,d=t,v=n,m=i,g=l,S=c;S=S||0;var x=b,T=w,N=E;u(x,v,g),o.rotate(T,y,S);var C=f(T,x);if(C>d.radius)return 0;if(h)return!0;var k=this.createContactEquation(m,p,s,t);return o.copy(k.normalA,T),o.scale(k.contactPointB,k.normalA,-d.radius),a(k.contactPointB,k.contactPointB,v),u(k.contactPointB,k.contactPointB,p.position),o.scale(N,k.normalA,C),u(k.contactPointA,x,N),a(k.contactPointA,k.contactPointA,g),u(k.contactPointA,k.contactPointA,m.position),this.contactEquations.push(k),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(k)),1},r.prototype[m.CONVEX]=r.prototype[m.CONVEX|m.BOX]=r.prototype[m.BOX]=r.prototype.convexConvex=function(e,t,n,i,s,l,c,h,p,d){var v=b,m=w,g=E,y=S,T=x,L=N,A=C,O=k,M=0,d="number"==typeof d?d:0,_=r.findSeparatingAxis(t,n,i,l,c,h,v);if(!_)return 0;u(A,c,n),f(v,A)>0&&o.scale(v,v,-1);var D=r.getClosestEdge(t,i,v,!0),P=r.getClosestEdge(l,h,v);if(-1===D||-1===P)return 0;for(var H=0;2>H;H++){var B=D,j=P,F=t,I=l,q=n,R=c,U=i,z=h,W=e,X=s;if(0===H){var V;V=B,B=j,j=V,V=F,F=I,I=V,V=q,q=R,R=V,V=U,U=z,z=V,V=W,W=X,X=V}for(var $=j;j+2>$;$++){var J=I.vertices[($+I.vertices.length)%I.vertices.length];o.rotate(m,J,z),a(m,m,R);for(var K=0,Q=B-1;B+2>Q;Q++){var G=F.vertices[(Q+F.vertices.length)%F.vertices.length],Y=F.vertices[(Q+1+F.vertices.length)%F.vertices.length];o.rotate(g,G,U),o.rotate(y,Y,U),a(g,g,q),a(y,y,q),u(T,y,g),o.rotate90cw(O,T),o.normalize(O,O),u(A,m,g);var Z=f(O,A);(Q===B&&d>=Z||Q!==B&&0>=Z)&&K++}if(K>=3){if(p)return!0;var et=this.createContactEquation(W,X,F,I);M++;var G=F.vertices[B%F.vertices.length],Y=F.vertices[(B+1)%F.vertices.length];o.rotate(g,G,U),o.rotate(y,Y,U),a(g,g,q),a(y,y,q),u(T,y,g),o.rotate90cw(et.normalA,T),o.normalize(et.normalA,et.normalA),u(A,m,g);var Z=f(et.normalA,A);o.scale(L,et.normalA,Z),u(et.contactPointA,m,q),u(et.contactPointA,et.contactPointA,L),a(et.contactPointA,et.contactPointA,q),u(et.contactPointA,et.contactPointA,W.position),u(et.contactPointB,m,R),a(et.contactPointB,et.contactPointB,R),u(et.contactPointB,et.contactPointB,X.position),this.contactEquations.push(et),this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(et))}}}return this.enableFrictionReduction&&this.enableFriction&&M&&this.frictionEquations.push(this.createFrictionFromAverage(M)),M};var Y=o.fromValues(0,0);r.projectConvexOntoAxis=function(e,t,n,r,i){var s,u,a=null,l=null,c=Y;o.rotate(c,r,-n);for(var h=0;h<e.vertices.length;h++)s=e.vertices[h],u=f(s,c),(null===a||u>a)&&(a=u),(null===l||l>u)&&(l=u);if(l>a){var p=l;l=a,a=p}var d=f(t,r);o.set(i,l+d,a+d)};var Z=o.fromValues(0,0),et=o.fromValues(0,0),tt=o.fromValues(0,0),nt=o.fromValues(0,0),rt=o.fromValues(0,0),it=o.fromValues(0,0);r.findSeparatingAxis=function(e,t,n,i,s,a,f){var l=null,c=!1,h=!1,p=Z,d=et,v=tt,m=nt,y=rt,b=it;if(e instanceof g&&i instanceof g)for(var w=0;2!==w;w++){var E=e,S=n;1===w&&(E=i,S=a);for(var x=0;2!==x;x++){0===x?o.set(m,0,1):1===x&&o.set(m,1,0),0!==S&&o.rotate(m,m,S),r.projectConvexOntoAxis(e,t,n,m,y),r.projectConvexOntoAxis(i,s,a,m,b);var T=y,N=b,C=!1;y[0]>b[0]&&(N=y,T=b,C=!0);var k=N[0]-T[1];c=0>=k,(null===l||k>l)&&(o.copy(f,m),l=k,h=c)}}else for(var w=0;2!==w;w++){var E=e,S=n;1===w&&(E=i,S=a);for(var x=0;x!==E.vertices.length;x++){o.rotate(d,E.vertices[x],S),o.rotate(v,E.vertices[(x+1)%E.vertices.length],S),u(p,v,d),o.rotate90cw(m,p),o.normalize(m,m),r.projectConvexOntoAxis(e,t,n,m,y),r.projectConvexOntoAxis(i,s,a,m,b);var T=y,N=b,C=!1;y[0]>b[0]&&(N=y,T=b,C=!0);var k=N[0]-T[1];c=0>=k,(null===l||k>l)&&(o.copy(f,m),l=k,h=c)}}return h};var st=o.fromValues(0,0),ot=o.fromValues(0,0),ut=o.fromValues(0,0);r.getClosestEdge=function(e,t,n,r){var i=st,s=ot,a=ut;o.rotate(i,n,-t),r&&o.scale(i,i,-1);for(var l=-1,c=e.vertices.length,h=-1,p=0;p!==c;p++){u(s,e.vertices[(p+1)%c],e.vertices[p%c]),o.rotate90cw(a,s),o.normalize(a,a);var d=f(a,i);(-1===l||d>h)&&(l=p%c,h=d)}return l};var at=o.create(),ft=o.create(),lt=o.create(),ct=o.create(),ht=o.create(),pt=o.create(),dt=o.create();r.prototype[m.CIRCLE|m.HEIGHTFIELD]=r.prototype.circleHeightfield=function(e,t,n,r,i,s,f,l,c,h){var p=s.heights,h=h||t.radius,d=s.elementWidth,v=ft,m=at,g=ht,y=dt,b=pt,w=lt,E=ct,S=Math.floor((n[0]-h-f[0])/d),x=Math.ceil((n[0]+h-f[0])/d);0>S&&(S=0),x>=p.length&&(x=p.length-1);for(var T=p[S],N=p[x],C=S;x>C;C++)p[C]<N&&(N=p[C]),p[C]>T&&(T=p[C]);if(n[1]-h>T)return c?!1:0;for(var k=!1,C=S;x>C;C++){o.set(w,C*d,p[C]),o.set(E,(C+1)*d,p[C+1]),o.add(w,w,f),o.add(E,E,f),o.sub(b,E,w),o.rotate(b,b,Math.PI/2),o.normalize(b,b),o.scale(m,b,-h),o.add(m,m,n),o.sub(v,m,w);var L=o.dot(v,b);if(m[0]>=w[0]&&m[0]<E[0]&&0>=L){if(c)return!0;k=!0,o.scale(v,b,-L),o.add(g,m,v),o.copy(y,b);var A=this.createContactEquation(i,e,s,t);o.copy(A.normalA,y),o.scale(A.contactPointB,A.normalA,-h),a(A.contactPointB,A.contactPointB,n),u(A.contactPointB,A.contactPointB,e.position),o.copy(A.contactPointA,g),o.sub(A.contactPointA,A.contactPointA,i.position),this.contactEquations.push(A),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(A))}}if(k=!1,h>0)for(var C=S;x>=C;C++)if(o.set(w,C*d,p[C]),o.add(w,w,f),o.sub(v,n,w),o.squaredLength(v)<Math.pow(h,2)){if(c)return!0;k=!0;var A=this.createContactEquation(i,e,s,t);o.copy(A.normalA,v),o.normalize(A.normalA,A.normalA),o.scale(A.contactPointB,A.normalA,-h),a(A.contactPointB,A.contactPointB,n),u(A.contactPointB,A.contactPointB,e.position),u(A.contactPointA,w,f),a(A.contactPointA,A.contactPointA,f),u(A.contactPointA,A.contactPointA,i.position),this.contactEquations.push(A),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(A))}return k?1:0};var vt=o.create(),mt=o.create(),gt=o.create(),yt=new v({vertices:[o.create(),o.create(),o.create(),o.create()]});r.prototype[m.BOX|m.HEIGHTFIELD]=r.prototype[m.CONVEX|m.HEIGHTFIELD]=r.prototype.convexHeightfield=function(e,t,n,r,i,s,u,a,f){var l=s.heights,c=s.elementWidth,h=vt,p=mt,d=gt,v=yt,m=Math.floor((e.aabb.lowerBound[0]-u[0])/c),g=Math.ceil((e.aabb.upperBound[0]-u[0])/c);0>m&&(m=0),g>=l.length&&(g=l.length-1);for(var y=l[m],b=l[g],w=m;g>w;w++)l[w]<b&&(b=l[w]),l[w]>y&&(y=l[w]);if(e.aabb.lowerBound[1]>y)return f?!1:0;for(var E=0,w=m;g>w;w++){o.set(h,w*c,l[w]),o.set(p,(w+1)*c,l[w+1]),o.add(h,h,u),o.add(p,p,u);var S=100;o.set(d,.5*(p[0]+h[0]),.5*(p[1]+h[1]-S)),o.sub(v.vertices[0],p,d),o.sub(v.vertices[1],h,d),o.copy(v.vertices[2],v.vertices[1]),o.copy(v.vertices[3],v.vertices[0]),v.vertices[2][1]-=S,v.vertices[3][1]-=S,E+=this.convexConvex(e,t,n,r,i,v,d,0,f)}return E}},{"../equations/ContactEquation":21,"../equations/Equation":22,"../equations/FrictionEquation":23,"../math/vec2":30,"../objects/Body":31,"../shapes/Box":37,"../shapes/Circle":39,"../shapes/Convex":40,"../shapes/Shape":45,"../utils/ContactEquationPool":48,"../utils/FrictionEquationPool":49,"../utils/TupleDictionary":56,"../utils/Utils":57}],11:[function(e,t,n){function r(e){e=e||{},this.from=e.from?s.fromValues(e.from[0],e.from[1]):s.create(),this.to=e.to?s.fromValues(e.to[0],e.to[1]):s.create(),this.checkCollisionResponse=void 0!==e.checkCollisionResponse?e.checkCollisionResponse:!0,this.skipBackfaces=!!e.skipBackfaces,this.collisionMask=void 0!==e.collisionMask?e.collisionMask:-1,this.collisionGroup=void 0!==e.collisionGroup?e.collisionGroup:-1,this.mode=void 0!==e.mode?e.mode:r.ANY,this.callback=e.callback||function(e){},this.direction=s.create(),this.length=1,this.update()}function i(e,t,n){s.sub(u,n,e);var r=s.dot(u,t);return s.scale(a,t,r),s.add(a,a,e),s.squaredDistance(n,a)}t.exports=r;var s=e("../math/vec2");e("../collision/RaycastResult"),e("../shapes/Shape"),e("../collision/AABB"),r.prototype.constructor=r,r.CLOSEST=1,r.ANY=2,r.ALL=4,r.prototype.update=function(){var e=this.direction;s.sub(e,this.to,this.from),this.length=s.length(e),s.normalize(e,e)},r.prototype.intersectBodies=function(e,t){for(var n=0,r=t.length;!e.shouldStop(this)&&r>n;n++){var i=t[n],s=i.getAABB();(s.overlapsRay(this)>=0||s.containsPoint(this.from))&&this.intersectBody(e,i)}};var o=s.create();r.prototype.intersectBody=function(e,t){var n=this.checkCollisionResponse;if(!n||t.collisionResponse)for(var r=o,i=0,u=t.shapes.length;u>i;i++){var a=t.shapes[i];if((!n||a.collisionResponse)&&0!==(this.collisionGroup&a.collisionMask)&&0!==(a.collisionGroup&this.collisionMask)){s.rotate(r,a.position,t.angle),s.add(r,r,t.position);var l=a.angle+t.angle;if(this.intersectShape(e,a,l,r,t),e.shouldStop(this))break}}},r.prototype.intersectShape=function(e,t,n,r,s){var o=this.from,u=i(o,this.direction,r);u>t.boundingRadius*t.boundingRadius||(this._currentBody=s,this._currentShape=t,t.raycast(e,this,r,n),this._currentBody=this._currentShape=null)},r.prototype.getAABB=function(e){var t=this.to,n=this.from;s.set(e.lowerBound,Math.min(t[0],n[0]),Math.min(t[1],n[1])),s.set(e.upperBound,Math.max(t[0],n[0]),Math.max(t[1],n[1]))},s.create(),r.prototype.reportIntersection=function(e,t,n,i){var o=(this.from,this.to,this._currentShape),u=this._currentBody;if(!(this.skipBackfaces&&s.dot(n,this.direction)>0))switch(this.mode){case r.ALL:e.set(n,o,u,t,i),this.callback(e);break;case r.CLOSEST:(t<e.fraction||!e.hasHit())&&e.set(n,o,u,t,i);break;case r.ANY:e.set(n,o,u,t,i)}};var u=s.create(),a=s.create()},{"../collision/AABB":7,"../collision/RaycastResult":12,"../math/vec2":30,"../shapes/Shape":45}],12:[function(e,t,n){function r(){this.normal=i.create(),this.shape=null,this.body=null,this.faceIndex=-1,this.fraction=-1,this.isStopped=!1}var i=e("../math/vec2"),s=e("../collision/Ray");t.exports=r,r.prototype.reset=function(){i.set(this.normal,0,0),this.shape=null,this.body=null,this.faceIndex=-1,this.fraction=-1,this.isStopped=!1},r.prototype.getHitDistance=function(e){return i.distance(e.from,e.to)*this.fraction},r.prototype.hasHit=function(){return-1!==this.fraction},r.prototype.getHitPoint=function(e,t){i.lerp(e,t.from,t.to,this.fraction)},r.prototype.stop=function(){this.isStopped=!0},r.prototype.shouldStop=function(e){return this.isStopped||-1!==this.fraction&&e.mode===s.ANY},r.prototype.set=function(e,t,n,r,s){i.copy(this.normal,e),this.shape=t,this.body=n,this.fraction=r,this.faceIndex=s}},{"../collision/Ray":11,"../math/vec2":30}],13:[function(e,t,n){function r(){s.call(this,s.SAP),this.axisList=[],this.axisIndex=0;var e=this;this._addBodyHandler=function(t){e.axisList.push(t.body)},this._removeBodyHandler=function(t){var n=e.axisList.indexOf(t.body);-1!==n&&e.axisList.splice(n,1)}}var i=e("../utils/Utils"),s=e("../collision/Broadphase");t.exports=r,r.prototype=new s,r.prototype.constructor=r,r.prototype.setWorld=function(e){this.axisList.length=0,i.appendArray(this.axisList,e.bodies),e.off("addBody",this._addBodyHandler).off("removeBody",this._removeBodyHandler),e.on("addBody",this._addBodyHandler).on("removeBody",this._removeBodyHandler),this.world=e},r.sortAxisList=function(e,t){t=0|t;for(var n=1,r=e.length;r>n;n++){for(var i=e[n],s=n-1;s>=0&&!(e[s].aabb.lowerBound[t]<=i.aabb.lowerBound[t]);s--)e[s+1]=e[s];e[s+1]=i}return e},r.prototype.sortList=function(){var e=this.axisList,t=this.axisIndex;r.sortAxisList(e,t)},r.prototype.getCollisionPairs=function(e){var t=this.axisList,n=this.result,r=this.axisIndex;n.length=0;for(var i=t.length;i--;){var o=t[i];o.aabbNeedsUpdate&&o.updateAABB()}this.sortList();for(var u=0,a=0|t.length;u!==a;u++)for(var l=t[u],c=u+1;a>c;c++){var h=t[c],p=h.aabb.lowerBound[r]<=l.aabb.upperBound[r];if(!p)break;s.canCollide(l,h)&&this.boundingVolumeCheck(l,h)&&n.push(l,h)}return n},r.prototype.aabbQuery=function(e,t,n){n=n||[],this.sortList();var r=this.axisIndex,i="x";1===r&&(i="y"),2===r&&(i="z");for(var s=this.axisList,o=(t.lowerBound[i],t.upperBound[i],0);o<s.length;o++){var u=s[o];u.aabbNeedsUpdate&&u.updateAABB(),u.aabb.overlaps(t)&&n.push(u)}return n}},{"../collision/Broadphase":8,"../utils/Utils":57}],14:[function(e,t,n){function r(e,t,n,r){this.type=n,r=i.defaults(r,{collideConnected:!0,wakeUpBodies:!0}),this.equations=[],this.bodyA=e,this.bodyB=t,this.collideConnected=r.collideConnected,r.wakeUpBodies&&(e&&e.wakeUp(),t&&t.wakeUp())}t.exports=r;var i=e("../utils/Utils");r.prototype.update=function(){throw new Error("method update() not implmemented in this Constraint subclass!")},r.DISTANCE=1,r.GEAR=2,r.LOCK=3,r.PRISMATIC=4,r.REVOLUTE=5,r.prototype.setStiffness=function(e){for(var t=this.equations,n=0;n!==t.length;n++){var r=t[n];r.stiffness=e,r.needsUpdate=!0}},r.prototype.setRelaxation=function(e){for(var t=this.equations,n=0;n!==t.length;n++){var r=t[n];r.relaxation=e,r.needsUpdate=!0}}},{"../utils/Utils":57}],15:[function(e,t,n){function r(e,t,n){n=u.defaults(n,{localAnchorA:[0,0],localAnchorB:[0,0]}),i.call(this,e,t,i.DISTANCE,n),this.localAnchorA=o.fromValues(n.localAnchorA[0],n.localAnchorA[1]),this.localAnchorB=o.fromValues(n.localAnchorB[0],n.localAnchorB[1]);var r=this.localAnchorA,a=this.localAnchorB;if(this.distance=0,"number"==typeof n.distance)this.distance=n.distance;else{var f=o.create(),l=o.create(),c=o.create();o.rotate(f,r,e.angle),o.rotate(l,a,t.angle),o.add(c,t.position,l),o.sub(c,c,f),o.sub(c,c,e.position),this.distance=o.length(c)}var p;p="undefined"==typeof n.maxForce?Number.MAX_VALUE:n.maxForce;var d=new s(e,t,-p,p);this.equations=[d],this.maxForce=p;var c=o.create(),v=o.create(),m=o.create(),y=this;d.computeGq=function(){var e=this.bodyA,t=this.bodyB,n=e.position,i=t.position;return o.rotate(v,r,e.angle),o.rotate(m,a,t.angle),o.add(c,i,m),o.sub(c,c,v),o.sub(c,c,n),o.length(c)-y.distance},this.setMaxForce(p),this.upperLimitEnabled=!1,this.upperLimit=1,this.lowerLimitEnabled=!1,this.lowerLimit=0,this.position=0}var i=e("./Constraint"),s=e("../equations/Equation"),o=e("../math/vec2"),u=e("../utils/Utils");t.exports=r,r.prototype=new i,r.prototype.constructor=r;var a=o.create(),f=o.create(),l=o.create();r.prototype.update=function(){var e=this.equations[0],t=this.bodyA,n=this.bodyB,r=(this.distance,t.position),i=n.position,s=this.equations[0],u=e.G;o.rotate(f,this.localAnchorA,t.angle),o.rotate(l,this.localAnchorB,n.angle),o.add(a,i,l),o.sub(a,a,f),o.sub(a,a,r),this.position=o.length(a);var c=!1;if(this.upperLimitEnabled&&this.position>this.upperLimit&&(s.maxForce=0,s.minForce=-this.maxForce,this.distance=this.upperLimit,c=!0),this.lowerLimitEnabled&&this.position<this.lowerLimit&&(s.maxForce=this.maxForce,s.minForce=0,this.distance=this.lowerLimit,c=!0),(this.lowerLimitEnabled||this.upperLimitEnabled)&&!c)return void (s.enabled=!1);s.enabled=!0,o.normalize(a,a);var h=o.crossLength(f,a),p=o.crossLength(l,a);u[0]=-a[0],u[1]=-a[1],u[2]=-h,u[3]=a[0],u[4]=a[1],u[5]=p},r.prototype.setMaxForce=function(e){var t=this.equations[0];t.minForce=-e,t.maxForce=e},r.prototype.getMaxForce=function(){var e=this.equations[0];return e.maxForce}},{"../equations/Equation":22,"../math/vec2":30,"../utils/Utils":57,"./Constraint":14}],16:[function(e,t,n){function r(e,t,n){n=n||{},i.call(this,e,t,i.GEAR,n),this.ratio=void 0!==n.ratio?n.ratio:1,this.angle=void 0!==n.angle?n.angle:t.angle-this.ratio*e.angle,n.angle=this.angle,n.ratio=this.ratio,this.equations=[new s(e,t,n)],void 0!==n.maxTorque&&this.setMaxTorque(n.maxTorque)}var i=e("./Constraint"),s=(e("../equations/Equation"),e("../equations/AngleLockEquation"));e("../math/vec2"),t.exports=r,r.prototype=new i,r.prototype.constructor=r,r.prototype.update=function(){var e=this.equations[0];e.ratio!==this.ratio&&e.setRatio(this.ratio),e.angle=this.angle},r.prototype.setMaxTorque=function(e){this.equations[0].setMaxTorque(e)},r.prototype.getMaxTorque=function(e){return this.equations[0].maxForce}},{"../equations/AngleLockEquation":20,"../equations/Equation":22,"../math/vec2":30,"./Constraint":14}],17:[function(e,t,n){function r(e,t,n){n=n||{},i.call(this,e,t,i.LOCK,n);var r="undefined"==typeof n.maxForce?Number.MAX_VALUE:n.maxForce,u=(n.localAngleB||0,new o(e,t,-r,r)),a=new o(e,t,-r,r),f=new o(e,t,-r,r),l=s.create(),c=s.create(),h=this;u.computeGq=function(){return s.rotate(l,h.localOffsetB,e.angle),s.sub(c,t.position,e.position),s.sub(c,c,l),c[0]},a.computeGq=function(){return s.rotate(l,h.localOffsetB,e.angle),s.sub(c,t.position,e.position),s.sub(c,c,l),c[1]};var p=s.create(),d=s.create();f.computeGq=function(){return s.rotate(p,h.localOffsetB,t.angle-h.localAngleB),s.scale(p,p,-1),s.sub(c,e.position,t.position),s.add(c,c,p),s.rotate(d,p,-Math.PI/2),s.normalize(d,d),s.dot(c,d)},this.localOffsetB=s.create(),n.localOffsetB?s.copy(this.localOffsetB,n.localOffsetB):(s.sub(this.localOffsetB,t.position,e.position),s.rotate(this.localOffsetB,this.localOffsetB,-e.angle)),this.localAngleB=0,"number"==typeof n.localAngleB?this.localAngleB=n.localAngleB:this.localAngleB=t.angle-e.angle,this.equations.push(u,a,f),this.setMaxForce(r)}var i=e("./Constraint"),s=e("../math/vec2"),o=e("../equations/Equation");t.exports=r,r.prototype=new i,r.prototype.constructor=r,r.prototype.setMaxForce=function(e){for(var t=this.equations,n=0;n<this.equations.length;n++)t[n].maxForce=e,t[n].minForce=-e},r.prototype.getMaxForce=function(){return this.equations[0].maxForce};var u=s.create(),a=s.create(),f=s.create(),l=s.fromValues(1,0),c=s.fromValues(0,1);r.prototype.update=function(){var e=this.equations[0],t=this.equations[1],n=this.equations[2],r=this.bodyA,i=this.bodyB;s.rotate(u,this.localOffsetB,r.angle),s.rotate(a,this.localOffsetB,i.angle-this.localAngleB),s.scale(a,a,-1),s.rotate(f,a,Math.PI/2),s.normalize(f,f),e.G[0]=-1,e.G[1]=0,e.G[2]=-s.crossLength(u,l),e.G[3]=1,t.G[0]=0,t.G[1]=-1,t.G[2]=-s.crossLength(u,c),t.G[4]=1,n.G[0]=-f[0],n.G[1]=-f[1],n.G[3]=f[0],n.G[4]=f[1],n.G[5]=s.crossLength(a,f)}},{"../equations/Equation":22,"../math/vec2":30,"./Constraint":14}],18:[function(e,t,n){function r(e,t,n){n=n||{},i.call(this,e,t,i.PRISMATIC,n);var r=u.fromValues(0,0),f=u.fromValues(1,0),l=u.fromValues(0,0);n.localAnchorA&&u.copy(r,n.localAnchorA),n.localAxisA&&u.copy(f,n.localAxisA),n.localAnchorB&&u.copy(l,n.localAnchorB),this.localAnchorA=r,this.localAnchorB=l,this.localAxisA=f;var c=this.maxForce="undefined"!=typeof n.maxForce?n.maxForce:Number.MAX_VALUE,h=new o(e,t,-c,c),p=new u.create,d=new u.create,v=new u.create,m=new u.create;if(h.computeGq=function(){return u.dot(v,m)},h.updateJacobian=function(){var n=this.G,i=e.position,s=t.position;u.rotate(p,r,e.angle),u.rotate(d,l,t.angle),u.add(v,s,d),u.sub(v,v,i),u.sub(v,v,p),u.rotate(m,f,e.angle+Math.PI/2),n[0]=-m[0],n[1]=-m[1],n[2]=-u.crossLength(p,m)+u.crossLength(m,v),n[3]=m[0],n[4]=m[1],n[5]=u.crossLength(d,m)},this.equations.push(h),!n.disableRotationalLock){var y=new a(e,t,-c,c);this.equations.push(y)}this.position=0,this.velocity=0,this.lowerLimitEnabled="undefined"!=typeof n.lowerLimit?!0:!1,this.upperLimitEnabled="undefined"!=typeof n.upperLimit?!0:!1,this.lowerLimit="undefined"!=typeof n.lowerLimit?n.lowerLimit:0,this.upperLimit="undefined"!=typeof n.upperLimit?n.upperLimit:1,this.upperLimitEquation=new s(e,t),this.lowerLimitEquation=new s(e,t),this.upperLimitEquation.minForce=this.lowerLimitEquation.minForce=0,this.upperLimitEquation.maxForce=this.lowerLimitEquation.maxForce=c,this.motorEquation=new o(e,t),this.motorEnabled=!1,this.motorSpeed=0;var b=this,w=this.motorEquation;w.computeGW,w.computeGq=function(){return 0},w.computeGW=function(){var e=this.G,t=this.bodyA,n=this.bodyB,r=t.velocity,i=n.velocity,s=t.angularVelocity,o=n.angularVelocity;return this.gmult(e,r,s,i,o)+b.motorSpeed}}var i=e("./Constraint"),s=e("../equations/ContactEquation"),o=e("../equations/Equation"),u=e("../math/vec2"),a=e("../equations/RotationalLockEquation");t.exports=r,r.prototype=new i,r.prototype.constructor=r;var f=u.create(),l=u.create(),c=u.create(),h=u.create(),p=u.create(),d=u.create();r.prototype.update=function(){var e=this.equations,t=e[0],n=this.upperLimit,r=this.lowerLimit,i=this.upperLimitEquation,s=this.lowerLimitEquation,o=this.bodyA,a=this.bodyB,v=this.localAxisA,g=this.localAnchorA,y=this.localAnchorB;t.updateJacobian(),u.rotate(f,v,o.angle),u.rotate(h,g,o.angle),u.add(l,h,o.position),u.rotate(p,y,a.angle),u.add(c,p,a.position);var b=this.position=u.dot(c,f)-u.dot(l,f);if(this.motorEnabled){var w=this.motorEquation.G;w[0]=f[0],w[1]=f[1],w[2]=u.crossLength(f,p),w[3]=-f[0],w[4]=-f[1],w[5]=-u.crossLength(f,h)}if(this.upperLimitEnabled&&b>n)u.scale(i.normalA,f,-1),u.sub(i.contactPointA,l,o.position),u.sub(i.contactPointB,c,a.position),u.scale(d,f,n),u.add(i.contactPointA,i.contactPointA,d),-1===e.indexOf(i)&&e.push(i);else{var E=e.indexOf(i);-1!==E&&e.splice(E,1)}if(this.lowerLimitEnabled&&r>b)u.scale(s.normalA,f,1),u.sub(s.contactPointA,l,o.position),u.sub(s.contactPointB,c,a.position),u.scale(d,f,r),u.sub(s.contactPointB,s.contactPointB,d),-1===e.indexOf(s)&&e.push(s);else{var E=e.indexOf(s);-1!==E&&e.splice(E,1)}},r.prototype.enableMotor=function(){this.motorEnabled||(this.equations.push(this.motorEquation),this.motorEnabled=!0)},r.prototype.disableMotor=function(){if(this.motorEnabled){var e=this.equations.indexOf(this.motorEquation);this.equations.splice(e,1),this.motorEnabled=!1}},r.prototype.setLimits=function(e,t){"number"==typeof e?(this.lowerLimit=e,this.lowerLimitEnabled=!0):(this.lowerLimit=e,this.lowerLimitEnabled=!1),"number"==typeof t?(this.upperLimit=t,this.upperLimitEnabled=!0):(this.upperLimit=t,this.upperLimitEnabled=!1)}},{"../equations/ContactEquation":21,"../equations/Equation":22,"../equations/RotationalLockEquation":24,"../math/vec2":30,"./Constraint":14}],19:[function(e,t,n){function r(e,t,n){n=n||{},i.call(this,e,t,i.REVOLUTE,n);var r=this.maxForce="undefined"!=typeof n.maxForce?n.maxForce:Number.MAX_VALUE;this.pivotA=a.create(),this.pivotB=a.create(),n.worldPivot?(a.sub(this.pivotA,n.worldPivot,e.position),a.sub(this.pivotB,n.worldPivot,t.position),a.rotate(this.pivotA,this.pivotA,-e.angle),a.rotate(this.pivotB,this.pivotB,-t.angle)):(a.copy(this.pivotA,n.localPivotA),a.copy(this.pivotB,n.localPivotB));var d=this.equations=[new s(e,t,-r,r),new s(e,t,-r,r)],v=d[0],y=d[1],b=this;v.computeGq=function(){return a.rotate(f,b.pivotA,e.angle),a.rotate(l,b.pivotB,t.angle),a.add(p,t.position,l),a.sub(p,p,e.position),a.sub(p,p,f),a.dot(p,c)},y.computeGq=function(){return a.rotate(f,b.pivotA,e.angle),a.rotate(l,b.pivotB,t.angle),a.add(p,t.position,l),a.sub(p,p,e.position),a.sub(p,p,f),a.dot(p,h)},y.minForce=v.minForce=-r,y.maxForce=v.maxForce=r,this.motorEquation=new o(e,t),this.motorEnabled=!1,this.angle=0,this.lowerLimitEnabled=!1,this.upperLimitEnabled=!1,this.lowerLimit=0,this.upperLimit=0,this.upperLimitEquation=new u(e,t),this.lowerLimitEquation=new u(e,t),this.upperLimitEquation.minForce=0,this.lowerLimitEquation.maxForce=0}var i=e("./Constraint"),s=e("../equations/Equation"),o=e("../equations/RotationalVelocityEquation"),u=e("../equations/RotationalLockEquation"),a=e("../math/vec2");t.exports=r;var f=a.create(),l=a.create(),c=a.fromValues(1,0),h=a.fromValues(0,1),p=a.create();r.prototype=new i,r.prototype.constructor=r,r.prototype.setLimits=function(e,t){"number"==typeof e?(this.lowerLimit=e,this.lowerLimitEnabled=!0):(this.lowerLimit=e,this.lowerLimitEnabled=!1),"number"==typeof t?(this.upperLimit=t,this.upperLimitEnabled=!0):(this.upperLimit=t,this.upperLimitEnabled=!1)},r.prototype.update=function(){var e=this.bodyA,t=this.bodyB,n=this.pivotA,r=this.pivotB,i=this.equations,s=(i[0],i[1],i[0]),o=i[1],u=this.upperLimit,p=this.lowerLimit,d=this.upperLimitEquation,v=this.lowerLimitEquation,g=this.angle=t.angle-e.angle;if(this.upperLimitEnabled&&g>u)d.angle=u,-1===i.indexOf(d)&&i.push(d);else{var y=i.indexOf(d);-1!==y&&i.splice(y,1)}if(this.lowerLimitEnabled&&p>g)v.angle=p,-1===i.indexOf(v)&&i.push(v);else{var y=i.indexOf(v);-1!==y&&i.splice(y,1)}a.rotate(f,n,e.angle),a.rotate(l,r,t.angle),s.G[0]=-1,s.G[1]=0,s.G[2]=-a.crossLength(f,c),s.G[3]=1,s.G[4]=0,s.G[5]=a.crossLength(l,c),o.G[0]=0,o.G[1]=-1,o.G[2]=-a.crossLength(f,h),o.G[3]=0,o.G[4]=1,o.G[5]=a.crossLength(l,h)},r.prototype.enableMotor=function(){this.motorEnabled||(this.equations.push(this.motorEquation),this.motorEnabled=!0)},r.prototype.disableMotor=function(){if(this.motorEnabled){var e=this.equations.indexOf(this.motorEquation);this.equations.splice(e,1),this.motorEnabled=!1}},r.prototype.motorIsEnabled=function(){return!!this.motorEnabled},r.prototype.setMotorSpeed=function(e){if(this.motorEnabled){var t=this.equations.indexOf(this.motorEquation);this.equations[t].relativeVelocity=e}},r.prototype.getMotorSpeed=function(){return this.motorEnabled?this.motorEquation.relativeVelocity:!1}},{"../equations/Equation":22,"../equations/RotationalLockEquation":24,"../equations/RotationalVelocityEquation":25,"../math/vec2":30,"./Constraint":14}],20:[function(e,t,n){function r(e,t,n){n=n||{},i.call(this,e,t,-Number.MAX_VALUE,Number.MAX_VALUE),this.angle=n.angle||0,this.ratio="number"==typeof n.ratio?n.ratio:1,this.setRatio(this.ratio)}var i=e("./Equation");e("../math/vec2"),t.exports=r,r.prototype=new i,r.prototype.constructor=r,r.prototype.computeGq=function(){return this.ratio*this.bodyA.angle-this.bodyB.angle+this.angle},r.prototype.setRatio=function(e){var t=this.G;t[2]=e,t[5]=-1,this.ratio=e},r.prototype.setMaxTorque=function(e){this.maxForce=e,this.minForce=-e}},{"../math/vec2":30,"./Equation":22}],21:[function(e,t,n){function r(e,t){i.call(this,e,t,0,Number.MAX_VALUE),this.contactPointA=s.create(),this.penetrationVec=s.create(),this.contactPointB=s.create(),this.normalA=s.create(),this.restitution=0,this.firstImpact=!1,this.shapeA=null,this.shapeB=null}var i=e("./Equation"),s=e("../math/vec2");t.exports=r,r.prototype=new i,r.prototype.constructor=r,r.prototype.computeB=function(e,t,n){var r=this.bodyA,i=this.bodyB,o=this.contactPointA,u=this.contactPointB,a=r.position,l=i.position,c=this.penetrationVec,h=this.normalA,p=this.G,d=s.crossLength(o,h),v=s.crossLength(u,h);p[0]=-h[0],p[1]=-h[1],p[2]=-d,p[3]=h[0],p[4]=h[1],p[5]=v,s.add(c,l,u),s.sub(c,c,a),s.sub(c,c,o);var m,g;this.firstImpact&&0!==this.restitution?(g=0,m=1/t*(1+this.restitution)*this.computeGW()):(g=s.dot(h,c)+this.offset,m=this.computeGW());var y=this.computeGiMf(),b=-g*e-m*t-n*y;return b}},{"../math/vec2":30,"./Equation":22}],22:[function(e,t,n){function r(e,t,n,i){this.minForce="undefined"==typeof n?-Number.MAX_VALUE:n,this.maxForce="undefined"==typeof i?Number.MAX_VALUE:i,this.bodyA=e,this.bodyB=t,this.stiffness=r.DEFAULT_STIFFNESS,this.relaxation=r.DEFAULT_RELAXATION,this.G=new s.ARRAY_TYPE(6);for(var o=0;6>o;o++)this.G[o]=0;this.offset=0,this.a=0,this.b=0,this.epsilon=0,this.timeStep=1/60,this.needsUpdate=!0,this.multiplier=0,this.relativeVelocity=0,this.enabled=!0}t.exports=r;var i=e("../math/vec2"),s=e("../utils/Utils");e("../objects/Body"),r.prototype.constructor=r,r.DEFAULT_STIFFNESS=1e6,r.DEFAULT_RELAXATION=4,r.prototype.update=function(){var e=this.stiffness,t=this.relaxation,n=this.timeStep;this.a=4/(n*(1+4*t)),this.b=4*t/(1+4*t),this.epsilon=4/(n*n*e*(1+4*t)),this.needsUpdate=!1},r.prototype.gmult=function(e,t,n,r,i){return e[0]*t[0]+e[1]*t[1]+e[2]*n+e[3]*r[0]+e[4]*r[1]+e[5]*i},r.prototype.computeB=function(e,t,n){var r=this.computeGW(),i=this.computeGq(),s=this.computeGiMf();return-i*e-r*t-s*n};var o=i.create(),u=i.create();r.prototype.computeGq=function(){var e=this.G,t=this.bodyA,n=this.bodyB,r=(t.position,n.position,t.angle),i=n.angle;return this.gmult(e,o,r,u,i)+this.offset},r.prototype.computeGW=function(){var e=this.G,t=this.bodyA,n=this.bodyB,r=t.velocity,i=n.velocity,s=t.angularVelocity,o=n.angularVelocity;return this.gmult(e,r,s,i,o)+this.relativeVelocity},r.prototype.computeGWlambda=function(){var e=this.G,t=this.bodyA,n=this.bodyB,r=t.vlambda,i=n.vlambda,s=t.wlambda,o=n.wlambda;return this.gmult(e,r,s,i,o)};var a=i.create(),f=i.create();r.prototype.computeGiMf=function(){var e=this.bodyA,t=this.bodyB,n=e.force,r=e.angularForce,s=t.force,o=t.angularForce,u=e.invMassSolve,l=t.invMassSolve,c=e.invInertiaSolve,h=t.invInertiaSolve,p=this.G;return i.scale(a,n,u),i.multiply(a,e.massMultiplier,a),i.scale(f,s,l),i.multiply(f,t.massMultiplier,f),this.gmult(p,a,r*c,f,o*h)},r.prototype.computeGiMGt=function(){var e=this.bodyA,t=this.bodyB,n=e.invMassSolve,r=t.invMassSolve,i=e.invInertiaSolve,s=t.invInertiaSolve,o=this.G;return o[0]*o[0]*n*e.massMultiplier[0]+o[1]*o[1]*n*e.massMultiplier[1]+o[2]*o[2]*i+o[3]*o[3]*r*t.massMultiplier[0]+o[4]*o[4]*r*t.massMultiplier[1]+o[5]*o[5]*s};var l=i.create(),c=i.create(),h=i.create();i.create(),i.create(),i.create(),r.prototype.addToWlambda=function(e){var t=this.bodyA,n=this.bodyB,r=l,s=c,o=h,u=t.invMassSolve,a=n.invMassSolve,f=t.invInertiaSolve,p=n.invInertiaSolve,d=this.G;s[0]=d[0],s[1]=d[1],o[0]=d[3],o[1]=d[4],i.scale(r,s,u*e),i.multiply(r,r,t.massMultiplier),i.add(t.vlambda,t.vlambda,r),t.wlambda+=f*d[2]*e,i.scale(r,o,a*e),i.multiply(r,r,n.massMultiplier),i.add(n.vlambda,n.vlambda,r),n.wlambda+=p*d[5]*e},r.prototype.computeInvC=function(e){return 1/(this.computeGiMGt()+e)}},{"../math/vec2":30,"../objects/Body":31,"../utils/Utils":57}],23:[function(e,t,n){function r(e,t,n){s.call(this,e,t,-n,n),this.contactPointA=i.create(),this.contactPointB=i.create(),this.t=i.create(),this.contactEquations=[],this.shapeA=null,this.shapeB=null,this.frictionCoefficient=.3}var i=e("../math/vec2"),s=e("./Equation");e("../utils/Utils"),t.exports=r,r.prototype=new s,r.prototype.constructor=r,r.prototype.setSlipForce=function(e){this.maxForce=e,this.minForce=-e},r.prototype.getSlipForce=function(){return this.maxForce},r.prototype.computeB=function(e,t,n){var r=(this.bodyA,this.bodyB,this.contactPointA),s=this.contactPointB,o=this.t,u=this.G;u[0]=-o[0],u[1]=-o[1],u[2]=-i.crossLength(r,o),u[3]=o[0],u[4]=o[1],u[5]=i.crossLength(s,o);var a=this.computeGW(),f=this.computeGiMf(),l=-a*t-n*f;return l}},{"../math/vec2":30,"../utils/Utils":57,"./Equation":22}],24:[function(e,t,n){function r(e,t,n){n=n||{},i.call(this,e,t,-Number.MAX_VALUE,Number.MAX_VALUE),this.angle=n.angle||0;var r=this.G;r[2]=1,r[5]=-1}var i=e("./Equation"),s=e("../math/vec2");t.exports=r,r.prototype=new i,r.prototype.constructor=r;var o=s.create(),u=s.create(),a=s.fromValues(1,0),f=s.fromValues(0,1);r.prototype.computeGq=function(){return s.rotate(o,a,this.bodyA.angle+this.angle),s.rotate(u,f,this.bodyB.angle),s.dot(o,u)}},{"../math/vec2":30,"./Equation":22}],25:[function(e,t,n){function r(e,t){i.call(this,e,t,-Number.MAX_VALUE,Number.MAX_VALUE),this.relativeVelocity=1,this.ratio=1}var i=e("./Equation");e("../math/vec2"),t.exports=r,r.prototype=new i,r.prototype.constructor=r,r.prototype.computeB=function(e,t,n){var r=this.G;r[2]=-1,r[5]=this.ratio;var i=this.computeGiMf(),s=this.computeGW(),o=-s*t-n*i;return o}},{"../math/vec2":30,"./Equation":22}],26:[function(e,t,n){var r=function(){};t.exports=r,r.prototype={constructor:r,on:function(e,t,n){t.context=n||this,void 0===this._listeners&&(this._listeners={});var r=this._listeners;return void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t),this},has:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;if(t){if(void 0!==n[e]&&-1!==n[e].indexOf(t))return!0}else if(void 0!==n[e])return!0;return!1},off:function(e,t){if(void 0===this._listeners)return this;var n=this._listeners,r=n[e].indexOf(t);return-1!==r&&n[e].splice(r,1),this},emit:function(e){if(void 0===this._listeners)return this;var t=this._listeners,n=t[e.type];if(void 0!==n){e.target=this;for(var r=0,i=n.length;i>r;r++){var s=n[r];s.call(s.context,e)}}return this}}},{}],27:[function(e,t,n){function r(e,t,n){if(n=n||{},!(e instanceof i&&t instanceof i))throw new Error("First two arguments must be Material instances.");this.id=r.idCounter++,this.materialA=e,this.materialB=t,this.friction="undefined"!=typeof n.friction?Number(n.friction):.3,this.restitution="undefined"!=typeof n.restitution?Number(n.restitution):0,this.stiffness="undefined"!=typeof n.stiffness?Number(n.stiffness):s.DEFAULT_STIFFNESS,this.relaxation="undefined"!=typeof n.relaxation?Number(n.relaxation):s.DEFAULT_RELAXATION,this.frictionStiffness="undefined"!=typeof n.frictionStiffness?Number(n.frictionStiffness):s.DEFAULT_STIFFNESS,this.frictionRelaxation="undefined"!=typeof n.frictionRelaxation?Number(n.frictionRelaxation):s.DEFAULT_RELAXATION,this.surfaceVelocity="undefined"!=typeof n.surfaceVelocity?Number(n.surfaceVelocity):0,this.contactSkinSize=.005}var i=e("./Material"),s=e("../equations/Equation");t.exports=r,r.idCounter=0},{"../equations/Equation":22,"./Material":28}],28:[function(e,t,n){function r(e){this.id=e||r.idCounter++}t.exports=r,r.idCounter=0},{}],29:[function(e,t,n){var r={};r.GetArea=function(e){if(e.length<6)return 0;for(var t=e.length-2,n=0,r=0;t>r;r+=2)n+=(e[r+2]-e[r])*(e[r+1]+e[r+3]);return n+=(e[0]-e[t])*(e[t+1]+e[1]),.5*-n},r.Triangulate=function(e){var t=e.length>>1;if(3>t)return[];for(var n=[],i=[],s=0;t>s;s++)i.push(s);for(var s=0,o=t;o>3;){var u=i[(s+0)%o],a=i[(s+1)%o],f=i[(s+2)%o],l=e[2*u],c=e[2*u+1],h=e[2*a],p=e[2*a+1],v=e[2*f],m=e[2*f+1],g=!1;if(r._convex(l,c,h,p,v,m)){g=!0;for(var y=0;o>y;y++){var b=i[y];if(b!=u&&b!=a&&b!=f&&r._PointInTriangle(e[2*b],e[2*b+1],l,c,h,p,v,m)){g=!1;break}}}if(g)n.push(u,a,f),i.splice((s+1)%o,1),o--,s=0;else if(s++>3*o)break}return n.push(i[0],i[1],i[2]),n},r._PointInTriangle=function(e,t,n,r,i,s,o,u){var a=o-n,f=u-r,l=i-n,c=s-r,h=e-n,p=t-r,d=a*a+f*f,v=a*l+f*c,m=a*h+f*p,g=l*l+c*c,y=l*h+c*p,b=1/(d*g-v*v),w=(g*m-v*y)*b,E=(d*y-v*m)*b;return w>=0&&E>=0&&1>w+E},r._convex=function(e,t,n,r,i,s){return(t-r)*(i-n)+(n-e)*(s-r)>=0},t.exports=r},{}],30:[function(e,t,n){var r=t.exports={},i=e("../utils/Utils");r.crossLength=function(e,t){return e[0]*t[1]-e[1]*t[0]},r.crossVZ=function(e,t,n){return r.rotate(e,t,-Math.PI/2),r.scale(e,e,n),e},r.crossZV=function(e,t,n){return r.rotate(e,n,Math.PI/2),r.scale(e,e,t),e},r.rotate=function(e,t,n){if(0!==n){var r=Math.cos(n),i=Math.sin(n),s=t[0],o=t[1];e[0]=r*s-i*o,e[1]=i*s+r*o}else e[0]=t[0],e[1]=t[1]},r.rotate90cw=function(e,t){var n=t[0],r=t[1];e[0]=r,e[1]=-n},r.toLocalFrame=function(e,t,n,i){r.copy(e,t),r.sub(e,e,n),r.rotate(e,e,-i)},r.toGlobalFrame=function(e,t,n,i){r.copy(e,t),r.rotate(e,e,i),r.add(e,e,n)},r.vectorToLocalFrame=function(e,t,n){r.rotate(e,t,-n)},r.vectorToGlobalFrame=function(e,t,n){r.rotate(e,t,n)},r.centroid=function(e,t,n,i){return r.add(e,t,n),r.add(e,e,i),r.scale(e,e,1/3),e},r.create=function(){var e=new i.ARRAY_TYPE(2);return e[0]=0,e[1]=0,e},r.clone=function(e){var t=new i.ARRAY_TYPE(2);return t[0]=e[0],t[1]=e[1],t},r.fromValues=function(e,t){var n=new i.ARRAY_TYPE(2);return n[0]=e,n[1]=t,n},r.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e},r.set=function(e,t,n){return e[0]=t,e[1]=n,e},r.add=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e},r.subtract=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e},r.sub=r.subtract,r.multiply=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e},r.mul=r.multiply,r.divide=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e},r.div=r.divide,r.scale=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e},r.distance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)},r.dist=r.distance,r.squaredDistance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r},r.sqrDist=r.squaredDistance,r.length=function(e){var t=e[0],n=e[1];return Math.sqrt(t*t+n*n)},r.len=r.length,r.squaredLength=function(e){var t=e[0],n=e[1];return t*t+n*n},r.sqrLen=r.squaredLength,r.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},r.normalize=function(e,t){var n=t[0],r=t[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i),e},r.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},r.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},r.lerp=function(e,t,n,r){var i=t[0],s=t[1];return e[0]=i+r*(n[0]-i),e[1]=s+r*(n[1]-s),e},r.reflect=function(e,t,n){var r=t[0]*n[0]+t[1]*n[1];e[0]=t[0]-2*n[0]*r,e[1]=t[1]-2*n[1]*r},r.getLineSegmentsIntersection=function(e,t,n,i,s){var o=r.getLineSegmentsIntersectionFraction(t,n,i,s);return 0>o?!1:(e[0]=t[0]+o*(n[0]-t[0]),e[1]=t[1]+o*(n[1]-t[1]),!0)},r.getLineSegmentsIntersectionFraction=function(e,t,n,r){var i,s,o=t[0]-e[0],u=t[1]-e[1],a=r[0]-n[0],f=r[1]-n[1];return i=(-u*(e[0]-n[0])+o*(e[1]-n[1]))/(-a*u+o*f),s=(a*(e[1]-n[1])-f*(e[0]-n[0]))/(-a*u+o*f),i>=0&&1>=i&&s>=0&&1>=s?s:-1}},{"../utils/Utils":57}],31:[function(e,t,n){function r(e){e=e||{},l.call(this),this.id=e.id||++r._idCounter,this.world=null,this.shapes=[],this.mass=e.mass||0,this.invMass=0,this.inertia=0,this.invInertia=0,this.invMassSolve=0,this.invInertiaSolve=0,this.fixedRotation=!!e.fixedRotation,this.fixedX=!!e.fixedX,this.fixedY=!!e.fixedY,this.massMultiplier=i.create(),this.position=i.fromValues(0,0),e.position&&i.copy(this.position,e.position),this.interpolatedPosition=i.fromValues(0,0),this.interpolatedAngle=0,this.previousPosition=i.fromValues(0,0),this.previousAngle=0,this.velocity=i.fromValues(0,0),e.velocity&&i.copy(this.velocity,e.velocity),this.vlambda=i.fromValues(0,0),this.wlambda=0,this.angle=e.angle||0,this.angularVelocity=e.angularVelocity||0,this.force=i.create(),e.force&&i.copy(this.force,e.force),this.angularForce=e.angularForce||0,this.damping="number"==typeof e.damping?e.damping:.1,this.angularDamping="number"==typeof e.angularDamping?e.angularDamping:.1,this.type=r.STATIC,"undefined"!=typeof e.type?this.type=e.type:e.mass?this.type=r.DYNAMIC:this.type=r.STATIC,this.boundingRadius=0,this.aabb=new f,this.aabbNeedsUpdate=!0,this.allowSleep=void 0!==e.allowSleep?e.allowSleep:!0,this.wantsToSleep=!1,this.sleepState=r.AWAKE,this.sleepSpeedLimit=void 0!==e.sleepSpeedLimit?e.sleepSpeedLimit:.2,this.sleepTimeLimit=void 0!==e.sleepTimeLimit?e.sleepTimeLimit:1,this.gravityScale=void 0!==e.gravityScale?e.gravityScale:1,this.collisionResponse=void 0!==e.collisionResponse?e.collisionResponse:!0,this.idleTime=0,this.timeLastSleepy=0,this.ccdSpeedThreshold=void 0!==e.ccdSpeedThreshold?e.ccdSpeedThreshold:-1,this.ccdIterations=void 0!==e.ccdIterations?e.ccdIterations:10,this.concavePath=null,this._wakeUpAfterNarrowphase=!1,this.updateMassProperties()}var i=e("../math/vec2"),s=e("poly-decomp"),o=e("../shapes/Convex"),u=e("../collision/RaycastResult"),a=e("../collision/Ray"),f=e("../collision/AABB"),l=e("../events/EventEmitter");t.exports=r,r.prototype=new l,r.prototype.constructor=r,r._idCounter=0,r.prototype.updateSolveMassProperties=function(){this.sleepState===r.SLEEPING||this.type===r.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve=0):(this.invMassSolve=this.invMass,this.invInertiaSolve=this.invInertia)},r.prototype.setDensity=function(e){var t=this.getArea();this.mass=t*e,this.updateMassProperties()},r.prototype.getArea=function(){for(var e=0,t=0;t<this.shapes.length;t++)e+=this.shapes[t].area;return e},r.prototype.getAABB=function(){return this.aabbNeedsUpdate&&this.updateAABB(),this.aabb};var c=new f,h=i.create();r.prototype.updateAABB=function(){for(var e=this.shapes,t=e.length,n=h,r=this.angle,s=0;s!==t;s++){var o=e[s],u=o.angle+r;i.rotate(n,o.position,r),i.add(n,n,this.position),o.computeAABB(c,n,u),0===s?this.aabb.copy(c):this.aabb.extend(c)}this.aabbNeedsUpdate=!1},r.prototype.updateBoundingRadius=function(){for(var e=this.shapes,t=e.length,n=0,r=0;r!==t;r++){var s=e[r],o=i.length(s.position),u=s.boundingRadius;o+u>n&&(n=o+u)}this.boundingRadius=n},r.prototype.addShape=function(e,t,n){if(e.body)throw new Error("A shape can only be added to one body.");e.body=this,t?i.copy(e.position,t):i.set(e.position,0,0),e.angle=n||0,this.shapes.push(e),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0},r.prototype.removeShape=function(e){var t=this.shapes.indexOf(e);return-1!==t?(this.shapes.splice(t,1),this.aabbNeedsUpdate=!0,e.body=null,!0):!1},r.prototype.updateMassProperties=function(){if(this.type===r.STATIC||this.type===r.KINEMATIC)this.mass=Number.MAX_VALUE,this.invMass=0,this.inertia=Number.MAX_VALUE,this.invInertia=0;else{var e=this.shapes,t=e.length,n=this.mass/t,s=0;if(this.fixedRotation)this.inertia=Number.MAX_VALUE,this.invInertia=0;else{for(var o=0;t>o;o++){var u=e[o],a=i.squaredLength(u.position),f=u.computeMomentOfInertia(n);s+=f+n*a}this.inertia=s,this.invInertia=s>0?1/s:0}this.invMass=1/this.mass,i.set(this.massMultiplier,this.fixedX?0:1,this.fixedY?0:1)}},i.create(),r.prototype.applyForce=function(e,t){if(i.add(this.force,this.force,e),t){var n=i.crossLength(t,e);this.angularForce+=n}};var p=i.create(),d=i.create(),v=i.create();r.prototype.applyForceLocal=function(e,t){t=t||v;var n=p,r=d;this.vectorToWorldFrame(n,e),this.vectorToWorldFrame(r,t),this.applyForce(n,r)};var m=i.create();r.prototype.applyImpulse=function(e,t){if(this.type===r.DYNAMIC){var n=m;if(i.scale(n,e,this.invMass),i.multiply(n,this.massMultiplier,n),i.add(this.velocity,n,this.velocity),t){var s=i.crossLength(t,e);s*=this.invInertia,this.angularVelocity+=s}}};var g=i.create(),y=i.create(),b=i.create();r.prototype.applyImpulseLocal=function(e,t){t=t||b;var n=g,r=y;this.vectorToWorldFrame(n,e),this.vectorToWorldFrame(r,t),this.applyImpulse(n,r)},r.prototype.toLocalFrame=function(e,t){i.toLocalFrame(e,t,this.position,this.angle)},r.prototype.toWorldFrame=function(e,t){i.toGlobalFrame(e,t,this.position,this.angle)},r.prototype.vectorToLocalFrame=function(e,t){i.vectorToLocalFrame(e,t,this.angle)},r.prototype.vectorToWorldFrame=function(e,t){i.vectorToGlobalFrame(e,t,this.angle)},r.prototype.fromPolygon=function(e,t){t=t||{};for(var n=this.shapes.length;n>=0;--n)this.removeShape(this.shapes[n]);var r=new s.Polygon;if(r.vertices=e,r.makeCCW(),"number"==typeof t.removeCollinearPoints&&r.removeCollinearPoints(t.removeCollinearPoints),"undefined"==typeof t.skipSimpleCheck&&!r.isSimple())return!1;this.concavePath=r.vertices.slice(0);for(var n=0;n<this.concavePath.length;n++){var u=[0,0];i.copy(u,this.concavePath[n]),this.concavePath[n]=u}var a;a=t.optimalDecomp?r.decomp():r.quickDecomp();for(var f=i.create(),n=0;n!==a.length;n++){for(var l=new o({vertices:a[n].vertices}),c=0;c!==l.vertices.length;c++){var u=l.vertices[c];i.sub(u,u,l.centerOfMass)}i.scale(f,l.centerOfMass,1),l.updateTriangles(),l.updateCenterOfMass(),l.updateBoundingRadius(),this.addShape(l,f)}return this.adjustCenterOfMass(),this.aabbNeedsUpdate=!0,!0};var w=(i.fromValues(0,0),i.fromValues(0,0)),E=i.fromValues(0,0),S=i.fromValues(0,0);r.prototype.adjustCenterOfMass=function(){var e=w,t=E,n=S,r=0;i.set(t,0,0);for(var s=0;s!==this.shapes.length;s++){var o=this.shapes[s];i.scale(e,o.position,o.area),i.add(t,t,e),r+=o.area}i.scale(n,t,1/r);for(var s=0;s!==this.shapes.length;s++){var o=this.shapes[s];i.sub(o.position,o.position,n)}i.add(this.position,this.position,n);for(var s=0;this.concavePath&&s<this.concavePath.length;s++)i.sub(this.concavePath[s],this.concavePath[s],n);this.updateMassProperties(),this.updateBoundingRadius()},r.prototype.setZeroForce=function(){i.set(this.force,0,0),this.angularForce=0},r.prototype.resetConstraintVelocity=function(){var e=this,t=e.vlambda;i.set(t,0,0),e.wlambda=0},r.prototype.addConstraintVelocity=function(){var e=this,t=e.velocity;i.add(t,t,e.vlambda),e.angularVelocity+=e.wlambda},r.prototype.applyDamping=function(e){if(this.type===r.DYNAMIC){var t=this.velocity;i.scale(t,t,Math.pow(1-this.damping,e)),this.angularVelocity*=Math.pow(1-this.angularDamping,e)}},r.prototype.wakeUp=function(){var e=this.sleepState;this.sleepState=r.AWAKE,this.idleTime=0,e!==r.AWAKE&&this.emit(r.wakeUpEvent)},r.prototype.sleep=function(){this.sleepState=r.SLEEPING,this.angularVelocity=0,this.angularForce=0,i.set(this.velocity,0,0),i.set(this.force,0,0),this.emit(r.sleepEvent)},r.prototype.sleepTick=function(e,t,n){if(this.allowSleep&&this.type!==r.SLEEPING){this.wantsToSleep=!1;var s=(this.sleepState,i.squaredLength(this.velocity)+Math.pow(this.angularVelocity,2)),o=Math.pow(this.sleepSpeedLimit,2);s>=o?(this.idleTime=0,this.sleepState=r.AWAKE):(this.idleTime+=n,this.sleepState=r.SLEEPY),this.idleTime>this.sleepTimeLimit&&(t?this.wantsToSleep=!0:this.sleep())}},r.prototype.overlaps=function(e){return this.world.overlapKeeper.bodiesAreOverlapping(this,e)};var x=i.create(),T=i.create();r.prototype.integrate=function(e){var t=this.invMass,n=this.force,r=this.position,s=this.velocity;i.copy(this.previousPosition,this.position),this.previousAngle=this.angle,this.fixedRotation||(this.angularVelocity+=this.angularForce*this.invInertia*e),i.scale(x,n,e*t),i.multiply(x,this.massMultiplier,x),i.add(s,x,s),this.integrateToTimeOfImpact(e)||(i.scale(T,s,e),i.add(r,r,T),this.fixedRotation||(this.angle+=this.angularVelocity*e)),this.aabbNeedsUpdate=!0};var N=new u,C=new a({mode:a.ALL}),k=i.create(),L=i.create(),A=i.create(),O=i.create();r.prototype.integrateToTimeOfImpact=function(e){if(this.ccdSpeedThreshold<0||i.squaredLength(this.velocity)<Math.pow(this.ccdSpeedThreshold,2))return!1;i.normalize(k,this.velocity),i.scale(L,this.velocity,e),i.add(L,L,this.position),i.sub(A,L,this.position);var t,n=this.angularVelocity*e,r=i.length(A),s=1,o=this;if(N.reset(),C.callback=function(e){e.body!==o&&(t=e.body,e.getHitPoint(L,C),i.sub(A,L,o.position),s=i.length(A)/r,e.stop())},i.copy(C.from,this.position),i.copy(C.to,L),C.update(),this.world.raycast(N,C),!t)return!1;var u=this.angle;i.copy(O,this.position);for(var a=0,f=0,l=0,c=s;c>=f&&a<this.ccdIterations;){a++,l=(c-f)/2,i.scale(T,A,s),i.add(this.position,O,T),this.angle=u+n*s,this.updateAABB();var h=this.aabb.overlaps(t.aabb)&&this.world.narrowphase.bodiesOverlap(this,t);h?f=l:c=l}return s=l,i.copy(this.position,O),this.angle=u,i.scale(T,A,s),i.add(this.position,this.position,T),this.fixedRotation||(this.angle+=n*s),!0},r.prototype.getVelocityAtPoint=function(e,t){return i.crossVZ(e,t,this.angularVelocity),i.subtract(e,this.velocity,e),e},r.sleepyEvent={type:"sleepy"},r.sleepEvent={type:"sleep"},r.wakeUpEvent={type:"wakeup"},r.DYNAMIC=1,r.STATIC=2,r.KINEMATIC=4,r.AWAKE=0,r.SLEEPY=1,r.SLEEPING=2},{"../collision/AABB":7,"../collision/Ray":11,"../collision/RaycastResult":12,"../events/EventEmitter":26,"../math/vec2":30,"../shapes/Convex":40,"poly-decomp":5}],32:[function(e,t,n){function r(e,t,n){n=n||{},s.call(this,e,t,n),this.localAnchorA=i.fromValues(0,0),this.localAnchorB=i.fromValues(0,0),n.localAnchorA&&i.copy(this.localAnchorA,n.localAnchorA),n.localAnchorB&&i.copy(this.localAnchorB,n.localAnchorB),n.worldAnchorA&&this.setWorldAnchorA(n.worldAnchorA),n.worldAnchorB&&this.setWorldAnchorB(n.worldAnchorB);var r=i.create(),o=i.create();this.getWorldAnchorA(r),this.getWorldAnchorB(o);var u=i.distance(r,o);this.restLength="number"==typeof n.restLength?n.restLength:u}var i=e("../math/vec2"),s=e("./Spring");e("../utils/Utils"),t.exports=r,r.prototype=new s,r.prototype.constructor=r,r.prototype.setWorldAnchorA=function(e){this.bodyA.toLocalFrame(this.localAnchorA,e)},r.prototype.setWorldAnchorB=function(e){this.bodyB.toLocalFrame(this.localAnchorB,e)},r.prototype.getWorldAnchorA=function(e){this.bodyA.toWorldFrame(e,this.localAnchorA)},r.prototype.getWorldAnchorB=function(e){this.bodyB.toWorldFrame(e,this.localAnchorB)};var o=i.create(),u=i.create(),a=i.create(),f=i.create(),l=i.create(),c=i.create(),h=i.create(),p=i.create(),d=i.create();r.prototype.applyForce=function(){var e=this.stiffness,t=this.damping,n=this.restLength,r=this.bodyA,s=this.bodyB,v=o,y=u,b=a,w=f,E=d,S=l,x=c,T=h,N=p;this.getWorldAnchorA(S),this.getWorldAnchorB(x),i.sub(T,S,r.position),i.sub(N,x,s.position),i.sub(v,x,S);var C=i.len(v);i.normalize(y,v),i.sub(b,s.velocity,r.velocity),i.crossZV(E,s.angularVelocity,N),i.add(b,b,E),i.crossZV(E,r.angularVelocity,T),i.sub(b,b,E),i.scale(w,y,-e*(C-n)-t*i.dot(b,y)),i.sub(r.force,r.force,w),i.add(s.force,s.force,w);var L=i.crossLength(T,w),A=i.crossLength(N,w);r.angularForce-=L,s.angularForce+=A}},{"../math/vec2":30,"../utils/Utils":57,"./Spring":34}],33:[function(e,t,n){function r(e,t,n){n=n||{},i.call(this,e,t,n),this.restAngle="number"==typeof n.restAngle?n.restAngle:t.angle-e.angle}var i=(e("../math/vec2"),e("./Spring"));t.exports=r,r.prototype=new i,r.prototype.constructor=r,r.prototype.applyForce=function(){var e=this.stiffness,t=this.damping,n=this.restAngle,r=this.bodyA,i=this.bodyB,s=i.angle-r.angle,o=i.angularVelocity-r.angularVelocity,u=-e*(s-n)-t*o*0;r.angularForce-=u,i.angularForce+=u}},{"../math/vec2":30,"./Spring":34}],34:[function(e,t,n){function r(e,t,n){n=i.defaults(n,{stiffness:100,damping:1}),this.stiffness=n.stiffness,this.damping=n.damping,this.bodyA=e,this.bodyB=t}var i=(e("../math/vec2"),e("../utils/Utils"));t.exports=r,r.prototype.applyForce=function(){}},{"../math/vec2":30,"../utils/Utils":57}],35:[function(e,t,n){function r(e,t){t=t||{},this.chassisBody=e,this.wheels=[],this.groundBody=new a({mass:0}),this.world=null;var n=this;this.preStepCallback=function(){n.update()}}function i(e,t){t=t||{},this.vehicle=e,this.forwardEquation=new u(e.chassisBody,e.groundBody),this.sideEquation=new u(e.chassisBody,e.groundBody),this.steerValue=0,this.engineForce=0,this.setSideFriction(void 0!==t.sideFriction?t.sideFriction:5),this.localForwardVector=s.fromValues(0,1),t.localForwardVector&&s.copy(this.localForwardVector,t.localForwardVector),this.localPosition=s.fromValues(0,0),t.localPosition&&s.copy(this.localPosition,t.localPosition),o.apply(this,e.chassisBody,e.groundBody),this.equations.push(this.forwardEquation,this.sideEquation),this.setBrakeForce(0)}var s=e("../math/vec2"),o=(e("../utils/Utils"),e("../constraints/Constraint")),u=e("../equations/FrictionEquation"),a=e("../objects/Body");t.exports=r,r.prototype.addToWorld=function(e){this.world=e,e.addBody(this.groundBody),e.on("preStep",this.preStepCallback);for(var t=0;t<this.wheels.length;t++){var n=this.wheels[t];e.addConstraint(n)}},r.prototype.removeFromWorld=function(){var e=this.world;e.removeBody(this.groundBody),e.off("preStep",this.preStepCallback);for(var t=0;t<this.wheels.length;t++){var n=this.wheels[t];e.removeConstraint(n)}this.world=null},r.prototype.addWheel=function(e){var t=new i(this,e);return this.wheels.push(t),t},r.prototype.update=function(){for(var e=0;e<this.wheels.length;e++)this.wheels[e].update()},i.prototype=new o,i.prototype.setBrakeForce=function(e){this.forwardEquation.setSlipForce(e)},i.prototype.setSideFriction=function(e){this.sideEquation.setSlipForce(e)};var f=s.create(),l=s.create();i.prototype.getSpeed=function(){return this.vehicle.chassisBody.vectorToWorldFrame(l,this.localForwardVector),this.vehicle.chassisBody.getVelocityAtPoint(f,l),s.dot(f,l)};var c=s.create();i.prototype.update=function(){this.vehicle.chassisBody.vectorToWorldFrame(this.forwardEquation.t,this.localForwardVector),s.rotate(this.sideEquation.t,this.localForwardVector,Math.PI/2),this.vehicle.chassisBody.vectorToWorldFrame(this.sideEquation.t,this.sideEquation.t),s.rotate(this.forwardEquation.t,this.forwardEquation.t,this.steerValue),s.rotate(this.sideEquation.t,this.sideEquation.t,this.steerValue),this.vehicle.chassisBody.toWorldFrame(this.forwardEquation.contactPointB,this.localPosition),s.copy(this.sideEquation.contactPointB,this.forwardEquation.contactPointB),this.vehicle.chassisBody.vectorToWorldFrame(this.forwardEquation.contactPointA,this.localPosition),s.copy(this.sideEquation.contactPointA,this.forwardEquation.contactPointA),s.normalize(c,this.forwardEquation.t),s.scale(c,c,this.engineForce),this.vehicle.chassisBody.applyForce(c,this.forwardEquation.contactPointA)}},{"../constraints/Constraint":14,"../equations/FrictionEquation":23,"../math/vec2":30,"../objects/Body":31,"../utils/Utils":57}],36:[function(e,t,n){var r=t.exports={AABB:e("./collision/AABB"),AngleLockEquation:e("./equations/AngleLockEquation"),Body:e("./objects/Body"),Broadphase:e("./collision/Broadphase"),Capsule:e("./shapes/Capsule"),Circle:e("./shapes/Circle"),Constraint:e("./constraints/Constraint"),ContactEquation:e("./equations/ContactEquation"),ContactEquationPool:e("./utils/ContactEquationPool"),ContactMaterial:e("./material/ContactMaterial"),Convex:e("./shapes/Convex"),DistanceConstraint:e("./constraints/DistanceConstraint"),Equation:e("./equations/Equation"),EventEmitter:e("./events/EventEmitter"),FrictionEquation:e("./equations/FrictionEquation"),FrictionEquationPool:e("./utils/FrictionEquationPool"),GearConstraint:e("./constraints/GearConstraint"),GSSolver:e("./solver/GSSolver"),Heightfield:e("./shapes/Heightfield"),Line:e("./shapes/Line"),LockConstraint:e("./constraints/LockConstraint"),Material:e("./material/Material"),Narrowphase:e("./collision/Narrowphase"),NaiveBroadphase:e("./collision/NaiveBroadphase"),Particle:e("./shapes/Particle"),Plane:e("./shapes/Plane"),Pool:e("./utils/Pool"),RevoluteConstraint:e("./constraints/RevoluteConstraint"),PrismaticConstraint:e("./constraints/PrismaticConstraint"),Ray:e("./collision/Ray"),RaycastResult:e("./collision/RaycastResult"),Box:e("./shapes/Box"),RotationalVelocityEquation:e("./equations/RotationalVelocityEquation"),SAPBroadphase:e("./collision/SAPBroadphase"),Shape:e("./shapes/Shape"),Solver:e("./solver/Solver"),Spring:e("./objects/Spring"),TopDownVehicle:e("./objects/TopDownVehicle"),LinearSpring:e("./objects/LinearSpring"),RotationalSpring:e("./objects/RotationalSpring"),Utils:e("./utils/Utils"),World:e("./world/World"),vec2:e("./math/vec2"),version:e("../package.json").version};Object.defineProperty(r,"Rectangle",{get:function(){return console.warn("The Rectangle class has been renamed to Box."),this.Box}})},{"../package.json":6,"./collision/AABB":7,"./collision/Broadphase":8,"./collision/NaiveBroadphase":9,"./collision/Narrowphase":10,"./collision/Ray":11,"./collision/RaycastResult":12,"./collision/SAPBroadphase":13,"./constraints/Constraint":14,"./constraints/DistanceConstraint":15,"./constraints/GearConstraint":16,"./constraints/LockConstraint":17,"./constraints/PrismaticConstraint":18,"./constraints/RevoluteConstraint":19,"./equations/AngleLockEquation":20,"./equations/ContactEquation":21,"./equations/Equation":22,"./equations/FrictionEquation":23,"./equations/RotationalVelocityEquation":25,"./events/EventEmitter":26,"./material/ContactMaterial":27,"./material/Material":28,"./math/vec2":30,"./objects/Body":31,"./objects/LinearSpring":32,"./objects/RotationalSpring":33,"./objects/Spring":34,"./objects/TopDownVehicle":35,"./shapes/Box":37,"./shapes/Capsule":38,"./shapes/Circle":39,"./shapes/Convex":40,"./shapes/Heightfield":41,"./shapes/Line":42,"./shapes/Particle":43,"./shapes/Plane":44,"./shapes/Shape":45,"./solver/GSSolver":46,"./solver/Solver":47,"./utils/ContactEquationPool":48,"./utils/FrictionEquationPool":49,"./utils/Pool":55,"./utils/Utils":57,"./world/World":61}],37:[function(e,t,n){function r(e){"number"==typeof arguments[0]&&"number"==typeof arguments[1]&&(e={width:arguments[0],height:arguments[1]},console.warn("The Rectangle has been renamed to Box and its constructor signature has changed. Please use the following format: new Box({ width: 1, height: 1, ... })")),e=e||{};var t=this.width=e.width||1,n=this.height=e.height||1,r=[i.fromValues(-t/2,-n/2),i.fromValues(t/2,-n/2),i.fromValues(t/2,n/2),i.fromValues(-t/2,n/2)],u=[i.fromValues(1,0),i.fromValues(0,1)];e.vertices=r,e.axes=u,e.type=s.BOX,o.call(this,e)}var i=e("../math/vec2"),s=e("./Shape"),o=e("./Convex");t.exports=r,r.prototype=new o,r.prototype.constructor=r,r.prototype.computeMomentOfInertia=function(e){var t=this.width,n=this.height;return e*(n*n+t*t)/12},r.prototype.updateBoundingRadius=function(){var e=this.width,t=this.height;this.boundingRadius=Math.sqrt(e*e+t*t)/2},i.create(),i.create(),i.create(),i.create(),r.prototype.computeAABB=function(e,t,n){e.setFromPoints(this.vertices,t,n,0)},r.prototype.updateArea=function(){this.area=this.width*this.height}},{"../math/vec2":30,"./Convex":40,"./Shape":45}],38:[function(e,t,n){function r(e){"number"==typeof arguments[0]&&"number"==typeof arguments[1]&&(e={length:arguments[0],radius:arguments[1]},console.warn("The Capsule constructor signature has changed. Please use the following format: new Capsule({ radius: 1, length: 1 })")),e=e||{},this.length=e.length||1,this.radius=e.radius||1,e.type=i.CAPSULE,i.call(this,e)}var i=e("./Shape"),s=e("../math/vec2");t.exports=r,r.prototype=new i,r.prototype.constructor=r,r.prototype.computeMomentOfInertia=function(e){var t=this.radius,n=this.length+t,r=2*t;return e*(r*r+n*n)/12},r.prototype.updateBoundingRadius=function(){this.boundingRadius=this.radius+this.length/2},r.prototype.updateArea=function(){this.area=Math.PI*this.radius*this.radius+2*this.radius*this.length};var o=s.create();r.prototype.computeAABB=function(e,t,n){var r=this.radius;s.set(o,this.length/2,0),0!==n&&s.rotate(o,o,n),s.set(e.upperBound,Math.max(o[0]+r,-o[0]+r),Math.max(o[1]+r,-o[1]+r)),s.set(e.lowerBound,Math.min(o[0]-r,-o[0]-r),Math.min(o[1]-r,-o[1]-r)),s.add(e.lowerBound,e.lowerBound,t),s.add(e.upperBound,e.upperBound,t)};var u=s.create(),a=s.create(),f=s.create(),l=s.create(),c=s.fromValues(0,1);r.prototype.raycast=function(e,t,n,r){for(var i=t.from,o=t.to,p=(t.direction,u),d=a,v=f,m=l,g=this.length/2,y=0;2>y;y++){var b=this.radius*(2*y-1);s.set(v,-g,b),s.set(m,g,b),s.toGlobalFrame(v,v,n,r),s.toGlobalFrame(m,m,n,r);var w=s.getLineSegmentsIntersectionFraction(i,o,v,m);if(w>=0&&(s.rotate(d,c,r),s.scale(d,d,2*y-1),t.reportIntersection(e,w,d,-1),e.shouldStop(t)))return}for(var E=Math.pow(this.radius,2)+Math.pow(g,2),y=0;2>y;y++){s.set(v,g*(2*y-1),0),s.toGlobalFrame(v,v,n,r);var S=Math.pow(o[0]-i[0],2)+Math.pow(o[1]-i[1],2),x=2*((o[0]-i[0])*(i[0]-v[0])+(o[1]-i[1])*(i[1]-v[1])),T=Math.pow(i[0]-v[0],2)+Math.pow(i[1]-v[1],2)-Math.pow(this.radius,2),w=Math.pow(x,2)-4*S*T;if(!(0>w))if(0===w){if(s.lerp(p,i,o,w),s.squaredDistance(p,n)>E&&(s.sub(d,p,v),s.normalize(d,d),t.reportIntersection(e,w,d,-1),e.shouldStop(t)))return}else{var N=Math.sqrt(w),C=1/(2*S),L=(-x-N)*C,A=(-x+N)*C;if(L>=0&&1>=L&&(s.lerp(p,i,o,L),s.squaredDistance(p,n)>E&&(s.sub(d,p,v),s.normalize(d,d),t.reportIntersection(e,L,d,-1),e.shouldStop(t))))return;if(A>=0&&1>=A&&(s.lerp(p,i,o,A),s.squaredDistance(p,n)>E&&(s.sub(d,p,v),s.normalize(d,d),t.reportIntersection(e,A,d,-1),e.shouldStop(t))))return}}}},{"../math/vec2":30,"./Shape":45}],39:[function(e,t,n){function r(e){"number"==typeof arguments[0]&&(e={radius:arguments[0]},console.warn("The Circle constructor signature has changed. Please use the following format: new Circle({ radius: 1 })")),e=e||{},this.radius=e.radius||1,e.type=i.CIRCLE,i.call(this,e)}var i=e("./Shape"),s=e("../math/vec2");t.exports=r,r.prototype=new i,r.prototype.constructor=r,r.prototype.computeMomentOfInertia=function(e){var t=this.radius;return e*t*t/2},r.prototype.updateBoundingRadius=function(){this.boundingRadius=this.radius},r.prototype.updateArea=function(){this.area=Math.PI*this.radius*this.radius},r.prototype.computeAABB=function(e,t,n){var r=this.radius;s.set(e.upperBound,r,r),s.set(e.lowerBound,-r,-r),t&&(s.add(e.lowerBound,e.lowerBound,t),s.add(e.upperBound,e.upperBound,t))};var o=s.create(),u=s.create();r.prototype.raycast=function(e,t,n,r){var i=t.from,a=t.to,l=this.radius,c=Math.pow(a[0]-i[0],2)+Math.pow(a[1]-i[1],2),p=2*((a[0]-i[0])*(i[0]-n[0])+(a[1]-i[1])*(i[1]-n[1])),d=Math.pow(i[0]-n[0],2)+Math.pow(i[1]-n[1],2)-Math.pow(l,2),v=Math.pow(p,2)-4*c*d,m=o,y=u;if(!(0>v))if(0===v)s.lerp(m,i,a,v),s.sub(y,m,n),s.normalize(y,y),t.reportIntersection(e,v,y,-1);else{var b=Math.sqrt(v),w=1/(2*c),E=(-p-b)*w,S=(-p+b)*w;if(E>=0&&1>=E&&(s.lerp(m,i,a,E),s.sub(y,m,n),s.normalize(y,y),t.reportIntersection(e,E,y,-1),e.shouldStop(t)))return;S>=0&&1>=S&&(s.lerp(m,i,a,S),s.sub(y,m,n),s.normalize(y,y),t.reportIntersection(e,S,y,-1))}}},{"../math/vec2":30,"./Shape":45}],40:[function(e,t,n){function r(e){Array.isArray(arguments[0])&&(e={vertices:arguments[0],axes:arguments[1]},console.warn("The Convex constructor signature has changed. Please use the following format: new Convex({ vertices: [...], ... })")),e=e||{},this.vertices=[];for(var t=void 0!==e.vertices?e.vertices:[],n=0;n<t.length;n++){var r=s.create();s.copy(r,t[n]),this.vertices.push(r)}if(this.axes=[],e.axes)for(var n=0;n<e.axes.length;n++){var o=s.create();s.copy(o,e.axes[n]),this.axes.push(o)}else for(var n=0;n<this.vertices.length;n++){var u=this.vertices[n],a=this.vertices[(n+1)%this.vertices.length],f=s.create();s.sub(f,a,u),s.rotate90cw(f,f),s.normalize(f,f),this.axes.push(f)}if(this.centerOfMass=s.fromValues(0,0),this.triangles=[],this.vertices.length&&(this.updateTriangles(),this.updateCenterOfMass()),this.boundingRadius=0,e.type=i.CONVEX,i.call(this,e),this.updateBoundingRadius(),this.updateArea(),this.area<0)throw new Error("Convex vertices must be given in conter-clockwise winding.")}var i=e("./Shape"),s=e("../math/vec2"),o=e("../math/polyk");e("poly-decomp"),t.exports=r,r.prototype=new i,r.prototype.constructor=r;var u=s.create(),a=s.create();r.prototype.projectOntoLocalAxis=function(e,t){for(var n,r,i=null,o=null,e=u,a=0;a<this.vertices.length;a++)n=this.vertices[a],r=s.dot(n,e),(null===i||r>i)&&(i=r),(null===o||o>r)&&(o=r);if(o>i){var f=o;o=i,i=f}s.set(t,o,i)},r.prototype.projectOntoWorldAxis=function(e,t,n,r){var i=a;this.projectOntoLocalAxis(e,r),0!==n?s.rotate(i,e,n):i=e;var o=s.dot(t,i);s.set(r,r[0]+o,r[1]+o)},r.prototype.updateTriangles=function(){this.triangles.length=0;for(var e=[],t=0;t<this.vertices.length;t++){var n=this.vertices[t];e.push(n[0],n[1])}for(var r=o.Triangulate(e),t=0;t<r.length;t+=3){var i=r[t],s=r[t+1],u=r[t+2];this.triangles.push([i,s,u])}};var f=s.create(),l=s.create(),c=s.create(),h=s.create(),p=s.create();s.create(),s.create(),s.create(),s.create(),r.prototype.updateCenterOfMass=function(){var e=this.triangles,t=this.vertices,n=this.centerOfMass,i=f,o=c,u=h,a=p,d=l;s.set(n,0,0);for(var v=0,m=0;m!==e.length;m++){var g=e[m],o=t[g[0]],u=t[g[1]],a=t[g[2]];s.centroid(i,o,u,a);var y=r.triangleArea(o,u,a);v+=y,s.scale(d,i,y),s.add(n,n,d)}s.scale(n,n,1/v)},r.prototype.computeMomentOfInertia=function(e){for(var t=0,n=0,r=this.vertices.length,i=r-1,o=0;r>o;i=o,o++){var u=this.vertices[i],a=this.vertices[o],f=Math.abs(s.crossLength(u,a)),l=s.dot(a,a)+s.dot(a,u)+s.dot(u,u);t+=f*l,n+=f}return e/6*(t/n)},r.prototype.updateBoundingRadius=function(){for(var e=this.vertices,t=0,n=0;n!==e.length;n++){var r=s.squaredLength(e[n]);r>t&&(t=r)}this.boundingRadius=Math.sqrt(t)},r.triangleArea=function(e,t,n){return.5*((t[0]-e[0])*(n[1]-e[1])-(n[0]-e[0])*(t[1]-e[1]))},r.prototype.updateArea=function(){this.updateTriangles(),this.area=0;for(var e=this.triangles,t=this.vertices,n=0;n!==e.length;n++){var i=e[n],s=t[i[0]],o=t[i[1]],u=t[i[2]],a=r.triangleArea(s,o,u);this.area+=a}},r.prototype.computeAABB=function(e,t,n){e.setFromPoints(this.vertices,t,n,0)};var d=s.create(),v=s.create(),m=s.create();r.prototype.raycast=function(e,t,n,r){var i=d,o=v,u=m,a=this.vertices;s.toLocalFrame(i,t.from,n,r),s.toLocalFrame(o,t.to,n,r);for(var f=a.length,l=0;f>l&&!e.shouldStop(t);l++){var c=a[l],h=a[(l+1)%f],p=s.getLineSegmentsIntersectionFraction(i,o,c,h);p>=0&&(s.sub(u,h,c),s.rotate(u,u,-Math.PI/2+r),s.normalize(u,u),t.reportIntersection(e,p,u,l))}}},{"../math/polyk":29,"../math/vec2":30,"./Shape":45,"poly-decomp":5}],41:[function(e,t,n){function r(e){if(Array.isArray(arguments[0])){if(e={heights:arguments[0]},"object"==typeof arguments[1])for(var t in arguments[1])e[t]=arguments[1][t];console.warn("The Heightfield constructor signature has changed. Please use the following format: new Heightfield({ heights: [...], ... })")}e=e||{},this.heights=e.heights?e.heights.slice(0):[],this.maxValue=e.maxValue||null,this.minValue=e.minValue||null,this.elementWidth=e.elementWidth||.1,(void 0===e.maxValue||void 0===e.minValue)&&this.updateMaxMinValues(),e.type=i.HEIGHTFIELD,i.call(this,e)}var i=e("./Shape"),s=e("../math/vec2");e("../utils/Utils"),t.exports=r,r.prototype=new i,r.prototype.constructor=r,r.prototype.updateMaxMinValues=function(){for(var e=this.heights,t=e[0],n=e[0],r=0;r!==e.length;r++){var i=e[r];i>t&&(t=i),n>i&&(n=i)}this.maxValue=t,this.minValue=n},r.prototype.computeMomentOfInertia=function(e){return Number.MAX_VALUE},r.prototype.updateBoundingRadius=function(){this.boundingRadius=Number.MAX_VALUE},r.prototype.updateArea=function(){for(var e=this.heights,t=0,n=0;n<e.length-1;n++)t+=(e[n]+e[n+1])/2*this.elementWidth;this.area=t};var o=[s.create(),s.create(),s.create(),s.create()];r.prototype.computeAABB=function(e,t,n){s.set(o[0],0,this.maxValue),s.set(o[1],this.elementWidth*this.heights.length,this.maxValue),s.set(o[2],this.elementWidth*this.heights.length,this.minValue),s.set(o[3],0,this.minValue),e.setFromPoints(o,t,n)},r.prototype.getLineSegment=function(e,t,n){var r=this.heights,i=this.elementWidth;s.set(e,n*i,r[n]),s.set(t,(n+1)*i,r[n+1])},r.prototype.getSegmentIndex=function(e){return Math.floor(e[0]/this.elementWidth)},r.prototype.getClampedSegmentIndex=function(e){var t=this.getSegmentIndex(e);return t=Math.min(this.heights.length,Math.max(t,0))};var u=(s.create(),s.create()),a=s.create(),f=s.create(),l=s.create(),c=s.create();s.fromValues(0,1),r.prototype.raycast=function(e,t,n,r){var i=t.from,o=t.to,p=(t.direction,u),d=a,v=f,m=l,g=c;s.toLocalFrame(m,i,n,r),s.toLocalFrame(g,o,n,r);var y=this.getClampedSegmentIndex(m),b=this.getClampedSegmentIndex(g);if(y>b){var w=y;y=b,b=w}for(var E=0;E<this.heights.length-1;E++){this.getLineSegment(d,v,E);var S=s.getLineSegmentsIntersectionFraction(m,g,d,v);if(S>=0&&(s.sub(p,v,d),s.rotate(p,p,r+Math.PI/2),s.normalize(p,p),t.reportIntersection(e,S,p,-1),e.shouldStop(t)))return}}},{"../math/vec2":30,"../utils/Utils":57,"./Shape":45}],42:[function(e,t,n){function r(e){"number"==typeof arguments[0]&&(e={length:arguments[0]},console.warn("The Line constructor signature has changed. Please use the following format: new Line({ length: 1, ... })")),e=e||{},this.length=e.length||1,e.type=i.LINE,i.call(this,e)}var i=e("./Shape"),s=e("../math/vec2");t.exports=r,r.prototype=new i,r.prototype.constructor=r,r.prototype.computeMomentOfInertia=function(e){return e*Math.pow(this.length,2)/12},r.prototype.updateBoundingRadius=function(){this.boundingRadius=this.length/2};var o=[s.create(),s.create()];r.prototype.computeAABB=function(e,t,n){var r=this.length/2;s.set(o[0],-r,0),s.set(o[1],r,0),e.setFromPoints(o,t,n,0)};var u=(s.create(),s.create()),a=s.create(),f=s.create(),l=s.fromValues(0,1);r.prototype.raycast=function(e,t,n,r){var i=t.from,o=t.to,c=a,p=f,d=this.length/2;s.set(c,-d,0),s.set(p,d,0),s.toGlobalFrame(c,c,n,r),s.toGlobalFrame(p,p,n,r);var v=s.getLineSegmentsIntersectionFraction(c,p,i,o);if(v>=0){var m=u;s.rotate(m,l,r),t.reportIntersection(e,v,m,-1)}}},{"../math/vec2":30,"./Shape":45}],43:[function(e,t,n){function r(e){e=e||{},e.type=i.PARTICLE,i.call(this,e)}var i=e("./Shape"),s=e("../math/vec2");t.exports=r,r.prototype=new i,r.prototype.constructor=r,r.prototype.computeMomentOfInertia=function(e){return 0},r.prototype.updateBoundingRadius=function(){this.boundingRadius=0},r.prototype.computeAABB=function(e,t,n){s.copy(e.lowerBound,t),s.copy(e.upperBound,t)}},{"../math/vec2":30,"./Shape":45}],44:[function(e,t,n){function r(e){e=e||{},e.type=i.PLANE,i.call(this,e)}var i=e("./Shape"),s=e("../math/vec2");e("../utils/Utils"),t.exports=r,r.prototype=new i,r.prototype.constructor=r,r.prototype.computeMomentOfInertia=function(e){return 0},r.prototype.updateBoundingRadius=function(){this.boundingRadius=Number.MAX_VALUE},r.prototype.computeAABB=function(e,t,n){var r=n%(2*Math.PI),i=s.set,o=Number.MAX_VALUE,u=e.lowerBound,a=e.upperBound;0===r?(i(u,-o,-o),i(a,o,0)):r===Math.PI/2?(i(u,0,-o),i(a,o,o)):r===Math.PI?(i(u,-o,0),i(a,o,o)):r===3*Math.PI/2?(i(u,-o,-o),i(a,0,o)):(i(u,-o,-o),i(a,o,o)),s.add(u,u,t),s.add(a,a,t)},r.prototype.updateArea=function(){this.area=Number.MAX_VALUE};var o=s.create(),u=(s.create(),s.create(),s.create()),a=s.create();r.prototype.raycast=function(e,t,n,r){var i=t.from,l=t.to,c=t.direction,p=o,d=u,v=a;s.set(d,0,1),s.rotate(d,d,r),s.sub(v,i,n);var m=s.dot(v,d);s.sub(v,l,n);var y=s.dot(v,d);if(!(m*y>0||s.squaredDistance(i,l)<m*m)){var b=s.dot(d,c);s.sub(p,i,n);var w=-s.dot(d,p)/b/t.length;t.reportIntersection(e,w,d,-1)}}},{"../math/vec2":30,"../utils/Utils":57,"./Shape":45}],45:[function(e,t,n){function r(e){e=e||{},this.body=null,this.position=i.fromValues(0,0),e.position&&i.copy(this.position,e.position),this.angle=e.angle||0,this.type=e.type||0,this.id=r.idCounter++,this.boundingRadius=0,this.collisionGroup=void 0!==e.collisionGroup?e.collisionGroup:1,this.collisionResponse=void 0!==e.collisionResponse?e.collisionResponse:!0,this.collisionMask=void 0!==e.collisionMask?e.collisionMask:1,this.material=e.material||null,this.area=0,this.sensor=void 0!==e.sensor?e.sensor:!1,this.type&&this.updateBoundingRadius(),this.updateArea()}t.exports=r;var i=e("../math/vec2");r.idCounter=0,r.CIRCLE=1,r.PARTICLE=2,r.PLANE=4,r.CONVEX=8,r.LINE=16,r.BOX=32,Object.defineProperty(r,"RECTANGLE",{get:function(){return console.warn("Shape.RECTANGLE is deprecated, use Shape.BOX instead."),r.BOX}}),r.CAPSULE=64,r.HEIGHTFIELD=128,r.prototype.computeMomentOfInertia=function(e){},r.prototype.updateBoundingRadius=function(){},r.prototype.updateArea=function(){},r.prototype.computeAABB=function(e,t,n){},r.prototype.raycast=function(e,t,n,r){}},{"../math/vec2":30}],46:[function(e,t,n){function r(e){o.call(this,e,o.GS),e=e||{},this.iterations=e.iterations||10,this.tolerance=e.tolerance||1e-7,this.arrayStep=30,this.lambda=new u.ARRAY_TYPE(this.arrayStep),this.Bs=new u.ARRAY_TYPE(this.arrayStep),this.invCs=new u.ARRAY_TYPE(this.arrayStep),this.useZeroRHS=!1,this.frictionIterations=0,this.usedIterations=0}function i(e){for(var t=e.length;t--;)e[t]=0}var s=e("../math/vec2"),o=e("./Solver"),u=e("../utils/Utils"),a=e("../equations/FrictionEquation");t.exports=r,r.prototype=new o,r.prototype.constructor=r,r.prototype.solve=function(e,t){this.sortEquations();var n=0,o=this.iterations,l=this.frictionIterations,c=this.equations,p=c.length,v=Math.pow(this.tolerance*p,2),m=t.bodies,g=t.bodies.length,y=(s.add,s.set,this.useZeroRHS),b=this.lambda;if(this.usedIterations=0,p)for(var w=0;w!==g;w++){var E=m[w];E.updateSolveMassProperties()}b.length<p&&(b=this.lambda=new u.ARRAY_TYPE(p+this.arrayStep),this.Bs=new u.ARRAY_TYPE(p+this.arrayStep),this.invCs=new u.ARRAY_TYPE(p+this.arrayStep)),i(b);for(var S=this.invCs,x=this.Bs,b=this.lambda,w=0;w!==c.length;w++){var T=c[w];(T.timeStep!==e||T.needsUpdate)&&(T.timeStep=e,T.update()),x[w]=T.computeB(T.a,T.b,e),S[w]=T.computeInvC(T.epsilon)}var T,N,w,C;if(0!==p){for(w=0;w!==g;w++){var E=m[w];E.resetConstraintVelocity()}if(l){for(n=0;n!==l;n++){for(N=0,C=0;C!==p;C++){T=c[C];var k=r.iterateEquation(C,T,T.epsilon,x,S,b,y,e,n);N+=Math.abs(k)}if(this.usedIterations++,v>=N*N)break}for(r.updateMultipliers(c,b,1/e),C=0;C!==p;C++){var L=c[C];if(L instanceof a){for(var A=0,O=0;O!==L.contactEquations.length;O++)A+=L.contactEquations[O].multiplier;A*=L.frictionCoefficient/L.contactEquations.length,L.maxForce=A,L.minForce=-A}}}for(n=0;n!==o;n++){for(N=0,C=0;C!==p;C++){T=c[C];var k=r.iterateEquation(C,T,T.epsilon,x,S,b,y,e,n);N+=Math.abs(k)}if(this.usedIterations++,v>=N*N)break}for(w=0;w!==g;w++)m[w].addConstraintVelocity();r.updateMultipliers(c,b,1/e)}},r.updateMultipliers=function(e,t,n){for(var r=e.length;r--;)e[r].multiplier=t[r]*n},r.iterateEquation=function(e,t,n,r,i,s,o,u,a){var f=r[e],l=i[e],c=s[e],h=t.computeGWlambda(),p=t.maxForce,d=t.minForce;o&&(f=0);var v=l*(f-h-n*c),m=c+v;return d*u>m?v=d*u-c:m>p*u&&(v=p*u-c),s[e]+=v,t.addToWlambda(v),v}},{"../equations/FrictionEquation":23,"../math/vec2":30,"../utils/Utils":57,"./Solver":47}],47:[function(e,t,n){function r(e,t){e=e||{},i.call(this),this.type=t,this.equations=[],this.equationSortFunction=e.equationSortFunction||!1}var i=(e("../utils/Utils"),e("../events/EventEmitter"));t.exports=r,r.prototype=new i,r.prototype.constructor=r,r.prototype.solve=function(e,t){throw new Error("Solver.solve should be implemented by subclasses!")};var s={bodies:[]};r.prototype.solveIsland=function(e,t){this.removeAllEquations(),t.equations.length&&(this.addEquations(t.equations),s.bodies.length=0,t.getBodies(s.bodies),s.bodies.length&&this.solve(e,s))},r.prototype.sortEquations=function(){this.equationSortFunction&&this.equations.sort(this.equationSortFunction)},r.prototype.addEquation=function(e){e.enabled&&this.equations.push(e)},r.prototype.addEquations=function(e){for(var t=0,n=e.length;t!==n;t++){var r=e[t];r.enabled&&this.equations.push(r)}},r.prototype.removeEquation=function(e){var t=this.equations.indexOf(e);-1!==t&&this.equations.splice(t,1)},r.prototype.removeAllEquations=function(){this.equations.length=0},r.GS=1,r.ISLAND=2},{"../events/EventEmitter":26,"../utils/Utils":57}],48:[function(e,t,n){function r(){s.apply(this,arguments)}var i=e("../equations/ContactEquation"),s=e("./Pool");t.exports=r,r.prototype=new s,r.prototype.constructor=r,r.prototype.create=function(){return new i},r.prototype.destroy=function(e){return e.bodyA=e.bodyB=null,this}},{"../equations/ContactEquation":21,"./Pool":55}],49:[function(e,t,n){function r(){s.apply(this,arguments)}var i=e("../equations/FrictionEquation"),s=e("./Pool");t.exports=r,r.prototype=new s,r.prototype.constructor=r,r.prototype.create=function(){return new i},r.prototype.destroy=function(e){return e.bodyA=e.bodyB=null,this}},{"../equations/FrictionEquation":23,"./Pool":55}],50:[function(e,t,n){function r(){s.apply(this,arguments)}var i=e("../world/IslandNode"),s=e("./Pool");t.exports=r,r.prototype=new s,r.prototype.constructor=r,r.prototype.create=function(){return new i},r.prototype.destroy=function(e){return e.reset(),this}},{"../world/IslandNode":60,"./Pool":55}],51:[function(e,t,n){function r(){s.apply(this,arguments)}var i=e("../world/Island"),s=e("./Pool");t.exports=r,r.prototype=new s,r.prototype.constructor=r,r.prototype.create=function(){return new i},r.prototype.destroy=function(e){return e.reset(),this}},{"../world/Island":58,"./Pool":55}],52:[function(e,t,n){function r(){this.overlappingShapesLastState=new i,this.overlappingShapesCurrentState=new i,this.recordPool=new s({size:16}),this.tmpDict=new i,this.tmpArray1=[]}var i=e("./TupleDictionary"),s=(e("./OverlapKeeperRecord"),e("./OverlapKeeperRecordPool"));e("./Utils"),t.exports=r,r.prototype.tick=function(){for(var e=this.overlappingShapesLastState,t=this.overlappingShapesCurrentState,n=e.keys.length;n--;){var r=e.keys[n],i=e.getByKey(r);t.getByKey(r),i&&this.recordPool.release(i)}e.reset(),e.copy(t),t.reset()},r.prototype.setOverlapping=function(e,t,n,r){var i=(this.overlappingShapesLastState,this.overlappingShapesCurrentState);if(!i.get(t.id,r.id)){var s=this.recordPool.get();s.set(e,t,n,r),i.set(t.id,r.id,s)}},r.prototype.getNewOverlaps=function(e){return this.getDiff(this.overlappingShapesLastState,this.overlappingShapesCurrentState,e)},r.prototype.getEndOverlaps=function(e){return this.getDiff(this.overlappingShapesCurrentState,this.overlappingShapesLastState,e)},r.prototype.bodiesAreOverlapping=function(e,t){for(var n=this.overlappingShapesCurrentState,r=n.keys.length;r--;){var i=n.keys[r],s=n.data[i];if(s.bodyA===e&&s.bodyB===t||s.bodyA===t&&s.bodyB===e)return!0}return!1},r.prototype.getDiff=function(e,t,n){var n=n||[],r=e,i=t;n.length=0;for(var s=i.keys.length;s--;){var o=i.keys[s],u=i.data[o];if(!u)throw new Error("Key "+o+" had no data!");var a=r.data[o];a||n.push(u)}return n},r.prototype.isNewOverlap=function(e,t){var n=0|e.id,r=0|t.id,i=this.overlappingShapesLastState,s=this.overlappingShapesCurrentState;return!i.get(n,r)&&!!s.get(n,r)},r.prototype.getNewBodyOverlaps=function(e){this.tmpArray1.length=0;var t=this.getNewOverlaps(this.tmpArray1);return this.getBodyDiff(t,e)},r.prototype.getEndBodyOverlaps=function(e){this.tmpArray1.length=0;var t=this.getEndOverlaps(this.tmpArray1);return this.getBodyDiff(t,e)},r.prototype.getBodyDiff=function(e,t){t=t||[];for(var n=this.tmpDict,r=e.length;r--;){var i=e[r];n.set(0|i.bodyA.id,0|i.bodyB.id,i)}for(r=n.keys.length;r--;){var i=n.getByKey(n.keys[r]);i&&t.push(i.bodyA,i.bodyB)}return n.reset(),t}},{"./OverlapKeeperRecord":53,"./OverlapKeeperRecordPool":54,"./TupleDictionary":56,"./Utils":57}],53:[function(e,t,n){function r(e,t,n,r){this.shapeA=t,this.shapeB=r,this.bodyA=e,this.bodyB=n}t.exports=r,r.prototype.set=function(e,t,n,i){r.call(this,e,t,n,i)}},{}],54:[function(e,t,n){function r(){s.apply(this,arguments)}var i=e("./OverlapKeeperRecord"),s=e("./Pool");t.exports=r,r.prototype=new s,r.prototype.constructor=r,r.prototype.create=function(){return new i},r.prototype.destroy=function(e){return e.bodyA=e.bodyB=e.shapeA=e.shapeB=null,this}},{"./OverlapKeeperRecord":53,"./Pool":55}],55:[function(e,t,n){function r(e){e=e||{},this.objects=[],void 0!==e.size&&this.resize(e.size)}t.exports=r,r.prototype.resize=function(e){for(var t=this.objects;t.length>e;)t.pop();for(;t.length<e;)t.push(this.create());return this},r.prototype.get=function(){var e=this.objects;return e.length?e.pop():this.create()},r.prototype.release=function(e){return this.destroy(e),this.objects.push(e),this}},{}],56:[function(e,t,n){function r(){this.data={},this.keys=[]}var i=e("./Utils");t.exports=r,r.prototype.getKey=function(e,t){return e=0|e,t=0|t,(0|e)===(0|t)?-1:0|((0|e)>(0|t)?e<<16|65535&t:t<<16|65535&e)},r.prototype.getByKey=function(e){return e=0|e,this.data[e]},r.prototype.get=function(e,t){return this.data[this.getKey(e,t)]},r.prototype.set=function(e,t,n){if(!n)throw new Error("No data!");var r=this.getKey(e,t);return this.data[r]||this.keys.push(r),this.data[r]=n,r},r.prototype.reset=function(){for(var e=this.data,t=this.keys,n=t.length;n--;)delete e[t[n]];t.length=0},r.prototype.copy=function(e){this.reset(),i.appendArray(this.keys,e.keys);for(var t=e.keys.length;t--;){var n=e.keys[t];this.data[n]=e.data[n]}}},{"./Utils":57}],57:[function(e,t,n){function r(){}t.exports=r,r.appendArray=function(e,t){if(t.length<15e4)e.push.apply(e,t);else for(var n=0,r=t.length;n!==r;++n)e.push(t[n])},r.splice=function(e,t,n){n=n||1;for(var r=t,i=e.length-n;i>r;r++)e[r]=e[r+n];e.length=i},"undefined"!=typeof P2_ARRAY_TYPE?r.ARRAY_TYPE=P2_ARRAY_TYPE:"undefined"!=typeof Float32Array?r.ARRAY_TYPE=Float32Array:r.ARRAY_TYPE=Array,r.extend=function(e,t){for(var n in t)e[n]=t[n]},r.defaults=function(e,t){e=e||{};for(var n in t)n in e||(e[n]=t[n]);return e}},{}],58:[function(e,t,n){function r(){this.equations=[],this.bodies=[]}var i=e("../objects/Body");t.exports=r,r.prototype.reset=function(){this.equations.length=this.bodies.length=0};var s=[];r.prototype.getBodies=function(e){var t=e||[],n=this.equations;s.length=0;for(var r=0;r!==n.length;r++){var i=n[r];-1===s.indexOf(i.bodyA.id)&&(t.push(i.bodyA),s.push(i.bodyA.id)),-1===s.indexOf(i.bodyB.id)&&(t.push(i.bodyB),s.push(i.bodyB.id))}return t},r.prototype.wantsToSleep=function(){for(var e=0;e<this.bodies.length;e++){var t=this.bodies[e];if(t.type===i.DYNAMIC&&!t.wantsToSleep)return!1}return!0},r.prototype.sleep=function(){for(var e=0;e<this.bodies.length;e++){var t=this.bodies[e];t.sleep()}return!0}},{"../objects/Body":31}],59:[function(e,t,n){function r(e){this.nodePool=new i({size:16}),this.islandPool=new s({size:8}),this.equations=[],this.islands=[],this.nodes=[],this.queue=[]}var i=(e("../math/vec2"),e("./Island"),e("./IslandNode"),e("./../utils/IslandNodePool")),s=e("./../utils/IslandPool"),o=e("../objects/Body");t.exports=r,r.getUnvisitedNode=function(e){for(var t=e.length,n=0;n!==t;n++){var r=e[n];if(!r.visited&&r.body.type===o.DYNAMIC)return r}return!1},r.prototype.visit=function(e,t,n){t.push(e.body);for(var r=e.equations.length,i=0;i!==r;i++){var s=e.equations[i];-1===n.indexOf(s)&&n.push(s)}},r.prototype.bfs=function(e,t,n){var i=this.queue;for(i.length=0,i.push(e),e.visited=!0,this.visit(e,t,n);i.length;)for(var s,u=i.pop();s=r.getUnvisitedNode(u.neighbors);)s.visited=!0,this.visit(s,t,n),s.body.type===o.DYNAMIC&&i.push(s)},r.prototype.split=function(e){for(var t=e.bodies,n=this.nodes,i=this.equations;n.length;)this.nodePool.release(n.pop());for(var s=0;s!==t.length;s++){var o=this.nodePool.get();o.body=t[s],n.push(o)}for(var u=0;u!==i.length;u++){var a=i[u],s=t.indexOf(a.bodyA),f=t.indexOf(a.bodyB),l=n[s],c=n[f];l.neighbors.push(c),c.neighbors.push(l),l.equations.push(a),c.equations.push(a)}for(var h=this.islands,s=0;s<h.length;s++)this.islandPool.release(h[s]);h.length=0;for(var p;p=r.getUnvisitedNode(n);){var v=this.islandPool.get();this.bfs(p,v.bodies,v.equations),h.push(v)}return h}},{"../math/vec2":30,"../objects/Body":31,"./../utils/IslandNodePool":50,"./../utils/IslandPool":51,"./Island":58,"./IslandNode":60}],60:[function(e,t,n){function r(e){this.body=e,this.neighbors=[],this.equations=[],this.visited=!1}t.exports=r,r.prototype.reset=function(){this.equations.length=0,this.neighbors.length=0,this.visited=!1,this.body=null}},{}],61:[function(e,t,n){function r(e){c.apply(this),e=e||{},this.springs=[],this.bodies=[],this.disabledBodyCollisionPairs=[],this.solver=e.solver||new i,this.narrowphase=new g(this),this.islandManager=new w,this.gravity=s.fromValues(0,-9.78),e.gravity&&s.copy(this.gravity,e.gravity),this.frictionGravity=s.length(this.gravity)||10,this.useWorldGravityAsFrictionGravity=!0,this.useFrictionGravityOnZeroGravity=!0,this.broadphase=e.broadphase||new m,this.broadphase.setWorld(this),this.constraints=[],this.defaultMaterial=new p,this.defaultContactMaterial=new d(this.defaultMaterial,this.defaultMaterial),this.lastTimeStep=1/60,this.applySpringForces=!0,this.applyDamping=!0,this.applyGravity=!0,this.solveConstraints=!0,this.contactMaterials=[],this.time=0,this.accumulator=0,this.stepping=!1,this.bodiesToBeRemoved=[],this.islandSplit="undefined"!=typeof e.islandSplit?!!e.islandSplit:!0,this.emitImpactEvent=!0,this._constraintIdCounter=0,this._bodyIdCounter=0,this.postStepEvent={type:"postStep"},this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null},this.addSpringEvent={type:"addSpring",spring:null},this.impactEvent={type:"impact",bodyA:null,bodyB:null,shapeA:null,shapeB:null,contactEquation:null},this.postBroadphaseEvent={type:"postBroadphase",pairs:null},this.sleepMode=r.NO_SLEEPING,this.beginContactEvent={type:"beginContact",shapeA:null,shapeB:null,bodyA:null,bodyB:null,contactEquations:[]},this.endContactEvent={type:"endContact",shapeA:null,shapeB:null,bodyA:null,bodyB:null},this.preSolveEvent={type:"preSolve",contactEquations:null,frictionEquations:null},this.overlappingShapesLastState={keys:[]},this.overlappingShapesCurrentState={keys:[]},this.overlapKeeper=new b}var i=e("../solver/GSSolver"),s=(e("../solver/Solver"),e("../collision/Ray"),e("../math/vec2")),o=e("../shapes/Circle"),u=e("../shapes/Convex"),a=(e("../shapes/Line"),e("../shapes/Plane")),f=e("../shapes/Capsule"),l=e("../shapes/Particle"),c=e("../events/EventEmitter"),h=e("../objects/Body"),p=(e("../shapes/Shape"),e("../objects/LinearSpring"),e("../material/Material")),d=e("../material/ContactMaterial"),v=(e("../constraints/DistanceConstraint"),e("../constraints/Constraint"),e("../constraints/LockConstraint"),e("../constraints/RevoluteConstraint"),e("../constraints/PrismaticConstraint"),e("../constraints/GearConstraint"),e("../../package.json"),e("../collision/Broadphase"),e("../collision/AABB")),m=e("../collision/SAPBroadphase"),g=e("../collision/Narrowphase"),y=e("../utils/Utils"),b=e("../utils/OverlapKeeper"),w=e("./IslandManager");e("../objects/RotationalSpring"),t.exports=r,r.prototype=new Object(c.prototype),r.prototype.constructor=r,r.NO_SLEEPING=1,r.BODY_SLEEPING=2,r.ISLAND_SLEEPING=4,r.prototype.addConstraint=function(e){this.constraints.push(e)},r.prototype.addContactMaterial=function(e){this.contactMaterials.push(e)},r.prototype.removeContactMaterial=function(e){var t=this.contactMaterials.indexOf(e);-1!==t&&y.splice(this.contactMaterials,t,1)},r.prototype.getContactMaterial=function(e,t){for(var n=this.contactMaterials,r=0,i=n.length;r!==i;r++){var s=n[r];if(s.materialA.id===e.id&&s.materialB.id===t.id||s.materialA.id===t.id&&s.materialB.id===e.id)return s}return!1},r.prototype.removeConstraint=function(e){var t=this.constraints.indexOf(e);-1!==t&&y.splice(this.constraints,t,1)};var E=(s.create(),s.create(),s.create(),s.create(),s.create(),s.create(),s.create()),S=s.fromValues(0,0),x=s.fromValues(0,0);s.fromValues(0,0),s.fromValues(0,0),r.prototype.step=function(e,t,n){if(n=n||10,t=t||0,0===t)this.internalStep(e),this.time+=e;else{this.accumulator+=t;for(var r=0;this.accumulator>=e&&n>r;)this.internalStep(e),this.time+=e,this.accumulator-=e,r++;for(var i=this.accumulator%e/e,o=0;o!==this.bodies.length;o++){var u=this.bodies[o];s.lerp(u.interpolatedPosition,u.previousPosition,u.position,i),u.interpolatedAngle=u.previousAngle+i*(u.angle-u.previousAngle)}}};var T=[];r.prototype.internalStep=function(e){this.stepping=!0;var t=this.springs.length,n=this.springs,i=this.bodies,o=this.gravity,u=this.solver,a=this.bodies.length,f=this.broadphase,l=this.narrowphase,c=this.constraints,p=E,d=(s.scale,s.add),v=(s.rotate,this.islandManager);if(this.overlapKeeper.tick(),this.lastTimeStep=e,this.useWorldGravityAsFrictionGravity){var m=s.length(this.gravity);0===m&&this.useFrictionGravityOnZeroGravity||(this.frictionGravity=m)}if(this.applyGravity)for(var g=0;g!==a;g++){var b=i[g],w=b.force;b.type===h.DYNAMIC&&b.sleepState!==h.SLEEPING&&(s.scale(p,o,b.mass*b.gravityScale),d(w,w,p))}if(this.applySpringForces)for(var g=0;g!==t;g++){var S=n[g];S.applyForce()}if(this.applyDamping)for(var g=0;g!==a;g++){var b=i[g];b.type===h.DYNAMIC&&b.applyDamping(e)}for(var x=f.getCollisionPairs(this),N=this.disabledBodyCollisionPairs,g=N.length-2;g>=0;g-=2)for(var C=x.length-2;C>=0;C-=2)(N[g]===x[C]&&N[g+1]===x[C+1]||N[g+1]===x[C]&&N[g]===x[C+1])&&x.splice(C,2);var k=c.length;for(g=0;g!==k;g++){var L=c[g];if(!L.collideConnected)for(var C=x.length-2;C>=0;C-=2)(L.bodyA===x[C]&&L.bodyB===x[C+1]||L.bodyB===x[C]&&L.bodyA===x[C+1])&&x.splice(C,2)}this.postBroadphaseEvent.pairs=x,this.emit(this.postBroadphaseEvent),this.postBroadphaseEvent.pairs=null,l.reset(this);for(var g=0,A=x.length;g!==A;g+=2)for(var O=x[g],M=x[g+1],_=0,D=O.shapes.length;_!==D;_++)for(var P=O.shapes[_],H=P.position,B=P.angle,j=0,F=M.shapes.length;j!==F;j++){var I=M.shapes[j],q=I.position,R=I.angle,U=this.defaultContactMaterial;if(P.material&&I.material){var z=this.getContactMaterial(P.material,I.material);z&&(U=z)}this.runNarrowphase(l,O,P,H,B,M,I,q,R,U,this.frictionGravity)}for(var g=0;g!==a;g++){var W=i[g];W._wakeUpAfterNarrowphase&&(W.wakeUp(),W._wakeUpAfterNarrowphase=!1)}if(this.has("endContact")){this.overlapKeeper.getEndOverlaps(T);for(var X=this.endContactEvent,j=T.length;j--;){var V=T[j];X.shapeA=V.shapeA,X.shapeB=V.shapeB,X.bodyA=V.bodyA,X.bodyB=V.bodyB,this.emit(X)}T.length=0}var $=this.preSolveEvent;$.contactEquations=l.contactEquations,$.frictionEquations=l.frictionEquations,this.emit($),$.contactEquations=$.frictionEquations=null;var k=c.length;for(g=0;g!==k;g++)c[g].update();if(l.contactEquations.length||l.frictionEquations.length||k)if(this.islandSplit){for(v.equations.length=0,y.appendArray(v.equations,l.contactEquations),y.appendArray(v.equations,l.frictionEquations),g=0;g!==k;g++)y.appendArray(v.equations,c[g].equations);v.split(this);for(var g=0;g!==v.islands.length;g++){var J=v.islands[g];J.equations.length&&u.solveIsland(e,J)}}else{for(u.addEquations(l.contactEquations),u.addEquations(l.frictionEquations),g=0;g!==k;g++)u.addEquations(c[g].equations);this.solveConstraints&&u.solve(e,this),u.removeAllEquations()}for(var g=0;g!==a;g++){var W=i[g];W.integrate(e)}for(var g=0;g!==a;g++)i[g].setZeroForce();if(this.emitImpactEvent&&this.has("impact"))for(var K=this.impactEvent,g=0;g!==l.contactEquations.length;g++){var Q=l.contactEquations[g];Q.firstImpact&&(K.bodyA=Q.bodyA,K.bodyB=Q.bodyB,K.shapeA=Q.shapeA,K.shapeB=Q.shapeB,K.contactEquation=Q,this.emit(K))}if(this.sleepMode===r.BODY_SLEEPING)for(g=0;g!==a;g++)i[g].sleepTick(this.time,!1,e);else if(this.sleepMode===r.ISLAND_SLEEPING&&this.islandSplit){for(g=0;g!==a;g++)i[g].sleepTick(this.time,!0,e);for(var g=0;g<this.islandManager.islands.length;g++){var J=this.islandManager.islands[g];J.wantsToSleep()&&J.sleep()}}this.stepping=!1;for(var G=this.bodiesToBeRemoved,g=0;g!==G.length;g++)this.removeBody(G[g]);G.length=0,this.emit(this.postStepEvent)},r.prototype.runNarrowphase=function(e,t,n,r,i,o,u,a,f,l,c){if(0!==(n.collisionGroup&u.collisionMask)&&0!==(u.collisionGroup&n.collisionMask)){s.rotate(S,r,t.angle),s.rotate(x,a,o.angle),s.add(S,S,t.position),s.add(x,x,o.position);var p=i+t.angle,d=f+o.angle;e.enableFriction=l.friction>0,e.frictionCoefficient=l.friction;var v;v=t.type===h.STATIC||t.type===h.KINEMATIC?o.mass:o.type===h.STATIC||o.type===h.KINEMATIC?t.mass:t.mass*o.mass/(t.mass+o.mass),e.slipForce=l.friction*c*v,e.restitution=l.restitution,e.surfaceVelocity=l.surfaceVelocity,e.frictionStiffness=l.frictionStiffness,e.frictionRelaxation=l.frictionRelaxation,e.stiffness=l.stiffness,e.relaxation=l.relaxation,e.contactSkinSize=l.contactSkinSize,e.enabledEquations=t.collisionResponse&&o.collisionResponse&&n.collisionResponse&&u.collisionResponse;var m=e[n.type|u.type],g=0;if(m){var y=n.sensor||u.sensor,b=e.frictionEquations.length;g=n.type<u.type?m.call(e,t,n,S,p,o,u,x,d,y):m.call(e,o,u,x,d,t,n,S,p,y);var w=e.frictionEquations.length-b;if(g){if(t.allowSleep&&t.type===h.DYNAMIC&&t.sleepState===h.SLEEPING&&o.sleepState===h.AWAKE&&o.type!==h.STATIC){var E=s.squaredLength(o.velocity)+Math.pow(o.angularVelocity,2),T=Math.pow(o.sleepSpeedLimit,2);E>=2*T&&(t._wakeUpAfterNarrowphase=!0)}if(o.allowSleep&&o.type===h.DYNAMIC&&o.sleepState===h.SLEEPING&&t.sleepState===h.AWAKE&&t.type!==h.STATIC){var N=s.squaredLength(t.velocity)+Math.pow(t.angularVelocity,2),C=Math.pow(t.sleepSpeedLimit,2);N>=2*C&&(o._wakeUpAfterNarrowphase=!0)}if(this.overlapKeeper.setOverlapping(t,n,o,u),this.has("beginContact")&&this.overlapKeeper.isNewOverlap(n,u)){var k=this.beginContactEvent;if(k.shapeA=n,k.shapeB=u,k.bodyA=t,k.bodyB=o,k.contactEquations.length=0,"number"==typeof g)for(var L=e.contactEquations.length-g;L<e.contactEquations.length;L++)k.contactEquations.push(e.contactEquations[L]);this.emit(k)}if("number"==typeof g&&w>1)for(var L=e.frictionEquations.length-w;L<e.frictionEquations.length;L++){var A=e.frictionEquations[L];A.setSlipForce(A.getSlipForce()/w)}}}}},r.prototype.addSpring=function(e){this.springs.push(e);var t=this.addSpringEvent;t.spring=e,this.emit(t),t.spring=null},r.prototype.removeSpring=function(e){var t=this.springs.indexOf(e);-1!==t&&y.splice(this.springs,t,1)},r.prototype.addBody=function(e){if(-1===this.bodies.indexOf(e)){this.bodies.push(e),e.world=this;var t=this.addBodyEvent;t.body=e,this.emit(t),t.body=null}},r.prototype.removeBody=function(e){if(this.stepping)this.bodiesToBeRemoved.push(e);else{e.world=null;var t=this.bodies.indexOf(e);-1!==t&&(y.splice(this.bodies,t,1),this.removeBodyEvent.body=e,e.resetConstraintVelocity(),this.emit(this.removeBodyEvent),this.removeBodyEvent.body=null)}},r.prototype.getBodyById=function(e){for(var t=this.bodies,n=0;n<t.length;n++){var r=t[n];if(r.id===e)return r}return!1},r.prototype.disableBodyCollision=function(e,t){this.disabledBodyCollisionPairs.push(e,t)},r.prototype.enableBodyCollision=function(e,t){for(var n=this.disabledBodyCollisionPairs,r=0;r<n.length;r+=2)if(n[r]===e&&n[r+1]===t||n[r+1]===e&&n[r]===t)return void n.splice(r,2)},r.prototype.clear=function(){this.time=0,this.solver&&this.solver.equations.length&&this.solver.removeAllEquations();for(var e=this.constraints,t=e.length-1;t>=0;t--)this.removeConstraint(e[t]);for(var n=this.bodies,t=n.length-1;t>=0;t--)this.removeBody(n[t]);for(var i=this.springs,t=i.length-1;t>=0;t--)this.removeSpring(i[t]);for(var s=this.contactMaterials,t=s.length-1;t>=0;t--)this.removeContactMaterial(s[t]);r.apply(this)};var N=s.create(),C=(s.fromValues(0,0),s.fromValues(0,0));r.prototype.hitTest=function(e,t,n){n=n||0;var r=new h({position:e}),i=new l,c=e,p=0,d=N,v=C;r.addShape(i);for(var m=this.narrowphase,g=[],y=0,b=t.length;y!==b;y++)for(var w=t[y],E=0,S=w.shapes.length;E!==S;E++){var x=w.shapes[E];s.rotate(d,x.position,w.angle),s.add(d,d,w.position);var T=x.angle+w.angle;(x instanceof o&&m.circleParticle(w,x,d,T,r,i,c,p,!0)||x instanceof u&&m.particleConvex(r,i,c,p,w,x,d,T,!0)||x instanceof a&&m.particlePlane(r,i,c,p,w,x,d,T,!0)||x instanceof f&&m.particleCapsule(r,i,c,p,w,x,d,T,!0)||x instanceof l&&s.squaredLength(s.sub(v,d,e))<n*n)&&g.push(w)}return g},r.prototype.setGlobalStiffness=function(e){for(var t=this.constraints,n=0;n!==t.length;n++)for(var r=t[n],i=0;i!==r.equations.length;i++){var s=r.equations[i];s.stiffness=e,s.needsUpdate=!0}for(var o=this.contactMaterials,n=0;n!==o.length;n++){var r=o[n];r.stiffness=r.frictionStiffness=e}var r=this.defaultContactMaterial;r.stiffness=r.frictionStiffness=e},r.prototype.setGlobalRelaxation=function(e){for(var t=0;t!==this.constraints.length;t++)for(var n=this.constraints[t],r=0;r!==n.equations.length;r++){var i=n.equations[r];i.relaxation=e,i.needsUpdate=!0}for(var t=0;t!==this.contactMaterials.length;t++){var n=this.contactMaterials[t];n.relaxation=n.frictionRelaxation=e}var n=this.defaultContactMaterial;n.relaxation=n.frictionRelaxation=e};var k=new v,L=[];r.prototype.raycast=function(e,t){return t.getAABB(k),this.broadphase.aabbQuery(this,k,L),t.intersectBodies(e,L),L.length=0,e.hasHit()}},{"../../package.json":6,"../collision/AABB":7,"../collision/Broadphase":8,"../collision/Narrowphase":10,"../collision/Ray":11,"../collision/SAPBroadphase":13,"../constraints/Constraint":14,"../constraints/DistanceConstraint":15,"../constraints/GearConstraint":16,"../constraints/LockConstraint":17,"../constraints/PrismaticConstraint":18,"../constraints/RevoluteConstraint":19,"../events/EventEmitter":26,"../material/ContactMaterial":27,"../material/Material":28,"../math/vec2":30,"../objects/Body":31,"../objects/LinearSpring":32,"../objects/RotationalSpring":33,"../shapes/Capsule":38,"../shapes/Circle":39,"../shapes/Convex":40,"../shapes/Line":42,"../shapes/Particle":43,"../shapes/Plane":44,"../shapes/Shape":45,"../solver/GSSolver":46,"../solver/Solver":47,"../utils/OverlapKeeper":52,"../utils/Utils":57,"./IslandManager":59}]},{},[36])(36)}),function(){var e=this,t=t||{};return t.game=null,t.WEBGL_RENDERER=0,t.CANVAS_RENDERER=1,t.VERSION="v2.2.9",t._UID=0,"undefined"!=typeof Float32Array?(t.Float32Array=Float32Array,t.Uint16Array=Uint16Array,t.Uint32Array=Uint32Array,t.ArrayBuffer=ArrayBuffer):(t.Float32Array=Array,t.Uint16Array=Array),t.PI_2=2*Math.PI,t.RAD_TO_DEG=180/Math.PI,t.DEG_TO_RAD=Math.PI/180,t.RETINA_PREFIX="@2x",t.DisplayObject=function(){this.position=new t.Point(0,0),this.scale=new t.Point(1,1),this.pivot=new t.Point(0,0),this.rotation=0,this.alpha=1,this.visible=!0,this.hitArea=null,this.renderable=!1,this.parent=null,this.stage=null,this.worldAlpha=1,this.worldTransform=new t.Matrix,this.worldPosition=new t.Point(0,0),this.worldScale=new t.Point(1,1),this.worldRotation=0,this._sr=0,this._cr=1,this.filterArea=null,this._bounds=new t.Rectangle(0,0,1,1),this._currentBounds=null,this._mask=null,this._cacheAsBitmap=!1,this._cacheIsDirty=!1},t.DisplayObject.prototype.constructor=t.DisplayObject,t.DisplayObject.prototype.destroy=function(){if(this.children){for(var e=this.children.length;e--;)this.children[e].destroy();this.children=[]}this.hitArea=null,this.parent=null,this.stage=null,this.worldTransform=null,this.filterArea=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.renderable=!1,this._destroyCachedSprite()},Object.defineProperty(t.DisplayObject.prototype,"worldVisible",{get:function(){var e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}}),Object.defineProperty(t.DisplayObject.prototype,"mask",{get:function(){return this._mask},set:function(e){this._mask&&(this._mask.isMask=!1),this._mask=e,this._mask&&(this._mask.isMask=!0)}}),Object.defineProperty(t.DisplayObject.prototype,"filters",{get:function(){return this._filters},set:function(e){if(e){for(var n=[],r=0;r<e.length;r++)for(var i=e[r].passes,s=0;s<i.length;s++)n.push(i[s]);this._filterBlock={target:this,filterPasses:n}}this._filters=e,this.blendMode&&this.blendMode===t.blendModes.MULTIPLY&&(this.blendMode=t.blendModes.NORMAL)}}),Object.defineProperty(t.DisplayObject.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(e){this._cacheAsBitmap!==e&&(e?this._generateCachedSprite():this._destroyCachedSprite(),this._cacheAsBitmap=e)}}),t.DisplayObject.prototype.updateTransform=function(e){if(e||this.parent||this.game){var n=this.parent;e?n=e:this.parent||(n=this.game.world);var r,i,s,o,u,a,f=n.worldTransform,l=this.worldTransform;this.rotation%t.PI_2?(this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation)),r=this._cr*this.scale.x,i=this._sr*this.scale.x,s=-this._sr*this.scale.y,o=this._cr*this.scale.y,u=this.position.x,a=this.position.y,(this.pivot.x||this.pivot.y)&&(u-=this.pivot.x*r+this.pivot.y*s,a-=this.pivot.x*i+this.pivot.y*o),l.a=r*f.a+i*f.c,l.b=r*f.b+i*f.d,l.c=s*f.a+o*f.c,l.d=s*f.b+o*f.d,l.tx=u*f.a+a*f.c+f.tx,l.ty=u*f.b+a*f.d+f.ty):(r=this.scale.x,o=this.scale.y,u=this.position.x-this.pivot.x*r,a=this.position.y-this.pivot.y*o,l.a=r*f.a,l.b=r*f.b,l.c=o*f.c,l.d=o*f.d,l.tx=u*f.a+a*f.c+f.tx,l.ty=u*f.b+a*f.d+f.ty),this.worldAlpha=this.alpha*n.worldAlpha,this.worldPosition.set(l.tx,l.ty),this.worldScale.set(l.a,l.d),this.worldRotation=Math.atan2(l.c,l.d),this._currentBounds=null,this.transformCallback&&this.transformCallback.call(this.transformCallbackContext,l,f)}},t.DisplayObject.prototype.displayObjectUpdateTransform=t.DisplayObject.prototype.updateTransform,t.DisplayObject.prototype.getBounds=function(e){return e=e,t.EmptyRectangle},t.DisplayObject.prototype.getLocalBounds=function(){return this.getBounds(t.identityMatrix)},t.DisplayObject.prototype.setStageReference=function(e){this.stage=e},t.DisplayObject.prototype.preUpdate=function(){},t.DisplayObject.prototype.generateTexture=function(e,n,r){var i=this.getLocalBounds(),s=new t.RenderTexture(0|i.width,0|i.height,r,n,e);return t.DisplayObject._tempMatrix.tx=-i.x,t.DisplayObject._tempMatrix.ty=-i.y,s.render(this,t.DisplayObject._tempMatrix),s},t.DisplayObject.prototype.updateCache=function(){this._generateCachedSprite()},t.DisplayObject.prototype.toGlobal=function(e){return this.displayObjectUpdateTransform(),this.worldTransform.apply(e)},t.DisplayObject.prototype.toLocal=function(e,t){return t&&(e=t.toGlobal(e)),this.displayObjectUpdateTransform(),this.worldTransform.applyInverse(e)},t.DisplayObject.prototype._renderCachedSprite=function(e){this._cachedSprite.worldAlpha=this.worldAlpha,e.gl?t.Sprite.prototype._renderWebGL.call(this._cachedSprite,e):t.Sprite.prototype._renderCanvas.call(this._cachedSprite,e)},t.DisplayObject.prototype._generateCachedSprite=function(){this._cacheAsBitmap=!1;var e=this.getLocalBounds();if(e.width=Math.max(1,Math.ceil(e.width)),e.height=Math.max(1,Math.ceil(e.height)),this.updateTransform(),this._cachedSprite)this._cachedSprite.texture.resize(e.width,e.height);else{var n=new t.RenderTexture(e.width,e.height);this._cachedSprite=new t.Sprite(n),this._cachedSprite.worldTransform=this.worldTransform}var r=this._filters;this._filters=null,this._cachedSprite.filters=r,t.DisplayObject._tempMatrix.tx=-e.x,t.DisplayObject._tempMatrix.ty=-e.y,this._cachedSprite.texture.render(this,t.DisplayObject._tempMatrix,!0),this._cachedSprite.anchor.x=-(e.x/e.width),this._cachedSprite.anchor.y=-(e.y/e.height),this._filters=r,this._cacheAsBitmap=!0},t.DisplayObject.prototype._destroyCachedSprite=function(){this._cachedSprite&&(this._cachedSprite.texture.destroy(!0),this._cachedSprite=null)},t.DisplayObject.prototype._renderWebGL=function(e){e=e},t.DisplayObject.prototype._renderCanvas=function(e){e=e},Object.defineProperty(t.DisplayObject.prototype,"x",{get:function(){return this.position.x},set:function(e){this.position.x=e}}),Object.defineProperty(t.DisplayObject.prototype,"y",{get:function(){return this.position.y},set:function(e){this.position.y=e}}),t.DisplayObjectContainer=function(){t.DisplayObject.call(this),this.children=[]},t.DisplayObjectContainer.prototype=Object.create(t.DisplayObject.prototype),t.DisplayObjectContainer.prototype.constructor=t.DisplayObjectContainer,Object.defineProperty(t.DisplayObjectContainer.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(e){var t=this.getLocalBounds().width;0!==t?this.scale.x=e/t:this.scale.x=1,this._width=e}}),Object.defineProperty(t.DisplayObjectContainer.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(e){var t=this.getLocalBounds().height;0!==t?this.scale.y=e/t:this.scale.y=1,this._height=e}}),t.DisplayObjectContainer.prototype.addChild=function(e){return this.addChildAt(e,this.children.length)},t.DisplayObjectContainer.prototype.addChildAt=function(e,t){if(t>=0&&t<=this.children.length)return e.parent&&e.parent.removeChild(e),e.parent=this,this.children.splice(t,0,e),this.stage&&e.setStageReference(this.stage),e;throw new Error(e+"addChildAt: The index "+t+" supplied is out of bounds "+this.children.length)},t.DisplayObjectContainer.prototype.swapChildren=function(e,t){if(e!==t){var n=this.getChildIndex(e),r=this.getChildIndex(t);if(0>n||0>r)throw new Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.");this.children[n]=t,this.children[r]=e}},t.DisplayObjectContainer.prototype.getChildIndex=function(e){var t=this.children.indexOf(e);if(-1===t)throw new Error("The supplied DisplayObject must be a child of the caller");return t},t.DisplayObjectContainer.prototype.setChildIndex=function(e,t){if(0>t||t>=this.children.length)throw new Error("The supplied index is out of bounds");var n=this.getChildIndex(e);this.children.splice(n,1),this.children.splice(t,0,e)},t.DisplayObjectContainer.prototype.getChildAt=function(e){if(0>e||e>=this.children.length)throw new Error("getChildAt: Supplied index "+e+" does not exist in the child list, or the supplied DisplayObject must be a child of the caller");return this.children[e]},t.DisplayObjectContainer.prototype.removeChild=function(e){var t=this.children.indexOf(e);if(-1!==t)return this.removeChildAt(t)},t.DisplayObjectContainer.prototype.removeChildAt=function(e){var t=this.getChildAt(e);return this.stage&&t.removeStageReference(),t.parent=void 0,this.children.splice(e,1),t},t.DisplayObjectContainer.prototype.removeChildren=function(e,t){var n=e||0,r="number"==typeof t?t:this.children.length,i=r-n;if(i>0&&r>=i){for(var s=this.children.splice(n,i),o=0;o<s.length;o++){var u=s[o];this.stage&&u.removeStageReference(),u.parent=void 0}return s}if(0===i&&0===this.children.length)return[];throw new Error("removeChildren: Range Error, numeric values are outside the acceptable range")},t.DisplayObjectContainer.prototype.updateTransform=function(){if(this.visible&&(this.displayObjectUpdateTransform(),!this._cacheAsBitmap))for(var e=0;e<this.children.length;e++)this.children[e].updateTransform()},t.DisplayObjectContainer.prototype.displayObjectContainerUpdateTransform=t.DisplayObjectContainer.prototype.updateTransform,t.DisplayObjectContainer.prototype.getBounds=function(){if(0===this.children.length)return t.EmptyRectangle;for(var e,n,r,i=1/0,s=1/0,o=-1/0,u=-1/0,a=!1,f=0;f<this.children.length;f++){var l=this.children[f];l.visible&&(a=!0,e=this.children[f].getBounds(),i=i<e.x?i:e.x,s=s<e.y?s:e.y,n=e.width+e.x,r=e.height+e.y,o=o>n?o:n,u=u>r?u:r)}if(!a)return t.EmptyRectangle;var c=this._bounds;return c.x=i,c.y=s,c.width=o-i,c.height=u-s,c},t.DisplayObjectContainer.prototype.getLocalBounds=function(){var e=this.worldTransform;this.worldTransform=t.identityMatrix;for(var n=0;n<this.children.length;n++)this.children[n].updateTransform();var r=this.getBounds();for(this.worldTransform=e,n=0;n<this.children.length;n++)this.children[n].updateTransform();return r},t.DisplayObjectContainer.prototype.setStageReference=function(e){this.stage=e;for(var t=0;t<this.children.length;t++)this.children[t].setStageReference(e)},t.DisplayObjectContainer.prototype.removeStageReference=function(){for(var e=0;e<this.children.length;e++)this.children[e].removeStageReference();this.stage=null},t.DisplayObjectContainer.prototype._renderWebGL=function(e){if(this.visible&&!(this.alpha<=0)){if(this._cacheAsBitmap)return void this._renderCachedSprite(e);var t;if(this._mask||this._filters){for(this._filters&&(e.spriteBatch.flush(),e.filterManager.pushFilter(this._filterBlock)),this._mask&&(e.spriteBatch.stop(),e.maskManager.pushMask(this.mask,e),e.spriteBatch.start()),t=0;t<this.children.length;t++)this.children[t]._renderWebGL(e);e.spriteBatch.stop(),this._mask&&e.maskManager.popMask(this._mask,e),this._filters&&e.filterManager.popFilter(),e.spriteBatch.start()}else for(t=0;t<this.children.length;t++)this.children[t]._renderWebGL(e)}},t.DisplayObjectContainer.prototype._renderCanvas=function(e){if(this.visible!==!1&&0!==this.alpha){if(this._cacheAsBitmap)return void this._renderCachedSprite(e);this._mask&&e.maskManager.pushMask(this._mask,e);for(var t=0;t<this.children.length;t++)this.children[t]._renderCanvas(e);this._mask&&e.maskManager.popMask(e)}},t.Sprite=function(e){t.DisplayObjectContainer.call(this),this.anchor=new t.Point,this.texture=e||t.Texture.emptyTexture,this._width=0,this._height=0,this.tint=16777215,this.cachedTint=-1,this.tintedTexture=null,this.blendMode=t.blendModes.NORMAL,this.shader=null,this.texture.baseTexture.hasLoaded&&this.onTextureUpdate(),this.renderable=!0},t.Sprite.prototype=Object.create(t.DisplayObjectContainer.prototype),t.Sprite.prototype.constructor=t.Sprite,Object.defineProperty(t.Sprite.prototype,"width",{get:function(){return this.scale.x*this.texture.frame.width},set:function(e){this.scale.x=e/this.texture.frame.width,this._width=e}}),Object.defineProperty(t.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.frame.height},set:function(e){this.scale.y=e/this.texture.frame.height,this._height=e}}),t.Sprite.prototype.setTexture=function(e,t){void 0!==t&&this.texture.baseTexture.destroy(),this.texture.baseTexture.skipRender=!1,this.texture=e,this.texture.valid=!0,this.cachedTint=-1},t.Sprite.prototype.onTextureUpdate=function(){this._width&&(this.scale.x=this._width/this.texture.frame.width),this._height&&(this.scale.y=this._height/this.texture.frame.height)},t.Sprite.prototype.getBounds=function(e){var t=this.texture.frame.width,n=this.texture.frame.height,r=t*(1-this.anchor.x),i=t*-this.anchor.x,s=n*(1-this.anchor.y),o=n*-this.anchor.y,u=e||this.worldTransform,a=u.a,f=u.b,l=u.c,c=u.d,h=u.tx,p=u.ty,d=-1/0,v=-1/0,m=1/0,g=1/0;if(0===f&&0===l){if(0>a){a*=-1;var y=r;r=-i,i=-y}if(0>c){c*=-1;var y=s;s=-o,o=-y}m=a*i+h,d=a*r+h,g=c*o+p,v=c*s+p}else{var b=a*i+l*o+h,w=c*o+f*i+p,E=a*r+l*o+h,S=c*o+f*r+p,x=a*r+l*s+h,T=c*s+f*r+p,N=a*i+l*s+h,C=c*s+f*i+p;m=m>b?b:m,m=m>E?E:m,m=m>x?x:m,m=m>N?N:m,g=g>w?w:g,g=g>S?S:g,g=g>T?T:g,g=g>C?C:g,d=b>d?b:d,d=E>d?E:d,d=x>d?x:d,d=N>d?N:d,v=w>v?w:v,v=S>v?S:v,v=T>v?T:v,v=C>v?C:v}var k=this._bounds;return k.x=m,k.width=d-m,k.y=g,k.height=v-g,this._currentBounds=k,k},t.Sprite.prototype._renderWebGL=function(e,t){if(this.visible&&!(this.alpha<=0)&&this.renderable){var n=this.worldTransform;if(t&&(n=t),this._mask||this._filters){var r=e.spriteBatch;this._filters&&(r.flush(),e.filterManager.pushFilter(this._filterBlock)),this._mask&&(r.stop(),e.maskManager.pushMask(this.mask,e),r.start()),r.render(this);for(var i=0;i<this.children.length;i++)this.children[i]._renderWebGL(e);r.stop(),this._mask&&e.maskManager.popMask(this._mask,e),this._filters&&e.filterManager.popFilter(),r.start()}else{e.spriteBatch.render(this);for(var i=0;i<this.children.length;i++)this.children[i]._renderWebGL(e,n)}}},t.Sprite.prototype._renderCanvas=function(e,n){if(!(!this.visible||0===this.alpha||!this.renderable||this.texture.crop.width<=0||this.texture.crop.height<=0)){var r=this.worldTransform;if(n&&(r=n),this.blendMode!==e.currentBlendMode&&(e.currentBlendMode=this.blendMode,e.context.globalCompositeOperation=t.blendModesCanvas[e.currentBlendMode]),this._mask&&e.maskManager.pushMask(this._mask,e),this.texture.valid){var i=this.texture.baseTexture.resolution/e.resolution;e.context.globalAlpha=this.worldAlpha,e.smoothProperty&&e.scaleMode!==this.texture.baseTexture.scaleMode&&(e.scaleMode=this.texture.baseTexture.scaleMode,e.context[e.smoothProperty]=e.scaleMode===t.scaleModes.LINEAR);var s=this.texture.trim?this.texture.trim.x-this.anchor.x*this.texture.trim.width:this.anchor.x*-this.texture.frame.width,o=this.texture.trim?this.texture.trim.y-this.anchor.y*this.texture.trim.height:this.anchor.y*-this.texture.frame.height,u=r.tx*e.resolution+e.shakeX,a=r.ty*e.resolution+e.shakeY;e.roundPixels?(e.context.setTransform(r.a,r.b,r.c,r.d,0|u,0|a),s|=0,o|=0):e.context.setTransform(r.a,r.b,r.c,r.d,u,a);var f=this.texture.crop.width,l=this.texture.crop.height;if(s/=i,o/=i,16777215!==this.tint)(this.texture.requiresReTint||this.cachedTint!==this.tint)&&(this.tintedTexture=t.CanvasTinter.getTintedTexture(this,this.tint),this.cachedTint=this.tint,this.texture.requiresReTint=!1),e.context.drawImage(this.tintedTexture,0,0,f,l,s,o,f/i,l/i);else{var c=this.texture.crop.x,h=this.texture.crop.y;e.context.drawImage(this.texture.baseTexture.source,c,h,f,l,s,o,f/i,l/i)}}for(var p=0;p<this.children.length;p++)this.children[p]._renderCanvas(e);this._mask&&e.maskManager.popMask(e)}},t.Sprite.fromFrame=function(e){var n=t.TextureCache[e];if(!n)throw new Error('The frameId "'+e+'" does not exist in the texture cache'+this);return new t.Sprite(n)},t.Sprite.fromImage=function(e,n,r){var i=t.Texture.fromImage(e,n,r);return new t.Sprite(i)},t.SpriteBatch=function(e){t.DisplayObjectContainer.call(this),this.textureThing=e,this.ready=!1},t.SpriteBatch.prototype=Object.create(t.DisplayObjectContainer.prototype),t.SpriteBatch.prototype.constructor=t.SpriteBatch,t.SpriteBatch.prototype.initWebGL=function(e){this.fastSpriteBatch=new t.WebGLFastSpriteBatch(e),this.ready=!0},t.SpriteBatch.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},t.SpriteBatch.prototype._renderWebGL=function(e){!this.visible||this.alpha<=0||!this.children.length||(this.ready||this.initWebGL(e.gl),this.fastSpriteBatch.gl!==e.gl&&this.fastSpriteBatch.setContext(e.gl),e.spriteBatch.stop(),e.shaderManager.setShader(e.shaderManager.fastShader),this.fastSpriteBatch.begin(this,e),this.fastSpriteBatch.render(this),e.spriteBatch.start())},t.SpriteBatch.prototype._renderCanvas=function(e){if(this.visible&&!(this.alpha<=0)&&this.children.length){var t=e.context;t.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var n=this.worldTransform,r=!0,i=0;i<this.children.length;i++){var s=this.children[i];if(s.visible){var o=s.texture,u=o.frame;if(t.globalAlpha=this.worldAlpha*s.alpha,s.rotation%(2*Math.PI)===0)r&&(t.setTransform(n.a,n.b,n.c,n.d,n.tx,n.ty),r=!1),t.drawImage(o.baseTexture.source,u.x,u.y,u.width,u.height,s.anchor.x*-u.width*s.scale.x+s.position.x+.5+e.shakeX|0,s.anchor.y*-u.height*s.scale.y+s.position.y+.5+e.shakeY|0,u.width*s.scale.x,u.height*s.scale.y);else{r||(r=!0),s.displayObjectUpdateTransform();var a=s.worldTransform,f=a.tx*e.resolution+e.shakeX,l=a.ty*e.resolution+e.shakeY;e.roundPixels?t.setTransform(a.a,a.b,a.c,a.d,0|f,0|l):t.setTransform(a.a,a.b,a.c,a.d,f,l),t.drawImage(o.baseTexture.source,u.x,u.y,u.width,u.height,s.anchor.x*-u.width+.5|0,s.anchor.y*-u.height+.5|0,u.width,u.height)}}}}},t.hex2rgb=function(e){return[(e>>16&255)/255,(e>>8&255)/255,(255&e)/255]},t.rgb2hex=function(e){return(255*e[0]<<16)+(255*e[1]<<8)+255*e[2]},t.canUseNewCanvasBlendModes=function(){if(void 0===document)return!1;var e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/",n="AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==",r=new Image;r.src=e+"AP804Oa6"+n;var i=new Image;i.src=e+"/wCKxvRF"+n;var s=t.CanvasPool.create(this,6,1),o=s.getContext("2d");if(o.globalCompositeOperation="multiply",o.drawImage(r,0,0),o.drawImage(i,2,0),!o.getImageData(2,0,1,1))return!1;var u=o.getImageData(2,0,1,1).data;return t.CanvasPool.remove(this),255===u[0]&&0===u[1]&&0===u[2]},t.getNextPowerOfTwo=function(e){if(e>0&&0===(e&e-1))return e;for(var t=1;e>t;)t<<=1;return t},t.isPowerOfTwo=function(e,t){return e>0&&0===(e&e-1)&&t>0&&0===(t&t-1)},t.CanvasPool={create:function(e,n,r){var i,s=t.CanvasPool.getFirst();if(-1===s){var o={parent:e,canvas:document.createElement("canvas")};t.CanvasPool.pool.push(o),i=o.canvas}else t.CanvasPool.pool[s].parent=e,i=t.CanvasPool.pool[s].canvas;return void 0!==n&&(i.width=n,i.height=r),i},getFirst:function(){for(var e=t.CanvasPool.pool,n=0;n<e.length;n++)if(null===e[n].parent)return n;return-1},remove:function(e){for(var n=t.CanvasPool.pool,r=0;r<n.length;r++)n[r].parent===e&&(n[r].parent=null)},removeByCanvas:function(e){for(var n=t.CanvasPool.pool,r=0;r<n.length;r++)n[r].canvas===e&&(n[r].parent=null)},getTotal:function(){for(var e=t.CanvasPool.pool,n=0,r=0;r<e.length;r++)null!==e[r].parent&&n++;return n},getFree:function(){for(var e=t.CanvasPool.pool,n=0,r=0;r<e.length;r++)null===e[r].parent&&n++;return n}},t.CanvasPool.pool=[],t.initDefaultShaders=function(){},t.CompileVertexShader=function(e,n){return t._CompileShader(e,n,e.VERTEX_SHADER)},t.CompileFragmentShader=function(e,n){return t._CompileShader(e,n,e.FRAGMENT_SHADER)},t._CompileShader=function(e,t,n){var r=t;Array.isArray(t)&&(r=t.join("\n"));var i=e.createShader(n);return e.shaderSource(i,r),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS)?i:(window.console.log(e.getShaderInfoLog(i)),null)},t.compileProgram=function(e,n,r){var i=t.CompileFragmentShader(e,r),s=t.CompileVertexShader(e,n),o=e.createProgram();return e.attachShader(o,s),e.attachShader(o,i),e.linkProgram(o),e.getProgramParameter(o,e.LINK_STATUS)||(window.console.log(e.getProgramInfoLog(o)),window.console.log("Could not initialise shaders")),o},t.PixiShader=function(e){this._UID=t._UID++,this.gl=e,this.program=null,this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"],this.textureCount=0,this.firstRun=!0,this.dirty=!0,this.attributes=[],this.init()},t.PixiShader.prototype.constructor=t.PixiShader,t.PixiShader.prototype.init=function(){var e=this.gl,n=t.compileProgram(e,this.vertexSrc||t.PixiShader.defaultVertexSrc,this.fragmentSrc);e.useProgram(n),this.uSampler=e.getUniformLocation(n,"uSampler"),this.projectionVector=e.getUniformLocation(n,"projectionVector"),this.offsetVector=e.getUniformLocation(n,"offsetVector"),this.dimensions=e.getUniformLocation(n,"dimensions"),this.aVertexPosition=e.getAttribLocation(n,"aVertexPosition"),this.aTextureCoord=e.getAttribLocation(n,"aTextureCoord"),this.colorAttribute=e.getAttribLocation(n,"aColor"),-1===this.colorAttribute&&(this.colorAttribute=2),this.attributes=[this.aVertexPosition,this.aTextureCoord,this.colorAttribute];for(var r in this.uniforms)this.uniforms[r].uniformLocation=e.getUniformLocation(n,r);this.initUniforms(),this.program=n},t.PixiShader.prototype.initUniforms=function(){this.textureCount=1;var e,t=this.gl;for(var n in this.uniforms){e=this.uniforms[n];var r=e.type;"sampler2D"===r?(e._init=!1,null!==e.value&&this.initSampler2D(e)):"mat2"===r||"mat3"===r||"mat4"===r?(e.glMatrix=!0,e.glValueLength=1,"mat2"===r?e.glFunc=t.uniformMatrix2fv:"mat3"===r?e.glFunc=t.uniformMatrix3fv:"mat4"===r&&(e.glFunc=t.uniformMatrix4fv)):(e.glFunc=t["uniform"+r],"2f"===r||"2i"===r?e.glValueLength=2:"3f"===r||"3i"===r?e.glValueLength=3:"4f"===r||"4i"===r?e.glValueLength=4:e.glValueLength=1)}},t.PixiShader.prototype.initSampler2D=function(e){if(e.value&&e.value.baseTexture&&e.value.baseTexture.hasLoaded){var t=this.gl;if(t.activeTexture(t["TEXTURE"+this.textureCount]),t.bindTexture(t.TEXTURE_2D,e.value.baseTexture._glTextures[t.id]),e.textureData){var n=e.textureData,r=n.magFilter?n.magFilter:t.LINEAR,i=n.minFilter?n.minFilter:t.LINEAR,s=n.wrapS?n.wrapS:t.CLAMP_TO_EDGE,o=n.wrapT?n.wrapT:t.CLAMP_TO_EDGE,u=n.luminance?t.LUMINANCE:t.RGBA;if(n.repeat&&(s=t.REPEAT,o=t.REPEAT),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!!n.flipY),n.width){var a=n.width?n.width:512,f=n.height?n.height:2,l=n.border?n.border:0;t.texImage2D(t.TEXTURE_2D,0,u,a,f,l,u,t.UNSIGNED_BYTE,null)}else t.texImage2D(t.TEXTURE_2D,0,u,t.RGBA,t.UNSIGNED_BYTE,e.value.baseTexture.source);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,i),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,s),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,o)}t.uniform1i(e.uniformLocation,this.textureCount),e._init=!0,this.textureCount++}},t.PixiShader.prototype.syncUniforms=function(){this.textureCount=1;var e,n=this.gl;for(var r in this.uniforms)e=this.uniforms[r],1===e.glValueLength?e.glMatrix===!0?e.glFunc.call(n,e.uniformLocation,e.transpose,e.value):e.glFunc.call(n,e.uniformLocation,e.value):2===e.glValueLength?e.glFunc.call(n,e.uniformLocation,e.value.x,e.value.y):3===e.glValueLength?e.glFunc.call(n,e.uniformLocation,e.value.x,e.value.y,e.value.z):4===e.glValueLength?e.glFunc.call(n,e.uniformLocation,e.value.x,e.value.y,e.value.z,e.value.w):"sampler2D"===e.type&&(e._init?(n.activeTexture(n["TEXTURE"+this.textureCount]),e.value.baseTexture._dirty[n.id]?t.instances[n.id].updateTexture(e.value.baseTexture):n.bindTexture(n.TEXTURE_2D,e.value.baseTexture._glTextures[n.id]),n.uniform1i(e.uniformLocation,this.textureCount),this.textureCount++):this.initSampler2D(e))},t.PixiShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},t.PixiShader.defaultVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","varying vec4 vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = vec4(aColor.rgb * aColor.a, aColor.a);","}"],t.PixiFastShader=function(e){this._UID=t._UID++,this.gl=e,this.program=null,this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform mat3 uMatrix;","varying vec2 vTextureCoord;","varying float vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   vec2 v;","   vec2 sv = aVertexPosition * aScale;","   v.x = (sv.x) * cos(aRotation) - (sv.y) * sin(aRotation);","   v.y = (sv.x) * sin(aRotation) + (sv.y) * cos(aRotation);","   v = ( uMatrix * vec3(v + aPositionCoord , 1.0) ).xy ;","   gl_Position = vec4( ( v / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"],this.textureCount=0,this.init()},t.PixiFastShader.prototype.constructor=t.PixiFastShader,t.PixiFastShader.prototype.init=function(){var e=this.gl,n=t.compileProgram(e,this.vertexSrc,this.fragmentSrc);e.useProgram(n),this.uSampler=e.getUniformLocation(n,"uSampler"),this.projectionVector=e.getUniformLocation(n,"projectionVector"),this.offsetVector=e.getUniformLocation(n,"offsetVector"),this.dimensions=e.getUniformLocation(n,"dimensions"),this.uMatrix=e.getUniformLocation(n,"uMatrix"),this.aVertexPosition=e.getAttribLocation(n,"aVertexPosition"),this.aPositionCoord=e.getAttribLocation(n,"aPositionCoord"),this.aScale=e.getAttribLocation(n,"aScale"),this.aRotation=e.getAttribLocation(n,"aRotation"),this.aTextureCoord=e.getAttribLocation(n,"aTextureCoord"),this.colorAttribute=e.getAttribLocation(n,"aColor"),-1===this.colorAttribute&&(this.colorAttribute=2),this.attributes=[this.aVertexPosition,this.aPositionCoord,this.aScale,this.aRotation,this.aTextureCoord,this.colorAttribute],this.program=n},t.PixiFastShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},t.StripShader=function(e){this._UID=t._UID++,this.gl=e,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","uniform float alpha;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * alpha;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","}"],this.init()},t.StripShader.prototype.constructor=t.StripShader,t.StripShader.prototype.init=function(){var e=this.gl,n=t.compileProgram(e,this.vertexSrc,this.fragmentSrc);e.useProgram(n),this.uSampler=e.getUniformLocation(n,"uSampler"),this.projectionVector=e.getUniformLocation(n,"projectionVector"),this.offsetVector=e.getUniformLocation(n,"offsetVector"),this.colorAttribute=e.getAttribLocation(n,"aColor"),this.aVertexPosition=e.getAttribLocation(n,"aVertexPosition"),this.aTextureCoord=e.getAttribLocation(n,"aTextureCoord"),this.attributes=[this.aVertexPosition,this.aTextureCoord],this.translationMatrix=e.getUniformLocation(n,"translationMatrix"),this.alpha=e.getUniformLocation(n,"alpha"),this.program=n},t.StripShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attribute=null},t.PrimitiveShader=function(e){this._UID=t._UID++,this.gl=e,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform float alpha;","uniform float flipY;","uniform vec3 tint;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"],this.init()},t.PrimitiveShader.prototype.constructor=t.PrimitiveShader,t.PrimitiveShader.prototype.init=function(){var e=this.gl,n=t.compileProgram(e,this.vertexSrc,this.fragmentSrc);e.useProgram(n),this.projectionVector=e.getUniformLocation(n,"projectionVector"),this.offsetVector=e.getUniformLocation(n,"offsetVector"),this.tintColor=e.getUniformLocation(n,"tint"),this.flipY=e.getUniformLocation(n,"flipY"),this.aVertexPosition=e.getAttribLocation(n,"aVertexPosition"),this.colorAttribute=e.getAttribLocation(n,"aColor"),this.attributes=[this.aVertexPosition,this.colorAttribute],this.translationMatrix=e.getUniformLocation(n,"translationMatrix"),this.alpha=e.getUniformLocation(n,"alpha"),this.program=n},t.PrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},t.ComplexPrimitiveShader=function(e){this._UID=t._UID++,this.gl=e,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform vec3 tint;","uniform float alpha;","uniform vec3 color;","uniform float flipY;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);","   vColor = vec4(color * alpha * tint, alpha);","}"],this.init()},t.ComplexPrimitiveShader.prototype.constructor=t.ComplexPrimitiveShader,t.ComplexPrimitiveShader.prototype.init=function(){var e=this.gl,n=t.compileProgram(e,this.vertexSrc,this.fragmentSrc);e.useProgram(n),this.projectionVector=e.getUniformLocation(n,"projectionVector"),this.offsetVector=e.getUniformLocation(n,"offsetVector"),this.tintColor=e.getUniformLocation(n,"tint"),this.color=e.getUniformLocation(n,"color"),this.flipY=e.getUniformLocation(n,"flipY"),this.aVertexPosition=e.getAttribLocation(n,"aVertexPosition"),this.attributes=[this.aVertexPosition,this.colorAttribute],this.translationMatrix=e.getUniformLocation(n,"translationMatrix"),this.alpha=e.getUniformLocation(n,"alpha"),this.program=n},t.ComplexPrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attribute=null},t.glContexts=[],t.instances=[],t.WebGLRenderer=function(e){this.game=e,t.defaultRenderer||(t.defaultRenderer=this),this.type=t.WEBGL_RENDERER,this.resolution=e.resolution,this.transparent=e.transparent,this.autoResize=!1,this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.clearBeforeRender=e.clearBeforeRender,this.width=e.width,this.height=e.height,this.view=e.canvas,this._contextOptions={alpha:this.transparent,antialias:e.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,preserveDrawingBuffer:this.preserveDrawingBuffer},this.projection=new t.Point,this.offset=new t.Point,this.shaderManager=new t.WebGLShaderManager,this.spriteBatch=new t.WebGLSpriteBatch,this.maskManager=new t.WebGLMaskManager,this.filterManager=new t.WebGLFilterManager,this.stencilManager=new t.WebGLStencilManager,this.blendModeManager=new t.WebGLBlendModeManager,this.renderSession={},this.renderSession.game=this.game,this.renderSession.gl=this.gl,this.renderSession.drawCount=0,this.renderSession.shaderManager=this.shaderManager,this.renderSession.maskManager=this.maskManager,this.renderSession.filterManager=this.filterManager,this.renderSession.blendModeManager=this.blendModeManager,this.renderSession.spriteBatch=this.spriteBatch,this.renderSession.stencilManager=this.stencilManager,this.renderSession.renderer=this,this.renderSession.resolution=this.resolution,this.initContext(),this.mapBlendModes()},t.WebGLRenderer.prototype.constructor=t.WebGLRenderer,t.WebGLRenderer.prototype.initContext=function(){var e=this.view.getContext("webgl",this._contextOptions)||this.view.getContext("experimental-webgl",this._contextOptions);if(this.gl=e,!e)throw new Error("This browser does not support webGL. Try using the canvas renderer");this.glContextId=e.id=t.WebGLRenderer.glContextId++,t.glContexts[this.glContextId]=e,t.instances[this.glContextId]=this,e.disable(e.DEPTH_TEST),e.disable(e.CULL_FACE),e.enable(e.BLEND),this.shaderManager.setContext(e),this.spriteBatch.setContext(e),this.maskManager.setContext(e),this.filterManager.setContext(e),this.blendModeManager.setContext(e),this.stencilManager.setContext(e),this.renderSession.gl=this.gl,this.resize(this.width,this.height)},t.WebGLRenderer.prototype.render=function(e){if(!this.contextLost){e.updateTransform();var t=this.gl;t.viewport(0,0,this.width,this.height),t.bindFramebuffer(t.FRAMEBUFFER,null),this.game.clearBeforeRender&&(t.clearColor(e._bgColor.r,e._bgColor.g,e._bgColor.b,e._bgColor.a),t.clear(t.COLOR_BUFFER_BIT)),this.offset.x=this.game.camera._shake.x,this.offset.y=this.game.camera._shake.y,this.renderDisplayObject(e,this.projection)}},t.WebGLRenderer.prototype.renderDisplayObject=function(e,n,r,i){this.renderSession.blendModeManager.setBlendMode(t.blendModes.NORMAL),this.renderSession.drawCount=0,this.renderSession.flipY=r?-1:1,this.renderSession.projection=n,this.renderSession.offset=this.offset,this.spriteBatch.begin(this.renderSession),this.filterManager.begin(this.renderSession,r),e._renderWebGL(this.renderSession,i),this.spriteBatch.end()},t.WebGLRenderer.prototype.resize=function(e,t){this.width=e*this.resolution,this.height=t*this.resolution,this.view.width=this.width,this.view.height=this.height,this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px"),this.gl.viewport(0,0,this.width,this.height),this.projection.x=this.width/2/this.resolution,this.projection.y=-this.height/2/this.resolution},t.WebGLRenderer.prototype.updateTexture=function(e){if(!e.hasLoaded)return!1;var n=this.gl;return e._glTextures[n.id]||(e._glTextures[n.id]=n.createTexture()),n.bindTexture(n.TEXTURE_2D,e._glTextures[n.id]),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultipliedAlpha),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,e.source),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,e.scaleMode===t.scaleModes.LINEAR?n.LINEAR:n.NEAREST),e.mipmap&&t.isPowerOfTwo(e.width,e.height)?(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,e.scaleMode===t.scaleModes.LINEAR?n.LINEAR_MIPMAP_LINEAR:n.NEAREST_MIPMAP_NEAREST),n.generateMipmap(n.TEXTURE_2D)):n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,e.scaleMode===t.scaleModes.LINEAR?n.LINEAR:n.NEAREST),e._powerOf2?(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.REPEAT)):(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)),e._dirty[n.id]=!1,!0},t.WebGLRenderer.prototype.destroy=function(){t.glContexts[this.glContextId]=null,this.projection=null,this.offset=null,this.shaderManager.destroy(),this.spriteBatch.destroy(),this.maskManager.destroy(),this.filterManager.destroy(),this.shaderManager=null,this.spriteBatch=null,this.maskManager=null,this.filterManager=null,this.gl=null,this.renderSession=null,t.CanvasPool.remove(this),t.instances[this.glContextId]=null,t.WebGLRenderer.glContextId--},t.WebGLRenderer.prototype.mapBlendModes=function(){var e=this.gl;if(!t.blendModesWebGL){var n=[],r=t.blendModes;n[r.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],n[r.ADD]=[e.SRC_ALPHA,e.DST_ALPHA],n[r.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA],n[r.SCREEN]=[e.SRC_ALPHA,e.ONE],n[r.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],n[r.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],n[r.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],n[r.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],n[r.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],n[r.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],n[r.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],n[r.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],n[r.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],n[r.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],n[r.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],n[r.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],n[r.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t.blendModesWebGL=n}},t.WebGLRenderer.glContextId=0,t.WebGLBlendModeManager=function(){this.currentBlendMode=99999},t.WebGLBlendModeManager.prototype.constructor=t.WebGLBlendModeManager,t.WebGLBlendModeManager.prototype.setContext=function(e){this.gl=e},t.WebGLBlendModeManager.prototype.setBlendMode=function(e){if(this.currentBlendMode===e)return!1;this.currentBlendMode=e;var n=t.blendModesWebGL[this.currentBlendMode];return n&&this.gl.blendFunc(n[0],n[1]),!0},t.WebGLBlendModeManager.prototype.destroy=function(){this.gl=null},t.WebGLMaskManager=function(){},t.WebGLMaskManager.prototype.constructor=t.WebGLMaskManager,t.WebGLMaskManager.prototype.setContext=function(e){this.gl=e},t.WebGLMaskManager.prototype.pushMask=function(e,n){var r=n.gl;e.dirty&&t.WebGLGraphics.updateGraphics(e,r),void 0!==e._webGL[r.id]&&void 0!==e._webGL[r.id].data&&0!==e._webGL[r.id].data.length&&n.stencilManager.pushStencil(e,e._webGL[r.id].data[0],n)},t.WebGLMaskManager.prototype.popMask=function(e,t){var n=this.gl;void 0!==e._webGL[n.id]&&void 0!==e._webGL[n.id].data&&0!==e._webGL[n.id].data.length&&t.stencilManager.popStencil(e,e._webGL[n.id].data[0],t)},t.WebGLMaskManager.prototype.destroy=function(){this.gl=null},t.WebGLStencilManager=function(){this.stencilStack=[],this.reverse=!0,this.count=0},t.WebGLStencilManager.prototype.setContext=function(e){this.gl=e},t.WebGLStencilManager.prototype.pushStencil=function(e,t,n){var r=this.gl;this.bindGraphics(e,t,n),0===this.stencilStack.length&&(r.enable(r.STENCIL_TEST),r.clear(r.STENCIL_BUFFER_BIT),this.reverse=!0,this.count=0),this.stencilStack.push(t);var i=this.count;r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.ALWAYS,0,255),r.stencilOp(r.KEEP,r.KEEP,r.INVERT),1===t.mode?(r.drawElements(r.TRIANGLE_FAN,t.indices.length-4,r.UNSIGNED_SHORT,0),this.reverse?(r.stencilFunc(r.EQUAL,255-i,255),r.stencilOp(r.KEEP,r.KEEP,r.DECR)):(r.stencilFunc(r.EQUAL,i,255),r.stencilOp(r.KEEP,r.KEEP,r.INCR)),r.drawElements(r.TRIANGLE_FAN,4,r.UNSIGNED_SHORT,2*(t.indices.length-4)),this.reverse?r.stencilFunc(r.EQUAL,255-(i+1),255):r.stencilFunc(r.EQUAL,i+1,255),this.reverse=!this.reverse):(this.reverse?(r.stencilFunc(r.EQUAL,i,255),r.stencilOp(r.KEEP,r.KEEP,r.INCR)):(r.stencilFunc(r.EQUAL,255-i,255),r.stencilOp(r.KEEP,r.KEEP,r.DECR)),r.drawElements(r.TRIANGLE_STRIP,t.indices.length,r.UNSIGNED_SHORT,0),this.reverse?r.stencilFunc(r.EQUAL,i+1,255):r.stencilFunc(r.EQUAL,255-(i+1),255)),r.colorMask(!0,!0,!0,!0),r.stencilOp(r.KEEP,r.KEEP,r.KEEP),this.count++},t.WebGLStencilManager.prototype.bindGraphics=function(e,n,r){this._currentGraphics=e;var i,s=this.gl,o=r.projection,u=r.offset;1===n.mode?(i=r.shaderManager.complexPrimitiveShader,r.shaderManager.setShader(i),s.uniform1f(i.flipY,r.flipY),s.uniformMatrix3fv(i.translationMatrix,!1,e.worldTransform.toArray(!0)),s.uniform2f(i.projectionVector,o.x,-o.y),s.uniform2f(i.offsetVector,-u.x,-u.y),s.uniform3fv(i.tintColor,t.hex2rgb(e.tint)),s.uniform3fv(i.color,n.color),s.uniform1f(i.alpha,e.worldAlpha*n.alpha),s.bindBuffer(s.ARRAY_BUFFER,n.buffer),s.vertexAttribPointer(i.aVertexPosition,2,s.FLOAT,!1,8,0),s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,n.indexBuffer)):(i=r.shaderManager.primitiveShader,r.shaderManager.setShader(i),s.uniformMatrix3fv(i.translationMatrix,!1,e.worldTransform.toArray(!0)),s.uniform1f(i.flipY,r.flipY),s.uniform2f(i.projectionVector,o.x,-o.y),s.uniform2f(i.offsetVector,-u.x,-u.y),s.uniform3fv(i.tintColor,t.hex2rgb(e.tint)),s.uniform1f(i.alpha,e.worldAlpha),s.bindBuffer(s.ARRAY_BUFFER,n.buffer),s.vertexAttribPointer(i.aVertexPosition,2,s.FLOAT,!1,24,0),s.vertexAttribPointer(i.colorAttribute,4,s.FLOAT,!1,24,8),s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,n.indexBuffer))},t.WebGLStencilManager.prototype.popStencil=function(e,t,n){var r=this.gl;if(this.stencilStack.pop(),this.count--,0===this.stencilStack.length)r.disable(r.STENCIL_TEST);else{var i=this.count;this.bindGraphics(e,t,n),r.colorMask(!1,!1,!1,!1),1===t.mode?(this.reverse=!this.reverse,this.reverse?(r.stencilFunc(r.EQUAL,255-(i+1),255),r.stencilOp(r.KEEP,r.KEEP,r.INCR)):(r.stencilFunc(r.EQUAL,i+1,255),r.stencilOp(r.KEEP,r.KEEP,r.DECR)),r.drawElements(r.TRIANGLE_FAN,4,r.UNSIGNED_SHORT,2*(t.indices.length-4)),r.stencilFunc(r.ALWAYS,0,255),r.stencilOp(r.KEEP,r.KEEP,r.INVERT),r.drawElements(r.TRIANGLE_FAN,t.indices.length-4,r.UNSIGNED_SHORT,0),this.reverse?r.stencilFunc(r.EQUAL,i,255):r.stencilFunc(r.EQUAL,255-i,255)):(this.reverse?(r.stencilFunc(r.EQUAL,i+1,255),r.stencilOp(r.KEEP,r.KEEP,r.DECR)):(r.stencilFunc(r.EQUAL,255-(i+1),255),r.stencilOp(r.KEEP,r.KEEP,r.INCR)),r.drawElements(r.TRIANGLE_STRIP,t.indices.length,r.UNSIGNED_SHORT,0),this.reverse?r.stencilFunc(r.EQUAL,i,255):r.stencilFunc(r.EQUAL,255-i,255)),r.colorMask(!0,!0,!0,!0),r.stencilOp(r.KEEP,r.KEEP,r.KEEP)}},t.WebGLStencilManager.prototype.destroy=function(){this.stencilStack=null,this.gl=null},t.WebGLShaderManager=function(){this.maxAttibs=10,this.attribState=[],this.tempAttribState=[];for(var e=0;e<this.maxAttibs;e++)this.attribState[e]=!1;this.stack=[]},t.WebGLShaderManager.prototype.constructor=t.WebGLShaderManager,t.WebGLShaderManager.prototype.setContext=function(e){this.gl=e,this.primitiveShader=new t.PrimitiveShader(e),this.complexPrimitiveShader=new t.ComplexPrimitiveShader(e),this.defaultShader=new t.PixiShader(e),this.fastShader=new t.PixiFastShader(e),this.stripShader=new t.StripShader(e),this.setShader(this.defaultShader)},t.WebGLShaderManager.prototype.setAttribs=function(e){var t;for(t=0;t<this.tempAttribState.length;t++)this.tempAttribState[t]=!1;for(t=0;t<e.length;t++){var n=e[t];this.tempAttribState[n]=!0}var r=this.gl;for(t=0;t<this.attribState.length;t++)this.attribState[t]!==this.tempAttribState[t]&&(this.attribState[t]=this.tempAttribState[t],this.tempAttribState[t]?r.enableVertexAttribArray(t):r.disableVertexAttribArray(t))},t.WebGLShaderManager.prototype.setShader=function(e){return this._currentId===e._UID?!1:(this._currentId=e._UID,this.currentShader=e,this.gl.useProgram(e.program),this.setAttribs(e.attributes),!0)},t.WebGLShaderManager.prototype.destroy=function(){this.attribState=null,this.tempAttribState=null,this.primitiveShader.destroy(),this.complexPrimitiveShader.destroy(),this.defaultShader.destroy(),this.fastShader.destroy(),this.stripShader.destroy(),this.gl=null},t.WebGLSpriteBatch=function(){this.vertSize=5,this.size=2e3;var e=4*this.size*4*this.vertSize,n=6*this.size;this.vertices=new t.ArrayBuffer(e),this.positions=new t.Float32Array(this.vertices),this.colors=new t.Uint32Array(this.vertices),this.indices=new t.Uint16Array(n),this.lastIndexCount=0;for(var r=0,i=0;n>r;r+=6,i+=4)this.indices[r+0]=i+0,this.indices[r+1]=i+1,this.indices[r+2]=i+2,this.indices[r+3]=i+0,this.indices[r+4]=i+2,this.indices[r+5]=i+3;this.drawing=!1,this.currentBatchSize=0,this.currentBaseTexture=null,this.dirty=!0,this.textures=[],this.blendModes=[],this.shaders=[],this.sprites=[],this.defaultShader=new t.AbstractFilter(["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"])},t.WebGLSpriteBatch.prototype.setContext=function(e){this.gl=e,this.vertexBuffer=e.createBuffer(),this.indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertices,e.DYNAMIC_DRAW),this.currentBlendMode=99999;var n=new t.PixiShader(e);n.fragmentSrc=this.defaultShader.fragmentSrc,n.uniforms={},n.init(),this.defaultShader.shaders[e.id]=n},t.WebGLSpriteBatch.prototype.begin=function(e){this.renderSession=e,this.shader=this.renderSession.shaderManager.defaultShader,this.start()},t.WebGLSpriteBatch.prototype.end=function(){this.flush()},t.WebGLSpriteBatch.prototype.render=function(e,t){var n=e.texture,r=e.worldTransform;t&&(r=t),this.currentBatchSize>=this.size&&(this.flush(),this.currentBaseTexture=n.baseTexture);var i=n._uvs;if(i){var s,o,u,a,f=e.anchor.x,l=e.anchor.y;if(n.trim){var c=n.trim;o=c.x-f*c.width,s=o+n.crop.width,a=c.y-l*c.height,u=a+n.crop.height}else s=n.frame.width*(1-f),o=n.frame.width*-f,u=n.frame.height*(1-l),a=n.frame.height*-l;var h=4*this.currentBatchSize*this.vertSize,p=n.baseTexture.resolution,d=r.a/p,v=r.b/p,m=r.c/p,g=r.d/p,y=r.tx,b=r.ty,w=this.colors,E=this.positions;this.renderSession.roundPixels?(E[h]=d*o+m*a+y|0,E[h+1]=g*a+v*o+b|0,E[h+5]=d*s+m*a+y|0,E[h+6]=g*a+v*s+b|0,E[h+10]=d*s+m*u+y|0,E[h+11]=g*u+v*s+b|0,E[h+15]=d*o+m*u+y|0,E[h+16]=g*u+v*o+b|0):(E[h]=d*o+m*a+y,E[h+1]=g*a+v*o+b,E[h+5]=d*s+m*a+y,E[h+6]=g*a+v*s+b,E[h+10]=d*s+m*u+y,E[h+11]=g*u+v*s+b,E[h+15]=d*o+m*u+y,E[h+16]=g*u+v*o+b),E[h+2]=i.x0,E[h+3]=i.y0,E[h+7]=i.x1,E[h+8]=i.y1,E[h+12]=i.x2,E[h+13]=i.y2,E[h+17]=i.x3,E[h+18]=i.y3;var S=e.tint;w[h+4]=w[h+9]=w[h+14]=w[h+19]=(S>>16)+(65280&S)+((255&S)<<16)+(255*e.worldAlpha<<24),this.sprites[this.currentBatchSize++]=e}},t.WebGLSpriteBatch.prototype.renderTilingSprite=function(e){var n=e.tilingTexture;this.currentBatchSize>=this.size&&(this.flush(),this.currentBaseTexture=n.baseTexture),e._uvs||(e._uvs=new t.TextureUvs);var r=e._uvs,i=n.baseTexture.width,s=n.baseTexture.height;e.tilePosition.x%=i*e.tileScaleOffset.x,e.tilePosition.y%=s*e.tileScaleOffset.y;var o=e.tilePosition.x/(i*e.tileScaleOffset.x),u=e.tilePosition.y/(s*e.tileScaleOffset.y),a=e.width/i/(e.tileScale.x*e.tileScaleOffset.x),f=e.height/s/(e.tileScale.y*e.tileScaleOffset.y);r.x0=0-o,r.y0=0-u,r.x1=1*a-o,r.y1=0-u,r.x2=1*a-o,r.y2=1*f-u,r.x3=0-o,r.y3=1*f-u;var l=e.tint,c=(l>>16)+(65280&l)+((255&l)<<16)+(255*e.worldAlpha<<24),h=this.positions,p=this.colors,d=e.width,v=e.height,m=e.anchor.x,g=e.anchor.y,y=d*(1-m),w=d*-m,E=v*(1-g),S=v*-g,x=4*this.currentBatchSize*this.vertSize,T=n.baseTexture.resolution,N=e.worldTransform,C=N.a/T,k=N.b/T,L=N.c/T,A=N.d/T,O=N.tx,M=N.ty;h[x++]=C*w+L*S+O,h[x++]=A*S+k*w+M,h[x++]=r.x0,h[x++]=r.y0,p[x++]=c,h[x++]=C*y+L*S+O,h[x++]=A*S+k*y+M,h[x++]=r.x1,h[x++]=r.y1,p[x++]=c,h[x++]=C*y+L*E+O,h[x++]=A*E+k*y+M,h[x++]=r.x2,h[x++]=r.y2,p[x++]=c,h[x++]=C*w+L*E+O,h[x++]=A*E+k*w+M,h[x++]=r.x3,h[x++]=r.y3,p[x++]=c,this.sprites[this.currentBatchSize++]=e},t.WebGLSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var e,n=this.gl;if(this.dirty){this.dirty=!1,n.activeTexture(n.TEXTURE0),n.bindBuffer(n.ARRAY_BUFFER,this.vertexBuffer),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e=this.defaultShader.shaders[n.id];var r=4*this.vertSize;n.vertexAttribPointer(e.aVertexPosition,2,n.FLOAT,!1,r,0),n.vertexAttribPointer(e.aTextureCoord,2,n.FLOAT,!1,r,8),n.vertexAttribPointer(e.colorAttribute,4,n.UNSIGNED_BYTE,!0,r,16)}if(this.currentBatchSize>.5*this.size)n.bufferSubData(n.ARRAY_BUFFER,0,this.vertices);else{var i=this.positions.subarray(0,4*this.currentBatchSize*this.vertSize);n.bufferSubData(n.ARRAY_BUFFER,0,i)}for(var s,o,u,a,f=0,l=0,c=null,h=this.renderSession.blendModeManager.currentBlendMode,p=null,d=!1,v=!1,m=0,g=this.currentBatchSize;g>m;m++){a=this.sprites[m],s=a.tilingTexture?a.tilingTexture.baseTexture:a.texture.baseTexture,o=a.blendMode,u=a.shader||this.defaultShader,d=h!==o,v=p!==u;var y=s.skipRender;if(y&&a.children.length>0&&(y=!1),(c!==s&&!y||d||v)&&(this.renderBatch(c,f,l),l=m,f=0,c=s,d&&(h=o,this.renderSession.blendModeManager.setBlendMode(h)),v)){p=u,e=p.shaders[n.id],e||(e=new t.PixiShader(n),e.fragmentSrc=p.fragmentSrc,e.uniforms=p.uniforms,e.init(),p.shaders[n.id]=e),this.renderSession.shaderManager.setShader(e),e.dirty&&e.syncUniforms();var w=this.renderSession.projection;n.uniform2f(e.projectionVector,w.x,w.y);var E=this.renderSession.offset;n.uniform2f(e.offsetVector,E.x,E.y)}f++}this.renderBatch(c,f,l),this.currentBatchSize=0}},t.WebGLSpriteBatch.prototype.renderBatch=function(e,t,n){if(0!==t){var r=this.gl;if(e._dirty[r.id]){if(!this.renderSession.renderer.updateTexture(e))return}else r.bindTexture(r.TEXTURE_2D,e._glTextures[r.id]);r.drawElements(r.TRIANGLES,6*t,r.UNSIGNED_SHORT,6*n*2),this.renderSession.drawCount++}},t.WebGLSpriteBatch.prototype.stop=function(){this.flush(),this.dirty=!0},t.WebGLSpriteBatch.prototype.start=function(){this.dirty=!0},t.WebGLSpriteBatch.prototype.destroy=function(){this.vertices=null,this.indices=null,this.gl.deleteBuffer(this.vertexBuffer),this.gl.deleteBuffer(this.indexBuffer),this.currentBaseTexture=null,this.gl=null},t.WebGLFastSpriteBatch=function(e){this.vertSize=10,this.maxSize=6e3,this.size=this.maxSize;var n=4*this.size*this.vertSize,r=6*this.maxSize;this.vertices=new t.Float32Array(n),this.indices=new t.Uint16Array(r),this.vertexBuffer=null,this.indexBuffer=null,this.lastIndexCount=0;for(var i=0,s=0;r>i;i+=6,s+=4)this.indices[i+0]=s+0,this.indices[i+1]=s+1,this.indices[i+2]=s+2,this.indices[i+3]=s+0,this.indices[i+4]=s+2,this.indices[i+5]=s+3;this.drawing=!1,this.currentBatchSize=0,this.currentBaseTexture=null,this.currentBlendMode=0,this.renderSession=null,this.shader=null,this.matrix=null,this.setContext(e)},t.WebGLFastSpriteBatch.prototype.constructor=t.WebGLFastSpriteBatch,t.WebGLFastSpriteBatch.prototype.setContext=function(e){this.gl=e,this.vertexBuffer=e.createBuffer(),this.indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertices,e.DYNAMIC_DRAW)},t.WebGLFastSpriteBatch.prototype.begin=function(e,t){this.renderSession=t,this.shader=this.renderSession.shaderManager.fastShader,this.matrix=e.worldTransform.toArray(!0),this.start()},t.WebGLFastSpriteBatch.prototype.end=function(){this.flush()},t.WebGLFastSpriteBatch.prototype.render=function(e){var t=e.children,n=t[0];if(n.texture._uvs){this.currentBaseTexture=n.texture.baseTexture,n.blendMode!==this.renderSession.blendModeManager.currentBlendMode&&(this.flush(),this.renderSession.blendModeManager.setBlendMode(n.blendMode));for(var r=0,i=t.length;i>r;r++)this.renderSprite(t[r]);this.flush()}},t.WebGLFastSpriteBatch.prototype.renderSprite=function(e){if(e.visible&&(e.texture.baseTexture===this.currentBaseTexture||e.texture.baseTexture.skipRender||(this.flush(),this.currentBaseTexture=e.texture.baseTexture,e.texture._uvs))){var t,n,r,i,s,o,u,a,f=this.vertices;if(t=e.texture._uvs,n=e.texture.frame.width,r=e.texture.frame.height,e.texture.trim){var l=e.texture.trim;s=l.x-e.anchor.x*l.width,i=s+e.texture.crop.width,u=l.y-e.anchor.y*l.height,o=u+e.texture.crop.height}else i=e.texture.frame.width*(1-e.anchor.x),s=e.texture.frame.width*-e.anchor.x,o=e.texture.frame.height*(1-e.anchor.y),u=e.texture.frame.height*-e.anchor.y;a=4*this.currentBatchSize*this.vertSize,f[a++]=s,f[a++]=u,f[a++]=e.position.x,f[a++]=e.position.y,f[a++]=e.scale.x,f[a++]=e.scale.y,f[a++]=e.rotation,f[a++]=t.x0,f[a++]=t.y1,f[a++]=e.alpha,f[a++]=i,f[a++]=u,f[a++]=e.position.x,f[a++]=e.position.y,f[a++]=e.scale.x,f[a++]=e.scale.y,f[a++]=e.rotation,f[a++]=t.x1,f[a++]=t.y1,f[a++]=e.alpha,f[a++]=i,f[a++]=o,f[a++]=e.position.x,f[a++]=e.position.y,f[a++]=e.scale.x,f[a++]=e.scale.y,f[a++]=e.rotation,f[a++]=t.x2,f[a++]=t.y2,f[a++]=e.alpha,f[a++]=s,f[a++]=o,f[a++]=e.position.x,f[a++]=e.position.y,f[a++]=e.scale.x,f[a++]=e.scale.y,f[a++]=e.rotation,f[a++]=t.x3,f[a++]=t.y3,f[a++]=e.alpha,this.currentBatchSize++,this.currentBatchSize>=this.size&&this.flush()}},t.WebGLFastSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var e=this.gl;if(this.currentBaseTexture._glTextures[e.id]||this.renderSession.renderer.updateTexture(this.currentBaseTexture,e),e.bindTexture(e.TEXTURE_2D,this.currentBaseTexture._glTextures[e.id]),this.currentBatchSize>.5*this.size)e.bufferSubData(e.ARRAY_BUFFER,0,this.vertices);else{var t=this.vertices.subarray(0,4*this.currentBatchSize*this.vertSize);e.bufferSubData(e.ARRAY_BUFFER,0,t)}e.drawElements(e.TRIANGLES,6*this.currentBatchSize,e.UNSIGNED_SHORT,0),this.currentBatchSize=0,this.renderSession.drawCount++}},t.WebGLFastSpriteBatch.prototype.stop=function(){this.flush()},t.WebGLFastSpriteBatch.prototype.start=function(){var e=this.gl;e.activeTexture(e.TEXTURE0),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var t=this.renderSession.projection;e.uniform2f(this.shader.projectionVector,t.x,t.y),e.uniformMatrix3fv(this.shader.uMatrix,!1,this.matrix);var n=4*this.vertSize;e.vertexAttribPointer(this.shader.aVertexPosition,2,e.FLOAT,!1,n,0),e.vertexAttribPointer(this.shader.aPositionCoord,2,e.FLOAT,!1,n,8),e.vertexAttribPointer(this.shader.aScale,2,e.FLOAT,!1,n,16),e.vertexAttribPointer(this.shader.aRotation,1,e.FLOAT,!1,n,24),e.vertexAttribPointer(this.shader.aTextureCoord,2,e.FLOAT,!1,n,28),e.vertexAttribPointer(this.shader.colorAttribute,1,e.FLOAT,!1,n,36)},t.WebGLFilterManager=function(){this.filterStack=[],this.offsetX=0,this.offsetY=0},t.WebGLFilterManager.prototype.constructor=t.WebGLFilterManager,t.WebGLFilterManager.prototype.setContext=function(e){this.gl=e,this.texturePool=[],this.initShaderBuffers()},t.WebGLFilterManager.prototype.begin=function(e,t){this.renderSession=e,this.defaultShader=e.shaderManager.defaultShader;var n=this.renderSession.projection;this.width=2*n.x,this.height=2*-n.y,this.buffer=t},t.WebGLFilterManager.prototype.pushFilter=function(e){var n=this.gl,r=this.renderSession.projection,i=this.renderSession.offset;e._filterArea=e.target.filterArea||e.target.getBounds(),e._previous_stencil_mgr=this.renderSession.stencilManager,this.renderSession.stencilManager=new t.WebGLStencilManager,this.renderSession.stencilManager.setContext(n),n.disable(n.STENCIL_TEST),this.filterStack.push(e);var s=e.filterPasses[0];this.offsetX+=e._filterArea.x,this.offsetY+=e._filterArea.y;var o=this.texturePool.pop();o?o.resize(this.width*this.renderSession.resolution,this.height*this.renderSession.resolution):o=new t.FilterTexture(this.gl,this.width*this.renderSession.resolution,this.height*this.renderSession.resolution),n.bindTexture(n.TEXTURE_2D,o.texture);var u=e._filterArea,a=s.padding;u.x-=a,u.y-=a,u.width+=2*a,u.height+=2*a,u.x<0&&(u.x=0),u.width>this.width&&(u.width=this.width),u.y<0&&(u.y=0),u.height>this.height&&(u.height=this.height),n.bindFramebuffer(n.FRAMEBUFFER,o.frameBuffer),n.viewport(0,0,u.width*this.renderSession.resolution,u.height*this.renderSession.resolution),r.x=u.width/2,r.y=-u.height/2,i.x=-u.x,i.y=-u.y,n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),e._glFilterTexture=o},t.WebGLFilterManager.prototype.popFilter=function(){var e=this.gl,n=this.filterStack.pop(),r=n._filterArea,i=n._glFilterTexture,s=this.renderSession.projection,o=this.renderSession.offset;if(n.filterPasses.length>1){e.viewport(0,0,r.width*this.renderSession.resolution,r.height*this.renderSession.resolution),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray[0]=0,this.vertexArray[1]=r.height,this.vertexArray[2]=r.width,this.vertexArray[3]=r.height,this.vertexArray[4]=0,this.vertexArray[5]=0,this.vertexArray[6]=r.width,this.vertexArray[7]=0,e.bufferSubData(e.ARRAY_BUFFER,0,this.vertexArray),e.bindBuffer(e.ARRAY_BUFFER,this.uvBuffer),this.uvArray[2]=r.width/this.width,this.uvArray[5]=r.height/this.height,this.uvArray[6]=r.width/this.width,this.uvArray[7]=r.height/this.height,e.bufferSubData(e.ARRAY_BUFFER,0,this.uvArray);var u=i,a=this.texturePool.pop();a||(a=new t.FilterTexture(this.gl,this.width*this.renderSession.resolution,this.height*this.renderSession.resolution)),a.resize(this.width*this.renderSession.resolution,this.height*this.renderSession.resolution),e.bindFramebuffer(e.FRAMEBUFFER,a.frameBuffer),e.clear(e.COLOR_BUFFER_BIT),e.disable(e.BLEND);for(var f=0;f<n.filterPasses.length-1;f++){var l=n.filterPasses[f];e.bindFramebuffer(e.FRAMEBUFFER,a.frameBuffer),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,u.texture),this.applyFilterPass(l,r,r.width,r.height);var c=u;u=a,a=c}e.enable(e.BLEND),i=u,this.texturePool.push(a)}var h=n.filterPasses[n.filterPasses.length-1];this.offsetX-=r.x,this.offsetY-=r.y;var p=this.width,d=this.height,v=0,m=0,g=this.buffer;if(0===this.filterStack.length)e.colorMask(!0,!0,!0,!0);else{var y=this.filterStack[this.filterStack.length-1];r=y._filterArea,p=r.width,d=r.height,v=r.x,m=r.y,g=y._glFilterTexture.frameBuffer}s.x=p/2,s.y=-d/2,o.x=v,o.y=m,r=n._filterArea;var w=r.x-v,E=r.y-m;e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray[0]=w,this.vertexArray[1]=E+r.height,this.vertexArray[2]=w+r.width,this.vertexArray[3]=E+r.height,this.vertexArray[4]=w,this.vertexArray[5]=E,this.vertexArray[6]=w+r.width,this.vertexArray[7]=E,e.bufferSubData(e.ARRAY_BUFFER,0,this.vertexArray),e.bindBuffer(e.ARRAY_BUFFER,this.uvBuffer),this.uvArray[2]=r.width/this.width,this.uvArray[5]=r.height/this.height,this.uvArray[6]=r.width/this.width,this.uvArray[7]=r.height/this.height,e.bufferSubData(e.ARRAY_BUFFER,0,this.uvArray),e.viewport(0,0,p*this.renderSession.resolution,d*this.renderSession.resolution),e.bindFramebuffer(e.FRAMEBUFFER,g),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,i.texture),this.renderSession.stencilManager&&this.renderSession.stencilManager.destroy(),this.renderSession.stencilManager=n._previous_stencil_mgr,n._previous_stencil_mgr=null,this.renderSession.stencilManager.count>0?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.applyFilterPass(h,r,p,d),this.texturePool.push(i),n._glFilterTexture=null},t.WebGLFilterManager.prototype.applyFilterPass=function(e,n,r,i){var s=this.gl,o=e.shaders[s.id];o||(o=new t.PixiShader(s),o.fragmentSrc=e.fragmentSrc,o.uniforms=e.uniforms,o.init(),e.shaders[s.id]=o),this.renderSession.shaderManager.setShader(o),s.uniform2f(o.projectionVector,r/2,-i/2),s.uniform2f(o.offsetVector,0,0),e.uniforms.dimensions&&(e.uniforms.dimensions.value[0]=this.width,e.uniforms.dimensions.value[1]=this.height,e.uniforms.dimensions.value[2]=this.vertexArray[0],e.uniforms.dimensions.value[3]=this.vertexArray[5]),o.syncUniforms(),s.bindBuffer(s.ARRAY_BUFFER,this.vertexBuffer),s.vertexAttribPointer(o.aVertexPosition,2,s.FLOAT,!1,0,0),s.bindBuffer(s.ARRAY_BUFFER,this.uvBuffer),s.vertexAttribPointer(o.aTextureCoord,2,s.FLOAT,!1,0,0),s.bindBuffer(s.ARRAY_BUFFER,this.colorBuffer),s.vertexAttribPointer(o.colorAttribute,2,s.FLOAT,!1,0,0),s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,this.indexBuffer),s.drawElements(s.TRIANGLES,6,s.UNSIGNED_SHORT,0),this.renderSession.drawCount++},t.WebGLFilterManager.prototype.initShaderBuffers=function(){var e=this.gl;this.vertexBuffer=e.createBuffer(),this.uvBuffer=e.createBuffer(),this.colorBuffer=e.createBuffer(),this.indexBuffer=e.createBuffer(),this.vertexArray=new t.Float32Array([0,0,1,0,0,1,1,1]),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertexArray,e.STATIC_DRAW),this.uvArray=new t.Float32Array([0,0,1,0,0,1,1,1]),e.bindBuffer(e.ARRAY_BUFFER,this.uvBuffer),e.bufferData(e.ARRAY_BUFFER,this.uvArray,e.STATIC_DRAW),this.colorArray=new t.Float32Array([1,16777215,1,16777215,1,16777215,1,16777215]),e.bindBuffer(e.ARRAY_BUFFER,this.colorBuffer),e.bufferData(e.ARRAY_BUFFER,this.colorArray,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,1,3,2]),e.STATIC_DRAW)},t.WebGLFilterManager.prototype.destroy=function(){var e=this.gl;this.filterStack=null,this.offsetX=0,this.offsetY=0;for(var t=0;t<this.texturePool.length;t++)this.texturePool[t].destroy();this.texturePool=null,e.deleteBuffer(this.vertexBuffer),e.deleteBuffer(this.uvBuffer),e.deleteBuffer(this.colorBuffer),e.deleteBuffer(this.indexBuffer)},t.FilterTexture=function(e,n,r,i){this.gl=e,this.frameBuffer=e.createFramebuffer(),this.texture=e.createTexture(),i=i||t.scaleModes.DEFAULT,e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,i===t.scaleModes.LINEAR?e.LINEAR:e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,i===t.scaleModes.LINEAR?e.LINEAR:e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindFramebuffer(e.FRAMEBUFFER,this.frameBuffer),e.bindFramebuffer(e.FRAMEBUFFER,this.frameBuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture,0),this.renderBuffer=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,this.renderBuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,this.renderBuffer),this.resize(n,r)},t.FilterTexture.prototype.constructor=t.FilterTexture,t.FilterTexture.prototype.clear=function(){var e=this.gl;e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT)},t.FilterTexture.prototype.resize=function(e,t){if(this.width!==e||this.height!==t){this.width=e,this.height=t;var n=this.gl;n.bindTexture(n.TEXTURE_2D,this.texture),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,e,t,0,n.RGBA,n.UNSIGNED_BYTE,null),n.bindRenderbuffer(n.RENDERBUFFER,this.renderBuffer),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,e,t)}},t.FilterTexture.prototype.destroy=function(){var e=this.gl;e.deleteFramebuffer(this.frameBuffer),e.deleteTexture(this.texture),this.frameBuffer=null,this.texture=null},t.CanvasBuffer=function(e,n){this.width=e,this.height=n,this.canvas=t.CanvasPool.create(this,this.width,this.height),this.context=this.canvas.getContext("2d"),this.canvas.width=e,this.canvas.height=n},t.CanvasBuffer.prototype.constructor=t.CanvasBuffer,t.CanvasBuffer.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.width,this.height)},t.CanvasBuffer.prototype.resize=function(e,t){this.width=this.canvas.width=e,this.height=this.canvas.height=t},t.CanvasBuffer.prototype.destroy=function(){t.CanvasPool.remove(this)},t.CanvasMaskManager=function(){},t.CanvasMaskManager.prototype.constructor=t.CanvasMaskManager,t.CanvasMaskManager.prototype.pushMask=function(e,n){var r=n.context;r.save();var i=e.alpha,s=e.worldTransform,o=n.resolution;r.setTransform(s.a*o,s.b*o,s.c*o,s.d*o,s.tx*o,s.ty*o),t.CanvasGraphics.renderGraphicsMask(e,r),r.clip(),e.worldAlpha=i},t.CanvasMaskManager.prototype.popMask=function(e){e.context.restore()},t.CanvasTinter=function(){},t.CanvasTinter.getTintedTexture=function(e,n){var r=e.tintedTexture||t.CanvasPool.create(this);return t.CanvasTinter.tintMethod(e.texture,n,r),r},t.CanvasTinter.tintWithMultiply=function(e,t,n){var r=n.getContext("2d"),i=e.crop;(n.width!==i.width||n.height!==i.height)&&(n.width=i.width,n.height=i.height),r.clearRect(0,0,i.width,i.height),r.fillStyle="#"+("00000"+(0|t).toString(16)).substr(-6),r.fillRect(0,0,i.width,i.height),r.globalCompositeOperation="multiply",r.drawImage(e.baseTexture.source,i.x,i.y,i.width,i.height,0,0,i.width,i.height),r.globalCompositeOperation="destination-atop",r.drawImage(e.baseTexture.source,i.x,i.y,i.width,i.height,0,0,i.width,i.height)},t.CanvasTinter.tintWithPerPixel=function(e,n,r){var i=r.getContext("2d"),s=e.crop;r.width=s.width,r.height=s.height,i.globalCompositeOperation="copy",i.drawImage(e.baseTexture.source,s.x,s.y,s.width,s.height,0,0,s.width,s.height);for(var o=t.hex2rgb(n),u=o[0],a=o[1],f=o[2],l=i.getImageData(0,0,s.width,s.height),c=l.data,h=0;h<c.length;h+=4)if(c[h+0]*=u,c[h+1]*=a,c[h+2]*=f,!t.CanvasTinter.canHandleAlpha){var p=c[h+3];c[h+0]/=255/p,c[h+1]/=255/p,c[h+2]/=255/p}i.putImageData(l,0,0)},t.CanvasTinter.checkInverseAlpha=function(){var e=new t.CanvasBuffer(2,1);e.context.fillStyle="rgba(10, 20, 30, 0.5)",e.context.fillRect(0,0,1,1);var n=e.context.getImageData(0,0,1,1);if(null===n)return!1;e.context.putImageData(n,1,0);var r=e.context.getImageData(1,0,1,1);return r.data[0]===n.data[0]&&r.data[1]===n.data[1]&&r.data[2]===n.data[2]&&r.data[3]===n.data[3]},t.CanvasTinter.canHandleAlpha=t.CanvasTinter.checkInverseAlpha(),t.CanvasTinter.canUseMultiply=t.canUseNewCanvasBlendModes(),t.CanvasTinter.tintMethod=t.CanvasTinter.canUseMultiply?t.CanvasTinter.tintWithMultiply:t.CanvasTinter.tintWithPerPixel,t.CanvasRenderer=function(e){this.game=e,t.defaultRenderer||(t.defaultRenderer=this),this.type=t.CANVAS_RENDERER,this.resolution=e.resolution,this.clearBeforeRender=e.clearBeforeRender,this.transparent=e.transparent,this.autoResize=!1,this.width=e.width*this.resolution,this.height=e.height*this.resolution,this.view=e.canvas,this.context=this.view.getContext("2d",{alpha:this.transparent}),this.refresh=!0,this.count=0,this.maskManager=new t.CanvasMaskManager,this.renderSession={context:this.context,maskManager:this.maskManager,scaleMode:null,smoothProperty:Phaser.Canvas.getSmoothingPrefix(this.context),roundPixels:!1},this.mapBlendModes(),this.resize(this.width,this.height)},t.CanvasRenderer.prototype.constructor=t.CanvasRenderer,t.CanvasRenderer.prototype.render=function(e){e.updateTransform(),this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1,this.renderSession.currentBlendMode=0,this.renderSession.shakeX=this.game.camera._shake.x,this.renderSession.shakeY=this.game.camera._shake.y,this.context.globalCompositeOperation="source-over",navigator.isCocoonJS&&this.view.screencanvas&&(this.context.fillStyle="black",this.context.clear()),this.clearBeforeRender&&(this.transparent?this.context.clearRect(0,0,this.width,this.height):(this.context.fillStyle=e._bgColor.rgba,this.context.fillRect(0,0,this.width,this.height))),this.renderDisplayObject(e)},t.CanvasRenderer.prototype.destroy=function(e){void 0===e&&(e=!0),e&&this.view.parent&&this.view.parent.removeChild(this.view),this.view=null,this.context=null,this.maskManager=null,this.renderSession=null},t.CanvasRenderer.prototype.resize=function(e,n){this.width=e*this.resolution,this.height=n*this.resolution,this.view.width=this.width,this.view.height=this.height,this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px"),this.renderSession.smoothProperty&&(this.context[this.renderSession.smoothProperty]=this.renderSession.scaleMode===t.scaleModes.LINEAR)},t.CanvasRenderer.prototype.renderDisplayObject=function(e,t,n){this.renderSession.context=t||this.context,this.renderSession.resolution=this.resolution,e._renderCanvas(this.renderSession,n)},t.CanvasRenderer.prototype.mapBlendModes=function(){if(!t.blendModesCanvas){var e=[],n=t.blendModes,r=t.canUseNewCanvasBlendModes();e[n.NORMAL]="source-over",e[n.ADD]="lighter",e[n.MULTIPLY]=r?"multiply":"source-over",e[n.SCREEN]=r?"screen":"source-over",e[n.OVERLAY]=r?"overlay":"source-over",e[n.DARKEN]=r?"darken":"source-over",e[n.LIGHTEN]=r?"lighten":"source-over",e[n.COLOR_DODGE]=r?"color-dodge":"source-over",e[n.COLOR_BURN]=r?"color-burn":"source-over",e[n.HARD_LIGHT]=r?"hard-light":"source-over",e[n.SOFT_LIGHT]=r?"soft-light":"source-over",e[n.DIFFERENCE]=r?"difference":"source-over",e[n.EXCLUSION]=r?"exclusion":"source-over",e[n.HUE]=r?"hue":"source-over",e[n.SATURATION]=r?"saturation":"source-over",e[n.COLOR]=r?"color":"source-over",e[n.LUMINOSITY]=r?"luminosity":"source-over",t.blendModesCanvas=e}},t.BaseTextureCache={},t.BaseTextureCacheIdGenerator=0,t.BaseTexture=function(e,n){this.resolution=1,this.width=100,this.height=100,this.scaleMode=n||t.scaleModes.DEFAULT,this.hasLoaded=!1,this.source=e,this._UID=t._UID++,this.premultipliedAlpha=!0,this._glTextures=[],this.mipmap=!1,this._dirty=[!0,!0,!0,!0],e&&((this.source.complete||this.source.getContext)&&this.source.width&&this.source.height&&(this.hasLoaded=!0,this.width=this.source.naturalWidth||this.source.width,this.height=this.source.naturalHeight||this.source.height,this.dirty()),this.skipRender=!1,this.imageUrl=null,this._powerOf2=!1)},t.BaseTexture.prototype.constructor=t.BaseTexture,t.BaseTexture.prototype.forceLoaded=function(e,t){this.hasLoaded=!0,this.width=e,this.height=t,this.dirty()},t.BaseTexture.prototype.destroy=function(){this.imageUrl?(delete t.BaseTextureCache[this.imageUrl],delete t.TextureCache[this.imageUrl],this.imageUrl=null,navigator.isCocoonJS||(this.source.src="")):this.source&&(t.CanvasPool.removeByCanvas(this.source),this.source._pixiId&&delete t.BaseTextureCache[this.source._pixiId]),this.source=null,this.unloadFromGPU()},t.BaseTexture.prototype.updateSourceImage=function(e){this.hasLoaded=!1,this.source.src=null,this.source.src=e},t.BaseTexture.prototype.dirty=function(){for(var e=0;e<this._glTextures.length;e++)this._dirty[e]=!0},t.BaseTexture.prototype.unloadFromGPU=function(){this.dirty();for(var e=this._glTextures.length-1;e>=0;e--){var n=this._glTextures[e],r=t.glContexts[e];r&&n&&r.deleteTexture(n)}this._glTextures.length=0,this.dirty()},t.BaseTexture.fromImage=function(e,n,r){var i=t.BaseTextureCache[e];if(void 0===n&&-1===e.indexOf("data:")&&(n=!0),!i){var s=new Image;n&&(s.crossOrigin=""),s.src=e,i=new t.BaseTexture(s,r),i.imageUrl=e,t.BaseTextureCache[e]=i,-1!==e.indexOf(t.RETINA_PREFIX+".")&&(i.resolution=2)}return i},t.BaseTexture.fromCanvas=function(e,n){e._pixiId||(e._pixiId="canvas_"+t.TextureCacheIdGenerator++),0===e.width&&(e.width=1),0===e.height&&(e.height=1);var r=t.BaseTextureCache[e._pixiId];return r||(r=new t.BaseTexture(e,n),t.BaseTextureCache[e._pixiId]=r),r},t.TextureCache={},t.FrameCache={},t.TextureSilentFail=!1,t.TextureCacheIdGenerator=0,t.Texture=function(e,n,r,i){this.noFrame=!1,n||(this.noFrame=!0,n=new t.Rectangle(0,0,1,1)),e instanceof t.Texture&&(e=e.baseTexture),this.baseTexture=e,this.frame=n,this.trim=i,this.valid=!1,this.isTiling=!1,this.requiresUpdate=!1,this.requiresReTint=!1,this._uvs=null,this.width=0,this.height=0,this.crop=r||new t.Rectangle(0,0,1,1),e.hasLoaded&&(this.noFrame&&(n=new t.Rectangle(0,0,e.width,e.height)),this.setFrame(n))},t.Texture.prototype.constructor=t.Texture,t.Texture.prototype.onBaseTextureLoaded=function(){var e=this.baseTexture;this.noFrame&&(this.frame=new t.Rectangle(0,0,e.width,e.height)),this.setFrame(this.frame)},t.Texture.prototype.destroy=function(e){e&&this.baseTexture.destroy(),this.valid=!1},t.Texture.prototype.setFrame=function(e){if(this.noFrame=!1,this.frame=e,this.width=e.width,this.height=e.height,this.crop.x=e.x,this.crop.y=e.y,this.crop.width=e.width,this.crop.height=e.height,!this.trim&&(e.x+e.width>this.baseTexture.width||e.y+e.height>this.baseTexture.height)){if(!t.TextureSilentFail)throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);return void (this.valid=!1)}this.valid=e&&e.width&&e.height&&this.baseTexture.source&&this.baseTexture.hasLoaded,this.trim&&(this.width=this.trim.width,this.height=this.trim.height,this.frame.width=this.trim.width,this.frame.height=this.trim.height),this.valid&&this._updateUvs()},t.Texture.prototype._updateUvs=function(){this._uvs||(this._uvs=new t.TextureUvs);var e=this.crop,n=this.baseTexture.width,r=this.baseTexture.height;this._uvs.x0=e.x/n,this._uvs.y0=e.y/r,this._uvs.x1=(e.x+e.width)/n,this._uvs.y1=e.y/r,this._uvs.x2=(e.x+e.width)/n,this._uvs.y2=(e.y+e.height)/r,this._uvs.x3=e.x/n,this._uvs.y3=(e.y+e.height)/r},t.Texture.fromImage=function(e,n,r){var i=t.TextureCache[e];return i||(i=new t.Texture(t.BaseTexture.fromImage(e,n,r)),t.TextureCache[e]=i),i},t.Texture.fromFrame=function(e){var n=t.TextureCache[e];if(!n)throw new Error('The frameId "'+e+'" does not exist in the texture cache ');return n},t.Texture.fromCanvas=function(e,n){var r=t.BaseTexture.fromCanvas(e,n);return new t.Texture(r)},t.Texture.addTextureToCache=function(e,n){t.TextureCache[n]=e},t.Texture.removeTextureFromCache=function(e){var n=t.TextureCache[e];return delete t.TextureCache[e],delete t.BaseTextureCache[e],n},t.TextureUvs=function(){this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.x3=0,this.y3=0},t.RenderTexture=function(e,n,r,i,s){if(this.width=e||100,this.height=n||100,this.resolution=s||1,this.frame=new t.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution),this.crop=new t.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution),this.baseTexture=new t.BaseTexture,this.baseTexture.width=this.width*this.resolution,this.baseTexture.height=this.height*this.resolution,this.baseTexture._glTextures=[],this.baseTexture.resolution=this.resolution,this.baseTexture.scaleMode=i||t.scaleModes.DEFAULT,this.baseTexture.hasLoaded=!0,t.Texture.call(this,this.baseTexture,new t.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution)),this.renderer=r||t.defaultRenderer,this.renderer.type===t.WEBGL_RENDERER){var o=this.renderer.gl;this.baseTexture._dirty[o.id]=!1,this.textureBuffer=new t.FilterTexture(o,this.width,this.height,this.baseTexture.scaleMode),this.baseTexture._glTextures[o.id]=this.textureBuffer.texture,this.render=this.renderWebGL,this.projection=new t.Point(.5*this.width,.5*-this.height)}else this.render=this.renderCanvas,this.textureBuffer=new t.CanvasBuffer(this.width*this.resolution,this.height*this.resolution),this.baseTexture.source=this.textureBuffer.canvas;this.valid=!0,this.tempMatrix=new Phaser.Matrix,this._updateUvs()},t.RenderTexture.prototype=Object.create(t.Texture.prototype),t.RenderTexture.prototype.constructor=t.RenderTexture,t.RenderTexture.prototype.resize=function(e,n,r){(e!==this.width||n!==this.height)&&(this.valid=e>0&&n>0,this.width=e,this.height=n,this.frame.width=this.crop.width=e*this.resolution,this.frame.height=this.crop.height=n*this.resolution,r&&(this.baseTexture.width=this.width*this.resolution,this.baseTexture.height=this.height*this.resolution),this.renderer.type===t.WEBGL_RENDERER&&(this.projection.x=this.width/2,this.projection.y=-this.height/2),this.valid&&this.textureBuffer.resize(this.width,this.height))},t.RenderTexture.prototype.clear=function(){this.valid&&(this.renderer.type===t.WEBGL_RENDERER&&this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,this.textureBuffer.frameBuffer),this.textureBuffer.clear())},t.RenderTexture.prototype.renderWebGL=function(e,t,n){if(this.valid&&0!==e.alpha){var r=e.worldTransform;r.identity(),r.translate(0,2*this.projection.y),t&&r.append(t),r.scale(1,-1);for(var i=0;i<e.children.length;i++)e.children[i].updateTransform();var s=this.renderer.gl;s.viewport(0,0,this.width*this.resolution,this.height*this.resolution),s.bindFramebuffer(s.FRAMEBUFFER,this.textureBuffer.frameBuffer),n&&this.textureBuffer.clear(),this.renderer.spriteBatch.dirty=!0,this.renderer.renderDisplayObject(e,this.projection,this.textureBuffer.frameBuffer,t),this.renderer.spriteBatch.dirty=!0}},t.RenderTexture.prototype.renderCanvas=function(e,t,n){if(this.valid&&0!==e.alpha){var r=e.worldTransform;r.identity(),t&&r.append(t);for(var i=0;i<e.children.length;i++)e.children[i].updateTransform();n&&this.textureBuffer.clear();var s=this.renderer.resolution;this.renderer.resolution=this.resolution,this.renderer.renderDisplayObject(e,this.textureBuffer.context,t),this.renderer.resolution=s}},t.RenderTexture.prototype.getImage=function(){var e=new Image;return e.src=this.getBase64(),e},t.RenderTexture.prototype.getBase64=function(){return this.getCanvas().toDataURL()},t.RenderTexture.prototype.getCanvas=function(){if(this.renderer.type===t.WEBGL_RENDERER){var e=this.renderer.gl,n=this.textureBuffer.width,r=this.textureBuffer.height,i=new Uint8Array(4*n*r);e.bindFramebuffer(e.FRAMEBUFFER,this.textureBuffer.frameBuffer),e.readPixels(0,0,n,r,e.RGBA,e.UNSIGNED_BYTE,i),e.bindFramebuffer(e.FRAMEBUFFER,null);var s=new t.CanvasBuffer(n,r),o=s.context.getImageData(0,0,n,r);return o.data.set(i),s.context.putImageData(o,0,0),s.canvas}return this.textureBuffer.canvas},t.AbstractFilter=function(e,t){this.passes=[this],this.shaders=[],this.dirty=!0,this.padding=0,this.uniforms=t||{},this.fragmentSrc=e||[]},t.AbstractFilter.prototype.constructor=t.AbstractFilter,t.AbstractFilter.prototype.syncUniforms=function(){for(var e=0,t=this.shaders.length;t>e;e++)this.shaders[e].dirty=!0},t.Strip=function(e){t.DisplayObjectContainer.call(this),this.texture=e,this.uvs=new t.Float32Array([0,1,1,1,1,0,0,1]),this.vertices=new t.Float32Array([0,0,100,0,100,100,0,100]),this.colors=new t.Float32Array([1,1,1,1]),this.indices=new t.Uint16Array([0,1,2,3]),this.dirty=!0,this.blendMode=t.blendModes.NORMAL,this.canvasPadding=0,this.drawMode=t.Strip.DrawModes.TRIANGLE_STRIP},t.Strip.prototype=Object.create(t.DisplayObjectContainer.prototype),t.Strip.prototype.constructor=t.Strip,t.Strip.prototype._renderWebGL=function(e){!this.visible||this.alpha<=0||(e.spriteBatch.stop(),this._vertexBuffer||this._initWebGL(e),e.shaderManager.setShader(e.shaderManager.stripShader),this._renderStrip(e),e.spriteBatch.start())},t.Strip.prototype._initWebGL=function(e){var t=e.gl;this._vertexBuffer=t.createBuffer(),this._indexBuffer=t.createBuffer(),this._uvBuffer=t.createBuffer(),this._colorBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this._vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this._uvBuffer),t.bufferData(t.ARRAY_BUFFER,this.uvs,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this._colorBuffer),t.bufferData(t.ARRAY_BUFFER,this.colors,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW)},t.Strip.prototype._renderStrip=function(e){var n=e.gl,r=e.projection,i=e.offset,s=e.shaderManager.stripShader,o=this.drawMode===t.Strip.DrawModes.TRIANGLE_STRIP?n.TRIANGLE_STRIP:n.TRIANGLES;e.blendModeManager.setBlendMode(this.blendMode),n.uniformMatrix3fv(s.translationMatrix,!1,this.worldTransform.toArray(!0)),n.uniform2f(s.projectionVector,r.x,-r.y),n.uniform2f(s.offsetVector,-i.x,-i.y),n.uniform1f(s.alpha,this.worldAlpha),this.dirty?(this.dirty=!1,n.bindBuffer(n.ARRAY_BUFFER,this._vertexBuffer),n.bufferData(n.ARRAY_BUFFER,this.vertices,n.STATIC_DRAW),n.vertexAttribPointer(s.aVertexPosition,2,n.FLOAT,!1,0,0),n.bindBuffer(n.ARRAY_BUFFER,this._uvBuffer),n.bufferData(n.ARRAY_BUFFER,this.uvs,n.STATIC_DRAW),n.vertexAttribPointer(s.aTextureCoord,2,n.FLOAT,!1,0,0),n.activeTexture(n.TEXTURE0),this.texture.baseTexture._dirty[n.id]?e.renderer.updateTexture(this.texture.baseTexture):n.bindTexture(n.TEXTURE_2D,this.texture.baseTexture._glTextures[n.id]),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this._indexBuffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,this.indices,n.STATIC_DRAW)):(n.bindBuffer(n.ARRAY_BUFFER,this._vertexBuffer),n.bufferSubData(n.ARRAY_BUFFER,0,this.vertices),n.vertexAttribPointer(s.aVertexPosition,2,n.FLOAT,!1,0,0),n.bindBuffer(n.ARRAY_BUFFER,this._uvBuffer),n.vertexAttribPointer(s.aTextureCoord,2,n.FLOAT,!1,0,0),n.activeTexture(n.TEXTURE0),this.texture.baseTexture._dirty[n.id]?e.renderer.updateTexture(this.texture.baseTexture):n.bindTexture(n.TEXTURE_2D,this.texture.baseTexture._glTextures[n.id]),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this._indexBuffer)),n.drawElements(o,this.indices.length,n.UNSIGNED_SHORT,0)},t.Strip.prototype._renderCanvas=function(e){var n=e.context,r=this.worldTransform,i=r.tx*e.resolution+e.shakeX,s=r.ty*e.resolution+e.shakeY;e.roundPixels?n.setTransform(r.a,r.b,r.c,r.d,0|i,0|s):n.setTransform(r.a,r.b,r.c,r.d,i,s),this.drawMode===t.Strip.DrawModes.TRIANGLE_STRIP?this._renderCanvasTriangleStrip(n):this._renderCanvasTriangles(n)},t.Strip.prototype._renderCanvasTriangleStrip=function(e){var t=this.vertices,n=this.uvs,r=t.length/2;this.count++;for(var i=0;r-2>i;i++){var s=2*i;this._renderCanvasDrawTriangle(e,t,n,s,s+2,s+4)}},t.Strip.prototype._renderCanvasTriangles=function(e){var t=this.vertices,n=this.uvs,r=this.indices,i=r.length;this.count++;for(var s=0;i>s;s+=3){var o=2*r[s],u=2*r[s+1],a=2*r[s+2];this._renderCanvasDrawTriangle(e,t,n,o,u,a)}},t.Strip.prototype._renderCanvasDrawTriangle=function(e,t,n,r,i,s){var o=this.texture.baseTexture.source,u=this.texture.width,a=this.texture.height,f=t[r],l=t[i],c=t[s],h=t[r+1],p=t[i+1],d=t[s+1],v=n[r]*u,m=n[i]*u,g=n[s]*u,y=n[r+1]*a,b=n[i+1]*a,w=n[s+1]*a;if(this.canvasPadding>0){var E=this.canvasPadding/this.worldTransform.a,S=this.canvasPadding/this.worldTransform.d,x=(f+l+c)/3,T=(h+p+d)/3,N=f-x,C=h-T,k=Math.sqrt(N*N+C*C);f=x+N/k*(k+E),h=T+C/k*(k+S),N=l-x,C=p-T,k=Math.sqrt(N*N+C*C),l=x+N/k*(k+E),p=T+C/k*(k+S),N=c-x,C=d-T,k=Math.sqrt(N*N+C*C),c=x+N/k*(k+E),d=T+C/k*(k+S)}e.save(),e.beginPath(),e.moveTo(f,h),e.lineTo(l,p),e.lineTo(c,d),e.closePath(),e.clip();var L=v*b+y*g+m*w-b*g-y*m-v*w,A=f*b+y*c+l*w-b*c-y*l-f*w,O=v*l+f*g+m*c-l*g-f*m-v*c,M=v*b*c+y*l*g+f*m*w-f*b*g-y*m*c-v*l*w,_=h*b+y*d+p*w-b*d-y*p-h*w,D=v*p+h*g+m*d-p*g-h*m-v*d,P=v*b*d+y*p*g+h*m*w-h*b*g-y*m*d-v*p*w;e.transform(A/L,_/L,O/L,D/L,M/L,P/L),e.drawImage(o,0,0),e.restore()},t.Strip.prototype.renderStripFlat=function(e){var t=this.context,n=e.vertices,r=n.length/2;this.count++,t.beginPath();for(var i=1;r-2>i;i++){var s=2*i,o=n[s],u=n[s+2],a=n[s+4],f=n[s+1],l=n[s+3],c=n[s+5];t.moveTo(o,f),t.lineTo(u,l),t.lineTo(a,c)}t.fillStyle="#FF0000",t.fill(),t.closePath()},t.Strip.prototype.onTextureUpdate=function(){this.updateFrame=!0},t.Strip.prototype.getBounds=function(e){for(var n=e||this.worldTransform,r=n.a,i=n.b,s=n.c,o=n.d,u=n.tx,a=n.ty,f=-1/0,l=-1/0,c=1/0,h=1/0,p=this.vertices,d=0,v=p.length;v>d;d+=2){var m=p[d],g=p[d+1],y=r*m+s*g+u,w=o*g+i*m+a;c=c>y?y:c,h=h>w?w:h,f=y>f?y:f,l=w>l?w:l}if(c===-1/0||l===1/0)return t.EmptyRectangle;var E=this._bounds;return E.x=c,E.width=f-c,E.y=h,E.height=l-h,this._currentBounds=E,E},t.Strip.DrawModes={TRIANGLE_STRIP:0,TRIANGLES:1},t.Rope=function(e,n){t.Strip.call(this,e),this.points=n,this.vertices=new t.Float32Array(4*n.length),this.uvs=new t.Float32Array(4*n.length),this.colors=new t.Float32Array(2*n.length),this.indices=new t.Uint16Array(2*n.length),this.refresh()},t.Rope.prototype=Object.create(t.Strip.prototype),t.Rope.prototype.constructor=t.Rope,t.Rope.prototype.refresh=function(){var e=this.points;if(!(e.length<1)){var t=this.uvs,n=e[0],r=this.indices,i=this.colors;this.count-=.2,t[0]=0,t[1]=0,t[2]=0,t[3]=1,i[0]=1,i[1]=1,r[0]=0,r[1]=1;for(var s,o,u,a=e.length,f=1;a>f;f++)s=e[f],o=4*f,u=f/(a-1),f%2?(t[o]=u,t[o+1]=0,t[o+2]=u,t[o+3]=1):(t[o]=u,t[o+1]=0,t[o+2]=u,t[o+3]=1),o=2*f,i[o]=1,i[o+1]=1,o=2*f,r[o]=o,r[o+1]=o+1,n=s}},t.Rope.prototype.updateTransform=function(){var e=this.points;if(!(e.length<1)){var n,r=e[0],i={x:0,y:0};this.count-=.2;for(var s,o,u,a,f,l=this.vertices,c=e.length,h=0;c>h;h++)s=e[h],o=4*h,n=h<e.length-1?e[h+1]:s,i.y=-(n.x-r.x),i.x=n.y-r.y,u=10*(1-h/(c-1)),u>1&&(u=1),a=Math.sqrt(i.x*i.x+i.y*i.y),f=this.texture.height/2,i.x/=a,i.y/=a,i.x*=f,i.y*=f,l[o]=s.x+i.x,l[o+1]=s.y+i.y,l[o+2]=s.x-i.x,l[o+3]=s.y-i.y,r=s;t.DisplayObjectContainer.prototype.updateTransform.call(this)}},t.Rope.prototype.setTexture=function(e){this.texture=e},t.TilingSprite=function(e,n,r){t.Sprite.call(this,e),this._width=n||128,this._height=r||128,this.tileScale=new t.Point(1,1),this.tileScaleOffset=new t.Point(1,1),this.tilePosition=new t.Point,this.renderable=!0,this.tint=16777215,this.textureDebug=!1,this.blendMode=t.blendModes.NORMAL,this.canvasBuffer=null,this.tilingTexture=null,this.tilePattern=null,this.refreshTexture=!0,this.frameWidth=0,this.frameHeight=0},t.TilingSprite.prototype=Object.create(t.Sprite.prototype),t.TilingSprite.prototype.constructor=t.TilingSprite,t.TilingSprite.prototype.setTexture=function(e){this.texture!==e&&(this.texture=e,this.refreshTexture=!0,this.cachedTint=16777215)},t.TilingSprite.prototype._renderWebGL=function(e){if(this.visible&&this.renderable&&0!==this.alpha){if(this._mask&&(e.spriteBatch.stop(),e.maskManager.pushMask(this.mask,e),e.spriteBatch.start()),this._filters&&(e.spriteBatch.flush(),e.filterManager.pushFilter(this._filterBlock)),this.refreshTexture){if(this.generateTilingTexture(!0,e),!this.tilingTexture)return;this.tilingTexture.needsUpdate&&(e.renderer.updateTexture(this.tilingTexture.baseTexture),this.tilingTexture.needsUpdate=!1)}e.spriteBatch.renderTilingSprite(this);for(var t=0;t<this.children.length;t++)this.children[t]._renderWebGL(e);e.spriteBatch.stop(),this._filters&&e.filterManager.popFilter(),this._mask&&e.maskManager.popMask(this._mask,e),e.spriteBatch.start()}},t.TilingSprite.prototype._renderCanvas=function(e){if(this.visible&&this.renderable&&0!==this.alpha){var n=e.context;this._mask&&e.maskManager.pushMask(this._mask,e),n.globalAlpha=this.worldAlpha;var r=this.worldTransform,i=e.resolution,s=r.tx*i+e.shakeX,o=r.ty*i+e.shakeY;if(n.setTransform(r.a*i,r.b*i,r.c*i,r.d*i,s,o),this.refreshTexture){if(this.generateTilingTexture(!1,e),!this.tilingTexture)return;this.tilePattern=n.createPattern(this.tilingTexture.baseTexture.source,"repeat")}var u=e.currentBlendMode;this.blendMode!==e.currentBlendMode&&(e.currentBlendMode=this.blendMode,n.globalCompositeOperation=t.blendModesCanvas[e.currentBlendMode]);var a=this.tilePosition,f=this.tileScale;a.x%=this.tilingTexture.baseTexture.width,a.y%=this.tilingTexture.baseTexture.height,n.scale(f.x,f.y),n.translate(a.x+this.anchor.x*-this._width,a.y+this.anchor.y*-this._height),n.fillStyle=this.tilePattern;var s=-a.x,o=-a.y,l=this._width/f.x,c=this._height/f.y;e.roundPixels&&(s|=0,o|=0,l|=0,c|=0),n.fillRect(s,o,l,c),n.scale(1/f.x,1/f.y),n.translate(-a.x+this.anchor.x*this._width,-a.y+this.anchor.y*this._height),this._mask&&e.maskManager.popMask(e);for(var h=0;h<this.children.length;h++)this.children[h]._renderCanvas(e);u!==this.blendMode&&(e.currentBlendMode=u,n.globalCompositeOperation=t.blendModesCanvas[u])}},t.TilingSprite.prototype.onTextureUpdate=function(){},t.TilingSprite.prototype.generateTilingTexture=function(e,n){if(this.texture.baseTexture.hasLoaded){var r=this.texture,i=r.frame,s=this._frame.sourceSizeW||this._frame.width,o=this._frame.sourceSizeH||this._frame.height,u=0,a=0;this._frame.trimmed&&(u=this._frame.spriteSourceSizeX,a=this._frame.spriteSourceSizeY),e&&(s=t.getNextPowerOfTwo(s),o=t.getNextPowerOfTwo(o)),this.canvasBuffer?(this.canvasBuffer.resize(s,o),this.tilingTexture.baseTexture.width=s,this.tilingTexture.baseTexture.height=o,this.tilingTexture.needsUpdate=!0):(this.canvasBuffer=new t.CanvasBuffer(s,o),this.tilingTexture=t.Texture.fromCanvas(this.canvasBuffer.canvas),this.tilingTexture.isTiling=!0,this.tilingTexture.needsUpdate=!0),this.textureDebug&&(this.canvasBuffer.context.strokeStyle="#00ff00",this.canvasBuffer.context.strokeRect(0,0,s,o));var f=r.crop.width,l=r.crop.height;(f!==s||l!==o)&&(f=s,l=o),this.canvasBuffer.context.drawImage(r.baseTexture.source,r.crop.x,r.crop.y,r.crop.width,r.crop.height,u,a,f,l),this.tileScaleOffset.x=i.width/s,this.tileScaleOffset.y=i.height/o,this.refreshTexture=!1,this.tilingTexture.baseTexture._powerOf2=!0}},t.TilingSprite.prototype.getBounds=function(){var e=this._width,t=this._height,n=e*(1-this.anchor.x),r=e*-this.anchor.x,i=t*(1-this.anchor.y),s=t*-this.anchor.y,o=this.worldTransform,u=o.a,a=o.b,f=o.c,l=o.d,c=o.tx,h=o.ty,p=u*r+f*s+c,d=l*s+a*r+h,v=u*n+f*s+c,m=l*s+a*n+h,g=u*n+f*i+c,y=l*i+a*n+h,b=u*r+f*i+c,w=l*i+a*r+h,E=-1/0,S=-1/0,x=1/0,T=1/0;x=x>p?p:x,x=x>v?v:x,x=x>g?g:x,x=x>b?b:x,T=T>d?d:T,T=T>m?m:T,T=T>y?y:T,T=T>w?w:T,E=p>E?p:E,E=v>E?v:E,E=g>E?g:E,E=b>E?b:E,S=d>S?d:S,S=m>S?m:S,S=y>S?y:S,S=w>S?w:S;var N=this._bounds;return N.x=x,N.width=E-x,N.y=T,N.height=S-T,this._currentBounds=N,N},t.TilingSprite.prototype.destroy=function(){t.Sprite.prototype.destroy.call(this),this.canvasBuffer&&(this.canvasBuffer.destroy(),this.canvasBuffer=null),this.tileScale=null,this.tileScaleOffset=null,this.tilePosition=null,this.tilingTexture&&(this.tilingTexture.destroy(!0),this.tilingTexture=null)},Object.defineProperty(t.TilingSprite.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e}}),Object.defineProperty(t.TilingSprite.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e}}),"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=t),exports.PIXI=t):"undefined"!=typeof define&&define.amd?define("PIXI",function(){return e.PIXI=t}()):e.PIXI=t,t}.call(this),function(){function e(e,t){this._scaleFactor=e,this._deltaMode=t,this.originalEvent=null}var t=this,n=n||{VERSION:"2.4.8",GAMES:[],AUTO:0,CANVAS:1,WEBGL:2,HEADLESS:3,NONE:0,LEFT:1,RIGHT:2,UP:3,DOWN:4,SPRITE:0,BUTTON:1,IMAGE:2,GRAPHICS:3,TEXT:4,TILESPRITE:5,BITMAPTEXT:6,GROUP:7,RENDERTEXTURE:8,TILEMAP:9,TILEMAPLAYER:10,EMITTER:11,POLYGON:12,BITMAPDATA:13,CANVAS_FILTER:14,WEBGL_FILTER:15,ELLIPSE:16,SPRITEBATCH:17,RETROFONT:18,POINTER:19,ROPE:20,CIRCLE:21,RECTANGLE:22,LINE:23,MATRIX:24,POINT:25,ROUNDEDRECTANGLE:26,CREATURE:27,VIDEO:28,PENDING_ATLAS:-1,blendModes:{NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},scaleModes:{DEFAULT:0,LINEAR:0,NEAREST:1},PIXI:PIXI||{}};if(Math.trunc||(Math.trunc=function(e){return 0>e?Math.ceil(e):Math.floor(e)}),Function.prototype.bind||(Function.prototype.bind=function(){var e=Array.prototype.slice;return function(t){function n(){var s=i.concat(e.call(arguments));r.apply(this instanceof n?this:t,s)}var r=this,i=e.call(arguments,1);if("function"!=typeof r)throw new TypeError;return n.prototype=function s(e){return e&&(s.prototype=e),this instanceof s?void 0:new s}(r.prototype),n}}()),Array.isArray||(Array.isArray=function(e){return"[object Array]"==Object.prototype.toString.call(e)}),Array.prototype.forEach||(Array.prototype.forEach=function(e){"use strict";if(void 0===this||null===this)throw new TypeError;var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var r=arguments.length>=2?arguments[1]:void 0,i=0;n>i;i++)i in t&&e.call(r,t[i],i,t)}),"function"!=typeof window.Uint32Array&&"object"!=typeof window.Uint32Array){var r=function(e){var t=new Array;window[e]=function(e){if("number"==typeof e){Array.call(this,e),this.length=e;for(var t=0;t<this.length;t++)this[t]=0}else{Array.call(this,e.length),this.length=e.length;for(var t=0;t<this.length;t++)this[t]=e[t]}},window[e].prototype=t,window[e].constructor=window[e]};r("Uint32Array"),r("Int16Array")}window.console||(window.console={},window.console.log=window.console.assert=function(){},window.console.warn=window.console.assert=function(){}),n.Utils={getProperty:function(e,t){for(var n=t.split("."),r=n.pop(),i=n.length,s=1,o=n[0];i>s&&(e=e[o]);)o=n[s],s++;return e?e[r]:null},setProperty:function(e,t,n){for(var r=t.split("."),i=r.pop(),s=r.length,o=1,u=r[0];s>o&&(e=e[u]);)u=r[o],o++;return e&&(e[i]=n),e},chanceRoll:function(e){return void 0===e&&(e=50),e>0&&100*Math.random()<=e},randomChoice:function(e,t){return Math.random()<.5?e:t},parseDimension:function(e,t){var n=0,r=0;return"string"==typeof e?"%"===e.substr(-1)?(n=parseInt(e,10)/100,r=0===t?window.innerWidth*n:window.innerHeight*n):r=parseInt(e,10):r=e,r},pad:function(e,t,n,r){if(void 0===t)var t=0;if(void 0===n)var n=" ";if(void 0===r)var r=3;var i=0;if(t+1>=e.length)switch(r){case 1:e=(new Array(t+1-e.length)).join(n)+e;break;case 3:var s=Math.ceil((i=t-e.length)/2),o=i-s;e=(new Array(o+1)).join(n)+e+(new Array(s+1)).join(n);break;default:e+=(new Array(t+1-e.length)).join(n)}return e},isPlainObject:function(e){if("object"!=typeof e||e.nodeType||e===e.window)return!1;try{if(e.constructor&&!{}.hasOwnProperty.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},extend:function(){var e,t,r,i,s,o,u=arguments[0]||{},a=1,f=arguments.length,l=!1;for("boolean"==typeof u&&(l=u,u=arguments[1]||{},a=2),f===a&&(u=this,--a);f>a;a++)if(null!=(e=arguments[a]))for(t in e)r=u[t],i=e[t],u!==i&&(l&&i&&(n.Utils.isPlainObject(i)||(s=Array.isArray(i)))?(s?(s=!1,o=r&&Array.isArray(r)?r:[]):o=r&&n.Utils.isPlainObject(r)?r:{},u[t]=n.Utils.extend(l,o,i)):void 0!==i&&(u[t]=i));return u},mixinPrototype:function(e,t,n){void 0===n&&(n=!1);for(var r=Object.keys(t),i=0;i<r.length;i++){var s=r[i],o=t[s];!n&&s in e||(!o||"function"!=typeof o.get&&"function"!=typeof o.set?e[s]=o:"function"==typeof o.clone?e[s]=o.clone():Object.defineProperty(e,s,o))}},mixin:function(e,t){if(!e||"object"!=typeof e)return t;for(var r in e){var i=e[r];if(!i.childNodes&&!i.cloneNode){var s=typeof e[r];e[r]&&"object"===s?typeof t[r]===s?t[r]=n.Utils.mixin(e[r],t[r]):t[r]=n.Utils.mixin(e[r],new i.constructor):t[r]=e[r]}}return t}},n.Circle=function(e,t,r){e=e||0,t=t||0,r=r||0,this.x=e,this.y=t,this._diameter=r,this._radius=0,r>0&&(this._radius=.5*r),this.type=n.CIRCLE},n.Circle.prototype={circumference:function(){return 2*Math.PI*this._radius},random:function(e){void 0===e&&(e=new n.Point);var t=2*Math.PI*Math.random(),r=Math.random()+Math.random(),i=r>1?2-r:r,s=i*Math.cos(t),o=i*Math.sin(t);return e.x=this.x+s*this.radius,e.y=this.y+o*this.radius,e},getBounds:function(){return new n.Rectangle(this.x-this.radius,this.y-this.radius,this.diameter,this.diameter)},setTo:function(e,t,n){return this.x=e,this.y=t,this._diameter=n,this._radius=.5*n,this},copyFrom:function(e){return this.setTo(e.x,e.y,e.diameter)},copyTo:function(e){return e.x=this.x,e.y=this.y,e.diameter=this._diameter,e},distance:function(e,t){var r=n.Math.distance(this.x,this.y,e.x,e.y);return t?Math.round(r):r},clone:function(e){return void 0===e||null===e?e=new n.Circle(this.x,this.y,this.diameter):e.setTo(this.x,this.y,this.diameter),e},contains:function(e,t){return n.Circle.contains(this,e,t)},circumferencePoint:function(e,t,r){return n.Circle.circumferencePoint(this,e,t,r)},offset:function(e,t){return this.x+=e,this.y+=t,this},offsetPoint:function(e){return this.offset(e.x,e.y)},toString:function(){return"[{Phaser.Circle (x="+this.x+" y="+this.y+" diameter="+this.diameter+" radius="+this.radius+")}]"}},n.Circle.prototype.constructor=n.Circle,Object.defineProperty(n.Circle.prototype,"diameter",{get:function(){return this._diameter},set:function(e){e>0&&(this._diameter=e,this._radius=.5*e)}}),Object.defineProperty(n.Circle.prototype,"radius",{get:function(){return this._radius},set:function(e){e>0&&(this._radius=e,this._diameter=2*e)}}),Object.defineProperty(n.Circle.prototype,"left",{get:function(){return this.x-this._radius},set:function(e){e>this.x?(this._radius=0,this._diameter=0):this.radius=this.x-e}}),Object.defineProperty(n.Circle.prototype,"right",{get:function(){return this.x+this._radius},set:function(e){e<this.x?(this._radius=0,this._diameter=0):this.radius=e-this.x}}),Object.defineProperty(n.Circle.prototype,"top",{get:function(){return this.y-this._radius},set:function(e){e>this.y?(this._radius=0,this._diameter=0):this.radius=this.y-e}}),Object.defineProperty(n.Circle.prototype,"bottom",{get:function(){return this.y+this._radius},set:function(e){e<this.y?(this._radius=0,this._diameter=0):this.radius=e-this.y}}),Object.defineProperty(n.Circle.prototype,"area",{get:function(){return this._radius>0?Math.PI*this._radius*this._radius:0}}),Object.defineProperty(n.Circle.prototype,"empty",{get:function(){return 0===this._diameter},set:function(e){e===!0&&this.setTo(0,0,0)}}),n.Circle.contains=function(e,t,n){if(e.radius>0&&t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom){var r=(e.x-t)*(e.x-t),i=(e.y-n)*(e.y-n);return r+i<=e.radius*e.radius}return!1},n.Circle.equals=function(e,t){return e.x==t.x&&e.y==t.y&&e.diameter==t.diameter},n.Circle.intersects=function(e,t){return n.Math.distance(e.x,e.y,t.x,t.y)<=e.radius+t.radius},n.Circle.circumferencePoint=function(e,t,r,i){return void 0===r&&(r=!1),void 0===i&&(i=new n.Point),r===!0&&(t=n.Math.degToRad(t)),i.x=e.x+e.radius*Math.cos(t),i.y=e.y+e.radius*Math.sin(t),i},n.Circle.intersectsRectangle=function(e,t){var n=Math.abs(e.x-t.x-t.halfWidth),r=t.halfWidth+e.radius;if(n>r)return!1;var i=Math.abs(e.y-t.y-t.halfHeight),s=t.halfHeight+e.radius;if(i>s)return!1;if(n<=t.halfWidth||i<=t.halfHeight)return!0;var o=n-t.halfWidth,u=i-t.halfHeight,a=o*o,f=u*u,l=e.radius*e.radius;return l>=a+f},PIXI.Circle=n.Circle,n.Ellipse=function(e,t,r,i){e=e||0,t=t||0,r=r||0,i=i||0,this.x=e,this.y=t,this.width=r,this.height=i,this.type=n.ELLIPSE},n.Ellipse.prototype={setTo:function(e,t,n,r){return this.x=e,this.y=t,this.width=n,this.height=r,this},getBounds:function(){return new n.Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)},copyFrom:function(e){return this.setTo(e.x,e.y,e.width,e.height)},copyTo:function(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e},clone:function(e){return void 0===e||null===e?e=new n.Ellipse(this.x,this.y,this.width,this.height):e.setTo(this.x,this.y,this.width,this.height),e},contains:function(e,t){return n.Ellipse.contains(this,e,t)},random:function(e){void 0===e&&(e=new n.Point);var t=Math.random()*Math.PI*2,r=Math.random();return e.x=Math.sqrt(r)*Math.cos(t),e.y=Math.sqrt(r)*Math.sin(t),e.x=this.x+e.x*this.width/2,e.y=this.y+e.y*this.height/2,e},toString:function(){return"[{Phaser.Ellipse (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+")}]"}},n.Ellipse.prototype.constructor=n.Ellipse,Object.defineProperty(n.Ellipse.prototype,"left",{get:function(){return this.x},set:function(e){this.x=e}}),Object.defineProperty(n.Ellipse.prototype,"right",{get:function(){return this.x+this.width},set:function(e){e<this.x?this.width=0:this.width=e-this.x}}),Object.defineProperty(n.Ellipse.prototype,"top",{get:function(){return this.y},set:function(e){this.y=e}}),Object.defineProperty(n.Ellipse.prototype,"bottom",{get:function(){return this.y+this.height},set:function(e){e<this.y?this.height=0:this.height=e-this.y}}),Object.defineProperty(n.Ellipse.prototype,"empty",{get:function(){return 0===this.width||0===this.height},set:function(e){e===!0&&this.setTo(0,0,0,0)}}),n.Ellipse.contains=function(e,t,n){if(e.width<=0||e.height<=0)return!1;var r=(t-e.x)/e.width-.5,i=(n-e.y)/e.height-.5;return r*=r,i*=i,.25>r+i},PIXI.Ellipse=n.Ellipse,n.Line=function(e,t,r,i){e=e||0,t=t||0,r=r||0,i=i||0,this.start=new n.Point(e,t),this.end=new n.Point(r,i),this.type=n.LINE},n.Line.prototype={setTo:function(e,t,n,r){return this.start.setTo(e,t),this.end.setTo(n,r),this},fromSprite:function(e,t,n){return void 0===n&&(n=!1),n?this.setTo(e.center.x,e.center.y,t.center.x,t.center.y):this.setTo(e.x,e.y,t.x,t.y)},fromAngle:function(e,t,n,r){return this.start.setTo(e,t),this.end.setTo(e+Math.cos(n)*r,t+Math.sin(n)*r),this},rotate:function(e,t){var n=(this.start.x+this.end.x)/2,r=(this.start.y+this.end.y)/2;return this.start.rotate(n,r,e,t),this.end.rotate(n,r,e,t),this},rotateAround:function(e,t,n,r){return this.start.rotate(e,t,n,r),this.end.rotate(e,t,n,r),this},intersects:function(e,t,r){return n.Line.intersectsPoints(this.start,this.end,e.start,e.end,t,r)},reflect:function(e){return n.Line.reflect(this,e)},midPoint:function(e){return void 0===e&&(e=new n.Point),e.x=(this.start.x+this.end.x)/2,e.y=(this.start.y+this.end.y)/2,e},centerOn:function(e,t){var n=(this.start.x+this.end.x)/2,r=(this.start.y+this.end.y)/2,i=e-n,s=t-r;this.start.add(i,s),this.end.add(i,s)},pointOnLine:function(e,t){return(e-this.start.x)*(this.end.y-this.start.y)===(this.end.x-this.start.x)*(t-this.start.y)},pointOnSegment:function(e,t){var n=Math.min(this.start.x,this.end.x),r=Math.max(this.start.x,this.end.x),i=Math.min(this.start.y,this.end.y),s=Math.max(this.start.y,this.end.y);return this.pointOnLine(e,t)&&e>=n&&r>=e&&t>=i&&s>=t},random:function(e){void 0===e&&(e=new n.Point);var t=Math.random();return e.x=this.start.x+t*(this.end.x-this.start.x),e.y=this.start.y+t*(this.end.y-this.start.y),e},coordinatesOnLine:function(e,t){void 0===e&&(e=1),void 0===t&&(t=[]);var n=Math.round(this.start.x),r=Math.round(this.start.y),i=Math.round(this.end.x),s=Math.round(this.end.y),o=Math.abs(i-n),u=Math.abs(s-r),a=i>n?1:-1,f=s>r?1:-1,l=o-u;t.push([n,r]);for(var c=1;n!=i||r!=s;){var h=l<<1;h>-u&&(l-=u,n+=a),o>h&&(l+=o,r+=f),c%e===0&&t.push([n,r]),c++}return t},clone:function(e){return void 0===e||null===e?e=new n.Line(this.start.x,this.start.y,this.end.x,this.end.y):e.setTo(this.start.x,this.start.y,this.end.x,this.end.y),e}},Object.defineProperty(n.Line.prototype,"length",{get:function(){return Math.sqrt((this.end.x-this.start.x)*(this.end.x-this.start.x)+(this.end.y-this.start.y)*(this.end.y-this.start.y))}}),Object.defineProperty(n.Line.prototype,"angle",{get:function(){return Math.atan2(this.end.y-this.start.y,this.end.x-this.start.x)}}),Object.defineProperty(n.Line.prototype,"slope",{get:function(){return(this.end.y-this.start.y)/(this.end.x-this.start.x)}}),Object.defineProperty(n.Line.prototype,"perpSlope",{get:function(){return-((this.end.x-this.start.x)/(this.end.y-this.start.y))}}),Object.defineProperty(n.Line.prototype,"x",{get:function(){return Math.min(this.start.x,this.end.x)}}),Object.defineProperty(n.Line.prototype,"y",{get:function(){return Math.min(this.start.y,this.end.y)}}),Object.defineProperty(n.Line.prototype,"left",{get:function(){return Math.min(this.start.x,this.end.x)}}),Object.defineProperty(n.Line.prototype,"right",{get:function(){return Math.max(this.start.x,this.end.x)}}),Object.defineProperty(n.Line.prototype,"top",{get:function(){return Math.min(this.start.y,this.end.y)}}),Object.defineProperty(n.Line.prototype,"bottom",{get:function(){return Math.max(this.start.y,this.end.y)}}),Object.defineProperty(n.Line.prototype,"width",{get:function(){return Math.abs(this.start.x-this.end.x)}}),Object.defineProperty(n.Line.prototype,"height",{get:function(){return Math.abs(this.start.y-this.end.y)}}),Object.defineProperty(n.Line.prototype,"normalX",{get:function(){return Math.cos(this.angle-1.5707963267948966)}}),Object.defineProperty(n.Line.prototype,"normalY",{get:function(){return Math.sin(this.angle-1.5707963267948966)}}),Object.defineProperty(n.Line.prototype,"normalAngle",{get:function(){return n.Math.wrap(this.angle-1.5707963267948966,-Math.PI,Math.PI)}}),n.Line.intersectsPoints=function(e,t,r,i,s,o){void 0===s&&(s=!0),void 0===o&&(o=new n.Point);var u=t.y-e.y,a=i.y-r.y,f=e.x-t.x,l=r.x-i.x,c=t.x*e.y-e.x*t.y,h=i.x*r.y-r.x*i.y,p=u*l-a*f;if(0===p)return null;if(o.x=(f*h-l*c)/p,o.y=(a*c-u*h)/p,s){var d=(i.y-r.y)*(t.x-e.x)-(i.x-r.x)*(t.y-e.y),v=((i.x-r.x)*(e.y-r.y)-(i.y-r.y)*(e.x-r.x))/d,m=((t.x-e.x)*(e.y-r.y)-(t.y-e.y)*(e.x-r.x))/d;return v>=0&&1>=v&&m>=0&&1>=m?o:null}return o},n.Line.intersects=function(e,t,r,i){return n.Line.intersectsPoints(e.start,e.end,t.start,t.end,r,i)},n.Line.reflect=function(e,t){return 2*t.normalAngle-3.141592653589793-e.angle},n.Matrix=function(e,t,r,i,s,o){e=e||1,t=t||0,r=r||0,i=i||1,s=s||0,o=o||0,this.a=e,this.b=t,this.c=r,this.d=i,this.tx=s,this.ty=o,this.type=n.MATRIX},n.Matrix.prototype={fromArray:function(e){return this.setTo(e[0],e[1],e[3],e[4],e[2],e[5])},setTo:function(e,t,n,r,i,s){return this.a=e,this.b=t,this.c=n,this.d=r,this.tx=i,this.ty=s,this},clone:function(e){return void 0===e||null===e?e=new n.Matrix(this.a,this.b,this.c,this.d,this.tx,this.ty):(e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty),e},copyTo:function(e){return e.copyFrom(this),e},copyFrom:function(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this},toArray:function(e,t){return void 0===t&&(t=new PIXI.Float32Array(9)),e?(t[0]=this.a,t[1]=this.b,t[2]=0,t[3]=this.c,t[4]=this.d,t[5]=0,t[6]=this.tx,t[7]=this.ty,t[8]=1):(t[0]=this.a,t[1]=this.c,t[2]=this.tx,t[3]=this.b,t[4]=this.d,t[5]=this.ty,t[6]=0,t[7]=0,t[8]=1),t},apply:function(e,t){return void 0===t&&(t=new n.Point),t.x=this.a*e.x+this.c*e.y+this.tx,t.y=this.b*e.x+this.d*e.y+this.ty,t},applyInverse:function(e,t){void 0===t&&(t=new n.Point);var r=1/(this.a*this.d+this.c*-this.b),i=e.x,s=e.y;return t.x=this.d*r*i+ -this.c*r*s+(this.ty*this.c-this.tx*this.d)*r,t.y=this.a*r*s+ -this.b*r*i+(-this.ty*this.a+this.tx*this.b)*r,t},translate:function(e,t){return this.tx+=e,this.ty+=t,this},scale:function(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this},rotate:function(e){var t=Math.cos(e),n=Math.sin(e),r=this.a,i=this.c,s=this.tx;return this.a=r*t-this.b*n,this.b=r*n+this.b*t,this.c=i*t-this.d*n,this.d=i*n+this.d*t,this.tx=s*t-this.ty*n,this.ty=s*n+this.ty*t,this},append:function(e){var t=this.a,n=this.b,r=this.c,i=this.d;return this.a=e.a*t+e.b*r,this.b=e.a*n+e.b*i,this.c=e.c*t+e.d*r,this.d=e.c*n+e.d*i,this.tx=e.tx*t+e.ty*r+this.tx,this.ty=e.tx*n+e.ty*i+this.ty,this},identity:function(){return this.setTo(1,0,0,1,0,0)}},n.identityMatrix=new n.Matrix,PIXI.Matrix=n.Matrix,PIXI.identityMatrix=n.identityMatrix,n.Point=function(e,t){e=e||0,t=t||0,this.x=e,this.y=t,this.type=n.POINT},n.Point.prototype={copyFrom:function(e){return this.setTo(e.x,e.y)},invert:function(){return this.setTo(this.y,this.x)},setTo:function(e,t){return this.x=e||0,this.y=t||(0!==t?this.x:0),this},set:function(e,t){return this.x=e||0,this.y=t||(0!==t?this.x:0),this},add:function(e,t){return this.x+=e,this.y+=t,this},subtract:function(e,t){return this.x-=e,this.y-=t,this},multiply:function(e,t){return this.x*=e,this.y*=t,this},divide:function(e,t){return this.x/=e,this.y/=t,this},clampX:function(e,t){return this.x=n.Math.clamp(this.x,e,t),this},clampY:function(e,t){return this.y=n.Math.clamp(this.y,e,t),this},clamp:function(e,t){return this.x=n.Math.clamp(this.x,e,t),this.y=n.Math.clamp(this.y,e,t),this},clone:function(e){return void 0===e||null===e?e=new n.Point(this.x,this.y):e.setTo(this.x,this.y),e},copyTo:function(e){return e.x=this.x,e.y=this.y,e},distance:function(e,t){return n.Point.distance(this,e,t)},equals:function(e){return e.x===this.x&&e.y===this.y},angle:function(e,t){return void 0===t&&(t=!1),t?n.Math.radToDeg(Math.atan2(e.y-this.y,e.x-this.x)):Math.atan2(e.y-this.y,e.x-this.x)},rotate:function(e,t,r,i,s){return n.Point.rotate(this,e,t,r,i,s)},getMagnitude:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},getMagnitudeSq:function(){return this.x*this.x+this.y*this.y},setMagnitude:function(e){return this.normalize().multiply(e,e)},normalize:function(){if(!this.isZero()){var e=this.getMagnitude();this.x/=e,this.y/=e}return this},isZero:function(){return 0===this.x&&0===this.y},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},perp:function(){return this.setTo(-this.y,this.x)},rperp:function(){return this.setTo(this.y,-this.x)},normalRightHand:function(){return this.setTo(-1*this.y,this.x)},floor:function(){return this.setTo(Math.floor(this.x),Math.floor(this.y))},ceil:function(){return this.setTo(Math.ceil(this.x),Math.ceil(this.y))},toString:function(){return"[{Point (x="+this.x+" y="+this.y+")}]"}},n.Point.prototype.constructor=n.Point,n.Point.add=function(e,t,r){return void 0===r&&(r=new n.Point),r.x=e.x+t.x,r.y=e.y+t.y,r},n.Point.subtract=function(e,t,r){return void 0===r&&(r=new n.Point),r.x=e.x-t.x,r.y=e.y-t.y,r},n.Point.multiply=function(e,t,r){return void 0===r&&(r=new n.Point),r.x=e.x*t.x,r.y=e.y*t.y,r},n.Point.divide=function(e,t,r){return void 0===r&&(r=new n.Point),r.x=e.x/t.x,r.y=e.y/t.y,r},n.Point.equals=function(e,t){return e.x===t.x&&e.y===t.y},n.Point.angle=function(e,t){return Math.atan2(e.y-t.y,e.x-t.x)},n.Point.negative=function(e,t){return void 0===t&&(t=new n.Point),t.setTo(-e.x,-e.y)},n.Point.multiplyAdd=function(e,t,r,i){return void 0===i&&(i=new n.Point),i.setTo(e.x+t.x*r,e.y+t.y*r)},n.Point.interpolate=function(e,t,r,i){return void 0===i&&(i=new n.Point),i.setTo(e.x+(t.x-e.x)*r,e.y+(t.y-e.y)*r)},n.Point.perp=function(e,t){return void 0===t&&(t=new n.Point),t.setTo(-e.y,e.x)},n.Point.rperp=function(e,t){return void 0===t&&(t=new n.Point),t.setTo(e.y,-e.x)},n.Point.distance=function(e,t,r){var i=n.Math.distance(e.x,e.y,t.x,t.y);return r?Math.round(i):i},n.Point.project=function(e,t,r){void 0===r&&(r=new n.Point);var i=e.dot(t)/t.getMagnitudeSq();return 0!==i&&r.setTo(i*t.x,i*t.y),r},n.Point.projectUnit=function(e,t,r){void 0===r&&(r=new n.Point);var i=e.dot(t);return 0!==i&&r.setTo(i*t.x,i*t.y),r},n.Point.normalRightHand=function(e,t){return void 0===t&&(t=new n.Point),t.setTo(-1*e.y,e.x)},n.Point.normalize=function(e,t){void 0===t&&(t=new n.Point);var r=e.getMagnitude();return 0!==r&&t.setTo(e.x/r,e.y/r),t},n.Point.rotate=function(e,t,r,i,s,o){if(s&&(i=n.Math.degToRad(i)),void 0===o){e.subtract(t,r);var u=Math.sin(i),a=Math.cos(i),f=a*e.x-u*e.y,l=u*e.x+a*e.y;e.x=f+t,e.y=l+r}else{var c=i+Math.atan2(e.y-r,e.x-t);e.x=t+o*Math.cos(c),e.y=r+o*Math.sin(c)}return e},n.Point.centroid=function(e,t){if(void 0===t&&(t=new n.Point),"[object Array]"!==Object.prototype.toString.call(e))throw new Error("Phaser.Point. Parameter 'points' must be an array");var r=e.length;if(1>r)throw new Error("Phaser.Point. Parameter 'points' array must not be empty");if(1===r)return t.copyFrom(e[0]),t;for(var i=0;r>i;i++)n.Point.add(t,e[i],t);return t.divide(r,r),t},n.Point.parse=function(e,t,r){t=t||"x",r=r||"y";var i=new n.Point;return e[t]&&(i.x=parseInt(e[t],10)),e[r]&&(i.y=parseInt(e[r],10)),i},PIXI.Point=n.Point,n.Polygon=function(){this.area=0,this._points=[],arguments.length>0&&this.setTo.apply(this,arguments),this.closed=!0,this.type=n.POLYGON},n.Polygon.prototype={toNumberArray:function(e){void 0===e&&(e=[]);for(var t=0;t<this._points.length;t++)"number"==typeof this._points[t]?(e.push(this._points[t]),e.push(this._points[t+1]),t++):(e.push(this._points[t].x),e.push(this._points[t].y));return e},flatten:function(){return this._points=this.toNumberArray(),this},clone:function(e){var t=this._points.slice();return void 0===e||null===e?e=new n.Polygon(t):e.setTo(t),e},contains:function(e,t){for(var n=this._points.length,r=!1,i=-1,s=n-1;++i<n;s=i){var o=this._points[i].x,u=this._points[i].y,a=this._points[s].x,f=this._points[s].y;(t>=u&&f>t||t>=f&&u>t)&&(a-o)*(t-u)/(f-u)+o>e&&(r=!r)}return r},setTo:function(e){if(this.area=0,this._points=[],arguments.length>0){Array.isArray(e)||(e=Array.prototype.slice.call(arguments));for(var t=Number.MAX_VALUE,n=0,r=e.length;r>n;n++){if("number"==typeof e[n]){var i=new PIXI.Point(e[n],e[n+1]);n++}else if(Array.isArray(e[n]))var i=new PIXI.Point(e[n][0],e[n][1]);else var i=new PIXI.Point(e[n].x,e[n].y);this._points.push(i),i.y<t&&(t=i.y)}this.calculateArea(t)}return this},calculateArea:function(e){for(var t,n,r,i,s=0,o=this._points.length;o>s;s++)t=this._points[s],n=s===o-1?this._points[0]:this._points[s+1],r=(t.y-e+(n.y-e))/2,i=t.x-n.x,this.area+=r*i;return this.area}},n.Polygon.prototype.constructor=n.Polygon,Object.defineProperty(n.Polygon.prototype,"points",{get:function(){return this._points},set:function(e){null!=e?this.setTo(e):this.setTo()}}),PIXI.Polygon=n.Polygon,n.Rectangle=function(e,t,r,i){e=e||0,t=t||0,r=r||0,i=i||0,this.x=e,this.y=t,this.width=r,this.height=i,this.type=n.RECTANGLE},n.Rectangle.prototype={offset:function(e,t){return this.x+=e,this.y+=t,this},offsetPoint:function(e){return this.offset(e.x,e.y)},setTo:function(e,t,n,r){return this.x=e,this.y=t,this.width=n,this.height=r,this},scale:function(e,t){return void 0===t&&(t=e),this.width*=e,this.height*=t,this},centerOn:function(e,t){return this.centerX=e,this.centerY=t,this},floor:function(){this.x=Math.floor(this.x),this.y=Math.floor(this.y)},floorAll:function(){this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.width=Math.floor(this.width),this.height=Math.floor(this.height)},ceil:function(){this.x=Math.ceil(this.x),this.y=Math.ceil(this.y)},ceilAll:function(){this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.width=Math.ceil(this.width),this.height=Math.ceil(this.height)},copyFrom:function(e){return this.setTo(e.x,e.y,e.width,e.height)},copyTo:function(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e},inflate:function(e,t){return n.Rectangle.inflate(this,e,t)},size:function(e){return n.Rectangle.size(this,e)},resize:function(e,t){return this.width=e,this.height=t,this},clone:function(e){return n.Rectangle.clone(this,e)},contains:function(e,t){return n.Rectangle.contains(this,e,t)},containsRect:function(e){return n.Rectangle.containsRect(e,this)},equals:function(e){return n.Rectangle.equals(this,e)},intersection:function(e,t){return n.Rectangle.intersection(this,e,t)},intersects:function(e){return n.Rectangle.intersects(this,e)},intersectsRaw:function(e,t,r,i,s){return n.Rectangle.intersectsRaw(this,e,t,r,i,s)},union:function(e,t){return n.Rectangle.union(this,e,t)},random:function(e){return void 0===e&&(e=new n.Point),e.x=this.randomX,e.y=this.randomY,e},toString:function(){return"[{Rectangle (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+" empty="+this.empty+")}]"}},Object.defineProperty(n.Rectangle.prototype,"halfWidth",{get:function(){return Math.round(this.width/2)}}),Object.defineProperty(n.Rectangle.prototype,"halfHeight",{get:function(){return Math.round(this.height/2)}}),Object.defineProperty(n.Rectangle.prototype,"bottom",{get:function(){return this.y+this.height},set:function(e){e<=this.y?this.height=0:this.height=e-this.y}}),Object.defineProperty(n.Rectangle.prototype,"bottomLeft",{get:function(){return new n.Point(this.x,this.bottom)},set:function(e){this.x=e.x,this.bottom=e.y}}),Object.defineProperty(n.Rectangle.prototype,"bottomRight",{get:function(){return new n.Point(this.right,this.bottom)},set:function(e){this.right=e.x,this.bottom=e.y}}),Object.defineProperty(n.Rectangle.prototype,"left",{get:function(){return this.x},set:function(e){e>=this.right?this.width=0:this.width=this.right-e,this.x=e}}),Object.defineProperty(n.Rectangle.prototype,"right",{get:function(){return this.x+this.width},set:function(e){e<=this.x?this.width=0:this.width=e-this.x}}),Object.defineProperty(n.Rectangle.prototype,"volume",{get:function(){return this.width*this.height}}),Object.defineProperty(n.Rectangle.prototype,"perimeter",{get:function(){return 2*this.width+2*this.height}}),Object.defineProperty(n.Rectangle.prototype,"centerX",{get:function(){return this.x+this.halfWidth},set:function(e){this.x=e-this.halfWidth}}),Object.defineProperty(n.Rectangle.prototype,"centerY",{get:function(){return this.y+this.halfHeight},set:function(e){this.y=e-this.halfHeight}}),Object.defineProperty(n.Rectangle.prototype,"randomX",{get:function(){return this.x+Math.random()*this.width}}),Object.defineProperty(n.Rectangle.prototype,"randomY",{get:function(){return this.y+Math.random()*this.height}}),Object.defineProperty(n.Rectangle.prototype,"top",{get:function(){return this.y},set:function(e){e>=this.bottom?(this.height=0,this.y=e):this.height=this.bottom-e}}),Object.defineProperty(n.Rectangle.prototype,"topLeft",{get:function(){return new n.Point(this.x,this.y)},set:function(e){this.x=e.x,this.y=e.y}}),Object.defineProperty(n.Rectangle.prototype,"topRight",{get:function(){return new n.Point(this.x+this.width,this.y)},set:function(e){this.right=e.x,this.y=e.y}}),Object.defineProperty(n.Rectangle.prototype,"empty",{get:function(){return!this.width||!this.height},set:function(e){e===!0&&this.setTo(0,0,0,0)}}),n.Rectangle.prototype.constructor=n.Rectangle,n.Rectangle.inflate=function(e,t,n){return e.x-=t,e.width+=2*t,e.y-=n,e.height+=2*n,e},n.Rectangle.inflatePoint=function(e,t){return n.Rectangle.inflate(e,t.x,t.y)},n.Rectangle.size=function(e,t){return void 0===t||null===t?t=new n.Point(e.width,e.height):t.setTo(e.width,e.height),t},n.Rectangle.clone=function(e,t){return void 0===t||null===t?t=new n.Rectangle(e.x,e.y,e.width,e.height):t.setTo(e.x,e.y,e.width,e.height),t},n.Rectangle.contains=function(e,t,n){return e.width<=0||e.height<=0?!1:t>=e.x&&t<e.right&&n>=e.y&&n<e.bottom},n.Rectangle.containsRaw=function(e,t,n,r,i,s){return i>=e&&e+n>i&&s>=t&&t+r>s},n.Rectangle.containsPoint=function(e,t){return n.Rectangle.contains(e,t.x,t.y)},n.Rectangle.containsRect=function(e,t){return e.volume>t.volume?!1:e.x>=t.x&&e.y>=t.y&&e.right<t.right&&e.bottom<t.bottom},n.Rectangle.equals=function(e,t){return e.x==t.x&&e.y==t.y&&e.width==t.width&&e.height==t.height},n.Rectangle.sameDimensions=function(e,t){return e.width===t.width&&e.height===t.height},n.Rectangle.intersection=function(e,t,r){return void 0===r&&(r=new n.Rectangle),n.Rectangle.intersects(e,t)&&(r.x=Math.max(e.x,t.x),r.y=Math.max(e.y,t.y),r.width=Math.min(e.right,t.right)-r.x,r.height=Math.min(e.bottom,t.bottom)-r.y),r},n.Rectangle.intersects=function(e,t){return e.width<=0||e.height<=0||t.width<=0||t.height<=0?!1:!(e.right<t.x||e.bottom<t.y||e.x>t.right||e.y>t.bottom)},n.Rectangle.intersectsRaw=function(e,t,n,r,i,s){return void 0===s&&(s=0),!(t>e.right+s||n<e.left-s||r>e.bottom+s||i<e.top-s)},n.Rectangle.union=function(e,t,r){return void 0===r&&(r=new n.Rectangle),r.setTo(Math.min(e.x,t.x),Math.min(e.y,t.y),Math.max(e.right,t.right)-Math.min(e.left,t.left),Math.max(e.bottom,t.bottom)-Math.min(e.top,t.top))},n.Rectangle.aabb=function(e,t){void 0===t&&(t=new n.Rectangle);var r=Number.MIN_VALUE,i=Number.MAX_VALUE,s=Number.MIN_VALUE,o=Number.MAX_VALUE;return e.forEach(function(e){e.x>r&&(r=e.x),e.x<i&&(i=e.x),e.y>s&&(s=e.y),e.y<o&&(o=e.y)}),t.setTo(i,o,r-i,s-o),t},PIXI.Rectangle=n.Rectangle,PIXI.EmptyRectangle=new n.Rectangle(0,0,0,0),n.RoundedRectangle=function(e,t,r,i,s){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===s&&(s=20),this.x=e,this.y=t,this.width=r,this.height=i,this.radius=s||20,this.type=n.ROUNDEDRECTANGLE},n.RoundedRectangle.prototype={clone:function(){return new n.RoundedRectangle(this.x,this.y,this.width,this.height,this.radius)},contains:function(e,t){if(this.width<=0||this.height<=0)return!1;var n=this.x;if(e>=n&&e<=n+this.width){var r=this.y;if(t>=r&&t<=r+this.height)return!0}return!1}},n.RoundedRectangle.prototype.constructor=n.RoundedRectangle,PIXI.RoundedRectangle=n.RoundedRectangle,n.Camera=function(e,t,r,i,s,o){this.game=e,this.world=e.world,this.id=0,this.view=new n.Rectangle(r,i,s,o),this.bounds=new n.Rectangle(r,i,s,o),this.deadzone=null,this.visible=!0,this.roundPx=!0,this.atLimit={x:!1,y:!1},this.target=null,this.displayObject=null,this.scale=null,this.totalInView=0,this.lerp=new n.Point(1,1),this.onShakeComplete=new n.Signal,this.onFlashComplete=new n.Signal,this.onFadeComplete=new n.Signal,this.fx=null,this._targetPosition=new n.Point,this._edge=0,this._position=new n.Point,this._shake={intensity:0,duration:0,horizontal:!1,vertical:!1,shakeBounds:!0,x:0,y:0},this._fxDuration=0,this._fxType=0},n.Camera.FOLLOW_LOCKON=0,n.Camera.FOLLOW_PLATFORMER=1,n.Camera.FOLLOW_TOPDOWN=2,n.Camera.FOLLOW_TOPDOWN_TIGHT=3,n.Camera.SHAKE_BOTH=4,n.Camera.SHAKE_HORIZONTAL=5,n.Camera.SHAKE_VERTICAL=6,n.Camera.ENABLE_FX=!0,n.Camera.prototype={boot:function(){this.displayObject=this.game.world,this.scale=this.game.world.scale,this.game.camera=this,n.Graphics&&n.Camera.ENABLE_FX&&(this.fx=new n.Graphics(this.game),this.game.stage.addChild(this.fx))},preUpdate:function(){this.totalInView=0},follow:function(e,t,r,i){void 0===t&&(t=n.Camera.FOLLOW_LOCKON),void 0===r&&(r=1),void 0===i&&(i=1),this.target=e,this.lerp.set(r,i);var s;switch(t){case n.Camera.FOLLOW_PLATFORMER:var o=this.width/8,u=this.height/3;this.deadzone=new n.Rectangle((this.width-o)/2,(this.height-u)/2-.25*u,o,u);break;case n.Camera.FOLLOW_TOPDOWN:s=Math.max(this.width,this.height)/4,this.deadzone=new n.Rectangle((this.width-s)/2,(this.height-s)/2,s,s);break;case n.Camera.FOLLOW_TOPDOWN_TIGHT:s=Math.max(this.width,this.height)/8,this.deadzone=new n.Rectangle((this.width-s)/2,(this.height-s)/2,s,s);break;case n.Camera.FOLLOW_LOCKON:this.deadzone=null;break;default:this.deadzone=null}},unfollow:function(){this.target=null},focusOn:function(e){this.setPosition(Math.round(e.x-this.view.halfWidth),Math.round(e.y-this.view.halfHeight))},focusOnXY:function(e,t){this.setPosition(Math.round(e-this.view.halfWidth),Math.round(t-this.view.halfHeight))},shake:function(e,t,r,i,s){return void 0===e&&(e=.05),void 0===t&&(t=500),void 0===r&&(r=!0),void 0===i&&(i=n.Camera.SHAKE_BOTH),void 0===s&&(s=!0),!r&&this._shake.duration>0?!1:(this._shake.intensity=e,this._shake.duration=t,this._shake.shakeBounds=s,this._shake.x=0,this._shake.y=0,this._shake.horizontal=i===n.Camera.SHAKE_BOTH||i===n.Camera.SHAKE_HORIZONTAL,this._shake.vertical=i===n.Camera.SHAKE_BOTH||i===n.Camera.SHAKE_VERTICAL,!0)},flash:function(e,t,n){return void 0===e&&(e=16777215),void 0===t&&(t=500),void 0===n&&(n=!1),!this.fx||!n&&this._fxDuration>0?!1:(this.fx.clear(),this.fx.beginFill(e),this.fx.drawRect(0,0,this.width,this.height),this.fx.endFill(),this.fx.alpha=1,this._fxDuration=t,this._fxType=0,!0)},fade:function(e,t,n){return void 0===e&&(e=0),void 0===t&&(t=500),void 0===n&&(n=!1),!this.fx||!n&&this._fxDuration>0?!1:(this.fx.clear(),this.fx.beginFill(e),this.fx.drawRect(0,0,this.width,this.height),this.fx.endFill(),this.fx.alpha=0,this._fxDuration=t,this._fxType=1,!0)},update:function(){this._fxDuration>0&&this.updateFX(),this.target&&this.updateTarget(),this._shake.duration>0&&this.updateShake(),this.bounds&&this.checkBounds(),this.roundPx&&(this.view.floor(),this._shake.x=Math.floor(this._shake.x),this._shake.y=Math.floor(this._shake.y)),this.displayObject.position.x=-this.view.x,this.displayObject.position.y=-this.view.y},updateFX:function(){0===this._fxType?(this.fx.alpha-=this.game.time.elapsedMS/this._fxDuration,this.fx.alpha<=0&&(this._fxDuration=0,this.fx.alpha=0,this.onFlashComplete.dispatch())):(this.fx.alpha+=this.game.time.elapsedMS/this._fxDuration,this.fx.alpha>=1&&(this._fxDuration=0,this.fx.alpha=1,this.onFadeComplete.dispatch()))},updateShake:function(){this._shake.duration-=this.game.time.elapsedMS,this._shake.duration<=0?(this.onShakeComplete.dispatch(),this._shake.x=0,this._shake.y=0):(this._shake.horizontal&&(this._shake.x=this.game.rnd.frac()*this._shake.intensity*this.view.width*2-this._shake.intensity*this.view.width),this._shake.vertical&&(this._shake.y=this.game.rnd.frac()*this._shake.intensity*this.view.height*2-this._shake.intensity*this.view.height))},updateTarget:function(){this._targetPosition.copyFrom(this.target.world),this.deadzone?(this._edge=this._targetPosition.x-this.view.x,this._edge<this.deadzone.left?this.view.x=this.game.math.linear(this.view.x,this._targetPosition.x-this.deadzone.left,this.lerp.x):this._edge>this.deadzone.right&&(this.view.x=this.game.math.linear(this.view.x,this._targetPosition.x-this.deadzone.right,this.lerp.x)),this._edge=this._targetPosition.y-this.view.y,this._edge<this.deadzone.top?this.view.y=this.game.math.linear(this.view.y,this._targetPosition.y-this.deadzone.top,this.lerp.y):this._edge>this.deadzone.bottom&&(this.view.y=this.game.math.linear(this.view.y,this._targetPosition.y-this.deadzone.bottom,this.lerp.y))):(this.view.x=this.game.math.linear(this.view.x,this._targetPosition.x-this.view.halfWidth,this.lerp.x),this.view.y=this.game.math.linear(this.view.y,this._targetPosition.y-this.view.halfHeight,this.lerp.y))},setBoundsToWorld:function(){this.bounds&&this.bounds.copyFrom(this.game.world.bounds)},checkBounds:function(){this.atLimit.x=!1,this.atLimit.y=!1;var e=this.view.x+this._shake.x,t=this.view.right+this._shake.x,n=this.view.y+this._shake.y,r=this.view.bottom+this._shake.y;e<=this.bounds.x*this.scale.x&&(this.atLimit.x=!0,this.view.x=this.bounds.x*this.scale.x,this._shake.shakeBounds||(this._shake.x=0)),t>=this.bounds.right*this.scale.x&&(this.atLimit.x=!0,this.view.x=this.bounds.right*this.scale.x-this.width,this._shake.shakeBounds||(this._shake.x=0)),n<=this.bounds.top*this.scale.y&&(this.atLimit.y=!0,this.view.y=this.bounds.top*this.scale.y,this._shake.shakeBounds||(this._shake.y=0)),r>=this.bounds.bottom*this.scale.y&&(this.atLimit.y=!0,this.view.y=this.bounds.bottom*this.scale.y-this.height,this._shake.shakeBounds||(this._shake.y=0))},setPosition:function(e,t){this.view.x=e,this.view.y=t,this.bounds&&this.checkBounds()},setSize:function(e,t){this.view.width=e,this.view.height=t},reset:function(){this.target=null,this.view.x=0,this.view.y=0,this._shake.duration=0,this.resetFX()},resetFX:function(){this.fx.clear(),this.fx.alpha=0,this._fxDuration=0}},n.Camera.prototype.constructor=n.Camera,Object.defineProperty(n.Camera.prototype,"x",{get:function(){return this.view.x},set:function(e){this.view.x=e,this.bounds&&this.checkBounds()}}),Object.defineProperty(n.Camera.prototype,"y",{get:function(){return this.view.y},set:function(e){this.view.y=e,this.bounds&&this.checkBounds()}}),Object.defineProperty(n.Camera.prototype,"position",{get:function(){return this._position.set(this.view.x,this.view.y),this._position},set:function(e){"undefined"!=typeof e.x&&(this.view.x=e.x),"undefined"!=typeof e.y&&(this.view.y=e.y),this.bounds&&this.checkBounds()}}),Object.defineProperty(n.Camera.prototype,"width",{get:function(){return this.view.width},set:function(e){this.view.width=e}}),Object.defineProperty(n.Camera.prototype,"height",{get:function(){return this.view.height},set:function(e){this.view.height=e}}),Object.defineProperty(n.Camera.prototype,"shakeIntensity",{get:function(){return this._shake.intensity},set:function(e){this._shake.intensity=e}}),n.State=function(){this.game=null,this.key="",this.add=null,this.make=null,this.camera=null,this.cache=null,this.input=null,this.load=null,this.math=null,this.sound=null,this.scale=null,this.stage=null,this.time=null,this.tweens=null,this.world=null,this.particles=null,this.physics=null,this.rnd=null},n.State.prototype={init:function(){},preload:function(){},loadUpdate:function(){},loadRender:function(){},create:function(){},update:function(){},preRender:function(){},render:function(){},resize:function(){},paused:function(){},resumed:function(){},pauseUpdate:function(){},shutdown:function(){}},n.State.prototype.constructor=n.State,n.StateManager=function(e,t){this.game=e,this.states={},this._pendingState=null,"undefined"!=typeof t&&null!==t&&(this._pendingState=t),this._clearWorld=!1,this._clearCache=!1,this._created=!1,this._args=[],this.current="",this.onStateChange=new n.Signal,this.onInitCallback=null,this.onPreloadCallback=null,this.onCreateCallback=null,this.onUpdateCallback=null,this.onRenderCallback=null,this.onResizeCallback=null,this.onPreRenderCallback=null,this.onLoadUpdateCallback=null,this.onLoadRenderCallback=null,this.onPausedCallback=null,this.onResumedCallback=null,this.onPauseUpdateCallback=null,this.onShutDownCallback=null},n.StateManager.prototype={boot:function(){this.game.onPause.add(this.pause,this),this.game.onResume.add(this.resume,this),null!==this._pendingState&&"string"!=typeof this._pendingState&&this.add("default",this._pendingState,!0)},add:function(e,t,r){void 0===r&&(r=!1);var i;return t instanceof n.State?i=t:"object"==typeof t?(i=t,i.game=this.game):"function"==typeof t&&(i=new t(this.game)),this.states[e]=i,r&&(this.game.isBooted?this.start(e):this._pendingState=e),i},remove:function(e){this.current===e&&(this.callbackContext=null,this.onInitCallback=null,this.onShutDownCallback=null,this.onPreloadCallback=null,this.onLoadRenderCallback=null,this.onLoadUpdateCallback=null,this.onCreateCallback=null,this.onUpdateCallback=null,this.onPreRenderCallback=null,this.onRenderCallback=null,this.onResizeCallback=null,this.onPausedCallback=null,this.onResumedCallback=null,this.onPauseUpdateCallback=null),delete this.states[e]},start:function(e,t,n){void 0===t&&(t=!0),void 0===n&&(n=!1),this.checkState(e)&&(this._pendingState=e,this._clearWorld=t,this._clearCache=n,arguments.length>3&&(this._args=Array.prototype.splice.call(arguments,3)))},restart:function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!1),this._pendingState=this.current,this._clearWorld=e,this._clearCache=t,arguments.length>2&&(this._args=Array.prototype.slice.call(arguments,2))},dummy:function(){},preUpdate:function(){if(this._pendingState&&this.game.isBooted){var e=this.current;if(this.clearCurrentState(),this.setCurrentState(this._pendingState),this.onStateChange.dispatch(this.current,e),this.current!==this._pendingState)return;this._pendingState=null,this.onPreloadCallback?(this.game.load.reset(!0),this.onPreloadCallback.call(this.callbackContext,this.game),0===this.game.load.totalQueuedFiles()&&0===this.game.load.totalQueuedPacks()?this.loadComplete():this.game.load.start()):this.loadComplete()}},clearCurrentState:function(){this.current&&(this.onShutDownCallback&&this.onShutDownCallback.call(this.callbackContext,this.game),this.game.tweens.removeAll(),this.game.camera.reset(),this.game.input.reset(!0),this.game.physics.clear(),this.game.time.removeAll(),this.game.scale.reset(this._clearWorld),this.game.debug&&this.game.debug.reset(),this._clearWorld&&(this.game.world.shutdown(),this._clearCache&&this.game.cache.destroy()))},checkState:function(e){return this.states[e]?this.states[e].preload||this.states[e].create||this.states[e].update||this.states[e].render?!0:(console.warn("Invalid Phaser State object given. Must contain at least a one of the required functions: preload, create, update or render"),!1):(console.warn("Phaser.StateManager - No state found with the key: "+e),!1)},link:function(e){this.states[e].game=this.game,this.states[e].add=this.game.add,this.states[e].make=this.game.make,this.states[e].camera=this.game.camera,this.states[e].cache=this.game.cache,this.states[e].input=this.game.input,this.states[e].load=this.game.load,this.states[e].math=this.game.math,this.states[e].sound=this.game.sound,this.states[e].scale=this.game.scale,this.states[e].state=this,this.states[e].stage=this.game.stage,this.states[e].time=this.game.time,this.states[e].tweens=this.game.tweens,this.states[e].world=this.game.world,this.states[e].particles=this.game.particles,this.states[e].rnd=this.game.rnd,this.states[e].physics=this.game.physics,this.states[e].key=e},unlink:function(e){this.states[e]&&(this.states[e].game=null,this.states[e].add=null,this.states[e].make=null,this.states[e].camera=null,this.states[e].cache=null,this.states[e].input=null,this.states[e].load=null,this.states[e].math=null,this.states[e].sound=null,this.states[e].scale=null,this.states[e].state=null,this.states[e].stage=null,this.states[e].time=null,this.states[e].tweens=null,this.states[e].world=null,this.states[e].particles=null,this.states[e].rnd=null,this.states[e].physics=null)},setCurrentState:function(e){this.callbackContext=this.states[e],this.link(e),this.onInitCallback=this.states[e].init||this.dummy,this.onPreloadCallback=this.states[e].preload||null,this.onLoadRenderCallback=this.states[e].loadRender||null,this.onLoadUpdateCallback=this.states[e].loadUpdate||null,this.onCreateCallback=this.states[e].create||null,this.onUpdateCallback=this.states[e].update||null,this.onPreRenderCallback=this.states[e].preRender||null,this.onRenderCallback=this.states[e].render||null,this.onResizeCallback=this.states[e].resize||null,this.onPausedCallback=this.states[e].paused||null,this.onResumedCallback=this.states[e].resumed||null,this.onPauseUpdateCallback=this.states[e].pauseUpdate||null,this.onShutDownCallback=this.states[e].shutdown||this.dummy,""!==this.current&&this.game.physics.reset(),this.current=e,this._created=!1,this.onInitCallback.apply(this.callbackContext,this._args),e===this._pendingState&&(this._args=[]),this.game._kickstart=!0},getCurrentState:function(){return this.states[this.current]},loadComplete:function(){this._created===!1&&this.onLoadUpdateCallback&&this.onLoadUpdateCallback.call(this.callbackContext,this.game),this._created===!1&&this.onCreateCallback?(this._created=!0,this.onCreateCallback.call(this.callbackContext,this.game)):this._created=!0},pause:function(){this._created&&this.onPausedCallback&&this.onPausedCallback.call(this.callbackContext,this.game)},resume:function(){this._created&&this.onResumedCallback&&this.onResumedCallback.call(this.callbackContext,this.game)},update:function(){this._created?this.onUpdateCallback&&this.onUpdateCallback.call(this.callbackContext,this.game):this.onLoadUpdateCallback&&this.onLoadUpdateCallback.call(this.callbackContext,this.game)},pauseUpdate:function(){this._created?this.onPauseUpdateCallback&&this.onPauseUpdateCallback.call(this.callbackContext,this.game):this.onLoadUpdateCallback&&this.onLoadUpdateCallback.call(this.callbackContext,this.game)},preRender:function(e){this._created&&this.onPreRenderCallback&&this.onPreRenderCallback.call(this.callbackContext,this.game,e)},resize:function(e,t){this.onResizeCallback&&this.onResizeCallback.call(this.callbackContext,e,t)},render:function(){this._created?this.onRenderCallback&&(this.game.renderType===n.CANVAS?(this.game.context.save(),this.game.context.setTransform(1,0,0,1,0,0),this.onRenderCallback.call(this.callbackContext,this.game),this.game.context.restore()):this.onRenderCallback.call(this.callbackContext,this.game)):this.onLoadRenderCallback&&this.onLoadRenderCallback.call(this.callbackContext,this.game)},destroy:function(){this._clearWorld=!0,this._clearCache=!0,this.clearCurrentState(),this.callbackContext=null,this.onInitCallback=null,this.onShutDownCallback=null,this.onPreloadCallback=null,this.onLoadRenderCallback=null,this.onLoadUpdateCallback=null,this.onCreateCallback=null,this.onUpdateCallback=null,this.onRenderCallback=null,this.onPausedCallback=null,this.onResumedCallback=null,this.onPauseUpdateCallback=null,this.game=null,this.states={},this._pendingState=null,this.current=""}},n.StateManager.prototype.constructor=n.StateManager,Object.defineProperty(n.StateManager.prototype,"created",{get:function(){return this._created}}),n.Signal=function(){},n.Signal.prototype={_bindings:null,_prevParams:null,memorize:!1,_shouldPropagate:!0,active:!0,_boundDispatch:!1,validateListener:function(e,t){if("function"!=typeof e)throw new Error("Phaser.Signal: listener is a required param of {fn}() and should be a Function.".replace("{fn}",t))},_registerListener:function(e,t,r,i,s){var o,u=this._indexOfListener(e,r);if(-1!==u){if(o=this._bindings[u],o.isOnce()!==t)throw new Error("You cannot add"+(t?"":"Once")+"() then add"+(t?"Once":"")+"() the same listener without removing the relationship first.")}else o=new n.SignalBinding(this,e,t,r,i,s),this._addBinding(o);return this.memorize&&this._prevParams&&o.execute(this._prevParams),o},_addBinding:function(e){this._bindings||(this._bindings=[]);var t=this._bindings.length;do t--;while(this._bindings[t]&&e._priority<=this._bindings[t]._priority);this._bindings.splice(t+1,0,e)},_indexOfListener:function(e,t){if(!this._bindings)return-1;void 0===t&&(t=null);for(var n,r=this._bindings.length;r--;)if(n=this._bindings[r],n._listener===e&&n.context===t)return r;return-1},has:function(e,t){return-1!==this._indexOfListener(e,t)},add:function(e,t,n){this.validateListener(e,"add");var r=[];if(arguments.length>3)for(var i=3;i<arguments.length;i++)r.push(arguments[i]);return this._registerListener(e,!1,t,n,r)},addOnce:function(e,t,n){this.validateListener(e,"addOnce");var r=[];if(arguments.length>3)for(var i=3;i<arguments.length;i++)r.push(arguments[i]);return this._registerListener(e,!0,t,n,r)},remove:function(e,t){this.validateListener(e,"remove");var n=this._indexOfListener(e,t);return-1!==n&&(this._bindings[n]._destroy(),this._bindings.splice(n,1)),e},removeAll:function(e){if(void 0===e&&(e=null),this._bindings){for(var t=this._bindings.length;t--;)e?this._bindings[t].context===e&&(this._bindings[t]._destroy(),this._bindings.splice(t,1)):this._bindings[t]._destroy();e||(this._bindings.length=0)}},getNumListeners:function(){return this._bindings?this._bindings.length:0},halt:function(){this._shouldPropagate=!1},dispatch:function(){if(this.active&&this._bindings){var e,t=Array.prototype.slice.call(arguments),n=this._bindings.length;if(this.memorize&&(this._prevParams=t),n){e=this._bindings.slice(),this._shouldPropagate=!0;do n--;while(e[n]&&this._shouldPropagate&&e[n].execute(t)!==!1)}}},forget:function(){this._prevParams&&(this._prevParams=null)},dispose:function(){this.removeAll(),this._bindings=null,this._prevParams&&(this._prevParams=null)},toString:function(){return"[Phaser.Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}},Object.defineProperty(n.Signal.prototype,"boundDispatch",{get:function(){var e=this;return this._boundDispatch||(this._boundDispatch=function(){return e.dispatch.apply(e,arguments)})}}),n.Signal.prototype.constructor=n.Signal,n.SignalBinding=function(e,t,n,r,i,s){this._listener=t,n&&(this._isOnce=!0),null!=r&&(this.context=r),this._signal=e,i&&(this._priority=i),s&&s.length&&(this._args=s)},n.SignalBinding.prototype={context:null,_isOnce:!1,_priority:0,_args:null,callCount:0,active:!0,params:null,execute:function(e){var t,n;return this.active&&this._listener&&(n=this.params?this.params.concat(e):e,this._args&&(n=n.concat(this._args)),t=this._listener.apply(this.context,n),this.callCount++,this._isOnce&&this.detach()),t},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[Phaser.SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},n.SignalBinding.prototype.constructor=n.SignalBinding,n.Filter=function(e,t,r){this.game=e,this.type=n.WEBGL_FILTER,this.passes=[this],this.shaders=[],this.dirty=!0,this.padding=0,this.prevPoint=new n.Point;var i=new Date;if(this.uniforms={resolution:{type:"2f",value:{x:256,y:256}},time:{type:"1f",value:0},mouse:{type:"2f",value:{x:0,y:0}},date:{type:"4fv",value:[i.getFullYear(),i.getMonth(),i.getDate(),60*i.getHours()*60+60*i.getMinutes()+i.getSeconds()]},sampleRate:{type:"1f",value:44100},iChannel0:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel1:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel2:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel3:{type:"sampler2D",value:null,textureData:{repeat:!0}}},t)for(var s in t)this.uniforms[s]=t[s];this.fragmentSrc=r||""},n.Filter.prototype={init:function(){},setResolution:function(e,t){this.uniforms.resolution.value.x=e,this.uniforms.resolution.value.y=t},update:function(e){if("undefined"!=typeof e){var t=e.x/this.game.width,n=1-e.y/this.game.height;(t!==this.prevPoint.x||n!==this.prevPoint.y)&&(this.uniforms.mouse.value.x=t.toFixed(2),this.uniforms.mouse.value.y=n.toFixed(2),this.prevPoint.set(t,n))}this.uniforms.time.value=this.game.time.totalElapsedSeconds()},addToWorld:function(e,t,n,r,i,s){void 0===i&&(i=0),void 0===s&&(s=0),void 0!==n&&null!==n?this.width=n:n=this.width,void 0!==r&&null!==r?this.height=r:r=this.height;var o=this.game.add.image(e,t,"__default");return o.width=n,o.height=r,o.anchor.set(i,s),o.filters=[this],o},destroy:function(){this.game=null}},n.Filter.prototype.constructor=n.Filter,Object.defineProperty(n.Filter.prototype,"width",{get:function(){return this.uniforms.resolution.value.x},set:function(e){this.uniforms.resolution.value.x=e}}),Object.defineProperty(n.Filter.prototype,"height",{get:function(){return this.uniforms.resolution.value.y},set:function(e){this.uniforms.resolution.value.y=e}}),n.Plugin=function(e,t){void 0===t&&(t=null),this.game=e,this.parent=t,this.active=!1,this.visible=!1,this.hasPreUpdate=!1,this.hasUpdate=!1,this.hasPostUpdate=!1,this.hasRender=!1,this.hasPostRender=!1},n.Plugin.prototype={preUpdate:function(){},update:function(){},render:function(){},postRender:function(){},destroy:function(){this.game=null,this.parent=null,this.active=!1,this.visible=!1}},n.Plugin.prototype.constructor=n.Plugin,n.PluginManager=function(e){this.game=e,this.plugins=[],this._len=0,this._i=0},n.PluginManager.prototype={add:function(e){var t=Array.prototype.slice.call(arguments,1),n=!1;return"function"==typeof e?e=new e(this.game,this):(e.game=this.game,e.parent=this),"function"==typeof e.preUpdate&&(e.hasPreUpdate=!0,n=!0),"function"==typeof e.update&&(e.hasUpdate=!0,n=!0),"function"==typeof e.postUpdate&&(e.hasPostUpdate=!0,n=!0),"function"==typeof e.render&&(e.hasRender=!0,n=!0),"function"==typeof e.postRender&&(e.hasPostRender=!0,n=!0),n?((e.hasPreUpdate||e.hasUpdate||e.hasPostUpdate)&&(e.active=!0),(e.hasRender||e.hasPostRender)&&(e.visible=!0),this._len=this.plugins.push(e),"function"==typeof e.init&&e.init.apply(e,t),e):null},remove:function(e){for(this._i=this._len;this._i--;)if(this.plugins[this._i]===e)return e.destroy(),this.plugins.splice(this._i,1),void (this._len--)},removeAll:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].destroy();this.plugins.length=0,this._len=0},preUpdate:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].active&&this.plugins[this._i].hasPreUpdate&&this.plugins[this._i].preUpdate()},update:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].active&&this.plugins[this._i].hasUpdate&&this.plugins[this._i].update()},postUpdate:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].active&&this.plugins[this._i].hasPostUpdate&&this.plugins[this._i].postUpdate()},render:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].visible&&this.plugins[this._i].hasRender&&this.plugins[this._i].render()},postRender:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].visible&&this.plugins[this._i].hasPostRender&&this.plugins[this._i].postRender()},destroy:function(){this.removeAll(),this.game=null}},n.PluginManager.prototype.constructor=n.PluginManager,n.Stage=function(e){this.game=e,PIXI.DisplayObjectContainer.call(this),this.name="_stage_root",this.disableVisibilityChange=!1,this.exists=!0,this.worldTransform=new PIXI.Matrix,this.stage=this,this.currentRenderOrderID=0,this._hiddenVar="hidden",this._onChange=null,this._bgColor={r:0,g:0,b:0,a:0,color:0,rgba:"#000000"},this.game.transparent||(this._bgColor.a=1),e.config&&this.parseConfig(e.config)},n.Stage.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),n.Stage.prototype.constructor=n.Stage,n.Stage.prototype.parseConfig=function(e){e.disableVisibilityChange&&(this.disableVisibilityChange=e.disableVisibilityChange),e.backgroundColor&&this.setBackgroundColor(e.backgroundColor)},n.Stage.prototype.boot=function(){n.DOM.getOffset(this.game.canvas,this.offset),n.Canvas.setUserSelect(this.game.canvas,"none"),n.Canvas.setTouchAction(this.game.canvas,"none"),this.checkVisibility()},n.Stage.prototype.preUpdate=function(){this.currentRenderOrderID=0;for(var e=0;e<this.children.length;e++)this.children[e].preUpdate()},n.Stage.prototype.update=function(){for(var e=this.children.length;e--;)this.children[e].update()},n.Stage.prototype.postUpdate=function(){if(this.game.world.camera.target){this.game.world.camera.target.postUpdate(),this.game.world.camera.update();for(var e=this.children.length;e--;)this.children[e]!==this.game.world.camera.target&&this.children[e].postUpdate()}else{this.game.world.camera.update();for(var e=this.children.length;e--;)this.children[e].postUpdate()}},n.Stage.prototype.updateTransform=function(){this.worldAlpha=1;for(var e=0;e<this.children.length;e++)this.children[e].updateTransform()},n.Stage.prototype.checkVisibility=function(){void 0!==document.webkitHidden?this._hiddenVar="webkitvisibilitychange":void 0!==document.mozHidden?this._hiddenVar="mozvisibilitychange":void 0!==document.msHidden?this._hiddenVar="msvisibilitychange":void 0!==document.hidden?this._hiddenVar="visibilitychange":this._hiddenVar=null;var e=this;this._onChange=function(t){return e.visibilityChange(t)},this._hiddenVar&&document.addEventListener(this._hiddenVar,this._onChange,!1),window.onblur=this._onChange,window.onfocus=this._onChange,window.onpagehide=this._onChange,window.onpageshow=this._onChange,this.game.device.cocoonJSApp&&(CocoonJS.App.onSuspended.addEventListener(function(){n.Stage.prototype.visibilityChange.call(e,{type:"pause"})}),CocoonJS.App.onActivated.addEventListener(function(){n.Stage.prototype.visibilityChange.call(e,{type:"resume"})}))},n.Stage.prototype.visibilityChange=function(e){return"pagehide"===e.type||"blur"===e.type||"pageshow"===e.type||"focus"===e.type?void ("pagehide"===e.type||"blur"===e.type?this.game.focusLoss(e):("pageshow"===e.type||"focus"===e.type)&&this.game.focusGain(e)):void (this.disableVisibilityChange||(document.hidden||document.mozHidden||document.msHidden||document.webkitHidden||"pause"===e.type?this.game.gamePaused(e):this.game.gameResumed(e)))},n.Stage.prototype.setBackgroundColor=function(e){this.game.transparent||(n.Color.valueToColor(e,this._bgColor),n.Color.updateColor(this._bgColor),this._bgColor.r/=255,this._bgColor.g/=255,this._bgColor.b/=255,this._bgColor.a=1)},n.Stage.prototype.destroy=function(){this._hiddenVar&&document.removeEventListener(this._hiddenVar,this._onChange,!1),window.onpagehide=null,window.onpageshow=null,window.onblur=null,window.onfocus=null},Object.defineProperty(n.Stage.prototype,"backgroundColor",{get:function(){return this._bgColor.color},set:function(e){this.setBackgroundColor(e)}}),Object.defineProperty(n.Stage.prototype,"smoothed",{get:function(){return PIXI.scaleModes.DEFAULT===PIXI.scaleModes.LINEAR},set:function(e){e?PIXI.scaleModes.DEFAULT=PIXI.scaleModes.LINEAR:PIXI.scaleModes.DEFAULT=PIXI.scaleModes.NEAREST}}),n.Group=function(e,t,r,i,s,o){void 0===i&&(i=!1),void 0===s&&(s=!1),void 0===o&&(o=n.Physics.ARCADE),this.game=e,void 0===t&&(t=e.world),this.name=r||"group",this.z=0,PIXI.DisplayObjectContainer.call(this),i?(this.game.stage.addChild(this),this.z=this.game.stage.children.length):t&&(t.addChild(this),this.z=t.children.length),this.type=n.GROUP,this.physicsType=n.GROUP,this.alive=!0,this.exists=!0,this.ignoreDestroy=!1,this.pendingDestroy=!1,this.classType=n.Sprite,this.cursor=null,this.enableBody=s,this.enableBodyDebug=!1,this.physicsBodyType=o,this.physicsSortDirection=null,this.onDestroy=new n.Signal,this.cursorIndex=0,this.fixedToCamera=!1,this.cameraOffset=new n.Point,this.hash=[],this._sortProperty="z"},n.Group.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),n.Group.prototype.constructor=n.Group,n.Group.RETURN_NONE=0,n.Group.RETURN_TOTAL=1,n.Group.RETURN_CHILD=2,n.Group.SORT_ASCENDING=-1,n.Group.SORT_DESCENDING=1,n.Group.prototype.add=function(e,t){return void 0===t&&(t=!1),e.parent!==this&&(e.body&&e.parent&&e.parent.hash&&e.parent.removeFromHash(e),e.z=this.children.length,this.addChild(e),this.enableBody&&null===e.body?this.game.physics.enable(e,this.physicsBodyType):e.body&&this.addToHash(e),!t&&e.events&&e.events.onAddedToGroup$dispatch(e,this),null===this.cursor&&(this.cursor=e)),e},n.Group.prototype.addToHash=function(e){if(e.parent===this){var t=this.hash.indexOf(e);if(-1===t)return this.hash.push(e),!0}return!1},n.Group.prototype.removeFromHash=function(e){if(e){var t=this.hash.indexOf(e);if(-1!==t)return this.hash.splice(t,1),!0}return!1},n.Group.prototype.addMultiple=function(e,t){if(e instanceof n.Group)e.moveAll(this,t);else if(Array.isArray(e))for(var r=0;r<e.length;r++)this.add(e[r],t);return e},n.Group.prototype.addAt=function(e,t,n){return void 0===n&&(n=!1),e.parent!==this&&(e.body&&e.parent&&e.parent.removeFromHash(e),this.addChildAt(e,t),this.updateZ(),this.enableBody&&null===e.body?this.game.physics.enable(e,this.physicsBodyType):e.body&&this.addToHash(e),!n&&e.events&&e.events.onAddedToGroup$dispatch(e,this),null===this.cursor&&(this.cursor=e)),e},n.Group.prototype.getAt=function(e){return 0>e||e>=this.children.length?-1:this.getChildAt(e)},n.Group.prototype.create=function(e,t,n,r,i){void 0===i&&(i=!0);var s=new this.classType(this.game,e,t,n,r);return s.exists=i,s.visible=i,s.alive=i,s.z=this.children.length,this.addChild(s),this.enableBody&&this.game.physics.enable(s,this.physicsBodyType,this.enableBodyDebug),s.events&&s.events.onAddedToGroup$dispatch(s,this),null===this.cursor&&(this.cursor=s),s},n.Group.prototype.createMultiple=function(e,t,n,r){void 0===r&&(r=!1);for(var i=0;e>i;i++)this.create(0,0,t,n,r)},n.Group.prototype.updateZ=function(){for(var e=this.children.length;e--;)this.children[e].z=e},n.Group.prototype.resetCursor=function(e){return void 0===e&&(e=0),e>this.children.length-1&&(e=0),this.cursor?(this.cursorIndex=e,this.cursor=this.children[this.cursorIndex],this.cursor):void 0},n.Group.prototype.next=function(){return this.cursor?(this.cursorIndex>=this.children.length-1?this.cursorIndex=0:this.cursorIndex++,this.cursor=this.children[this.cursorIndex],this.cursor):void 0},n.Group.prototype.previous=function(){return this.cursor?(0===this.cursorIndex?this.cursorIndex=this.children.length-1:this.cursorIndex--,this.cursor=this.children[this.cursorIndex],this.cursor):void 0},n.Group.prototype.swap=function(e,t){this.swapChildren(e,t),this.updateZ()},n.Group.prototype.bringToTop=function(e){return e.parent===this&&this.getIndex(e)<this.children.length&&(this.remove(e,!1,!0),this.add(e,!0)),e},n.Group.prototype.sendToBack=function(e){return e.parent===this&&this.getIndex(e)>0&&(this.remove(e,!1,!0),this.addAt(e,0,!0)),e},n.Group.prototype.moveUp=function(e){if(e.parent===this&&this.getIndex(e)<this.children.length-1){var t=this.getIndex(e),n=this.getAt(t+1);n&&this.swap(e,n)}return e},n.Group.prototype.moveDown=function(e){if(e.parent===this&&this.getIndex(e)>0){var t=this.getIndex(e),n=this.getAt(t-1);n&&this.swap(e,n)}return e},n.Group.prototype.xy=function(e,t,n){return 0>e||e>this.children.length?-1:(this.getChildAt(e).x=t,void (this.getChildAt(e).y=n))},n.Group.prototype.reverse=function(){this.children.reverse(),this.updateZ()},n.Group.prototype.getIndex=function(e){return this.children.indexOf(e)},n.Group.prototype.getByName=function(e){for(var t=0;t<this.children.length;t++)if(this.children[t].name===e)return this.children[t];return null},n.Group.prototype.replace=function(e,t){var r=this.getIndex(e);return-1!==r?(t.parent&&(t.parent instanceof n.Group?t.parent.remove(t):t.parent.removeChild(t)),this.remove(e),this.addAt(t,r),e):void 0},n.Group.prototype.hasProperty=function(e,t){var n=t.length;return 1===n&&t[0]in e?!0:2===n&&t[0]in e&&t[1]in e[t[0]]?!0:3===n&&t[0]in e&&t[1]in e[t[0]]&&t[2]in e[t[0]][t[1]]?!0:4===n&&t[0]in e&&t[1]in e[t[0]]&&t[2]in e[t[0]][t[1]]&&t[3]in e[t[0]][t[1]][t[2]]?!0:!1},n.Group.prototype.setProperty=function(e,t,n,r,i){if(void 0===i&&(i=!1),r=r||0,!this.hasProperty(e,t)&&(!i||r>0))return!1;var s=t.length;return 1===s?0===r?e[t[0]]=n:1==r?e[t[0]]+=n:2==r?e[t[0]]-=n:3==r?e[t[0]]*=n:4==r&&(e[t[0]]/=n):2===s?0===r?e[t[0]][t[1]]=n:1==r?e[t[0]][t[1]]+=n:2==r?e[t[0]][t[1]]-=n:3==r?e[t[0]][t[1]]*=n:4==r&&(e[t[0]][t[1]]/=n):3===s?0===r?e[t[0]][t[1]][t[2]]=n:1==r?e[t[0]][t[1]][t[2]]+=n:2==r?e[t[0]][t[1]][t[2]]-=n:3==r?e[t[0]][t[1]][t[2]]*=n:4==r&&(e[t[0]][t[1]][t[2]]/=n):4===s&&(0===r?e[t[0]][t[1]][t[2]][t[3]]=n:1==r?e[t[0]][t[1]][t[2]][t[3]]+=n:2==r?e[t[0]][t[1]][t[2]][t[3]]-=n:3==r?e[t[0]][t[1]][t[2]][t[3]]*=n:4==r&&(e[t[0]][t[1]][t[2]][t[3]]/=n)),!0},n.Group.prototype.checkProperty=function(e,t,r,i){return void 0===i&&(i=!1),!n.Utils.getProperty(e,t)&&i?!1:n.Utils.getProperty(e,t)!==r?!1:!0},n.Group.prototype.set=function(e,t,n,r,i,s,o){return void 0===o&&(o=!1),t=t.split("."),void 0===r&&(r=!1),void 0===i&&(i=!1),(r===!1||r&&e.alive)&&(i===!1||i&&e.visible)?this.setProperty(e,t,n,s,o):void 0},n.Group.prototype.setAll=function(e,t,n,r,i,s){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===s&&(s=!1),e=e.split("."),i=i||0;for(var o=0;o<this.children.length;o++)(!n||n&&this.children[o].alive)&&(!r||r&&this.children[o].visible)&&this.setProperty(this.children[o],e,t,i,s)},n.Group.prototype.setAllChildren=function(e,t,r,i,s,o){void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===o&&(o=!1),s=s||0;for(var u=0;u<this.children.length;u++)(!r||r&&this.children[u].alive)&&(!i||i&&this.children[u].visible)&&(this.children[u]instanceof n.Group?this.children[u].setAllChildren(e,t,r,i,s,o):this.setProperty(this.children[u],e.split("."),t,s,o))},n.Group.prototype.checkAll=function(e,t,n,r,i){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===i&&(i=!1);for(var s=0;s<this.children.length;s++)if((!n||n&&this.children[s].alive)&&(!r||r&&this.children[s].visible)&&!this.checkProperty(this.children[s],e,t,i))return!1;return!0},n.Group.prototype.addAll=function(e,t,n,r){this.setAll(e,t,n,r,1)},n.Group.prototype.subAll=function(e,t,n,r){this.setAll(e,t,n,r,2)},n.Group.prototype.multiplyAll=function(e,t,n,r){this.setAll(e,t,n,r,3)},n.Group.prototype.divideAll=function(e,t,n,r){this.setAll(e,t,n,r,4)},n.Group.prototype.callAllExists=function(e,t){var n;if(arguments.length>2){n=[];for(var r=2;r<arguments.length;r++)n.push(arguments[r])}for(var r=0;r<this.children.length;r++)this.children[r].exists===t&&this.children[r][e]&&this.children[r][e].apply(this.children[r],n)},n.Group.prototype.callbackFromArray=function(e,t,n){if(1==n){if(e[t[0]])return e[t[0]]}else if(2==n){if(e[t[0]][t[1]])return e[t[0]][t[1]]}else if(3==n){if(e[t[0]][t[1]][t[2]])return e[t[0]][t[1]][t[2]]}else if(4==n){if(e[t[0]][t[1]][t[2]][t[3]])return e[t[0]][t[1]][t[2]][t[3]]}else if(e[t])return e[t];return!1},n.Group.prototype.callAll=function(e,t){if(void 0!==e){e=e.split(".");var n=e.length;if(void 0===t||null===t||""===t)t=null;else if("string"==typeof t){t=t.split(".");var r=t.length}var i;if(arguments.length>2){i=[];for(var s=2;s<arguments.length;s++)i.push(arguments[s])}for(var o=null,u=null,s=0;s<this.children.length;s++)o=this.callbackFromArray(this.children[s],e,n),t&&o?(u=this.callbackFromArray(this.children[s],t,r),o&&o.apply(u,i)):o&&o.apply(this.children[s],i)}},n.Group.prototype.preUpdate=function(){if(this.pendingDestroy)return this.destroy(),!1;if(!this.exists||!this.parent.exists)return this.renderOrderID=-1,!1;for(var e=this.children.length;e--;)this.children[e].preUpdate();return!0},n.Group.prototype.update=function(){for(var e=this.children.length;e--;)this.children[e].update()},n.Group.prototype.postUpdate=function(){this.fixedToCamera&&(this.x=this.game.camera.view.x+this.cameraOffset.x,this.y=this.game.camera.view.y+this.cameraOffset.y);for(var e=this.children.length;e--;)this.children[e].postUpdate()},n.Group.prototype.filter=function(e,t){for(var r=-1,i=this.children.length,s=[];++r<i;){var o=this.children[r];(!t||t&&o.exists)&&e(o,r,this.children)&&s.push(o)}return new n.ArraySet(s)},n.Group.prototype.forEach=function(e,t,n){if(void 0===n&&(n=!1),arguments.length<=3)for(var r=0;r<this.children.length;r++)(!n||n&&this.children[r].exists)&&e.call(t,this.children[r]);else{for(var i=[null],r=3;r<arguments.length;r++)i.push(arguments[r]);for(var r=0;r<this.children.length;r++)(!n||n&&this.children[r].exists)&&(i[0]=this.children[r],e.apply(t,i))}},n.Group.prototype.forEachExists=function(e,t){var r;if(arguments.length>2){r=[null];for(var i=2;i<arguments.length;i++)r.push(arguments[i])}this.iterate("exists",!0,n.Group.RETURN_TOTAL,e,t,r)},n.Group.prototype.forEachAlive=function(e,t){var r;if(arguments.length>2){r=[null];for(var i=2;i<arguments.length;i++)r.push(arguments[i])}this.iterate("alive",!0,n.Group.RETURN_TOTAL,e,t,r)},n.Group.prototype.forEachDead=function(e,t){var r;if(arguments.length>2){r=[null];for(var i=2;i<arguments.length;i++)r.push(arguments[i])}this.iterate("alive",!1,n.Group.RETURN_TOTAL,e,t,r)},n.Group.prototype.sort=function(e,t){this.children.length<2||(void 0===e&&(e="z"),void 0===t&&(t=n.Group.SORT_ASCENDING),this._sortProperty=e,t===n.Group.SORT_ASCENDING?this.children.sort(this.ascendingSortHandler.bind(this)):this.children.sort(this.descendingSortHandler.bind(this)),this.updateZ())},n.Group.prototype.customSort=function(e,t){this.children.length<2||(this.children.sort(e.bind(t)),this.updateZ())},n.Group.prototype.ascendingSortHandler=function(e,t){return e[this._sortProperty]<t[this._sortProperty]?-1:e[this._sortProperty]>t[this._sortProperty]?1:e.z<t.z?-1:1},n.Group.prototype.descendingSortHandler=function(e,t){return e[this._sortProperty]<t[this._sortProperty]?1:e[this._sortProperty]>t[this._sortProperty]?-1:0},n.Group.prototype.iterate=function(e,t,r,i,s,o){if(r===n.Group.RETURN_TOTAL&&0===this.children.length)return 0;for(var u=0,a=0;a<this.children.length;a++)if(this.children[a][e]===t&&(u++,i&&(o?(o[0]=this.children[a],i.apply(s,o)):i.call(s,this.children[a])),r===n.Group.RETURN_CHILD))return this.children[a];return r===n.Group.RETURN_TOTAL?u:null},n.Group.prototype.getFirstExists=function(e,t,r,i,s,o){void 0===t&&(t=!1),"boolean"!=typeof e&&(e=!0);var u=this.iterate("exists",e,n.Group.RETURN_CHILD);return null===u&&t?this.create(r,i,s,o):this.resetChild(u,r,i,s,o)},n.Group.prototype.getFirstAlive=function(e,t,r,i,s){void 0===e&&(e=!1);var o=this.iterate("alive",!0,n.Group.RETURN_CHILD);return null===o&&e?this.create(t,r,i,s):this.resetChild(o,t,r,i,s)},n.Group.prototype.getFirstDead=function(e,t,r,i,s){void 0===e&&(e=!1);var o=this.iterate("alive",!1,n.Group.RETURN_CHILD);return null===o&&e?this.create(t,r,i,s):this.resetChild(o,t,r,i,s)},n.Group.prototype.resetChild=function(e,t,n,r,i){return null===e?null:(void 0===t&&(t=null),void 0===n&&(n=null),null!==t&&null!==n&&e.reset(t,n),void 0!==r&&e.loadTexture(r,i),e)},n.Group.prototype.getTop=function(){return this.children.length>0?this.children[this.children.length-1]:void 0},n.Group.prototype.getBottom=function(){return this.children.length>0?this.children[0]:void 0},n.Group.prototype.countLiving=function(){return this.iterate("alive",!0,n.Group.RETURN_TOTAL)},n.Group.prototype.countDead=function(){return this.iterate("alive",!1,n.Group.RETURN_TOTAL)},n.Group.prototype.getRandom=function(e,t){return 0===this.children.length?null:(e=e||0,t=t||this.children.length,n.ArrayUtils.getRandomItem(this.children,e,t))},n.Group.prototype.remove=function(e,t,n){if(void 0===t&&(t=!1),void 0===n&&(n=!1),0===this.children.length||-1===this.children.indexOf(e))return!1;n||!e.events||e.destroyPhase||e.events.onRemovedFromGroup$dispatch(e,this);var r=this.removeChild(e);return this.removeFromHash(e),this.updateZ(),this.cursor===e&&this.next(),t&&r&&r.destroy(!0),!0},n.Group.prototype.moveAll=function(e,t){if(void 0===t&&(t=!1),this.children.length>0&&e instanceof n.Group){do e.add(this.children[0],t);while(this.children.length>0);this.hash=[],this.cursor=null}return e},n.Group.prototype.removeAll=function(e,t){if(void 0===e&&(e=!1),void 0===t&&(t=!1),0!==this.children.length){do{!t&&this.children[0].events&&this.children[0].events.onRemovedFromGroup$dispatch(this.children[0],this);var n=this.removeChild(this.children[0]);this.removeFromHash(n),e&&n&&n.destroy(!0)}while(this.children.length>0);this.hash=[],this.cursor=null}},n.Group.prototype.removeBetween=function(e,t,n,r){if(void 0===t&&(t=this.children.length-1),void 0===n&&(n=!1),void 0===r&&(r=!1),0!==this.children.length){if(e>t||0>e||t>this.children.length)return!1;for(var i=t;i>=e;){!r&&this.children[i].events&&this.children[i].events.onRemovedFromGroup$dispatch(this.children[i],this);var s=this.removeChild(this.children[i]);this.removeFromHash(s),n&&s&&s.destroy(!0),this.cursor===this.children[i]&&(this.cursor=null),i--}this.updateZ()}},n.Group.prototype.destroy=function(e,t){null===this.game||this.ignoreDestroy||(void 0===e&&(e=!0),void 0===t&&(t=!1),this.onDestroy.dispatch(this,e,t),this.removeAll(e),this.cursor=null,this.filters=null,this.pendingDestroy=!1,t||(this.parent&&this.parent.removeChild(this),this.game=null,this.exists=!1))},Object.defineProperty(n.Group.prototype,"total",{get:function(){return this.iterate("exists",!0,n.Group.RETURN_TOTAL)}}),Object.defineProperty(n.Group.prototype,"length",{get:function(){return this.children.length}}),Object.defineProperty(n.Group.prototype,"angle",{get:function(){return n.Math.radToDeg(this.rotation)},set:function(e){this.rotation=n.Math.degToRad(e)}}),n.World=function(e){n.Group.call(this,e,null,"__world",!1),this.bounds=new n.Rectangle(0,0,e.width,e.height),this.camera=null,this._definedSize=!1,this._width=e.width,this._height=e.height,this.game.state.onStateChange.add(this.stateChange,this)},n.World.prototype=Object.create(n.Group.prototype),n.World.prototype.constructor=n.World,n.World.prototype.boot=function(){this.camera=new n.Camera(this.game,0,0,0,this.game.width,this.game.height),this.game.stage.addChild(this),this.camera.boot()},n.World.prototype.stateChange=function(){this.x=0,this.y=0,this.camera.reset()},n.World.prototype.setBounds=function(e,t,n,r){this._definedSize=!0,this._width=n,this._height=r,this.bounds.setTo(e,t,n,r),this.x=e,this.y=t,this.camera.bounds&&this.camera.bounds.setTo(e,t,Math.max(n,this.game.width),Math.max(r,this.game.height)),this.game.physics.setBoundsToWorld()},n.World.prototype.resize=function(e,t){this._definedSize&&(e<this._width&&(e=this._width),t<this._height&&(t=this._height)),this.bounds.width=e,this.bounds.height=t,this.game.camera.setBoundsToWorld(),this.game.physics.setBoundsToWorld()},n.World.prototype.shutdown=function(){this.destroy(!0,!0)},n.World.prototype.wrap=function(e,t,n,r,i){void 0===t&&(t=0),void 0===n&&(n=!1),void 0===r&&(r=!0),void 0===i&&(i=!0),n?(e.getBounds(),r&&(e.x+e._currentBounds.width<this.bounds.x?e.x=this.bounds.right:e.x>this.bounds.right&&(e.x=this.bounds.left)),i&&(e.y+e._currentBounds.height<this.bounds.top?e.y=this.bounds.bottom:e.y>this.bounds.bottom&&(e.y=this.bounds.top))):(r&&e.x+t<this.bounds.x?e.x=this.bounds.right+t:r&&e.x-t>this.bounds.right&&(e.x=this.bounds.left-t),i&&e.y+t<this.bounds.top?e.y=this.bounds.bottom+t:i&&e.y-t>this.bounds.bottom&&(e.y=this.bounds.top-t))},Object.defineProperty(n.World.prototype,"width",{get:function(){return this.bounds.width},set:function(e){e<this.game.width&&(e=this.game.width),this.bounds.width=e,this._width=e,this._definedSize=!0}}),Object.defineProperty(n.World.prototype,"height",{get:function(){return this.bounds.height},set:function(e){e<this.game.height&&(e=this.game.height),this.bounds.height=e,this._height=e,this._definedSize=!0}}),Object.defineProperty(n.World.prototype,"centerX",{get:function(){return this.bounds.halfWidth+this.bounds.x}}),Object.defineProperty(n.World.prototype,"centerY",{get:function(){return this.bounds.halfHeight+this.bounds.y}}),Object.defineProperty(n.World.prototype,"randomX",{get:function(){return this.bounds.x<0?this.game.rnd.between(this.bounds.x,this.bounds.width-Math.abs(this.bounds.x)):this.game.rnd.between(this.bounds.x,this.bounds.width)}}),Object.defineProperty(n.World.prototype,"randomY",{get:function(){return this.bounds.y<0?this.game.rnd.between(this.bounds.y,this.bounds.height-Math.abs(this.bounds.y)):this.game.rnd.between(this.bounds.y,this.bounds.height)}}),n.Game=function(e,t,r,i,s,o,u,a){return this.id=n.GAMES.push(this)-1,this.config=null,this.physicsConfig=a,this.parent="",this.width=800,this.height=600,this.resolution=1,this._width=800,this._height=600,this.transparent=!1,this.antialias=!0,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!0,this.renderer=null,this.renderType=n.AUTO,this.state=null,this.isBooted=!1,this.isRunning=!1,this.raf=null,this.add=null,this.make=null,this.cache=null,this.input=null,this.load=null,this.math=null,this.net=null,this.scale=null,this.sound=null,this.stage=null,this.time=null,this.tweens=null,this.world=null,this.physics=null,this.plugins=null,this.rnd=null,this.device=n.Device,this.camera=null,this.canvas=null,this.context=null,this.debug=null,this.particles=null,this.create=null,this.lockRender=!1,this.stepping=!1,this.pendingStep=!1,this.stepCount=0,this.onPause=null,this.onResume=null,this.onBlur=null,this.onFocus=null,this._paused=!1,this._codePaused=!1,this.currentUpdateID=0,this.updatesThisFrame=1,this._deltaTime=0,this._lastCount=0,this._spiraling=0,this._kickstart=!0,this.fpsProblemNotifier=new n.Signal,this.forceSingleUpdate=!0,this._nextFpsNotification=0,1===arguments.length&&"object"==typeof arguments[0]?this.parseConfig(arguments[0]):(this.config={enableDebug:!0},"undefined"!=typeof e&&(this._width=e),"undefined"!=typeof t&&(this._height=t),"undefined"!=typeof r&&(this.renderType=r),"undefined"!=typeof i&&(this.parent=i),"undefined"!=typeof o&&(this.transparent=o),"undefined"!=typeof u&&(this.antialias=u),this.rnd=new n.RandomDataGenerator([(Date.now()*Math.random()).toString()]),this.state=new n.StateManager(this,s)),this.device.whenReady(this.boot,this),this},n.Game.prototype={parseConfig:function(e){this.config=e,void 0===e.enableDebug&&(this.config.enableDebug=!0),e.width&&(this._width=e.width),e.height&&(this._height=e.height),e.renderer&&(this.renderType=e.renderer),e.parent&&(this.parent=e.parent),void 0!==e.transparent&&(this.transparent=e.transparent),void 0!==e.antialias&&(this.antialias=e.antialias),e.resolution&&(this.resolution=e.resolution),void 0!==e.preserveDrawingBuffer&&(this.preserveDrawingBuffer=e.preserveDrawingBuffer),e.physicsConfig&&(this.physicsConfig=e.physicsConfig);var t=[(Date.now()*Math.random()).toString()];e.seed&&(t=e.seed),this.rnd=new n.RandomDataGenerator(t);var r=null;e.state&&(r=e.state),this.state=new n.StateManager(this,r)},boot:function(){this.isBooted||(this.onPause=new n.Signal,this.onResume=new n.Signal,this.onBlur=new n.Signal,this.onFocus=new n.Signal,this.isBooted=!0,PIXI.game=this,this.math=n.Math,this.scale=new n.ScaleManager(this,this._width,this._height),this.stage=new n.Stage(this),this.setUpRenderer(),this.world=new n.World(this),this.add=new n.GameObjectFactory(this),this.make=new n.GameObjectCreator(this),this.cache=new n.Cache(this),this.load=new n.Loader(this),this.time=new n.Time(this),this.tweens=new n.TweenManager(this),this.input=new n.Input(this),this.sound=new n.SoundManager(this),this.physics=new n.Physics(this,this.physicsConfig),this.particles=new n.Particles(this),this.create=new n.Create(this),this.plugins=new n.PluginManager(this),this.net=new n.Net(this),this.time.boot(),this.stage.boot(),this.world.boot(),this.scale.boot(),this.input.boot(),this.sound.boot(),this.state.boot(),this.config.enableDebug?(this.debug=new n.Utils.Debug(this),this.debug.boot()):this.debug={preUpdate:function(){},update:function(){},reset:function(){}},this.showDebugHeader(),this.isRunning=!0,this.config&&this.config.forceSetTimeOut?this.raf=new n.RequestAnimationFrame(this,this.config.forceSetTimeOut):this.raf=new n.RequestAnimationFrame(this,!1),this._kickstart=!0,window.focus&&(!window.PhaserGlobal||window.PhaserGlobal&&!window.PhaserGlobal.stopFocus)&&window.focus(),this.raf.start())},showDebugHeader:function(){if(!window.PhaserGlobal||!window.PhaserGlobal.hideBanner){var e=n.VERSION,t="Canvas",r="HTML Audio",i=1;if(this.renderType===n.WEBGL?(t="WebGL",i++):this.renderType==n.HEADLESS&&(t="Headless"),this.device.webAudio&&(r="WebAudio",i++),this.device.chrome){for(var s=["%c %c %c Phaser v"+e+" | Pixi.js "+PIXI.VERSION+" | "+t+" | "+r+"  %c %c %c http://phaser.io %c♥%c♥%c♥","background: #9854d8","background: #6c2ca7","color: #ffffff; background: #450f78;","background: #6c2ca7","background: #9854d8","background: #ffffff"],o=0;3>o;o++)i>o?s.push("color: #ff2424; background: #fff"):s.push("color: #959595; background: #fff");console.log.apply(console,s)}else window.console&&console.log("Phaser v"+e+" | Pixi.js "+PIXI.VERSION+" | "+t+" | "+r+" | http://phaser.io")}},setUpRenderer:function(){if(this.config.canvas?this.canvas=this.config.canvas:this.canvas=n.Canvas.create(this,this.width,this.height,this.config.canvasID,!0),this.config.canvasStyle?this.canvas.style=this.config.canvasStyle:this.canvas.style["-webkit-full-screen"]="width: 100%; height: 100%",this.renderType===n.HEADLESS||this.renderType===n.CANVAS||this.renderType===n.AUTO&&!this.device.webGL){if(!this.device.canvas)throw new Error("Phaser.Game - Cannot create Canvas or WebGL context, aborting.");this.renderType=n.CANVAS,this.renderer=new PIXI.CanvasRenderer(this),this.context=this.renderer.context}else this.renderType=n.WEBGL,this.renderer=new PIXI.WebGLRenderer(this),this.context=null,this.canvas.addEventListener("webglcontextlost",this.contextLost.bind(this),!1),this.canvas.addEventListener("webglcontextrestored",this.contextRestored.bind(this),!1);this.device.cocoonJS&&(this.canvas.screencanvas=this.renderType===n.CANVAS?!0:!1),this.renderType!==n.HEADLESS&&(this.stage.smoothed=this.antialias,n.Canvas.addToDOM(this.canvas,this.parent,!1),n.Canvas.setTouchAction(this.canvas))},contextLost:function(e){e.preventDefault(),this.renderer.contextLost=!0},contextRestored:function(){this.renderer.initContext(),this.cache.clearGLTextures(),this.renderer.contextLost=!1},update:function(e){if(this.time.update(e),this._kickstart)return this.updateLogic(this.time.desiredFpsMult),this.stage.updateTransform(),this.updateRender(this.time.slowMotion*this.time.desiredFps),void (this._kickstart=!1);if(this._spiraling>1&&!this.forceSingleUpdate)this.time.time>this._nextFpsNotification&&(this._nextFpsNotification=this.time.time+1e4,this.fpsProblemNotifier.dispatch()),this._deltaTime=0,this._spiraling=0,this.updateRender(this.time.slowMotion*this.time.desiredFps);else{var t=1e3*this.time.slowMotion/this.time.desiredFps;this._deltaTime+=Math.max(Math.min(3*t,this.time.elapsed),0);var n=0;for(this.updatesThisFrame=Math.floor(this._deltaTime/t),this.forceSingleUpdate&&(this.updatesThisFrame=Math.min(1,this.updatesThisFrame));this._deltaTime>=t&&(this._deltaTime-=t,this.currentUpdateID=n,this.updateLogic(this.time.desiredFpsMult),this.stage.updateTransform(),n++,!this.forceSingleUpdate||1!==n);)this.time.refresh();n>this._lastCount?this._spiraling++:n<this._lastCount&&(this._spiraling=0),this._lastCount=n,this.updateRender(this._deltaTime/t)}},updateLogic:function(e){this._paused||this.pendingStep?(this.scale.pauseUpdate(),this.state.pauseUpdate(),this.debug.preUpdate()):(this.stepping&&(this.pendingStep=!0),this.scale.preUpdate(),this.debug.preUpdate(),this.world.camera.preUpdate(),this.physics.preUpdate(),this.state.preUpdate(e),this.plugins.preUpdate(e),this.stage.preUpdate(),this.state.update(),this.stage.update(),this.tweens.update(),this.sound.update(),this.input.update(),this.physics.update(),this.particles.update(),this.plugins.update(),this.stage.postUpdate(),this.plugins.postUpdate())},updateRender:function(e){this.lockRender||(this.state.preRender(e),this.renderType!==n.HEADLESS&&(this.renderer.render(this.stage),this.plugins.render(e),this.state.render(e)),this.plugins.postRender(e))},enableStep:function(){this.stepping=!0,this.pendingStep=!1,this.stepCount=0},disableStep:function(){this.stepping=!1,this.pendingStep=!1},step:function(){this.pendingStep=!1,this.stepCount++},destroy:function(){this.raf.stop(),this.state.destroy(),this.sound.destroy(),this.scale.destroy(),this.stage.destroy(),this.input.destroy(),this.physics.destroy(),this.plugins.destroy(),this.state=null,this.sound=null,this.scale=null,this.stage=null,this.input=null,this.physics=null,this.plugins=null,this.cache=null,this.load=null,this.time=null,this.world=null,this.isBooted=!1,this.renderer.destroy(!1),n.Canvas.removeFromDOM(this.canvas),PIXI.defaultRenderer=null,n.GAMES[this.id]=null},gamePaused:function(e){this._paused||(this._paused=!0,this.time.gamePaused(),this.sound.muteOnPause&&this.sound.setMute(),this.onPause.dispatch(e),this.device.cordova&&this.device.iOS&&(this.lockRender=!0))},gameResumed:function(e){this._paused&&!this._codePaused&&(this._paused=!1,this.time.gameResumed(),this.input.reset(),this.sound.muteOnPause&&this.sound.unsetMute(),this.onResume.dispatch(e),this.device.cordova&&this.device.iOS&&(this.lockRender=!1))},focusLoss:function(e){this.onBlur.dispatch(e),this.stage.disableVisibilityChange||this.gamePaused(e)},focusGain:function(e){this.onFocus.dispatch(e),this.stage.disableVisibilityChange||this.gameResumed(e)}},n.Game.prototype.constructor=n.Game,Object.defineProperty(n.Game.prototype,"paused",{get:function(){return this._paused},set:function(e){e===!0?(this._paused===!1&&(this._paused=!0,this.sound.setMute(),this.time.gamePaused(),this.onPause.dispatch(this)),this._codePaused=!0):(this._paused&&(this._paused=!1,this.input.reset(),this.sound.unsetMute(),this.time.gameResumed(),this.onResume.dispatch(this)),this._codePaused=!1)}}),n.Input=function(e){this.game=e,this.hitCanvas=null,this.hitContext=null,this.moveCallbacks=[],this.pollRate=0,this.enabled=!0,this.multiInputOverride=n.Input.MOUSE_TOUCH_COMBINE,this.position=null,this.speed=null,this.circle=null,this.scale=null,this.maxPointers=-1,this.tapRate=200,this.doubleTapRate=300,this.holdRate=2e3,this.justPressedRate=200,this.justReleasedRate=200,this.recordPointerHistory=!1,this.recordRate=100,this.recordLimit=100,this.pointer1=null,this.pointer2=null,this.pointer3=null,this.pointer4=null,this.pointer5=null,this.pointer6=null,this.pointer7=null,this.pointer8=null,this.pointer9=null,this.pointer10=null,this.pointers=[],this.activePointer=null,this.mousePointer=null,this.mouse=null,this.keyboard=null,this.touch=null,this.mspointer=null,this.gamepad=null,this.resetLocked=!1,this.onDown=null,this.onUp=null,this.onTap=null,this.onHold=null,this.minPriorityID=0,this.interactiveItems=new n.ArraySet,this._localPoint=new n.Point,this._pollCounter=0,this._oldPosition=null,this._x=0,this._y=0},n.Input.MOUSE_OVERRIDES_TOUCH=0,n.Input.TOUCH_OVERRIDES_MOUSE=1,n.Input.MOUSE_TOUCH_COMBINE=2,n.Input.MAX_POINTERS=10,n.Input.prototype={boot:function(){this.mousePointer=new n.Pointer(this.game,0,n.PointerMode.CURSOR),this.addPointer(),this.addPointer(),this.mouse=new n.Mouse(this.game),this.touch=new n.Touch(this.game),this.mspointer=new n.MSPointer(this.game),n.Keyboard&&(this.keyboard=new n.Keyboard(this.game)),n.Gamepad&&(this.gamepad=new n.Gamepad(this.game)),this.onDown=new n.Signal,this.onUp=new n.Signal,this.onTap=new n.Signal,this.onHold=new n.Signal,this.scale=new n.Point(1,1),this.speed=new n.Point,this.position=new n.Point,this._oldPosition=new n.Point,this.circle=new n.Circle(0,0,44),this.activePointer=this.mousePointer,this.hitCanvas=PIXI.CanvasPool.create(this,1,1),this.hitContext=this.hitCanvas.getContext("2d"),this.mouse.start(),this.touch.start(),this.mspointer.start(),this.mousePointer.active=!0,this.keyboard&&this.keyboard.start();var e=this;this._onClickTrampoline=function(t){e.onClickTrampoline(t)},this.game.canvas.addEventListener("click",this._onClickTrampoline,!1)},destroy:function(){this.mouse.stop(),this.touch.stop(),this.mspointer.stop(),this.keyboard&&this.keyboard.stop(),this.gamepad&&this.gamepad.stop(),this.moveCallbacks=[],PIXI.CanvasPool.remove(this),this.game.canvas.removeEventListener("click",this._onClickTrampoline)},addMoveCallback:function(e,t){this.moveCallbacks.push({callback:e,context:t})},deleteMoveCallback:function(e,t){for(var n=this.moveCallbacks.length;n--;)if(this.moveCallbacks[n].callback===e&&this.moveCallbacks[n].context===t)return void this.moveCallbacks.splice(n,1)},addPointer:function(){if(this.pointers.length>=n.Input.MAX_POINTERS)return console.warn("Phaser.Input.addPointer: Maximum limit of "+n.Input.MAX_POINTERS+" pointers reached."),null;var e=this.pointers.length+1,t=new n.Pointer(this.game,e,n.PointerMode.TOUCH);return this.pointers.push(t),this["pointer"+e]=t,t},update:function(){if(this.keyboard&&this.keyboard.update(),this.pollRate>0&&this._pollCounter<this.pollRate)return void (this._pollCounter++);this.speed.x=this.position.x-this._oldPosition.x,this.speed.y=this.position.y-this._oldPosition.y,this._oldPosition.copyFrom(this.position),this.mousePointer.update(),this.gamepad&&this.gamepad.active&&this.gamepad.update();for(var e=0;e<this.pointers.length;e++)this.pointers[e].update();this._pollCounter=0},reset:function(e){if(this.game.isBooted&&!this.resetLocked){void 0===e&&(e=!1),this.mousePointer.reset(),this.keyboard&&this.keyboard.reset(e),this.gamepad&&this.gamepad.reset();for(var t=0;t<this.pointers.length;t++)this.pointers[t].reset();"none"!==this.game.canvas.style.cursor&&(this.game.canvas.style.cursor="inherit"),e&&(this.onDown.dispose(),this.onUp.dispose(),this.onTap.dispose(),this.onHold.dispose(),this.onDown=new n.Signal,this.onUp=new n.Signal,this.onTap=new n.Signal,this.onHold=new n.Signal,this.moveCallbacks=[]),this._pollCounter=0}},resetSpeed:function(e,t){this._oldPosition.setTo(e,t),this.speed.setTo(0,0)},startPointer:function(e){if(this.maxPointers>=0&&this.countActivePointers(this.maxPointers)>=this.maxPointers)return null;if(!this.pointer1.active)return this.pointer1.start(e);if(!this.pointer2.active)return this.pointer2.start(e);for(var t=2;t<this.pointers.length;t++){var n=this.pointers[t];if(!n.active)return n.start(e)}return null},updatePointer:function(e){if(this.pointer1.active&&this.pointer1.identifier===e.identifier)return this.pointer1.move(e);if(this.pointer2.active&&this.pointer2.identifier===e.identifier)return this.pointer2.move(e);for(var t=2;t<this.pointers.length;t++){var n=this.pointers[t];if(n.active&&n.identifier===e.identifier)return n.move(e)}return null},stopPointer:function(e){if(this.pointer1.active&&this.pointer1.identifier===e.identifier)return this.pointer1.stop(e);if(this.pointer2.active&&this.pointer2.identifier===e.identifier)return this.pointer2.stop(e);for(var t=2;t<this.pointers.length;t++){var n=this.pointers[t];if(n.active&&n.identifier===e.identifier)return n.stop(e)}return null},countActivePointers:function(e){void 0===e&&(e=this.pointers.length);for(var t=e,n=0;n<this.pointers.length&&t>0;n++){var r=this.pointers[n];r.active&&t--}return e-t},getPointer:function(e){void 0===e&&(e=!1);for(var t=0;t<this.pointers.length;t++){var n=this.pointers[t];if(n.active===e)return n}return null},getPointerFromIdentifier:function(e){for(var t=0;t<this.pointers.length;t++){var n=this.pointers[t];if(n.identifier===e)return n}return null},getPointerFromId:function(e){for(var t=0;t<this.pointers.length;t++){var n=this.pointers[t];if(n.pointerId===e)return n}return null},getLocalPosition:function(e,t,r){void 0===r&&(r=new n.Point);var i=e.worldTransform,s=1/(i.a*i.d+i.c*-i.b);return r.setTo(i.d*s*t.x+ -i.c*s*t.y+(i.ty*i.c-i.tx*i.d)*s,i.a*s*t.y+ -i.b*s*t.x+(-i.ty*i.a+i.tx*i.b)*s)},hitTest:function(e,t,r){if(!e.worldVisible)return!1;if(this.getLocalPosition(e,t,this._localPoint),r.copyFrom(this._localPoint),e.hitArea&&e.hitArea.contains)return e.hitArea.contains(this._localPoint.x,this._localPoint.y);if(e instanceof n.TileSprite){var i=e.width,s=e.height,o=-i*e.anchor.x;if(this._localPoint.x>=o&&this._localPoint.x<o+i){var u=-s*e.anchor.y;if(this._localPoint.y>=u&&this._localPoint.y<u+s)return!0}}else if(e instanceof PIXI.Sprite){var i=e.texture.frame.width,s=e.texture.frame.height,o=-i*e.anchor.x;if(this._localPoint.x>=o&&this._localPoint.x<o+i){var u=-s*e.anchor.y;if(this._localPoint.y>=u&&this._localPoint.y<u+s)return!0}}else if(e instanceof n.Graphics)for(var a=0;a<e.graphicsData.length;a++){var f=e.graphicsData[a];if(f.fill&&f.shape&&f.shape.contains(this._localPoint.x,this._localPoint.y))return!0}for(var a=0;a<e.children.length;a++)if(this.hitTest(e.children[a],t,r))return!0;return!1},onClickTrampoline:function(){this.activePointer.processClickTrampolines()}},n.Input.prototype.constructor=n.Input,Object.defineProperty(n.Input.prototype,"x",{get:function(){return this._x},set:function(e){this._x=Math.floor(e)}}),Object.defineProperty(n.Input.prototype,"y",{get:function(){return this._y},set:function(e){this._y=Math.floor(e)}}),Object.defineProperty(n.Input.prototype,"pollLocked",{get:function(){return this.pollRate>0&&this._pollCounter<this.pollRate}}),Object.defineProperty(n.Input.prototype,"totalInactivePointers",{get:function(){return this.pointers.length-this.countActivePointers()}}),Object.defineProperty(n.Input.prototype,"totalActivePointers",{get:function(){return this.countActivePointers()}}),Object.defineProperty(n.Input.prototype,"worldX",{get:function(){return this.game.camera.view.x+this.x}}),Object.defineProperty(n.Input.prototype,"worldY",{get:function(){return this.game.camera.view.y+this.y}}),n.Mouse=function(e){this.game=e,this.input=e.input,this.callbackContext=this.game,this.mouseDownCallback=null,this.mouseUpCallback=null,this.mouseOutCallback=null,this.mouseOverCallback=null,this.mouseWheelCallback=null,this.capture=!1,this.button=-1,this.wheelDelta=0,this.enabled=!0,this.locked=!1,this.stopOnGameOut=!1,this.pointerLock=new n.Signal,this.event=null,this._onMouseDown=null,this._onMouseMove=null,this._onMouseUp=null,this._onMouseOut=null,this._onMouseOver=null,this._onMouseWheel=null,this._wheelEvent=null},n.Mouse.NO_BUTTON=-1,n.Mouse.LEFT_BUTTON=0,n.Mouse.MIDDLE_BUTTON=1,n.Mouse.RIGHT_BUTTON=2,n.Mouse.BACK_BUTTON=3,n.Mouse.FORWARD_BUTTON=4,n.Mouse.WHEEL_UP=1,n.Mouse.WHEEL_DOWN=-1,n.Mouse.prototype={start:function(){if((!this.game.device.android||this.game.device.chrome!==!1)&&null===this._onMouseDown){var t=this;this._onMouseDown=function(e){return t.onMouseDown(e)},this._onMouseMove=function(e){return t.onMouseMove(e)},this._onMouseUp=function(e){return t.onMouseUp(e)},this._onMouseUpGlobal=function(e){return t.onMouseUpGlobal(e)},this._onMouseOutGlobal=function(e){return t.onMouseOutGlobal(e)},this._onMouseOut=function(e){return t.onMouseOut(e)},this._onMouseOver=function(e){return t.onMouseOver(e)},this._onMouseWheel=function(e){return t.onMouseWheel(e)};var n=this.game.canvas;n.addEventListener("mousedown",this._onMouseDown,!0),n.addEventListener("mousemove",this._onMouseMove,!0),n.addEventListener("mouseup",this._onMouseUp,!0),this.game.device.cocoonJS||(window.addEventListener("mouseup",this._onMouseUpGlobal,!0),window.addEventListener("mouseout",this._onMouseOutGlobal,!0),n.addEventListener("mouseover",this._onMouseOver,!0),n.addEventListener("mouseout",this._onMouseOut,!0));var r=this.game.device.wheelEvent;r&&(n.addEventListener(r,this._onMouseWheel,!0),"mousewheel"===r?this._wheelEvent=new e(-1/40,1):"DOMMouseScroll"===r&&(this._wheelEvent=new e(1,1)))}},onMouseDown:function(e){this.event=e,this.capture&&e.preventDefault(),this.mouseDownCallback&&this.mouseDownCallback.call(this.callbackContext,e),this.input.enabled&&this.enabled&&(e.identifier=0,this.input.mousePointer.start(e))},onMouseMove:function(e){this.event=e,this.capture&&e.preventDefault(),this.mouseMoveCallback&&this.mouseMoveCallback.call(this.callbackContext,e),this.input.enabled&&this.enabled&&(e.identifier=0,this.input.mousePointer.move(e))},onMouseUp:function(e){this.event=e,this.capture&&e.preventDefault(),this.mouseUpCallback&&this.mouseUpCallback.call(this.callbackContext,e),this.input.enabled&&this.enabled&&(e.identifier=0,this.input.mousePointer.stop(e))},onMouseUpGlobal:function(e){this.input.mousePointer.withinGame||(this.mouseUpCallback&&this.mouseUpCallback.call(this.callbackContext,e),e.identifier=0,this.input.mousePointer.stop(e))},onMouseOutGlobal:function(e){this.event=e,this.capture&&e.preventDefault(),this.input.mousePointer.withinGame=!1,this.input.enabled&&this.enabled&&(this.input.mousePointer.stop(e),this.input.mousePointer.leftButton.stop(e),this.input.mousePointer.rightButton.stop(e))},onMouseOut:function(e){this.event=e,this.capture&&e.preventDefault(),this.input.mousePointer.withinGame=!1,this.mouseOutCallback&&this.mouseOutCallback.call(this.callbackContext,e),this.input.enabled&&this.enabled&&this.stopOnGameOut&&(e.identifier=0,this.input.mousePointer.stop(e))},onMouseOver:function(e){this.event=e,this.capture&&e.preventDefault(),this.input.mousePointer.withinGame=!0,this.mouseOverCallback&&this.mouseOverCallback.call(this.callbackContext,e)},onMouseWheel:function(e){this._wheelEvent&&(e=this._wheelEvent.bindEvent(e)),this.event=e,this.capture&&e.preventDefault(),this.wheelDelta=n.Math.clamp(-e.deltaY,-1,1),this.mouseWheelCallback&&this.mouseWheelCallback.call(this.callbackContext,e)},requestPointerLock:function(){if(this.game.device.pointerLock){var e=this.game.canvas;e.requestPointerLock=e.requestPointerLock||e.mozRequestPointerLock||e.webkitRequestPointerLock,e.requestPointerLock();var t=this;this._pointerLockChange=function(e){return t.pointerLockChange(e)},document.addEventListener("pointerlockchange",this._pointerLockChange,!0),document.addEventListener("mozpointerlockchange",this._pointerLockChange,!0),document.addEventListener("webkitpointerlockchange",this._pointerLockChange,!0)}},pointerLockChange:function(e){var t=this.game.canvas;document.pointerLockElement===t||document.mozPointerLockElement===t||document.webkitPointerLockElement===t?(this.locked=!0,this.pointerLock.dispatch(!0,e)):(this.locked=!1,this.pointerLock.dispatch(!1,e))},releasePointerLock:function(){document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock,document.exitPointerLock(),document.removeEventListener("pointerlockchange",this._pointerLockChange,!0),document.removeEventListener("mozpointerlockchange",this._pointerLockChange,!0),document.removeEventListener("webkitpointerlockchange",this._pointerLockChange,!0)},stop:function(){var e=this.game.canvas;e.removeEventListener("mousedown",this._onMouseDown,!0),e.removeEventListener("mousemove",this._onMouseMove,!0),e.removeEventListener("mouseup",this._onMouseUp,!0),e.removeEventListener("mouseover",this._onMouseOver,!0),e.removeEventListener("mouseout",this._onMouseOut,!0);var t=this.game.device.wheelEvent;t&&e.removeEventListener(t,this._onMouseWheel,!0),window.removeEventListener("mouseup",this._onMouseUpGlobal,!0),window.removeEventListener("mouseout",this._onMouseOutGlobal,!0),document.removeEventListener("pointerlockchange",this._pointerLockChange,!0),document.removeEventListener("mozpointerlockchange",this._pointerLockChange,!0),document.removeEventListener("webkitpointerlockchange",this._pointerLockChange,!0)}},n.Mouse.prototype.constructor=n.Mouse,e.prototype={},e.prototype.constructor=e,e.prototype.bindEvent=function(t){if(!e._stubsGenerated&&t){var n=function(e){return function(){var t=this.originalEvent[e];return"function"!=typeof t?t:t.bind(this.originalEvent)}};for(var r in t)r in e.prototype||Object.defineProperty(e.prototype,r,{get:n(r)});e._stubsGenerated=!0}return this.originalEvent=t,this},Object.defineProperties(e.prototype,{type:{value:"wheel"},deltaMode:{get:function(){return this._deltaMode}},deltaY:{get:function(){return this._scaleFactor*(this.originalEvent.wheelDelta||this.originalEvent.detail)||0}},deltaX:{get:function(){return this._scaleFactor*this.originalEvent.wheelDeltaX||0}},deltaZ:{value:0}}),n.MSPointer=function(e){this.game=e,this.input=e.input,this.callbackContext=this.game,this.pointerDownCallback=null,this.pointerMoveCallback=null,this.pointerUpCallback=null,this.capture=!0,this.button=-1,this.event=null,this.enabled=!0,this._onMSPointerDown=null,this._onMSPointerMove=null,this._onMSPointerUp=null,this._onMSPointerUpGlobal=null,this._onMSPointerOut=null,this._onMSPointerOver=null},n.MSPointer.prototype={start:function(){if(null===this._onMSPointerDown){var e=this;if(this.game.device.mspointer){this._onMSPointerDown=function(t){return e.onPointerDown(t)},this._onMSPointerMove=function(t){return e.onPointerMove(t)},this._onMSPointerUp=function(t){return e.onPointerUp(t)},this._onMSPointerUpGlobal=function(t){return e.onPointerUpGlobal(t)},this._onMSPointerOut=function(t){return e.onPointerOut(t)},this._onMSPointerOver=function(t){return e.onPointerOver(t)};var t=this.game.canvas;t.addEventListener("MSPointerDown",this._onMSPointerDown,!1),t.addEventListener("MSPointerMove",this._onMSPointerMove,!1),t.addEventListener("MSPointerUp",this._onMSPointerUp,!1),t.addEventListener("pointerdown",this._onMSPointerDown,!1),t.addEventListener("pointermove",this._onMSPointerMove,!1),t.addEventListener("pointerup",this._onMSPointerUp,!1),t.style["-ms-content-zooming"]="none",t.style["-ms-touch-action"]="none",this.game.device.cocoonJS||(window.addEventListener("MSPointerUp",this._onMSPointerUpGlobal,!0),t.addEventListener("MSPointerOver",this._onMSPointerOver,!0),t.addEventListener("MSPointerOut",this._onMSPointerOut,!0),window.addEventListener("pointerup",this._onMSPointerUpGlobal,!0),t.addEventListener("pointerover",this._onMSPointerOver,!0),t.addEventListener("pointerout",this._onMSPointerOut,!0))}}},onPointerDown:function(e){this.event=e,this.capture&&e.preventDefault(),this.pointerDownCallback&&this.pointerDownCallback.call(this.callbackContext,e),this.input.enabled&&this.enabled&&(e.identifier=e.pointerId,"mouse"===e.pointerType||4===e.pointerType?this.input.mousePointer.start(e):this.input.startPointer(e))},onPointerMove:function(e){this.event=e,this.capture&&e.preventDefault(),this.pointerMoveCallback&&this.pointerMoveCallback.call(this.callbackContext,e),this.input.enabled&&this.enabled&&(e.identifier=e.pointerId,"mouse"===e.pointerType||4===e.pointerType?this.input.mousePointer.move(e):this.input.updatePointer(e))},onPointerUp:function(e){this.event=e,this.capture&&e.preventDefault(),this.pointerUpCallback&&this.pointerUpCallback.call(this.callbackContext,e),this.input.enabled&&this.enabled&&(e.identifier=e.pointerId,"mouse"===e.pointerType||4===e.pointerType?this.input.mousePointer.stop(e):this.input.stopPointer(e))},onPointerUpGlobal:function(e){if("mouse"!==e.pointerType&&4!==e.pointerType||this.input.mousePointer.withinGame){var t=this.input.getPointerFromIdentifier(e.identifier);t&&t.withinGame&&this.onPointerUp(e)}else this.onPointerUp(e)},onPointerOut:function(e){if(this.event=e,this.capture&&e.preventDefault(),"mouse"===e.pointerType||4===e.pointerType)this.input.mousePointer.withinGame=!1;else{var t=this.input.getPointerFromIdentifier(e.identifier);t&&(t.withinGame=!1)}this.input.mouse.mouseOutCallback&&this.input.mouse.mouseOutCallback.call(this.input.mouse.callbackContext,e),this.input.enabled&&this.enabled&&this.input.mouse.stopOnGameOut&&(e.identifier=0,t?t.stop(e):this.input.mousePointer.stop(e))},onPointerOver:function(e){if(this.event=e,this.capture&&e.preventDefault(),"mouse"===e.pointerType||4===e.pointerType)this.input.mousePointer.withinGame=!0;else{var t=this.input.getPointerFromIdentifier(e.identifier);t&&(t.withinGame=!0)}this.input.mouse.mouseOverCallback&&this.input.mouse.mouseOverCallback.call(this.input.mouse.callbackContext,e)},stop:function(){var e=this.game.canvas;e.removeEventListener("MSPointerDown",this._onMSPointerDown,!1),e.removeEventListener("MSPointerMove",this._onMSPointerMove,!1),e.removeEventListener("MSPointerUp",this._onMSPointerUp,!1),e.removeEventListener("pointerdown",this._onMSPointerDown,!1),e.removeEventListener("pointermove",this._onMSPointerMove,!1),e.removeEventListener("pointerup",this._onMSPointerUp,!1),window.removeEventListener("MSPointerUp",this._onMSPointerUpGlobal,!0),e.removeEventListener("MSPointerOver",this._onMSPointerOver,!0),e.removeEventListener("MSPointerOut",this._onMSPointerOut,!0),window.removeEventListener("pointerup",this._onMSPointerUpGlobal,!0),e.removeEventListener("pointerover",this._onMSPointerOver,!0),e.removeEventListener("pointerout",this._onMSPointerOut,!0)}},n.MSPointer.prototype.constructor=n.MSPointer,n.DeviceButton=function(e,t){this.parent=e,this.game=e.game,this.event=null,this.isDown=!1,this.isUp=!0,this.timeDown=0,this.timeUp=0,this.repeats=0,this.altKey=!1,this.shiftKey=!1,this.ctrlKey=!1,this.value=0,this.buttonCode=t,this.onDown=new n.Signal,this.onUp=new n.Signal,this.onFloat=new n.Signal},n.DeviceButton.prototype={start:function(e,t){this.isDown||(this.isDown=!0,this.isUp=!1,this.timeDown=this.game.time.time,this.repeats=0,this.event=e,this.value=t,e&&(this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.ctrlKey=e.ctrlKey),this.onDown.dispatch(this,t))},stop:function(e,t){this.isUp||(this.isDown=!1,this.isUp=!0,this.timeUp=this.game.time.time,this.event=e,this.value=t,e&&(this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.ctrlKey=e.ctrlKey),this.onUp.dispatch(this,t))},padFloat:function(e){this.value=e,this.onFloat.dispatch(this,e)},justPressed:function(e){return e=e||250,this.isDown&&this.timeDown+e>this.game.time.time},justReleased:function(e){return e=e||250,this.isUp&&this.timeUp+e>this.game.time.time},reset:function(){this.isDown=!1,this.isUp=!0,this.timeDown=this.game.time.time,this.repeats=0,this.altKey=!1,this.shiftKey=!1,this.ctrlKey=!1},destroy:function(){this.onDown.dispose(),this.onUp.dispose(),this.onFloat.dispose(),this.parent=null,this.game=null}},n.DeviceButton.prototype.constructor=n.DeviceButton,Object.defineProperty(n.DeviceButton.prototype,"duration",{get:function(){return this.isUp?-1:this.game.time.time-this.timeDown}}),n.Pointer=function(e,t,r){this.game=e,this.id=t,this.type=n.POINTER,this.exists=!0,this.identifier=0,this.pointerId=null,this.pointerMode=r||n.PointerMode.CURSOR|n.PointerMode.CONTACT,this.target=null,this.button=null,this.leftButton=new n.DeviceButton(this,n.Pointer.LEFT_BUTTON),this.middleButton=new n.DeviceButton(this,n.Pointer.MIDDLE_BUTTON),this.rightButton=new n.DeviceButton(this,n.Pointer.RIGHT_BUTTON),this.backButton=new n.DeviceButton(this,n.Pointer.BACK_BUTTON),this.forwardButton=new n.DeviceButton(this,n.Pointer.FORWARD_BUTTON),this.eraserButton=new n.DeviceButton(this,n.Pointer.ERASER_BUTTON),this._holdSent=!1,this._history=[],this._nextDrop=0,this._stateReset=!1,this.withinGame=!1,this.clientX=-1,this.clientY=-1,this.pageX=-1,this.pageY=-1,this.screenX=-1,this.screenY=-1,this.rawMovementX=0,this.rawMovementY=0,this.movementX=0,this.movementY=0,this.x=-1,this.y=-1,this.isMouse=0===t,this.isDown=!1,this.isUp=!0,this.timeDown=0,this.timeUp=0,this.previousTapTime=0,this.totalTouches=0,this.msSinceLastClick=Number.MAX_VALUE,this.targetObject=null,this.active=!1,this.dirty=!1,this.position=new n.Point,this.positionDown=new n.Point,this.positionUp=new n.Point,this.circle=new n.Circle(0,0,44),this._clickTrampolines=null,this._trampolineTargetObject=null},n.Pointer.NO_BUTTON=0,n.Pointer.LEFT_BUTTON=1,n.Pointer.RIGHT_BUTTON=2,n.Pointer.MIDDLE_BUTTON=4,n.Pointer.BACK_BUTTON=8,n.Pointer.FORWARD_BUTTON=16,n.Pointer.ERASER_BUTTON=32,n.Pointer.prototype={resetButtons:function(){this.isDown=!1,this.isUp=!0,this.isMouse&&(this.leftButton.reset(),this.middleButton.reset(),this.rightButton.reset(),this.backButton.reset(),this.forwardButton.reset(),this.eraserButton.reset())},processButtonsDown:function(e,t){n.Pointer.LEFT_BUTTON&e&&this.leftButton.start(t),n.Pointer.RIGHT_BUTTON&e&&this.rightButton.start(t),n.Pointer.MIDDLE_BUTTON&e&&this.middleButton.start(t),n.Pointer.BACK_BUTTON&e&&this.backButton.start(t),n.Pointer.FORWARD_BUTTON&e&&this.forwardButton.start(t),n.Pointer.ERASER_BUTTON&e&&this.eraserButton.start(t)},processButtonsUp:function(e,t){e===n.Mouse.LEFT_BUTTON&&this.leftButton.stop(t),e===n.Mouse.RIGHT_BUTTON&&this.rightButton.stop(t),e===n.Mouse.MIDDLE_BUTTON&&this.middleButton.stop(t),e===n.Mouse.BACK_BUTTON&&this.backButton.stop(t),e===n.Mouse.FORWARD_BUTTON&&this.forwardButton.stop(t),5===e&&this.eraserButton.stop(t)},updateButtons:function(e){this.button=e.button;var t="down"===e.type.toLowerCase().substr(-4);void 0!==e.buttons?t?this.processButtonsDown(e.buttons,e):this.processButtonsUp(e.button,e):t?this.leftButton.start(e):(this.leftButton.stop(e),this.rightButton.stop(e)),1===e.buttons&&e.ctrlKey&&this.leftButton.isDown&&(this.leftButton.stop(e),this.rightButton.start(e)),this.isUp=!0,this.isDown=!1,(this.leftButton.isDown||this.rightButton.isDown||this.middleButton.isDown||this.backButton.isDown||this.forwardButton.isDown||this.eraserButton.isDown)&&(this.isUp=!1,this.isDown=!0)},start:function(e){var t=this.game.input;return e.pointerId&&(this.pointerId=e.pointerId),this.identifier=e.identifier,this.target=e.target,this.isMouse?this.updateButtons(e):(this.isDown=!0,this.isUp=!1),this.active=!0,this.withinGame=!0,this.dirty=!1,this._history=[],this._clickTrampolines=null,this._trampolineTargetObject=null,this.msSinceLastClick=this.game.time.time-this.timeDown,this.timeDown=this.game.time.time,this._holdSent=!1,this.move(e,!0),this.positionDown.setTo(this.x,this.y),(t.multiInputOverride===n.Input.MOUSE_OVERRIDES_TOUCH||t.multiInputOverride===n.Input.MOUSE_TOUCH_COMBINE||t.multiInputOverride===n.Input.TOUCH_OVERRIDES_MOUSE&&0===t.totalActivePointers)&&(t.x=this.x,t.y=this.y,t.position.setTo(this.x,this.y),t.onDown.dispatch(this,e),t.resetSpeed(this.x,this.y)),this._stateReset=!1,this.totalTouches++,null!==this.targetObject&&this.targetObject._touchedHandler(this),this},update:function(){var e=this.game.input;this.active&&(this.dirty&&(e.interactiveItems.total>0&&this.processInteractiveObjects(!1),this.dirty=!1),this._holdSent===!1&&this.duration>=e.holdRate&&((e.multiInputOverride===n.Input.MOUSE_OVERRIDES_TOUCH||e.multiInputOverride===n.Input.MOUSE_TOUCH_COMBINE||e.multiInputOverride===n.Input.TOUCH_OVERRIDES_MOUSE&&0===e.totalActivePointers)&&e.onHold.dispatch(this),this._holdSent=!0),e.recordPointerHistory&&this.game.time.time>=this._nextDrop&&(this._nextDrop=this.game.time.time+e.recordRate,this._history.push({x:this.position.x,y:this.position.y}),this._history.length>e.recordLimit&&this._history.shift()))},move:function(e,t){var r=this.game.input;if(!r.pollLocked){if(void 0===t&&(t=!1),void 0!==e.button&&(this.button=e.button),t&&this.isMouse&&this.updateButtons(e),this.clientX=e.clientX,this.clientY=e.clientY,this.pageX=e.pageX,this.pageY=e.pageY,this.screenX=e.screenX,this.screenY=e.screenY,this.isMouse&&r.mouse.locked&&!t&&(this.rawMovementX=e.movementX||e.mozMovementX||e.webkitMovementX||0,this.rawMovementY=e.movementY||e.mozMovementY||e.webkitMovementY||0,this.movementX+=this.rawMovementX,this.movementY+=this.rawMovementY),this.x=(this.pageX-this.game.scale.offset.x)*r.scale.x,this.y=(this.pageY-this.game.scale.offset.y)*r.scale.y,this.position.setTo(this.x,this.y),this.circle.x=this.x,this.circle.y=this.y,(r.multiInputOverride===n.Input.MOUSE_OVERRIDES_TOUCH||r.multiInputOverride===n.Input.MOUSE_TOUCH_COMBINE||r.multiInputOverride===n.Input.TOUCH_OVERRIDES_MOUSE&&0===r.totalActivePointers)&&(r.activePointer=this,r.x=this.x,r.y=this.y,r.position.setTo(r.x,r.y),r.circle.x=r.x,r.circle.y=r.y),this.withinGame=this.game.scale.bounds.contains(this.pageX,this.pageY),this.game.paused)return this;for(var i=r.moveCallbacks.length;i--;)r.moveCallbacks[i].callback.call(r.moveCallbacks[i].context,this,this.x,this.y,t);return null!==this.targetObject&&this.targetObject.isDragged===!0?this.targetObject.update(this)===!1&&(this.targetObject=null):r.interactiveItems.total>0&&this.processInteractiveObjects(t),this}},processInteractiveObjects:function(e){for(var t=Number.MAX_VALUE,n=-1,r=null,i=this.game.input.interactiveItems.first;i;)i.checked=!1,i.validForInput(n,t,!1)&&(i.checked=!0,(e&&i.checkPointerDown(this,!0)||!e&&i.checkPointerOver(this,!0))&&(t=i.sprite.renderOrderID,n=i.priorityID,r=i)),i=this.game.input.interactiveItems.next;for(var i=this.game.input.interactiveItems.first;i;)!i.checked&&i.validForInput(n,t,!0)&&(e&&i.checkPointerDown(this,!1)||!e&&i.checkPointerOver(this,!1))&&(t=i.sprite.renderOrderID,n=i.priorityID,r=i),i=this.game.input.interactiveItems.next;return null===r?this.targetObject&&(this.targetObject._pointerOutHandler(this),this.targetObject=null):null===this.targetObject?(this.targetObject=r,r._pointerOverHandler(this)):this.targetObject===r?r.update(this)===!1&&(this.targetObject=null):(this.targetObject._pointerOutHandler(this),this.targetObject=r,this.targetObject._pointerOverHandler(this)),null!==this.targetObject},leave:function(e){this.withinGame=!1,this.move(e,!1)},stop:function(e){var t=this.game.input;return this._stateReset&&this.withinGame?void e.preventDefault():(this.timeUp=this.game.time.time,(t.multiInputOverride===n.Input.MOUSE_OVERRIDES_TOUCH||t.multiInputOverride===n.Input.MOUSE_TOUCH_COMBINE||t.multiInputOverride===n.Input.TOUCH_OVERRIDES_MOUSE&&0===t.totalActivePointers)&&(t.onUp.dispatch(this,e),this.duration>=0&&this.duration<=t.tapRate&&(this.timeUp-this.previousTapTime<t.doubleTapRate?t.onTap.dispatch(this,!0):t.onTap.dispatch(this,!1),this.previousTapTime=this.timeUp)),this.isMouse?this.updateButtons(e):(this.isDown=!1,this.isUp=!0),this.id>0&&(this.active=!1),this.withinGame=this.game.scale.bounds.contains(e.pageX,e.pageY),this.pointerId=null,this.identifier=null,this.positionUp.setTo(this.x,this.y),this.isMouse===!1&&t.currentPointers--,t.interactiveItems.callAll("_releasedHandler",this),this._clickTrampolines&&(this._trampolineTargetObject=this.targetObject),this.targetObject=null,this)},justPressed:function(e){return e=e||this.game.input.justPressedRate,this.isDown===!0&&this.timeDown+e>this.game.time.time},justReleased:function(e){return e=e||this.game.input.justReleasedRate,this.isUp&&this.timeUp+e>this.game.time.time},addClickTrampoline:function(e,t,n,r){if(this.isDown){for(var i=this._clickTrampolines=this._clickTrampolines||[],s=0;s<i.length;s++)if(i[s].name===e){i.splice(s,1);break}i.push({name:e,targetObject:this.targetObject,callback:t,callbackContext:n,callbackArgs:r})}},processClickTrampolines:function(){var e=this._clickTrampolines;if(e){for(var t=0;t<e.length;t++){var n=e[t];n.targetObject===this._trampolineTargetObject&&n.callback.apply(n.callbackContext,n.callbackArgs)}this._clickTrampolines=null,this._trampolineTargetObject=null}},reset:function(){this.isMouse===!1&&(this.active=!1),this.pointerId=null,this.identifier=null,this.dirty=!1,this.totalTouches=0,this._holdSent=!1,this._history.length=0,this._stateReset=!0,this.resetButtons(),this.targetObject&&this.targetObject._releasedHandler(this),this.targetObject=null},resetMovement:function(){this.movementX=0,this.movementY=0}},n.Pointer.prototype.constructor=n.Pointer,Object.defineProperty(n.Pointer.prototype,"duration",{get:function(){return this.isUp?-1:this.game.time.time-this.timeDown}}),Object.defineProperty(n.Pointer.prototype,"worldX",{get:function(){return this.game.world.camera.x+this.x}}),Object.defineProperty(n.Pointer.prototype,"worldY",{get:function(){return this.game.world.camera.y+this.y}}),n.PointerMode={CURSOR:1,CONTACT:2},n.Touch=function(e){this.game=e,this.enabled=!0,this.touchLockCallbacks=[],this.callbackContext=this.game,this.touchStartCallback=null,this.touchMoveCallback=null,this.touchEndCallback=null,this.touchEnterCallback=null,this.touchLeaveCallback=null,this.touchCancelCallback=null,this.preventDefault=!0,this.event=null,this._onTouchStart=null,this._onTouchMove=null,this._onTouchEnd=null,this._onTouchEnter=null,this._onTouchLeave=null,this._onTouchCancel=null,this._onTouchMove=null},n.Touch.prototype={start:function(){if(null===this._onTouchStart){var e=this;this.game.device.touch&&(this._onTouchStart=function(t){return e.onTouchStart(t)},this._onTouchMove=function(t){return e.onTouchMove(t)},this._onTouchEnd=function(t){return e.onTouchEnd(t)},this._onTouchEnter=function(t){return e.onTouchEnter(t)},this._onTouchLeave=function(t){return e.onTouchLeave(t)},this._onTouchCancel=function(t){return e.onTouchCancel(t)},this.game.canvas.addEventListener("touchstart",this._onTouchStart,!1),this.game.canvas.addEventListener("touchmove",this._onTouchMove,!1),this.game.canvas.addEventListener("touchend",this._onTouchEnd,!1),this.game.canvas.addEventListener("touchcancel",this._onTouchCancel,!1),this.game.device.cocoonJS||(this.game.canvas.addEventListener("touchenter",this._onTouchEnter,!1),this.game.canvas.addEventListener("touchleave",this._onTouchLeave,!1)))}},consumeDocumentTouches:function(){this._documentTouchMove=function(e){e.preventDefault()},document.addEventListener("touchmove",this._documentTouchMove,!1)},addTouchLockCallback:function(e,t,n){void 0===n&&(n=!1),this.touchLockCallbacks.push({callback:e,context:t,onEnd:n})},removeTouchLockCallback:function(e,t){for(var n=this.touchLockCallbacks.length;n--;)if(this.touchLockCallbacks[n].callback===e&&this.touchLockCallbacks[n].context===t)return this.touchLockCallbacks.splice(n,1),!0;return!1},onTouchStart:function(e){for(var t=this.touchLockCallbacks.length;t--;){var n=this.touchLockCallbacks[t];!n.onEnd&&n.callback.call(n.context,this,e)&&this.touchLockCallbacks.splice(t,1)}if(this.event=e,this.game.input.enabled&&this.enabled){this.touchStartCallback&&this.touchStartCallback.call(this.callbackContext,e),this.preventDefault&&e.preventDefault();for(var t=0;t<e.changedTouches.length;t++)this.game.input.startPointer(e.changedTouches[t])}},onTouchCancel:function(e){if(this.event=e,this.touchCancelCallback&&this.touchCancelCallback.call(this.callbackContext,e),this.game.input.enabled&&this.enabled){this.preventDefault&&e.preventDefault();for(var t=0;t<e.changedTouches.length;t++)this.game.input.stopPointer(e.changedTouches[t])}},onTouchEnter:function(e){this.event=e,this.touchEnterCallback&&this.touchEnterCallback.call(this.callbackContext,e),this.game.input.enabled&&this.enabled&&this.preventDefault&&e.preventDefault()},onTouchLeave:function(e){this.event=e,this.touchLeaveCallback&&this.touchLeaveCallback.call(this.callbackContext,e),this.preventDefault&&e.preventDefault()},onTouchMove:function(e){this.event=e,this.touchMoveCallback&&this.touchMoveCallback.call(this.callbackContext,e),this.preventDefault&&e.preventDefault();for(var t=0;t<e.changedTouches.length;t++)this.game.input.updatePointer(e.changedTouches[t])},onTouchEnd:function(e){for(var t=this.touchLockCallbacks.length;t--;){var n=this.touchLockCallbacks[t];n.onEnd&&n.callback.call(n.context,this,e)&&this.touchLockCallbacks.splice(t,1)}this.event=e,this.touchEndCallback&&this.touchEndCallback.call(this.callbackContext,e),this.preventDefault&&e.preventDefault();for(var t=0;t<e.changedTouches.length;t++)this.game.input.stopPointer(e.changedTouches[t])},stop:function(){this.game.device.touch&&(this.game.canvas.removeEventListener("touchstart",this._onTouchStart),this.game.canvas.removeEventListener("touchmove",this._onTouchMove),this.game.canvas.removeEventListener("touchend",this._onTouchEnd),this.game.canvas.removeEventListener("touchenter",this._onTouchEnter),this.game.canvas.removeEventListener("touchleave",this._onTouchLeave),this.game.canvas.removeEventListener("touchcancel",this._onTouchCancel))}},n.Touch.prototype.constructor=n.Touch,n.InputHandler=function(e){this.sprite=e,this.game=e.game,this.enabled=!1,this.checked=!1,this.priorityID=0,this.useHandCursor=!1,this._setHandCursor=!1,this.isDragged=!1,this.allowHorizontalDrag=!0,this.allowVerticalDrag=!0,this.bringToTop=!1,this.snapOffset=null,this.snapOnDrag=!1,this.snapOnRelease=!1,this.snapX=0,this.snapY=0,this.snapOffsetX=0,this.snapOffsetY=0,this.pixelPerfectOver=!1,this.pixelPerfectClick=!1,this.pixelPerfectAlpha=255,this.draggable=!1,this.boundsRect=null,this.boundsSprite=null,this.scaleLayer=!1,this.dragOffset=new n.Point,this.dragFromCenter=!1,this.dragStartPoint=new n.Point,this.snapPoint=new n.Point,this._dragPoint=new n.Point,this._dragPhase=!1,this._wasEnabled=!1,this._tempPoint=new n.Point,this._pointerData=[],this._pointerData.push({id:0,x:0,y:0,camX:0,camY:0,isDown:!1,isUp:!1,isOver:!1,isOut:!1,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,isDragged:!1})},n.InputHandler.prototype={start:function(e,t){if(e=e||0,void 0===t&&(t=!1),this.enabled===!1){this.game.input.interactiveItems.add(this),this.useHandCursor=t,this.priorityID=e;for(var r=0;10>r;r++)this._pointerData[r]={id:r,x:0,y:0,isDown:!1,isUp:!1,isOver:!1,isOut:!1,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,isDragged:!1};this.snapOffset=new n.Point,this.enabled=!0,this._wasEnabled=!0}return this.sprite.events.onAddedToGroup.add(this.addedToGroup,this),this.sprite.events.onRemovedFromGroup.add(this.removedFromGroup,this),this.flagged=!1,this.sprite},addedToGroup:function(){this._dragPhase||this._wasEnabled&&!this.enabled&&this.start()},removedFromGroup:function(){this._dragPhase||(this.enabled?(this._wasEnabled=!0,this.stop()):this._wasEnabled=!1)},reset:function(){this.enabled=!1,this.flagged=!1;for(var e=0;10>e;e++)this._pointerData[e]={id:e,x:0,y:0,isDown:!1,isUp:!1,isOver:!1,isOut:!1,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,isDragged:!1}},stop:function(){this.enabled!==!1&&(this.enabled=!1,this.game.input.interactiveItems.remove(this))},destroy:function(){this.sprite&&(this._setHandCursor&&(this.game.canvas.style.cursor="default",this._setHandCursor=!1),this.enabled=!1,this.game.input.interactiveItems.remove(this),this._pointerData.length=0,this.boundsRect=null,this.boundsSprite=null,this.sprite=null)},validForInput:function(e,t,n){return void 0===n&&(n=!0),!this.enabled||0===this.sprite.scale.x||0===this.sprite.scale.y||this.priorityID<this.game.input.minPriorityID?!1:(n||!this.pixelPerfectClick&&!this.pixelPerfectOver)&&(this.priorityID>e||this.priorityID===e&&this.sprite.renderOrderID<t)?!0:!1},isPixelPerfect:function(){return this.pixelPerfectClick||this.pixelPerfectOver},pointerX:function(e){return e=e||0,this._pointerData[e].x},pointerY:function(e){return e=e||0,this._pointerData[e].y},pointerDown:function(e){return e=e||0,this._pointerData[e].isDown},pointerUp:function(e){return e=e||0,this._pointerData[e].isUp},pointerTimeDown:function(e){return e=e||0,this._pointerData[e].timeDown},pointerTimeUp:function(e){return e=e||0,this._pointerData[e].timeUp},pointerOver:function(e){if(!this.enabled)return!1;if(void 0===e){for(var t=0;10>t;t++)if(this._pointerData[t].isOver)return!0;return!1}return this._pointerData[e].isOver},pointerOut:function(e){if(!this.enabled)return!1;if(void 0!==e)return this._pointerData[e].isOut;for(var t=0;10>t;t++)if(this._pointerData[t].isOut)return!0},pointerTimeOver:function(e){return e=e||0,this._pointerData[e].timeOver},pointerTimeOut:function(e){return e=e||0,this._pointerData[e].timeOut},pointerDragged:function(e){return e=e||0,this._pointerData[e].isDragged},checkPointerDown:function(e,t){return e.isDown&&this.enabled&&this.sprite&&this.sprite.parent&&this.sprite.visible&&!(!this.sprite.parent.visible|0===this.sprite.worldScale.x)&&0!==this.sprite.worldScale.y&&this.game.input.hitTest(this.sprite,e,this._tempPoint)?(void 0===t&&(t=!1),!t&&this.pixelPerfectClick?this.checkPixel(this._tempPoint.x,this._tempPoint.y):!0):!1},checkPointerOver:function(e,t){return e.isDown&&this.enabled&&this.sprite&&this.sprite.parent&&this.sprite.visible&&!(!this.sprite.parent.visible|0===this.sprite.worldScale.x)&&0!==this.sprite.worldScale.y&&this.game.input.hitTest(this.sprite,e,this._tempPoint)?(void 0===t&&(t=!1),!t&&this.pixelPerfectOver?this.checkPixel(this._tempPoint.x,this._tempPoint.y):!0):!1},checkPixel:function(e,t,n){if(this.sprite.texture.baseTexture.source){if(null===e&&null===t){this.game.input.getLocalPosition(this.sprite,n,this._tempPoint);var e=this._tempPoint.x,t=this._tempPoint.y}if(0!==this.sprite.anchor.x&&(e-=-this.sprite.texture.frame.width*this.sprite.anchor.x),0!==this.sprite.anchor.y&&(t-=-this.sprite.texture.frame.height*this.sprite.anchor.y),e+=this.sprite.texture.frame.x,t+=this.sprite.texture.frame.y,this.sprite.texture.trim&&(e-=this.sprite.texture.trim.x,t-=this.sprite.texture.trim.y,e<this.sprite.texture.crop.x||e>this.sprite.texture.crop.right||t<this.sprite.texture.crop.y||t>this.sprite.texture.crop.bottom))return this._dx=e,this._dy=t,!1;this._dx=e,this._dy=t,this.game.input.hitContext.clearRect(0,0,1,1),this.game.input.hitContext.drawImage(this.sprite.texture.baseTexture.source,e,t,1,1,0,0,1,1);var r=this.game.input.hitContext.getImageData(0,0,1,1);if(r.data[3]>=this.pixelPerfectAlpha)return!0}return!1},update:function(e){return null!==this.sprite&&void 0!==this.sprite.parent?this.enabled&&this.sprite.visible&&this.sprite.parent.visible?this.draggable&&this._draggedPointerID===e.id?this.updateDrag(e):this._pointerData[e.id].isOver?this.checkPointerOver(e)?(this._pointerData[e.id].x=e.x-this.sprite.x,this._pointerData[e.id].y=e.y-this.sprite.y,!0):(this._pointerOutHandler(e),!1):void 0:(this._pointerOutHandler(e),!1):void 0},_pointerOverHandler:function(e){if(null!==this.sprite){var t=this._pointerData[e.id];if(t.isOver===!1||e.dirty){var n=t.isOver===!1;t.isOver=!0,t.isOut=!1,t.timeOver=this.game.time.time,t.x=e.x-this.sprite.x,t.y=e.y-this.sprite.y,this.useHandCursor&&t.isDragged===!1&&(this.game.canvas.style.cursor="pointer",this._setHandCursor=!0),n&&this.sprite&&this.sprite.events&&this.sprite.events.onInputOver$dispatch(this.sprite,e)}}},_pointerOutHandler:function(e){if(null!==this.sprite){var t=this._pointerData[e.id];t.isOver=!1,t.isOut=!0,t.timeOut=this.game.time.time,this.useHandCursor&&t.isDragged===!1&&(this.game.canvas.style.cursor="default",this._setHandCursor=!1),this.sprite&&this.sprite.events&&this.sprite.events.onInputOut$dispatch(this.sprite,e)}},_touchedHandler:function(e){if(null!==this.sprite){var t=this._pointerData[e.id];if(!t.isDown&&t.isOver){if(this.pixelPerfectClick&&!this.checkPixel(null,null,e))return;if(t.isDown=!0,t.isUp=!1,t.timeDown=this.game.time.time,e.dirty=!0,this.sprite&&this.sprite.events&&(this.sprite.events.onInputDown$dispatch(this.sprite,e),null===this.sprite))return;this.draggable&&this.isDragged===!1&&this.startDrag(e),this.bringToTop&&this.sprite.bringToTop()}}},_releasedHandler:function(e){if(null!==this.sprite){var t=this._pointerData[e.id];if(t.isDown&&e.isUp){t.isDown=!1,t.isUp=!0,t.timeUp=this.game.time.time,t.downDuration=t.timeUp-t.timeDown;var n=this.checkPointerOver(e);this.sprite&&this.sprite.events&&(this.sprite.events.onInputUp$dispatch(this.sprite,e,n),n&&(n=this.checkPointerOver(e))),t.isOver=n,!n&&this.useHandCursor&&(this.game.canvas.style.cursor="default",this._setHandCursor=!1),e.dirty=!0,this.draggable&&this.isDragged&&this._draggedPointerID===e.id&&this.stopDrag(e)}}},updateDrag:function(e,t){if(e.isUp)return this.stopDrag(e),!1;void 0===t&&(t=!1);var n=this.globalToLocalX(e.x)+this._dragPoint.x+this.dragOffset.x,r=this.globalToLocalY(e.y)+this._dragPoint.y+this.dragOffset.y;if(this.sprite.fixedToCamera)this.allowHorizontalDrag&&(this.sprite.cameraOffset.x=n),this.allowVerticalDrag&&(this.sprite.cameraOffset.y=r),this.boundsRect&&this.checkBoundsRect(),this.boundsSprite&&this.checkBoundsSprite(),this.snapOnDrag&&(this.sprite.cameraOffset.x=Math.round((this.sprite.cameraOffset.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.cameraOffset.y=Math.round((this.sprite.cameraOffset.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY,this.snapPoint.set(this.sprite.cameraOffset.x,this.sprite.cameraOffset.y));else{var i=this.game.camera.x-this._pointerData[e.id].camX,s=this.game.camera.y-this._pointerData[e.id].camY;this.allowHorizontalDrag&&(this.sprite.x=n+i),this.allowVerticalDrag&&(this.sprite.y=r+s),this.boundsRect&&this.checkBoundsRect(),this.boundsSprite&&this.checkBoundsSprite(),this.snapOnDrag&&(this.sprite.x=Math.round((this.sprite.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.y=Math.round((this.sprite.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY,this.snapPoint.set(this.sprite.x,this.sprite.y))}return this.sprite.events.onDragUpdate.dispatch(this.sprite,e,n,r,this.snapPoint,t),!0},justOver:function(e,t){return e=e||0,t=t||500,this._pointerData[e].isOver&&this.overDuration(e)<t},justOut:function(e,t){return e=e||0,t=t||500,this._pointerData[e].isOut&&this.game.time.time-this._pointerData[e].timeOut<t},justPressed:function(e,t){return e=e||0,t=t||500,this._pointerData[e].isDown&&this.downDuration(e)<t},justReleased:function(e,t){return e=e||0,t=t||500,this._pointerData[e].isUp&&this.game.time.time-this._pointerData[e].timeUp<t},overDuration:function(e){return e=e||0,this._pointerData[e].isOver?this.game.time.time-this._pointerData[e].timeOver:-1},downDuration:function(e){return e=e||0,this._pointerData[e].isDown?this.game.time.time-this._pointerData[e].timeDown:-1},enableDrag:function(e,t,r,i,s,o){void 0===e&&(e=!1),void 0===t&&(t=!1),void 0===r&&(r=!1),void 0===i&&(i=255),void 0===s&&(s=null),void 0===o&&(o=null),this._dragPoint=new n.Point,this.draggable=!0,this.bringToTop=t,this.dragOffset=new n.Point,this.dragFromCenter=e,this.pixelPerfectClick=r,this.pixelPerfectAlpha=i,s&&(this.boundsRect=s),o&&(this.boundsSprite=o)},disableDrag:function(){if(this._pointerData)for(var e=0;10>e;e++)this._pointerData[e].isDragged=!1;this.draggable=!1,this.isDragged=!1,this._draggedPointerID=-1},startDrag:function(e){var t=this.sprite.x,n=this.sprite.y;if(this.isDragged=!0,this._draggedPointerID=e.id,this._pointerData[e.id].camX=this.game.camera.x,this._pointerData[e.id].camY=this.game.camera.y,this._pointerData[e.id].isDragged=!0,this.sprite.fixedToCamera){if(this.dragFromCenter){var r=this.sprite.getBounds();this.sprite.cameraOffset.x=this.globalToLocalX(e.x)+(this.sprite.cameraOffset.x-r.centerX),this.sprite.cameraOffset.y=this.globalToLocalY(e.y)+(this.sprite.cameraOffset.y-r.centerY)}this._dragPoint.setTo(this.sprite.cameraOffset.x-e.x,this.sprite.cameraOffset.y-e.y)}else{if(this.dragFromCenter){var r=this.sprite.getBounds();this.sprite.x=this.globalToLocalX(e.x)+(this.sprite.x-r.centerX),this.sprite.y=this.globalToLocalY(e.y)+(this.sprite.y-r.centerY)}this._dragPoint.setTo(this.sprite.x-this.globalToLocalX(e.x),this.sprite.y-this.globalToLocalY(e.y))}this.updateDrag(e,!0),this.bringToTop&&(this._dragPhase=!0,this.sprite.bringToTop()),this.dragStartPoint.set(t,n),this.sprite.events.onDragStart$dispatch(this.sprite,e,t,n)},globalToLocalX:function(e){return this.scaleLayer&&(e-=this.game.scale.grid.boundsFluid.x,e*=this.game.scale.grid.scaleFluidInversed.x),e},globalToLocalY:function(e){return this.scaleLayer&&(e-=this.game.scale.grid.boundsFluid.y,e*=this.game.scale.grid.scaleFluidInversed.y),e},stopDrag:function(e){this.isDragged=!1,this._draggedPointerID=-1,this._pointerData[e.id].isDragged=!1,this._dragPhase=!1,this.snapOnRelease&&(this.sprite.fixedToCamera?(this.sprite.cameraOffset.x=Math.round((this.sprite.cameraOffset.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.cameraOffset.y=Math.round((this.sprite.cameraOffset.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY):(this.sprite.x=Math.round((this.sprite.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.y=Math.round((this.sprite.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY)),this.sprite.events.onDragStop$dispatch(this.sprite,e),this.checkPointerOver(e)===!1&&this._pointerOutHandler(e)},setDragLock:function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0),this.allowHorizontalDrag=e,this.allowVerticalDrag=t},enableSnap:function(e,t,n,r,i,s){void 0===n&&(n=!0),void 0===r&&(r=!1),void 0===i&&(i=0),void 0===s&&(s=0),this.snapX=e,this.snapY=t,this.snapOffsetX=i,this.snapOffsetY=s,this.snapOnDrag=n,this.snapOnRelease=r},disableSnap:function(){this.snapOnDrag=!1,this.snapOnRelease=!1},checkBoundsRect:function(){this.sprite.fixedToCamera?(this.sprite.cameraOffset.x<this.boundsRect.left?this.sprite.cameraOffset.x=this.boundsRect.left:this.sprite.cameraOffset.x+this.sprite.width>this.boundsRect.right&&(this.sprite.cameraOffset.x=this.boundsRect.right-this.sprite.width),this.sprite.cameraOffset.y<this.boundsRect.top?this.sprite.cameraOffset.y=this.boundsRect.top:this.sprite.cameraOffset.y+this.sprite.height>this.boundsRect.bottom&&(this.sprite.cameraOffset.y=this.boundsRect.bottom-this.sprite.height)):(this.sprite.left<this.boundsRect.left?this.sprite.x=this.boundsRect.x+this.sprite.offsetX:this.sprite.right>this.boundsRect.right&&(this.sprite.x=this.boundsRect.right-(this.sprite.width-this.sprite.offsetX)),this.sprite.top<this.boundsRect.top?this.sprite.y=this.boundsRect.top+this.sprite.offsetY:this.sprite.bottom>this.boundsRect.bottom&&(this.sprite.y=this.boundsRect.bottom-(this.sprite.height-this.sprite.offsetY)))},checkBoundsSprite:function(){this.sprite.fixedToCamera&&this.boundsSprite.fixedToCamera?(this.sprite.cameraOffset.x<this.boundsSprite.cameraOffset.x?this.sprite.cameraOffset.x=this.boundsSprite.cameraOffset.x:this.sprite.cameraOffset.x+this.sprite.width>this.boundsSprite.cameraOffset.x+this.boundsSprite.width&&(this.sprite.cameraOffset.x=this.boundsSprite.cameraOffset.x+this.boundsSprite.width-this.sprite.width),this.sprite.cameraOffset.y<this.boundsSprite.cameraOffset.y?this.sprite.cameraOffset.y=this.boundsSprite.cameraOffset.y:this.sprite.cameraOffset.y+this.sprite.height>this.boundsSprite.cameraOffset.y+this.boundsSprite.height&&(this.sprite.cameraOffset.y=this.boundsSprite.cameraOffset.y+this.boundsSprite.height-this.sprite.height)):(this.sprite.left<this.boundsSprite.left?this.sprite.x=this.boundsSprite.left+this.sprite.offsetX:this.sprite.right>this.boundsSprite.right&&(this.sprite.x=this.boundsSprite.right-(this.sprite.width-this.sprite.offsetX)),this.sprite.top<this.boundsSprite.top?this.sprite.y=this.boundsSprite.top+this.sprite.offsetY:this.sprite.bottom>this.boundsSprite.bottom&&(this.sprite.y=this.boundsSprite.bottom-(this.sprite.height-this.sprite.offsetY)))}},n.InputHandler.prototype.constructor=n.InputHandler,n.Gamepad=function(e){this.game=e,this._gamepadIndexMap={},this._rawPads=[],this._active=!1,this.enabled=!0,this._gamepadSupportAvailable=!!navigator.webkitGetGamepads||!!navigator.webkitGamepads||-1!=navigator.userAgent.indexOf("Firefox/")||!!navigator.getGamepads,this._prevRawGamepadTypes=[],this._prevTimestamps=[],this.callbackContext=this,this.onConnectCallback=null,this.onDisconnectCallback=null,this.onDownCallback=null,this.onUpCallback=null,this.onAxisCallback=null,this.onFloatCallback=null,this._ongamepadconnected=null,this._gamepaddisconnected=null,this._gamepads=[new n.SinglePad(e,this),new n.SinglePad(e,this),new n.SinglePad(e,this),new n.SinglePad(e,this)]},n.Gamepad.prototype={addCallbacks:function(e,t){"undefined"!=typeof t&&(this.onConnectCallback="function"==typeof t.onConnect?t.onConnect:this.onConnectCallback,this.onDisconnectCallback="function"==typeof t.onDisconnect?t.onDisconnect:this.onDisconnectCallback,this.onDownCallback="function"==typeof t.onDown?t.onDown:this.onDownCallback,this.onUpCallback="function"==typeof t.onUp?t.onUp:this.onUpCallback,this.onAxisCallback="function"==typeof t.onAxis?t.onAxis:this.onAxisCallback,this.onFloatCallback="function"==typeof t.onFloat?t.onFloat:this.onFloatCallback,this.callbackContext=e)},start:function(){if(!this._active){this._active=!0;var e=this;this._onGamepadConnected=function(t){return e.onGamepadConnected(t)},this._onGamepadDisconnected=function(t){return e.onGamepadDisconnected(t)},window.addEventListener("gamepadconnected",this._onGamepadConnected,!1),window.addEventListener("gamepaddisconnected",this._onGamepadDisconnected,!1)}},onGamepadConnected:function(e){var t=e.gamepad;this._rawPads.push(t),this._gamepads[t.index].connect(t)},onGamepadDisconnected:function(e){var t=e.gamepad;for(var n in this._rawPads)this._rawPads[n].index===t.index&&this._rawPads.splice(n,1);this._gamepads[t.index].disconnect()},update:function(){this._pollGamepads(),this.pad1.pollStatus(),this.pad2.pollStatus(),this.pad3.pollStatus(),this.pad4.pollStatus()},_pollGamepads:function(){if(navigator.getGamepads)var e=navigator.getGamepads();else if(navigator.webkitGetGamepads)var e=navigator.webkitGetGamepads();else if(navigator.webkitGamepads)var e=navigator.webkitGamepads();if(e){this._rawPads=[];for(var t=!1,n=0;n<e.length&&(typeof e[n]!==this._prevRawGamepadTypes[n]&&(t=!0,this._prevRawGamepadTypes[n]=typeof e[n]),e[n]&&this._rawPads.push(e[n]),3!==n);n++);if(t){for(var r,i={rawIndices:{},padIndices:{}},s=0;s<this._gamepads.length;s++)if(r=this._gamepads[s],r.connected)for(var o=0;o<this._rawPads.length;o++)this._rawPads[o].index===r.index&&(i.rawIndices[r.index]=!0,i.padIndices[s]=!0);for(var u=0;u<this._gamepads.length;u++)if(r=this._gamepads[u],!i.padIndices[u]){this._rawPads.length<1&&r.disconnect();for(var a=0;a<this._rawPads.length&&!i.padIndices[u];a++){var f=this._rawPads[a];if(f){if(i.rawIndices[f.index]){r.disconnect();continue}r.connect(f),i.rawIndices[f.index]=!0,i.padIndices[u]=!0}else r.disconnect()}}}}},setDeadZones:function(e){for(var t=0;t<this._gamepads.length;t++)this._gamepads[t].deadZone=e},stop:function(){this._active=!1,window.removeEventListener("gamepadconnected",this._onGamepadConnected),window.removeEventListener("gamepaddisconnected",this._onGamepadDisconnected)},reset:function(){this.update();for(var e=0;e<this._gamepads.length;e++)this._gamepads[e].reset()},justPressed:function(e,t){for(var n=0;n<this._gamepads.length;n++)if(this._gamepads[n].justPressed(e,t)===!0)return!0;return!1},justReleased:function(e,t){for(var n=0;n<this._gamepads.length;n++)if(this._gamepads[n].justReleased(e,t)===!0)return!0;return!1},isDown:function(e){for(var t=0;t<this._gamepads.length;t++)if(this._gamepads[t].isDown(e)===!0)return!0;return!1},destroy:function(){this.stop();for(var e=0;e<this._gamepads.length;e++)this._gamepads[e].destroy()}},n.Gamepad.prototype.constructor=n.Gamepad,Object.defineProperty(n.Gamepad.prototype,"active",{get:function(){return this._active}}),Object.defineProperty(n.Gamepad.prototype,"supported",{get:function(){return this._gamepadSupportAvailable}}),Object.defineProperty(n.Gamepad.prototype,"padsConnected",{get:function(){return this._rawPads.length}}),Object.defineProperty(n.Gamepad.prototype,"pad1",{get:function(){return this._gamepads[0]}}),Object.defineProperty(n.Gamepad.prototype,"pad2",{get:function(){return this._gamepads[1]}}),Object.defineProperty(n.Gamepad.prototype,"pad3",{get:function(){return this._gamepads[2]}}),Object.defineProperty(n.Gamepad.prototype,"pad4",{get:function(){return this._gamepads[3]}}),n.Gamepad.BUTTON_0=0,n.Gamepad.BUTTON_1=1,n.Gamepad.BUTTON_2=2,n.Gamepad.BUTTON_3=3,n.Gamepad.BUTTON_4=4,n.Gamepad.BUTTON_5=5,n.Gamepad.BUTTON_6=6,n.Gamepad.BUTTON_7=7,n.Gamepad.BUTTON_8=8,n.Gamepad.BUTTON_9=9,n.Gamepad.BUTTON_10=10,n.Gamepad.BUTTON_11=11,n.Gamepad.BUTTON_12=12,n.Gamepad.BUTTON_13=13,n.Gamepad.BUTTON_14=14,n.Gamepad.BUTTON_15=15,n.Gamepad.AXIS_0=0,n.Gamepad.AXIS_1=1,n.Gamepad.AXIS_2=2,n.Gamepad.AXIS_3=3,n.Gamepad.AXIS_4=4,n.Gamepad.AXIS_5=5,n.Gamepad.AXIS_6=6,n.Gamepad.AXIS_7=7,n.Gamepad.AXIS_8=8,n.Gamepad.AXIS_9=9,n.Gamepad.XBOX360_A=0,n.Gamepad.XBOX360_B=1,n.Gamepad.XBOX360_X=2,n.Gamepad.XBOX360_Y=3,n.Gamepad.XBOX360_LEFT_BUMPER=4,n.Gamepad.XBOX360_RIGHT_BUMPER=5,n.Gamepad.XBOX360_LEFT_TRIGGER=6,n.Gamepad.XBOX360_RIGHT_TRIGGER=7,n.Gamepad.XBOX360_BACK=8,n.Gamepad.XBOX360_START=9,n.Gamepad.XBOX360_STICK_LEFT_BUTTON=10,n.Gamepad.XBOX360_STICK_RIGHT_BUTTON=11,n.Gamepad.XBOX360_DPAD_LEFT=14,n.Gamepad.XBOX360_DPAD_RIGHT=15,n.Gamepad.XBOX360_DPAD_UP=12,n.Gamepad.XBOX360_DPAD_DOWN=13,n.Gamepad.XBOX360_STICK_LEFT_X=0,n.Gamepad.XBOX360_STICK_LEFT_Y=1,n.Gamepad.XBOX360_STICK_RIGHT_X=2,n.Gamepad.XBOX360_STICK_RIGHT_Y=3,n.Gamepad.PS3XC_X=0,n.Gamepad.PS3XC_CIRCLE=1,n.Gamepad.PS3XC_SQUARE=2,n.Gamepad.PS3XC_TRIANGLE=3,n.Gamepad.PS3XC_L1=4,n.Gamepad.PS3XC_R1=5,n.Gamepad.PS3XC_L2=6,n.Gamepad.PS3XC_R2=7,n.Gamepad.PS3XC_SELECT=8,n.Gamepad.PS3XC_START=9,n.Gamepad.PS3XC_STICK_LEFT_BUTTON=10,n.Gamepad.PS3XC_STICK_RIGHT_BUTTON=11,n.Gamepad.PS3XC_DPAD_UP=12,n.Gamepad.PS3XC_DPAD_DOWN=13,n.Gamepad.PS3XC_DPAD_LEFT=14,n.Gamepad.PS3XC_DPAD_RIGHT=15,n.Gamepad.PS3XC_STICK_LEFT_X=0,n.Gamepad.PS3XC_STICK_LEFT_Y=1,n.Gamepad.PS3XC_STICK_RIGHT_X=2,n.Gamepad.PS3XC_STICK_RIGHT_Y=3,n.SinglePad=function(e,t){this.game=e,this.index=null,this.connected=!1,this.callbackContext=this,this.onConnectCallback=null,this.onDisconnectCallback=null,this.onDownCallback=null,this.onUpCallback=null,this.onAxisCallback=null,this.onFloatCallback=null,this.deadZone=.26,this._padParent=t,this._rawPad=null,this._prevTimestamp=null,this._buttons=[],this._buttonsLen=0,this._axes=[],this._axesLen=0},n.SinglePad.prototype={addCallbacks:function(e,t){"undefined"!=typeof t&&(this.onConnectCallback="function"==typeof t.onConnect?t.onConnect:this.onConnectCallback,this.onDisconnectCallback="function"==typeof t.onDisconnect?t.onDisconnect:this.onDisconnectCallback,this.onDownCallback="function"==typeof t.onDown?t.onDown:this.onDownCallback,this.onUpCallback="function"==typeof t.onUp?t.onUp:this.onUpCallback,this.onAxisCallback="function"==typeof t.onAxis?t.onAxis:this.onAxisCallback,this.onFloatCallback="function"==typeof t.onFloat?t.onFloat:this.onFloatCallback,this.callbackContext=e)},getButton:function(e){return this._buttons[e]?this._buttons[e]:null},pollStatus:function(){if(this.connected&&this.game.input.enabled&&this.game.input.gamepad.enabled&&(!this._rawPad.timestamp||this._rawPad.timestamp!==this._prevTimestamp)){for(var e=0;e<this._buttonsLen;e++){var t=isNaN(this._rawPad.buttons[e])?this._rawPad.buttons[e].value:this._rawPad.buttons[e];t!==this._buttons[e].value&&(1===t?this.processButtonDown(e,t):0===t?this.processButtonUp(e,t):this.processButtonFloat(e,t))}for(var n=0;n<this._axesLen;n++){var r=this._rawPad.axes[n];r>0&&r>this.deadZone||0>r&&r<-this.deadZone?this.processAxisChange(n,r):this.processAxisChange(n,0)}this._prevTimestamp=this._rawPad.timestamp}},connect:function(e){var t=!this.connected;this.connected=!0,this.index=e.index,this._rawPad=e,this._buttons=[],this._buttonsLen=e.buttons.length,this._axes=[],this._axesLen=e.axes.length;for(var r=0;r<this._axesLen;r++)this._axes[r]=e.axes[r];for(var i in e.buttons)i=parseInt(i,10),this._buttons[i]=new n.DeviceButton(this,i);t&&this._padParent.onConnectCallback&&this._padParent.onConnectCallback.call(this._padParent.callbackContext,this.index),t&&this.onConnectCallback&&this.onConnectCallback.call(this.callbackContext)},disconnect:function(){var e=this.connected,t=this.index;this.connected=!1,this.index=null,this._rawPad=void 0;for(var n=0;n<this._buttonsLen;n++)this._buttons[n].destroy();this._buttons=[],this._buttonsLen=0,this._axes=[],this._axesLen=0,e&&this._padParent.onDisconnectCallback&&this._padParent.onDisconnectCallback.call(this._padParent.callbackContext,t),e&&this.onDisconnectCallback&&this.onDisconnectCallback.call(this.callbackContext)},destroy:function(){this._rawPad=void 0;for(var e=0;e<this._buttonsLen;e++)this._buttons[e].destroy();this._buttons=[],this._buttonsLen=0,this._axes=[],this._axesLen=0,this.onConnectCallback=null,this.onDisconnectCallback=null,this.onDownCallback=null,this.onUpCallback=null,this.onAxisCallback=null,this.onFloatCallback=null},processAxisChange:function(e,t){this._axes[e]!==t&&(this._axes[e]=t,this._padParent.onAxisCallback&&this._padParent.onAxisCallback.call(this._padParent.callbackContext,this,e,t),this.onAxisCallback&&this.onAxisCallback.call(this.callbackContext,this,e,t))},processButtonDown:function(e,t){this._buttons[e]&&this._buttons[e].start(null,t),this._padParent.onDownCallback&&this._padParent.onDownCallback.call(this._padParent.callbackContext,e,t,this.index),this.onDownCallback&&this.onDownCallback.call(this.callbackContext,e,t)},processButtonUp:function(e,t){this._padParent.onUpCallback&&this._padParent.onUpCallback.call(this._padParent.callbackContext,e,t,this.index),this.onUpCallback&&this.onUpCallback.call(this.callbackContext,e,t),this._buttons[e]&&this._buttons[e].stop(null,t)},processButtonFloat:function(e,t){this._padParent.onFloatCallback&&this._padParent.onFloatCallback.call(this._padParent.callbackContext,e,t,this.index),this.onFloatCallback&&this.onFloatCallback.call(this.callbackContext,e,t),this._buttons[e]&&this._buttons[e].padFloat(t)},axis:function(e){return this._axes[e]?this._axes[e]:!1},isDown:function(e){return this._buttons[e]?this._buttons[e].isDown:!1},isUp:function(e){return this._buttons[e]?this._buttons[e].isUp:!1},justReleased:function(e,t){return this._buttons[e]?this._buttons[e].justReleased(t):void 0},justPressed:function(e,t){return this._buttons[e]?this._buttons[e].justPressed(t):void 0},buttonValue:function(e){return this._buttons[e]?this._buttons[e].value:null},reset:function(){for(var e=0;e<this._axes.length;e++)this._axes[e]=0}},n.SinglePad.prototype.constructor=n.SinglePad,n.Key=function(e,t){this.game=e,this._enabled=!0,this.event=null,this.isDown=!1,this.isUp=!0,this.altKey=!1,this.ctrlKey=!1,this.shiftKey=!1,this.timeDown=0,this.duration=0,this.timeUp=-2500,this.repeats=0,this.keyCode=t,this.onDown=new n.Signal,this.onHoldCallback=null,this.onHoldContext=null,this.onUp=new n.Signal,this._justDown=!1,this._justUp=!1},n.Key.prototype={update:function(){this._enabled&&this.isDown&&(this.duration=this.game.time.time-this.timeDown,this.repeats++,this.onHoldCallback&&this.onHoldCallback.call(this.onHoldContext,this))},processKeyDown:function(e){this._enabled&&(this.event=e,this.isDown||(this.altKey=e.altKey,this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey,this.isDown=!0,this.isUp=!1,this.timeDown=this.game.time.time,this.duration=0,this.repeats=0,this._justDown=!0,this.onDown.dispatch(this)))},processKeyUp:function(e){this._enabled&&(this.event=e,this.isUp||(this.isDown=!1,this.isUp=!0,this.timeUp=this.game.time.time,this.duration=this.game.time.time-this.timeDown,this._justUp=!0,this.onUp.dispatch(this)))},reset:function(e){void 0===e&&(e=!0),this.isDown=!1,this.isUp=!0,this.timeUp=this.game.time.time,this.duration=0,this._enabled=!0,this._justDown=!1,this._justUp=!1,e&&(this.onDown.removeAll(),this.onUp.removeAll(),this.onHoldCallback=null,this.onHoldContext=null)},downDuration:function(e){return void 0===e&&(e=50),this.isDown&&this.duration<e},upDuration:function(e){return void 0===e&&(e=50),!this.isDown&&this.game.time.time-this.timeUp<e}},Object.defineProperty(n.Key.prototype,"justDown",{get:function(){var e=this._justDown;return this._justDown=!1,e}}),Object.defineProperty(n.Key.prototype,"justUp",{get:function(){var e=this._justUp;return this._justUp=!1,e}}),Object.defineProperty(n.Key.prototype,"enabled",{get:function(){return this._enabled},set:function(e){e=!!e,e!==this._enabled&&(e||this.reset(!1),this._enabled=e)}}),n.Key.prototype.constructor=n.Key,n.Keyboard=function(e){this.game=e,this.enabled=!0,this.event=null,this.pressEvent=null,this.callbackContext=this,this.onDownCallback=null,this.onPressCallback=null,this.onUpCallback=null,this._keys=[],this._capture=[],this._onKeyDown=null,this._onKeyPress=null,this._onKeyUp=null,this._i=0,this._k=0},n.Keyboard.prototype={addCallbacks:function(e,t,n,r){this.callbackContext=e,void 0!==t&&null!==t&&(this.onDownCallback=t),void 0!==n&&null!==n&&(this.onUpCallback=n),void 0!==r&&null!==r&&(this.onPressCallback=r)},addKey:function(e){return this._keys[e]||(this._keys[e]=new n.Key(this.game,e),this.addKeyCapture(e)),this._keys[e]},addKeys:function(e){var t={};for(var n in e)t[n]=this.addKey(e[n]);return t},removeKey:function(e){this._keys[e]&&(this._keys[e]=null,this.removeKeyCapture(e))},createCursorKeys:function(){return this.addKeys({up:n.KeyCode.UP,down:n.KeyCode.DOWN,left:n.KeyCode.LEFT,right:n.KeyCode.RIGHT})},start:function(){if(!this.game.device.cocoonJS&&null===this._onKeyDown){var e=this;this._onKeyDown=function(t){return e.processKeyDown(t)},this._onKeyUp=function(t){return e.processKeyUp(t)},this._onKeyPress=function(t){return e.processKeyPress(t)},window.addEventListener("keydown",this._onKeyDown,!1),window.addEventListener("keyup",this._onKeyUp,!1),window.addEventListener("keypress",this._onKeyPress,!1)}},stop:function(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),window.removeEventListener("keypress",this._onKeyPress),this._onKeyDown=null,this._onKeyUp=null,this._onKeyPress=null},destroy:function(){this.stop(),this.clearCaptures(),this._keys.length=0,this._i=0},addKeyCapture:function(e){if("object"==typeof e)for(var t in e)this._capture[e[t]]=!0;else this._capture[e]=!0},removeKeyCapture:function(e){delete this._capture[e]},clearCaptures:function(){this._capture={}},update:function(){for(this._i=this._keys.length;this._i--;)this._keys[this._i]&&this._keys[this._i].update()},processKeyDown:function(e){this.event=e,this.game.input.enabled&&this.enabled&&(this._capture[e.keyCode]&&e.preventDefault(),this._keys[e.keyCode]||(this._keys[e.keyCode]=new n.Key(this.game,e.keyCode)),this._keys[e.keyCode].processKeyDown(e),this._k=e.keyCode,this.onDownCallback&&this.onDownCallback.call(this.callbackContext,e))},processKeyPress:function(e){this.pressEvent=e,this.game.input.enabled&&this.enabled&&this.onPressCallback&&this.onPressCallback.call(this.callbackContext,String.fromCharCode(e.charCode),e)},processKeyUp:function(e){this.event=e,this.game.input.enabled&&this.enabled&&(this._capture[e.keyCode]&&e.preventDefault(),this._keys[e.keyCode]||(this._keys[e.keyCode]=new n.Key(this.game,e.keyCode)),this._keys[e.keyCode].processKeyUp(e),this.onUpCallback&&this.onUpCallback.call(this.callbackContext,e))},reset:function(e){void 0===e&&(e=!0),this.event=null;for(var t=this._keys.length;t--;)this._keys[t]&&this._keys[t].reset(e)},downDuration:function(e,t){return this._keys[e]?this._keys[e].downDuration(t):null},upDuration:function(e,t){return this._keys[e]?this._keys[e].upDuration(t):null},isDown:function(e){return this._keys[e]?this._keys[e].isDown:null}},Object.defineProperty(n.Keyboard.prototype,"lastChar",{get:function(){return 32===this.event.charCode?"":String.fromCharCode(this.pressEvent.charCode)}}),Object.defineProperty(n.Keyboard.prototype,"lastKey",{get:function(){return this._keys[this._k]}}),n.Keyboard.prototype.constructor=n.Keyboard,n.KeyCode={A:"A".charCodeAt(0),B:"B".charCodeAt(0),C:"C".charCodeAt(0),D:"D".charCodeAt(0),E:"E".charCodeAt(0),F:"F".charCodeAt(0),G:"G".charCodeAt(0),H:"H".charCodeAt(0),I:"I".charCodeAt(0),J:"J".charCodeAt(0),K:"K".charCodeAt(0),L:"L".charCodeAt(0),M:"M".charCodeAt(0),N:"N".charCodeAt(0),O:"O".charCodeAt(0),P:"P".charCodeAt(0),Q:"Q".charCodeAt(0),R:"R".charCodeAt(0),S:"S".charCodeAt(0),T:"T".charCodeAt(0),U:"U".charCodeAt(0),V:"V".charCodeAt(0),W:"W".charCodeAt(0),X:"X".charCodeAt(0),Y:"Y".charCodeAt(0),Z:"Z".charCodeAt(0),ZERO:"0".charCodeAt(0),ONE:"1".charCodeAt(0),TWO:"2".charCodeAt(0),THREE:"3".charCodeAt(0),FOUR:"4".charCodeAt(0),FIVE:"5".charCodeAt(0),SIX:"6".charCodeAt(0),SEVEN:"7".charCodeAt(0),EIGHT:"8".charCodeAt(0),NINE:"9".charCodeAt(0),NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,NUMPAD_MULTIPLY:106,NUMPAD_ADD:107,NUMPAD_ENTER:108,NUMPAD_SUBTRACT:109,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,COLON:186,EQUALS:187,COMMA:188,UNDERSCORE:189,PERIOD:190,QUESTION_MARK:191,TILDE:192,OPEN_BRACKET:219,BACKWARD_SLASH:220,CLOSED_BRACKET:221,QUOTES:222,BACKSPACE:8,TAB:9,CLEAR:12,ENTER:13,SHIFT:16,CONTROL:17,ALT:18,CAPS_LOCK:20,ESC:27,SPACEBAR:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PLUS:43,MINUS:44,INSERT:45,DELETE:46,HELP:47,NUM_LOCK:144};for(var i in n.KeyCode)n.KeyCode.hasOwnProperty(i)&&!i.match(/[a-z]/)&&(n.Keyboard[i]=n.KeyCode[i]);n.Component=function(){},n.Component.Angle=function(){},n.Component.Angle.prototype={angle:{get:function(){return n.Math.wrapAngle(n.Math.radToDeg(this.rotation))},set:function(e){this.rotation=n.Math.degToRad(n.Math.wrapAngle(e))}}},n.Component.Animation=function(){},n.Component.Animation.prototype={play:function(e,t,n,r){return this.animations?this.animations.play(e,t,n,r):void 0}},n.Component.AutoCull=function(){},n.Component.AutoCull.prototype={autoCull:!1,inCamera:{get:function(){return this.autoCull||this.checkWorldBounds||(this._bounds.copyFrom(this.getBounds()),this._bounds.x+=this.game.camera.view.x,this._bounds.y+=this.game.camera.view.y),this.game.world.camera.view.intersects(this._bounds)}}},n.Component.Bounds=function(){},n.Component.Bounds.prototype={offsetX:{get:function(){return this.anchor.x*this.width}},offsetY:{get:function(){return this.anchor.y*this.height}},left:{get:function(){return this.x-this.offsetX}},right:{get:function(){return this.x+this.width-this.offsetX}},top:{get:function(){return this.y-this.offsetY}},bottom:{get:function(){return this.y+this.height-this.offsetY}}},n.Component.BringToTop=function(){},n.Component.BringToTop.prototype.bringToTop=function(){return this.parent&&this.parent.bringToTop(this),this},n.Component.BringToTop.prototype.sendToBack=function(){return this.parent&&this.parent.sendToBack(this),this},n.Component.BringToTop.prototype.moveUp=function(){return this.parent&&this.parent.moveUp(this),this},n.Component.BringToTop.prototype.moveDown=function(){return this.parent&&this.parent.moveDown(this),this},n.Component.Core=function(){},n.Component.Core.install=function(e){n.Utils.mixinPrototype(this,n.Component.Core.prototype),this.components={};for(var t=0;t<e.length;t++){var r=e[t],i=!1;"Destroy"===r&&(i=!0),n.Utils.mixinPrototype(this,n.Component[r].prototype,i),this.components[r]=!0}},n.Component.Core.init=function(e,t,r,i,s){this.game=e,this.key=i,this.position.set(t,r),this.world=new n.Point(t,r),this.previousPosition=new n.Point(t,r),this.events=new n.Events(this),this._bounds=new n.Rectangle,this.components.PhysicsBody&&(this.body=this.body),this.components.Animation&&(this.animations=new n.AnimationManager(this)),this.components.LoadTexture&&null!==i&&this.loadTexture(i,s),this.components.FixedToCamera&&(this.cameraOffset=new n.Point(t,r))},n.Component.Core.preUpdate=function(){if(this.pendingDestroy)return void this.destroy();if(this.previousPosition.set(this.world.x,this.world.y),this.previousRotation=this.rotation,!this.exists||!this.parent.exists)return this.renderOrderID=-1,!1;this.world.setTo(this.game.camera.x+this.worldTransform.tx,this.game.camera.y+this.worldTransform.ty),this.visible&&(this.renderOrderID=this.game.stage.currentRenderOrderID++),this.animations&&this.animations.update(),this.body&&this.body.preUpdate();for(var e=0;e<this.children.length;e++)this.children[e].preUpdate();return!0},n.Component.Core.prototype={game:null,name:"",components:{},z:0,events:void 0,animations:void 0,key:"",world:null,debug:!1,previousPosition:null,previousRotation:0,renderOrderID:0,fresh:!0,pendingDestroy:!1,_bounds:null,_exists:!0,exists:{get:function(){return this._exists},set:function(e){e?(this._exists=!0,this.body&&this.body.type===n.Physics.P2JS&&this.body.addToWorld(),this.visible=!0):(this._exists=!1,this.body&&this.body.type===n.Physics.P2JS&&this.body.removeFromWorld(),this.visible=!1)}},update:function(){},postUpdate:function(){this.customRender&&this.key.render(),this.components.PhysicsBody&&n.Component.PhysicsBody.postUpdate.call(this),this.components.FixedToCamera&&n.Component.FixedToCamera.postUpdate.call(this);for(var e=0;e<this.children.length;e++)this.children[e].postUpdate()}},n.Component.Crop=function(){},n.Component.Crop.prototype={cropRect:null,_crop:null,crop:function(e,t){void 0===t&&(t=!1),e?(t&&null!==this.cropRect?this.cropRect.setTo(e.x,e.y,e.width,e.height):t&&null===this.cropRect?this.cropRect=new n.Rectangle(e.x,e.y,e.width,e.height):this.cropRect=e,this.updateCrop()):(this._crop=null,this.cropRect=null,this.resetFrame())},updateCrop:function(){if(this.cropRect){this._crop=n.Rectangle.clone(this.cropRect,this._crop),this._crop.x+=this._frame.x,this._crop.y+=this._frame.y;var e=Math.max(this._frame.x,this._crop.x),t=Math.max(this._frame.y,this._crop.y),r=Math.min(this._frame.right,this._crop.right)-e,i=Math.min(this._frame.bottom,this._crop.bottom)-t;this.texture.crop.x=e,this.texture.crop.y=t,this.texture.crop.width=r,this.texture.crop.height=i,this.texture.frame.width=Math.min(r,this.cropRect.width),this.texture.frame.height=Math.min(i,this.cropRect.height),this.texture.width=this.texture.frame.width,this.texture.height=this.texture.frame.height,this.texture._updateUvs()}}},n.Component.Delta=function(){},n.Component.Delta.prototype={deltaX:{get:function(){return this.world.x-this.previousPosition.x}},deltaY:{get:function(){return this.world.y-this.previousPosition.y}},deltaZ:{get:function(){return this.rotation-this.previousRotation}}},n.Component.Destroy=function(){},n.Component.Destroy.prototype={destroyPhase:!1,destroy:function(e,t){if(null!==this.game&&!this.destroyPhase){void 0===e&&(e=!0),void 0===t&&(t=!1),this.destroyPhase=!0,this.events&&this.events.onDestroy$dispatch(this),this.parent&&(this.parent instanceof n.Group?this.parent.remove(this):this.parent.removeChild(this)),this.input&&this.input.destroy(),this.animations&&this.animations.destroy(),this.body&&this.body.destroy(),this.events&&this.events.destroy(),this.game.tweens.removeFrom(this);var r=this.children.length;if(e)for(;r--;)this.children[r].destroy(e);else for(;r--;)this.removeChild(this.children[r]);this._crop&&(this._crop=null),this._frame&&(this._frame=null),n.Video&&this.key instanceof n.Video&&this.key.onChangeSource.remove(this.resizeFrame,this),n.BitmapText&&this._glyphs&&(this._glyphs=[]),this.alive=!1,this.exists=!1,this.visible=!1,this.filters=null,this.mask=null,this.game=null,this.renderable=!1,this.transformCallback&&(this.transformCallback=null,this.transformCallbackContext=null),this.hitArea=null,this.parent=null,this.stage=null,this.worldTransform=null,this.filterArea=null,this._bounds=null,this._currentBounds=null,this._mask=null,this._destroyCachedSprite(),t&&this.texture.destroy(!0),this.destroyPhase=!1,this.pendingDestroy=!1}}},n.Events=function(e){this.parent=e},n.Events.prototype={destroy:function(){this._parent=null,this._onDestroy&&this._onDestroy.dispose(),this._onAddedToGroup&&this._onAddedToGroup.dispose(),this._onRemovedFromGroup&&this._onRemovedFromGroup.dispose(),this._onRemovedFromWorld&&this._onRemovedFromWorld.dispose(),this._onKilled&&this._onKilled.dispose(),this._onRevived&&this._onRevived.dispose(),this._onEnterBounds&&this._onEnterBounds.dispose(),this._onOutOfBounds&&this._onOutOfBounds.dispose(),this._onInputOver&&this._onInputOver.dispose(),this._onInputOut&&this._onInputOut.dispose(),this._onInputDown&&this._onInputDown.dispose(),this._onInputUp&&this._onInputUp.dispose(),this._onDragStart&&this._onDragStart.dispose(),this._onDragUpdate&&this._onDragUpdate.dispose(),this._onDragStop&&this._onDragStop.dispose(),this._onAnimationStart&&this._onAnimationStart.dispose(),this._onAnimationComplete&&this._onAnimationComplete.dispose(),this._onAnimationLoop&&this._onAnimationLoop.dispose()},onAddedToGroup:null,onRemovedFromGroup:null,onRemovedFromWorld:null,onDestroy:null,onKilled:null,onRevived:null,onOutOfBounds:null,onEnterBounds:null,onInputOver:null,onInputOut:null,onInputDown:null,onInputUp:null,onDragStart:null,onDragUpdate:null,onDragStop:null,onAnimationStart:null,onAnimationComplete:null,onAnimationLoop:null},n.Events.prototype.constructor=n.Events;for(var s in n.Events.prototype)n.Events.prototype.hasOwnProperty(s)&&0===s.indexOf("on")&&null===n.Events.prototype[s]&&!function(e,t){"use strict";Object.defineProperty(n.Events.prototype,e,{get:function(){return this[t]||(this[t]=new n.Signal)}}),n.Events.prototype[e+"$dispatch"]=function(){return this[t]?this[t].dispatch.apply(this[t],arguments):null}}(s,"_"+s);n.Component.FixedToCamera=function(){},n.Component.FixedToCamera.postUpdate=function(){this.fixedToCamera&&(this.position.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x,this.position.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y)},n.Component.FixedToCamera.prototype={_fixedToCamera:!1,fixedToCamera:{get:function(){return this._fixedToCamera},set:function(e){e?(this._fixedToCamera=!0,this.cameraOffset.set(this.x,this.y)):this._fixedToCamera=!1}},cameraOffset:new n.Point},n.Component.Health=function(){},n.Component.Health.prototype={health:1,maxHealth:100,damage:function(e){return this.alive&&(this.health-=e,this.health<=0&&this.kill()),this},setHealth:function(e){return this.health=e,this.health>this.maxHealth&&(this.health=this.maxHealth),this},heal:function(e){return this.alive&&(this.health+=e,this.health>this.maxHealth&&(this.health=this.maxHealth)),this}},n.Component.InCamera=function(){},n.Component.InCamera.prototype={inCamera:{get:function(){return this.game.world.camera.view.intersects(this._bounds)}}},n.Component.InputEnabled=function(){},n.Component.InputEnabled.prototype={input:null,inputEnabled:{get:function(){return this.input&&this.input.enabled},set:function(e){e?null===this.input?(this.input=new n.InputHandler(this),this.input.start()):this.input&&!this.input.enabled&&this.input.start():this.input&&this.input.enabled&&this.input.stop()}}},n.Component.InWorld=function(){},n.Component.InWorld.preUpdate=function(){if(this.autoCull||this.checkWorldBounds){if(this._bounds.copyFrom(this.getBounds()),this._bounds.x+=this.game.camera.view.x,this._bounds.y+=this.game.camera.view.y,this.autoCull)if(this.game.world.camera.view.intersects(this._bounds))this.renderable=!0,this.game.world.camera.totalInView++;else if(this.renderable=!1,this.outOfCameraBoundsKill)return this.kill(),!1;if(this.checkWorldBounds)if(this._outOfBoundsFired&&this.game.world.bounds.intersects(this._bounds))this._outOfBoundsFired=!1,this.events.onEnterBounds$dispatch(this);else if(!this._outOfBoundsFired&&!this.game.world.bounds.intersects(this._bounds)&&(this._outOfBoundsFired=!0,this.events.onOutOfBounds$dispatch(this),this.outOfBoundsKill))return this.kill(),!1}return!0},n.Component.InWorld.prototype={checkWorldBounds:!1,outOfBoundsKill:!1,outOfCameraBoundsKill:!1,_outOfBoundsFired:!1,inWorld:{get:function(){return this.game.world.bounds.intersects(this.getBounds())}}},n.Component.LifeSpan=function(){},n.Component.LifeSpan.preUpdate=function(){return this.lifespan>0&&(this.lifespan-=this.game.time.physicsElapsedMS,this.lifespan<=0)?(this.kill(),!1):!0},n.Component.LifeSpan.prototype={alive:!0,lifespan:0,revive:function(e){return void 0===e&&(e=100),this.alive=!0,this.exists=!0,this.visible=!0,"function"==typeof this.setHealth&&this.setHealth(e),this.events&&this.events.onRevived$dispatch(this),this},kill:function(){return this.alive=!1,this.exists=!1,this.visible=!1,this.events&&this.events.onKilled$dispatch(this),this}},n.Component.LoadTexture=function(){},n.Component.LoadTexture.prototype={customRender:!1,_frame:null,loadTexture:function(e,t,r){e===n.PENDING_ATLAS?(e=t,t=0):t=t||0,(r||void 0===r)&&this.animations&&this.animations.stop(),this.key=e,this.customRender=!1;var i=this.game.cache,s=!0,o=!this.texture.baseTexture.scaleMode;if(n.RenderTexture&&e instanceof n.RenderTexture)this.key=e.key,this.setTexture(e);else if(n.BitmapData&&e instanceof n.BitmapData)this.customRender=!0,this.setTexture(e.texture),s=i.hasFrameData(e.key,n.Cache.BITMAPDATA)?!this.animations.loadFrameData(i.getFrameData(e.key,n.Cache.BITMAPDATA),t):!this.animations.loadFrameData(e.frameData,0);else if(n.Video&&e instanceof n.Video){this.customRender=!0;var u=e.texture.valid;this.setTexture(e.texture),this.setFrame(e.texture.frame.clone()),e.onChangeSource.add(this.resizeFrame,this),this.texture.valid=u}else if(n.Tilemap&&e instanceof n.TilemapLayer)this.setTexture(PIXI.Texture.fromCanvas(e.canvas));else if(e instanceof PIXI.Texture)this.setTexture(e);else{var a=i.getImage(e,!0);this.key=a.key,this.setTexture(new PIXI.Texture(a.base)),"__default"===e?this.texture.baseTexture.skipRender=!0:this.texture.baseTexture.skipRender=!1,s=!this.animations.loadFrameData(a.frameData,t)}s&&(this._frame=n.Rectangle.clone(this.texture.frame)),o||(this.texture.baseTexture.scaleMode=1)},setFrame:function(e){this._frame=e,this.texture.frame.x=e.x,this.texture.frame.y=e.y,this.texture.frame.width=e.width,this.texture.frame.height=e.height,this.texture.crop.x=e.x,this.texture.crop.y=e.y,this.texture.crop.width=e.width,this.texture.crop.height=e.height,e.trimmed?(this.texture.trim?(this.texture.trim.x=e.spriteSourceSizeX,this.texture.trim.y=e.spriteSourceSizeY,this.texture.trim.width=e.sourceSizeW,this.texture.trim.height=e.sourceSizeH):this.texture.trim={x:e.spriteSourceSizeX,y:e.spriteSourceSizeY,width:e.sourceSizeW,height:e.sourceSizeH},this.texture.width=e.sourceSizeW,this.texture.height=e.sourceSizeH,this.texture.frame.width=e.sourceSizeW,this.texture.frame.height=e.sourceSizeH):!e.trimmed&&this.texture.trim&&(this.texture.trim=null),this.cropRect&&this.updateCrop(),this.texture.requiresReTint=!0,this.texture._updateUvs(),this.tilingTexture&&(this.refreshTexture=!0)},resizeFrame:function(e,t,n){this.texture.frame.resize(t,n),this.texture.setFrame(this.texture.frame)},resetFrame:function(){this._frame&&this.setFrame(this._frame)},frame:{get:function(){return this.animations.frame},set:function(e){this.animations.frame=e}},frameName:{get:function(){return this.animations.frameName},set:function(e){this.animations.frameName=e}}},n.Component.Overlap=function(){},n.Component.Overlap.prototype={overlap:function(e){return n.Rectangle.intersects(this.getBounds(),e.getBounds())}},n.Component.PhysicsBody=function(){},n.Component.PhysicsBody.preUpdate=function(){return this.fresh&&this.exists?(this.world.setTo(this.parent.position.x+this.position.x,this.parent.position.y+this.position.y),this.worldTransform.tx=this.world.x,this.worldTransform.ty=this.world.y,this.previousPosition.set(this.world.x,this.world.y),this.previousRotation=this.rotation,this.body&&this.body.preUpdate(),this.fresh=!1,!1):(this.previousPosition.set(this.world.x,this.world.y),this.previousRotation=this.rotation,this._exists&&this.parent.exists?!0:(this.renderOrderID=-1,!1))},n.Component.PhysicsBody.postUpdate=function(){this.exists&&this.body&&this.body.postUpdate()},n.Component.PhysicsBody.prototype={body:null,x:{get:function(){return this.position.x},set:function(e){this.position.x=e,this.body&&!this.body.dirty&&(this.body._reset=!0)}},y:{get:function(){return this.position.y},set:function(e){this.position.y=e,this.body&&!this.body.dirty&&(this.body._reset=!0)}}},n.Component.Reset=function(){},n.Component.Reset.prototype.reset=function(e,t,n){return void 0===n&&(n=1),this.world.set(e,t),this.position.set(e,t),this.fresh=!0,this.exists=!0,this.visible=!0,this.renderable=!0,this.components.InWorld&&(this._outOfBoundsFired=!1),this.components.LifeSpan&&(this.alive=!0,this.health=n),this.components.PhysicsBody&&this.body&&this.body.reset(e,t,!1,!1),this},n.Component.ScaleMinMax=function(){},n.Component.ScaleMinMax.prototype={transformCallback:null,transformCallbackContext:this,scaleMin:null,scaleMax:null,checkTransform:function(e){this.scaleMin&&(e.a<this.scaleMin.x&&(e.a=this.scaleMin.x),e.d<this.scaleMin.y&&(e.d=this.scaleMin.y)),this.scaleMax&&(e.a>this.scaleMax.x&&(e.a=this.scaleMax.x),e.d>this.scaleMax.y&&(e.d=this.scaleMax.y))},setScaleMinMax:function(e,t,r,i){void 0===t?t=r=i=e:void 0===r&&(r=i=t,t=e),null===e?this.scaleMin=null:this.scaleMin?this.scaleMin.set(e,t):this.scaleMin=new n.Point(e,t),null===r?this.scaleMax=null:this.scaleMax?this.scaleMax.set(r,i):this.scaleMax=new n.Point(r,i),null===this.scaleMin?this.transformCallback=null:(this.transformCallback=this.checkTransform,this.transformCallbackContext=this)}},n.Component.Smoothed=function(){},n.Component.Smoothed.prototype={smoothed:{get:function(){return!this.texture.baseTexture.scaleMode},set:function(e){e?this.texture&&(this.texture.baseTexture.scaleMode=0):this.texture&&(this.texture.baseTexture.scaleMode=1)}}},n.GameObjectFactory=function(e){this.game=e,this.world=this.game.world},n.GameObjectFactory.prototype={existing:function(e){return this.world.add(e)},image:function(e,t,r,i,s){return void 0===s&&(s=this.world),s.add(new n.Image(this.game,e,t,r,i))},sprite:function(e,t,n,r,i){return void 0===i&&(i=this.world),i.create(e,t,n,r)},creature:function(e,t,r,i,s){void 0===s&&(s=this.world);var o=new n.Creature(this.game,e,t,r,i);return s.add(o),o},tween:function(e){return this.game.tweens.create(e)},group:function(e,t,r,i,s){return new n.Group(this.game,e,t,r,i,s)},physicsGroup:function(e,t,r,i){return new n.Group(this.game,t,r,i,!0,e)},spriteBatch:function(e,t,r){return void 0===e&&(e=null),void 0===t&&(t="group"),void 0===r&&(r=!1),new n.SpriteBatch(this.game,e,t,r)},audio:function(e,t,n,r){return this.game.sound.add(e,t,n,r)},sound:function(e,t,n,r){return this.game.sound.add(e,t,n,r)},audioSprite:function(e){return this.game.sound.addSprite(e)},tileSprite:function(e,t,r,i,s,o,u){return void 0===u&&(u=this.world),u.add(new n.TileSprite(this.game,e,t,r,i,s,o))},rope:function(e,t,r,i,s,o){return void 0===o&&(o=this.world),o.add(new n.Rope(this.game,e,t,r,i,s))},text:function(e,t,r,i,s){return void 0===s&&(s=this.world),s.add(new n.Text(this.game,e,t,r,i))},button:function(e,t,r,i,s,o,u,a,f,l){return void 0===l&&(l=this.world),l.add(new n.Button(this.game,e,t,r,i,s,o,u,a,f))},graphics:function(e,t,r){return void 0===r&&(r=this.world),r.add(new n.Graphics(this.game,e,t))},emitter:function(e,t,r){return this.game.particles.add(new n.Particles.Arcade.Emitter(this.game,e,t,r))},retroFont:function(e,t,r,i,s,o,u,a,f){return new n.RetroFont(this.game,e,t,r,i,s,o,u,a,f)},bitmapText:function(e,t,r,i,s,o){return void 0===o&&(o=this.world),o.add(new n.BitmapText(this.game,e,t,r,i,s))},tilemap:function(e,t,r,i,s){return new n.Tilemap(this.game,e,t,r,i,s)},renderTexture:function(e,t,r,i){(void 0===r||""===r)&&(r=this.game.rnd.uuid()),void 0===i&&(i=!1);var s=new n.RenderTexture(this.game,e,t,r);return i&&this.game.cache.addRenderTexture(r,s),s},video:function(e,t){return new n.Video(this.game,e,t)},bitmapData:function(e,t,r,i){void 0===i&&(i=!1),(void 0===r||""===r)&&(r=this.game.rnd.uuid());var s=new n.BitmapData(this.game,r,e,t);return i&&this.game.cache.addBitmapData(r,s),s},filter:function(e){var t=Array.prototype.slice.call(arguments,1),e=new n.Filter[e](this.game);return e.init.apply(e,t),e},plugin:function(e){return this.game.plugins.add(e)}},n.GameObjectFactory.prototype.constructor=n.GameObjectFactory,n.GameObjectCreator=function(e){this.game=e,this.world=this.game.world},n.GameObjectCreator.prototype={image:function(e,t,r,i){return new n.Image(this.game,e,t,r,i)},sprite:function(e,t,r,i){return new n.Sprite(this.game,e,t,r,i)},tween:function(e){return new n.Tween(e,this.game,this.game.tweens)},group:function(e,t,r,i,s){return new n.Group(this.game,e,t,r,i,s)},spriteBatch:function(e,t,r){return void 0===t&&(t="group"),void 0===r&&(r=!1),new n.SpriteBatch(this.game,e,t,r)},audio:function(e,t,n,r){return this.game.sound.add(e,t,n,r)},audioSprite:function(e){return this.game.sound.addSprite(e)},sound:function(e,t,n,r){return this.game.sound.add(e,t,n,r)},tileSprite:function(e,t,r,i,s,o){return new n.TileSprite(this.game,e,t,r,i,s,o)},rope:function(e,t,r,i,s){return new n.Rope(this.game,e,t,r,i,s)},text:function(e,t,r,i){return new n.Text(this.game,e,t,r,i)},button:function(e,t,r,i,s,o,u,a,f){return new n.Button(this.game,e,t,r,i,s,o,u,a,f)},graphics:function(e,t){return new n.Graphics(this.game,e,t)},emitter:function(e,t,r){return new n.Particles.Arcade.Emitter(this.game,e,t,r)},retroFont:function(e,t,r,i,s,o,u,a,f){return new n.RetroFont(this.game,e,t,r,i,s,o,u,a,f)},bitmapText:function(e,t,r,i,s,o){return new n.BitmapText(this.game,e,t,r,i,s,o)},tilemap:function(e,t,r,i,s){return new n.Tilemap(this.game,e,t,r,i,s)},renderTexture:function(e,t,r,i){(void 0===r||""===r)&&(r=this.game.rnd.uuid()),void 0===i&&(i=!1);var s=new n.RenderTexture(this.game,e,t,r);return i&&this.game.cache.addRenderTexture(r,s),s},bitmapData:function(e,t,r,i){void 0===i&&(i=!1),(void 0===r||""===r)&&(r=this.game.rnd.uuid());var s=new n.BitmapData(this.game,r,e,t);return i&&this.game.cache.addBitmapData(r,s),s},filter:function(e){var t=Array.prototype.slice.call(arguments,1),e=new n.Filter[e](this.game);return e.init.apply(e,t),e}},n.GameObjectCreator.prototype.constructor=n.GameObjectCreator,n.Sprite=function(e,t,r,i,s){t=t||0,r=r||0,i=i||null,s=s||null,this.type=n.SPRITE,this.physicsType=n.SPRITE,PIXI.Sprite.call(this,PIXI.TextureCache.__default),n.Component.Core.init.call(this,e,t,r,i,s)},n.Sprite.prototype=Object.create(PIXI.Sprite.prototype),n.Sprite.prototype.constructor=n.Sprite,n.Component.Core.install.call(n.Sprite.prototype,["Angle","Animation","AutoCull","Bounds","BringToTop","Crop","Delta","Destroy","FixedToCamera","Health","InCamera","InputEnabled","InWorld","LifeSpan","LoadTexture","Overlap","PhysicsBody","Reset","ScaleMinMax","Smoothed"]),n.Sprite.prototype.preUpdatePhysics=n.Component.PhysicsBody.preUpdate,n.Sprite.prototype.preUpdateLifeSpan=n.Component.LifeSpan.preUpdate,n.Sprite.prototype.preUpdateInWorld=n.Component.InWorld.preUpdate,n.Sprite.prototype.preUpdateCore=n.Component.Core.preUpdate,n.Sprite.prototype.preUpdate=function(){return this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld()?this.preUpdateCore():!1},n.Image=function(e,t,r,i,s){t=t||0,r=r||0,i=i||null,s=s||null,this.type=n.IMAGE,PIXI.Sprite.call(this,PIXI.TextureCache.__default),n.Component.Core.init.call(this,e,t,r,i,s)},n.Image.prototype=Object.create(PIXI.Sprite.prototype),n.Image.prototype.constructor=n.Image,n.Component.Core.install.call(n.Image.prototype,["Angle","Animation","AutoCull","Bounds","BringToTop","Crop","Destroy","FixedToCamera","InputEnabled","LifeSpan","LoadTexture","Overlap","Reset","Smoothed"]),n.Image.prototype.preUpdateInWorld=n.Component.InWorld.preUpdate,n.Image.prototype.preUpdateCore=n.Component.Core.preUpdate,n.Image.prototype.preUpdate=function(){return this.preUpdateInWorld()?this.preUpdateCore():!1},n.Button=function(e,t,r,i,s,o,u,a,f,l){t=t||0,r=r||0,i=i||null,s=s||null,o=o||this,n.Image.call(this,e,t,r,i,a),this.type=n.BUTTON,this.physicsType=n.SPRITE,this._onOverFrame=null,this._onOutFrame=null,this._onDownFrame=null,this._onUpFrame=null,this.onOverSound=null,this.onOutSound=null,this.onDownSound=null,this.onUpSound=null,this.onOverSoundMarker="",this.onOutSoundMarker="",this.onDownSoundMarker="",this.onUpSoundMarker="",this.onInputOver=new n.Signal,this.onInputOut=new n.Signal,this.onInputDown=new n.Signal,this.onInputUp=new n.Signal,this.onOverMouseOnly=!0,this.justReleasedPreventsOver=n.PointerMode.TOUCH,this.freezeFrames=!1,this.forceOut=!1,this.inputEnabled=!0,this.input.start(0,!0),this.input.useHandCursor=!0,this.setFrames(u,a,f,l),null!==s&&this.onInputUp.add(s,o),this.events.onInputOver.add(this.onInputOverHandler,this),this.events.onInputOut.add(this.onInputOutHandler,this),this.events.onInputDown.add(this.onInputDownHandler,this),this.events.onInputUp.add(this.onInputUpHandler,this),this.events.onRemovedFromWorld.add(this.removedFromWorld,this)},n.Button.prototype=Object.create(n.Image.prototype),n.Button.prototype.constructor=n.Button;var o="Over",u="Out",a="Down",f="Up";n.Button.prototype.clearFrames=function(){this.setFrames(null,null,null,null)},n.Button.prototype.removedFromWorld=function(){this.inputEnabled=!1},n.Button.prototype.setStateFrame=function(e,t,n){var r="_on"+e+"Frame";null!==t?(this[r]=t,n&&this.changeStateFrame(e)):this[r]=null},n.Button.prototype.changeStateFrame=function(e){if(this.freezeFrames)return!1;var t="_on"+e+"Frame",n=this[t];return"string"==typeof n?(this.frameName=n,!0):"number"==typeof n?(this.frame=n,!0):!1},n.Button.prototype.setFrames=function(e,t,n,r){this.setStateFrame(o,e,this.input.pointerOver()),this.setStateFrame(u,t,!this.input.pointerOver()),this.setStateFrame(a,n,this.input.pointerDown()),this.setStateFrame(f,r,this.input.pointerUp())},n.Button.prototype.setStateSound=function(e,t,r){var i="on"+e+"Sound",s="on"+e+"SoundMarker";t instanceof n.Sound||t instanceof n.AudioSprite?(this[i]=t,this[s]="string"==typeof r?r:""):(this[i]=null,this[s]="")},n.Button.prototype.playStateSound=function(e){var t="on"+e+"Sound",n=this[t];if(n){var r="on"+e+"SoundMarker",i=this[r];return n.play(i),!0}return!1},n.Button.prototype.setSounds=function(e,t,n,r,i,s,l,c){this.setStateSound(o,e,t),this.setStateSound(u,i,s),this.setStateSound(a,n,r),this.setStateSound(f,l,c)},n.Button.prototype.setOverSound=function(e,t){this.setStateSound(o,e,t)},n.Button.prototype.setOutSound=function(e,t){this.setStateSound(u,e,t)},n.Button.prototype.setDownSound=function(e,t){this.setStateSound(a,e,t)},n.Button.prototype.setUpSound=function(e,t){this.setStateSound(f,e,t)},n.Button.prototype.onInputOverHandler=function(e,t){t.justReleased()&&(this.justReleasedPreventsOver&t.pointerMode)===t.pointerMode||(this.changeStateFrame(o),(!this.onOverMouseOnly||t.isMouse)&&(this.playStateSound(o),this.onInputOver&&this.onInputOver.dispatch(this,t)))},n.Button.prototype.onInputOutHandler=function(e,t){this.changeStateFrame(u),this.playStateSound(u),this.onInputOut&&this.onInputOut.dispatch(this,t)},n.Button.prototype.onInputDownHandler=function(e,t){this.changeStateFrame(a),this.playStateSound(a),this.onInputDown&&this.onInputDown.dispatch(this,t)},n.Button.prototype.onInputUpHandler=function(e,t,n){if(this.playStateSound(f),this.onInputUp&&this.onInputUp.dispatch(this,t,n),!this.freezeFrames)if(this.forceOut===!0||(this.forceOut&t.pointerMode)===t.pointerMode)this.changeStateFrame(u);else{var r=this.changeStateFrame(f);r||(n?this.changeStateFrame(o):this.changeStateFrame(u))}},n.SpriteBatch=function(e,t,r,i){(void 0===t||null===t)&&(t=e.world),PIXI.SpriteBatch.call(this),n.Group.call(this,e,t,r,i),this.type=n.SPRITEBATCH},n.SpriteBatch.prototype=n.Utils.extend(!0,n.SpriteBatch.prototype,PIXI.SpriteBatch.prototype,n.Group.prototype),n.SpriteBatch.prototype.constructor=n.SpriteBatch,n.BitmapData=function(e,t,r,i){(void 0===r||0===r)&&(r=256),(void 0===i||0===i)&&(i=256),this.game=e,this.key=t,this.width=r,this.height=i,this.canvas=PIXI.CanvasPool.create(this,r,i),this.context=this.canvas.getContext("2d",{alpha:!0}),this.ctx=this.context,this.imageData=this.context.getImageData(0,0,r,i),this.data=null,this.imageData&&(this.data=this.imageData.data),this.pixels=null,this.data&&(this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data),this.baseTexture=new PIXI.BaseTexture(this.canvas),this.texture=new PIXI.Texture(this.baseTexture),this.frameData=new n.FrameData,this.textureFrame=this.frameData.addFrame(new n.Frame(0,0,0,r,i,"bitmapData")),this.texture.frame=this.textureFrame,this.type=n.BITMAPDATA,this.disableTextureUpload=!1,this.dirty=!1,this.cls=this.clear,this._image=null,this._pos=new n.Point,this._size=new n.Point,this._scale=new n.Point,this._rotate=0,this._alpha={prev:1,current:1},this._anchor=new n.Point,this._tempR=0,this._tempG=0,this._tempB=0,this._circle=new n.Circle,this._swapCanvas=void 0},n.BitmapData.prototype={move:function(e,t,n){return 0!==e&&this.moveH(e,n),0!==t&&this.moveV(t,n),this},moveH:function(e,t){void 0===t&&(t=!0),void 0===this._swapCanvas&&(this._swapCanvas=PIXI.CanvasPool.create(this,this.width,this.height));var n=this._swapCanvas,r=n.getContext("2d"),i=this.height,s=this.canvas;if(r.clearRect(0,0,this.width,this.height),0>e){e=Math.abs(e);var o=this.width-e;t&&r.drawImage(s,0,0,e,i,o,0,e,i),r.drawImage(s,e,0,o,i,0,0,o,i)}else{var o=this.width-e;t&&r.drawImage(s,o,0,e,i,0,0,e,i),r.drawImage(s,0,0,o,i,e,0,o,i)}return this.clear(),this.copy(this._swapCanvas)},moveV:function(e,t){void 0===t&&(t=!0),void 0===this._swapCanvas&&(this._swapCanvas=PIXI.CanvasPool.create(this,this.width,this.height));var n=this._swapCanvas,r=n.getContext("2d"),i=this.width,s=this.canvas;if(r.clearRect(0,0,this.width,this.height),0>e){e=Math.abs(e);var o=this.height-e;t&&r.drawImage(s,0,0,i,e,0,o,i,e),r.drawImage(s,0,e,i,o,0,0,i,o)}else{var o=this.height-e;t&&r.drawImage(s,0,o,i,e,0,0,i,e),r.drawImage(s,0,0,i,o,0,e,i,o)}return this.clear(),this.copy(this._swapCanvas)},add:function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)e[t].loadTexture&&e[t].loadTexture(this);else e.loadTexture(this);return this},load:function(e){return"string"==typeof e&&(e=this.game.cache.getImage(e)),e?(this.resize(e.width,e.height),this.cls(),this.draw(e),this.update(),this):void 0},clear:function(e,t,n,r){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=this.width),void 0===r&&(r=this.height),this.context.clearRect(e,t,n,r),this.dirty=!0,this},fill:function(e,t,n,r){return void 0===r&&(r=1),this.context.fillStyle="rgba("+e+","+t+","+n+","+r+")",this.context.fillRect(0,0,this.width,this.height),this.dirty=!0,this},generateTexture:function(e){var t=new Image;t.src=this.canvas.toDataURL("image/png");var n=this.game.cache.addImage(e,"",t);return new PIXI.Texture(n.base)},resize:function(e,t){return(e!==this.width||t!==this.height)&&(this.width=e,this.height=t,this.canvas.width=e,this.canvas.height=t,void 0!==this._swapCanvas&&(this._swapCanvas.width=e,this._swapCanvas.height=t),this.baseTexture.width=e,this.baseTexture.height=t,this.textureFrame.width=e,this.textureFrame.height=t,this.texture.width=e,this.texture.height=t,this.texture.crop.width=e,this.texture.crop.height=t,this.update(),this.dirty=!0),this},update:function(e,t,n,r){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=Math.max(1,this.width)),void 0===r&&(r=Math.max(1,this.height)),this.imageData=this.context.getImageData(e,t,n,r),this.data=this.imageData.data,this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data,this},processPixelRGB:function(e,t,r,i,s,o){void 0===r&&(r=0),void 0===i&&(i=0),void 0===s&&(s=this.width),void 0===o&&(o=this.height);for(var u=r+s,a=i+o,f=n.Color.createColor(),l={r:0,g:0,b:0,a:0},c=!1,h=i;a>h;h++)for(var p=r;u>p;p++)n.Color.unpackPixel(this.getPixel32(p,h),f),l=e.call(t,f,p,h),l!==!1&&null!==l&&void 0!==l&&(this.setPixel32(p,h,l.r,l.g,l.b,l.a,!1),c=!0);return c&&(this.context.putImageData(this.imageData,0,0),this.dirty=!0),this},processPixel:function(e,t,n,r,i,s){void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=this.width),void 0===s&&(s=this.height);for(var o=n+i,u=r+s,a=0,f=0,l=!1,c=r;u>c;c++)for(var h=n;o>h;h++)a=this.getPixel32(h,c),f=e.call(t,a,h,c),f!==a&&(this.pixels[c*this.width+h]=f,l=!0);return l&&(this.context.putImageData(this.imageData,0,0),this.dirty=!0),this},replaceRGB:function(e,t,r,i,s,o,u,a,f){var l=0,c=0,h=this.width,p=this.height,d=n.Color.packPixel(e,t,r,i);void 0!==f&&f instanceof n.Rectangle&&(l=f.x,c=f.y,h=f.width,p=f.height);for(var v=0;p>v;v++)for(var m=0;h>m;m++)this.getPixel32(l+m,c+v)===d&&this.setPixel32(l+m,c+v,s,o,u,a,!1);return this.context.putImageData(this.imageData,0,0),this.dirty=!0,this},setHSL:function(e,t,r,i){var s=e||0===e,o=t||0===t,u=r||0===r;if(s||o||u){void 0===i&&(i=new n.Rectangle(0,0,this.width,this.height));for(var a=n.Color.createColor(),f=i.y;f<i.bottom;f++)for(var l=i.x;l<i.right;l++)n.Color.unpackPixel(this.getPixel32(l,f),a,!0),s&&(a.h=e),o&&(a.s=t),u&&(a.l=r),n.Color.HSLtoRGB(a.h,a.s,a.l,a),this.setPixel32(l,f,a.r,a.g,a.b,a.a,!1);return this.context.putImageData(this.imageData,0,0),this.dirty=!0,this}},shiftHSL:function(e,t,r,i){if((void 0===e||null===e)&&(e=!1),(void 0===t||null===t)&&(t=!1),(void 0===r||null===r)&&(r=!1),e||t||r){void 0===i&&(i=new n.Rectangle(0,0,this.width,this.height));for(var s=n.Color.createColor(),o=i.y;o<i.bottom;o++)for(var u=i.x;u<i.right;u++)n.Color.unpackPixel(this.getPixel32(u,o),s,!0),e&&(s.h=this.game.math.wrap(s.h+e,0,1)),t&&(s.s=this.game.math.clamp(s.s+t,0,1)),r&&(s.l=this.game.math.clamp(s.l+r,0,1)),n.Color.HSLtoRGB(s.h,s.s,s.l,s),this.setPixel32(u,o,s.r,s.g,s.b,s.a,!1);return this.context.putImageData(this.imageData,0,0),this.dirty=!0,this}},setPixel32:function(e,t,r,i,s,o,u){return void 0===u&&(u=!0),e>=0&&e<=this.width&&t>=0&&t<=this.height&&(n.Device.LITTLE_ENDIAN?this.pixels[t*this.width+e]=o<<24|s<<16|i<<8|r:this.pixels[t*this.width+e]=r<<24|i<<16|s<<8|o,u&&(this.context.putImageData(this.imageData,0,0),this.dirty=!0)),this},setPixel:function(e,t,n,r,i,s){return this.setPixel32(e,t,n,r,i,255,s)},getPixel:function(e,t,r){r||(r=n.Color.createColor());var i=~~(e+t*this.width);return i*=4,r.r=this.data[i],r.g=this.data[++i],r.b=this.data[++i],r.a=this.data[++i],r},getPixel32:function(e,t){return e>=0&&e<=this.width&&t>=0&&t<=this.height?this.pixels[t*this.width+e]:void 0},getPixelRGB:function(e,t,r,i,s){return n.Color.unpackPixel(this.getPixel32(e,t),r,i,s)},getPixels:function(e){return this.context.getImageData(e.x,e.y,e.width,e.height)},getFirstPixel:function(e){void 0===e&&(e=0);var t=n.Color.createColor(),r=0,i=0,s=1,o=!1;1===e?(s=-1,i=this.height):3===e&&(s=-1,r=this.width);do n.Color.unpackPixel(this.getPixel32(r,i),t),0===e||1===e?(r++,r===this.width&&(r=0,i+=s,(i>=this.height||0>=i)&&(o=!0))):(2===e||3===e)&&(i++,i===this.height&&(i=0,r+=s,(r>=this.width||0>=r)&&(o=!0)));while(0===t.a&&!o);return t.x=r,t.y=i,t},getBounds:function(e){return void 0===e&&(e=new n.Rectangle),e.x=this.getFirstPixel(2).x,e.x===this.width?e.setTo(0,0,0,0):(e.y=this.getFirstPixel(0).y,e.width=this.getFirstPixel(3).x-e.x+1,e.height=this.getFirstPixel(1).y-e.y+1,e)},addToWorld:function(e,t,n,r,i,s){i=i||1,s=s||1;var o=this.game.add.image(e,t,this);return o.anchor.set(n,r),o.scale.set(i,s),o},copy:function(e,t,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){if((void 0===e||null===e)&&(e=this),(e instanceof n.RenderTexture||e instanceof PIXI.RenderTexture)&&(e=e.getCanvas()),this._image=e,e instanceof n.Sprite||e instanceof n.Image||e instanceof n.Text||e instanceof PIXI.Sprite)this._pos.set(e.texture.crop.x,e.texture.crop.y),this._size.set(e.texture.crop.width,e.texture.crop.height),this._scale.set(e.scale.x,e.scale.y),this._anchor.set(e.anchor.x,e.anchor.y),this._rotate=e.rotation,this._alpha.current=e.alpha,e.texture instanceof n.RenderTexture||e.texture instanceof PIXI.RenderTexture?this._image=e.texture.getCanvas():this._image=e.texture.baseTexture.source,(void 0===o||null===o)&&(o=e.x),(void 0===u||null===u)&&(u=e.y),e.texture.trim&&(o+=e.texture.trim.x-e.anchor.x*e.texture.trim.width,u+=e.texture.trim.y-e.anchor.y*e.texture.trim.height),16777215!==e.tint&&(e.cachedTint!==e.tint&&(e.cachedTint=e.tint,e.tintedTexture=PIXI.CanvasTinter.getTintedTexture(e,e.tint)),this._image=e.tintedTexture,this._pos.set(0));else{if(this._pos.set(0),this._scale.set(1),this._anchor.set(0),this._rotate=0,this._alpha.current=1,e instanceof n.BitmapData)this._image=e.canvas;else if("string"==typeof e){if(e=this.game.cache.getImage(e),null===e)return;this._image=e}this._size.set(this._image.width,this._image.height)}if((void 0===t||null===t)&&(t=0),(void 0===r||null===r)&&(r=0),i&&(this._size.x=i),s&&(this._size.y=s),(void 0===o||null===o)&&(o=t),(void 0===u||null===u)&&(u=r),(void 0===a||null===a)&&(a=this._size.x),(void 0===f||null===f)&&(f=this._size.y),"number"==typeof l&&(this._rotate=l),"number"==typeof c&&(this._anchor.x=c),"number"==typeof h&&(this._anchor.y=h),"number"==typeof p&&(this._scale.x=p),"number"==typeof d&&(this._scale.y=d),"number"==typeof v&&(this._alpha.current=v),void 0===m&&(m=null),void 0===g&&(g=!1),!(this._alpha.current<=0||0===this._scale.x||0===this._scale.y||0===this._size.x||0===this._size.y)){var y=this.context;return this._alpha.prev=y.globalAlpha,y.save(),y.globalAlpha=this._alpha.current,m&&(this.op=m),g&&(o|=0,u|=0),y.translate(o,u),y.scale(this._scale.x,this._scale.y),y.rotate(this._rotate),y.drawImage(this._image,this._pos.x+t,this._pos.y+r,this._size.x,this._size.y,-a*this._anchor.x,-f*this._anchor.y,a,f),y.restore(),y.globalAlpha=this._alpha.prev,this.dirty=!0,this}},copyRect:function(e,t,n,r,i,s,o){return this.copy(e,t.x,t.y,t.width,t.height,n,r,t.width,t.height,0,0,0,1,1,i,s,o)},draw:function(e,t,n,r,i,s,o){return this.copy(e,null,null,null,null,t,n,r,i,null,null,null,null,null,null,s,o)},drawGroup:function(e,t,n){return e.total>0&&e.forEachExists(this.drawGroupProxy,this,t,n),this},drawGroupProxy:function(e,t,n){if(e.hasOwnProperty("texture")&&this.copy(e,null,null,null,null,e.worldPosition.x,e.worldPosition.y,null,null,e.worldRotation,null,null,e.worldScale.x,e.worldScale.y,e.worldAlpha,t,n),e.hasOwnProperty("children")&&e.children.length>0)for(var r,i=0;i<e.children.length;i++)r=e.children[i],this.copy(r,null,null,null,null,r.worldPosition.x,r.worldPosition.y,null,null,r.worldRotation,null,null,r.worldScale.x,r.worldScale.y,e.worldAlpha,t,n)},drawFull:function(e,t,r){if(e.worldVisible===!1||0===e.worldAlpha||e.hasOwnProperty("exists")&&e.exists===!1)return this;if(e.type!==n.GROUP&&e.type!==n.EMITTER&&e.type!==n.BITMAPTEXT)if(e.type===n.GRAPHICS){var i=e.getBounds();this.ctx.save(),this.ctx.translate(i.x,i.y),PIXI.CanvasGraphics.renderGraphics(e,this.ctx),this.ctx.restore()}else this.copy(e,null,null,null,null,e.worldPosition.x,e.worldPosition.y,null,null,e.worldRotation,null,null,e.worldScale.x,e.worldScale.y,e.worldAlpha,t,r);if(e.children)for(var s=0;s<e.children.length;s++)this.drawFull(e.children[s],t,r);return this},shadow:function(e,t,n,r){var i=this.context;void 0===e||null===e?i.shadowColor="rgba(0,0,0,0)":(i.shadowColor=e,i.shadowBlur=t||5,i.shadowOffsetX=n||10,i.shadowOffsetY=r||10)},alphaMask:function(e,t,n,r){return void 0===r||null===r?this.draw(t).blendSourceAtop():this.draw(t,r.x,r.y,r.width,r.height).blendSourceAtop(),void 0===n||null===n?this.draw(e).blendReset():this.draw(e,n.x,n.y,n.width,n.height).blendReset(),this},extract:function(e,t,n,r,i,s,o,u,a){return void 0===i&&(i=255),void 0===s&&(s=!1),void 0===o&&(o=t),void 0===u&&(u=n),void 0===a&&(a=r),s&&e.resize(this.width,this.height),this.processPixelRGB(function(s,f,l){return s.r===t&&s.g===n&&s.b===r&&e.setPixel32(f,l,o,u,a,i,!1),!1},this),e.context.putImageData(e.imageData,0,0),e.dirty=!0,e},rect:function(e,t,n,r,i){return"undefined"!=typeof i&&(this.context.fillStyle=i),this.context.fillRect(e,t,n,r),this},text:function(e,t,n,r,i,s){void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r="14px Courier"),void 0===i&&(i="rgb(255,255,255)"),void 0===s&&(s=!0);var o=this.context,u=o.font;o.font=r,s&&(o.fillStyle="rgb(0,0,0)",o.fillText(e,t+1,n+1)),o.fillStyle=i,o.fillText(e,t,n),o.font=u},circle:function(e,t,n,r){var i=this.context;return void 0!==r&&(i.fillStyle=r),i.beginPath(),i.arc(e,t,n,0,2*Math.PI,!1),i.closePath(),i.fill(),this},line:function(e,t,n,r,i,s){void 0===i&&(i="#fff"),void 0===s&&(s=1);var o=this.context;return o.beginPath(),o.moveTo(e,t),o.lineTo(n,r),o.lineWidth=s,o.strokeStyle=i,o.stroke(),o.closePath(),this},textureLine:function(e,t,r){if(void 0===r&&(r="repeat-x"),"string"!=typeof t||(t=this.game.cache.getImage(t))){var i=e.length;"no-repeat"===r&&i>t.width&&(i=t.width);var s=this.context;return s.fillStyle=s.createPattern(t,r),this._circle=new n.Circle(e.start.x,e.start.y,t.height),this._circle.circumferencePoint(e.angle-1.5707963267948966,!1,this._pos),s.save(),s.translate(this._pos.x,this._pos.y),s.rotate(e.angle),s.fillRect(0,0,i,t.height),s.restore(),this.dirty=!0,this}},render:function(){return!this.disableTextureUpload&&this.dirty&&(this.baseTexture.dirty(),this.dirty=!1),this},destroy:function(){this.frameData.destroy(),this.texture.destroy(!0),PIXI.CanvasPool.remove(this)},blendReset:function(){return this.op="source-over",this},blendSourceOver:function(){return this.op="source-over",this},blendSourceIn:function(){return this.op="source-in",this},blendSourceOut:function(){return this.op="source-out",this},blendSourceAtop:function(){return this.op="source-atop",this},blendDestinationOver:function(){return this.op="destination-over",this},blendDestinationIn:function(){return this.op="destination-in",this},blendDestinationOut:function(){return this.op="destination-out",this},blendDestinationAtop:function(){return this.op="destination-atop",this},blendXor:function(){return this.op="xor",this},blendAdd:function(){return this.op="lighter",this},blendMultiply:function(){return this.op="multiply",this},blendScreen:function(){return this.op="screen",this},blendOverlay:function(){return this.op="overlay",this},blendDarken:function(){return this.op="darken",this},blendLighten:function(){return this.op="lighten",this},blendColorDodge:function(){return this.op="color-dodge",this},blendColorBurn:function(){return this.op="color-burn",this},blendHardLight:function(){return this.op="hard-light",this},blendSoftLight:function(){return this.op="soft-light",this},blendDifference:function(){return this.op="difference",this},blendExclusion:function(){return this.op="exclusion",this},blendHue:function(){return this.op="hue",this},blendSaturation:function(){return this.op="saturation",this},blendColor:function(){return this.op="color",this},blendLuminosity:function(){return this.op="luminosity",this}},Object.defineProperty(n.BitmapData.prototype,"smoothed",{get:function(){n.Canvas.getSmoothingEnabled(this.context)},set:function(e){n.Canvas.setSmoothingEnabled(this.context,e)}}),Object.defineProperty(n.BitmapData.prototype,"op",{get:function(){return this.context.globalCompositeOperation},set:function(e){this.context.globalCompositeOperation=e}}),n.BitmapData.getTransform=function(e,t,n,r,i,s){return"number"!=typeof e&&(e=0),"number"!=typeof t&&(t=0),"number"!=typeof n&&(n=1),"number"!=typeof r&&(r=1),"number"!=typeof i&&(i=0),"number"!=typeof s&&(s=0),{sx:n,sy:r,scaleX:n,scaleY:r,skewX:i,skewY:s,translateX:e,translateY:t,tx:e,ty:t}},n.BitmapData.prototype.constructor=n.BitmapData,PIXI.Graphics=function(){PIXI.DisplayObjectContainer.call(this),this.renderable=!0,this.fillAlpha=1,this.lineWidth=0,this.lineColor=0,this.graphicsData=[],this.tint=16777215,this.blendMode=PIXI.blendModes.NORMAL,this.currentPath=null,this._webGL=[],this.isMask=!1,this.boundsPadding=0,this._localBounds=new PIXI.Rectangle(0,0,1,1),this.dirty=!0,this.webGLDirty=!1,this.cachedSpriteDirty=!1},PIXI.Graphics.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),PIXI.Graphics.prototype.constructor=PIXI.Graphics,PIXI.Graphics.prototype.lineStyle=function(e,t,n){return this.lineWidth=e||0,this.lineColor=t||0,this.lineAlpha=void 0===n?1:n,this.currentPath&&(this.currentPath.shape.points.length?this.drawShape(new PIXI.Polygon(this.currentPath.shape.points.slice(-2))):(this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha)),this},PIXI.Graphics.prototype.moveTo=function(e,t){return this.drawShape(new PIXI.Polygon([e,t])),this},PIXI.Graphics.prototype.lineTo=function(e,t){return this.currentPath||this.moveTo(0,0),this.currentPath.shape.points.push(e,t),this.dirty=!0,this},PIXI.Graphics.prototype.quadraticCurveTo=function(e,t,n,r){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var i,s,o=20,u=this.currentPath.shape.points;0===u.length&&this.moveTo(0,0);for(var a=u[u.length-2],f=u[u.length-1],l=0,c=1;o>=c;++c)l=c/o,i=a+(e-a)*l,s=f+(t-f)*l,u.push(i+(e+(n-e)*l-i)*l,s+(t+(r-t)*l-s)*l);return this.dirty=!0,this},PIXI.Graphics.prototype.bezierCurveTo=function(e,t,n,r,i,s){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);for(var o,u,a,f,l,c=20,h=this.currentPath.shape.points,p=h[h.length-2],d=h[h.length-1],v=0,m=1;c>=m;++m)v=m/c,o=1-v,u=o*o,a=u*o,f=v*v,l=f*v,h.push(a*p+3*u*v*e+3*o*f*n+l*i,a*d+3*u*v*t+3*o*f*r+l*s);return this.dirty=!0,this},PIXI.Graphics.prototype.arcTo=function(e,t,n,r,i){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(e,t):this.moveTo(e,t);var s=this.currentPath.shape.points,o=s[s.length-2],u=s[s.length-1],a=u-t,f=o-e,l=r-t,c=n-e,h=Math.abs(a*c-f*l);if(1e-8>h||0===i)(s[s.length-2]!==e||s[s.length-1]!==t)&&s.push(e,t);else{var p=a*a+f*f,d=l*l+c*c,v=a*l+f*c,m=i*Math.sqrt(p)/h,g=i*Math.sqrt(d)/h,y=m*v/p,b=g*v/d,w=m*c+g*f,E=m*l+g*a,S=f*(g+y),x=a*(g+y),T=c*(m+b),N=l*(m+b),C=Math.atan2(x-E,S-w),k=Math.atan2(N-E,T-w);this.arc(w+e,E+t,i,C,k,f*l>c*a)}return this.dirty=!0,this},PIXI.Graphics.prototype.arc=function(e,t,n,r,i,s,o){if(r===i)return this;void 0===s&&(s=!1),void 0===o&&(o=40),!s&&r>=i?i+=2*Math.PI:s&&i>=r&&(r+=2*Math.PI);var u=s?-1*(r-i):i-r,a=Math.ceil(Math.abs(u)/(2*Math.PI))*o;if(0===u)return this;var f=e+Math.cos(r)*n,l=t+Math.sin(r)*n;s&&this.filling?this.moveTo(e,t):this.moveTo(f,l);for(var c=this.currentPath.shape.points,h=u/(2*a),p=2*h,d=Math.cos(h),v=Math.sin(h),m=a-1,g=m%1/m,y=0;m>=y;y++){var b=y+g*y,w=h+r+p*b,E=Math.cos(w),S=-Math.sin(w);c.push((d*E+v*S)*n+e,(d*-S+v*E)*n+t)}return this.dirty=!0,this},PIXI.Graphics.prototype.beginFill=function(e,t){return this.filling=!0,this.fillColor=e||0,this.fillAlpha=void 0===t?1:t,this.currentPath&&this.currentPath.shape.points.length<=2&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha),this},PIXI.Graphics.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},PIXI.Graphics.prototype.drawRect=function(e,t,n,r){return this.drawShape(new PIXI.Rectangle(e,t,n,r)),this},PIXI.Graphics.prototype.drawRoundedRect=function(e,t,n,r,i){return this.drawShape(new PIXI.RoundedRectangle(e,t,n,r,i)),this},PIXI.Graphics.prototype.drawCircle=function(e,t,n){return this.drawShape(new PIXI.Circle(e,t,n)),this},PIXI.Graphics.prototype.drawEllipse=function(e,t,n,r){return this.drawShape(new PIXI.Ellipse(e,t,n,r)),this},PIXI.Graphics.prototype.drawPolygon=function(e){(e instanceof n.Polygon||e instanceof PIXI.Polygon)&&(e=e.points);var t=e;if(!Array.isArray(t)){t=new Array(arguments.length);for(var r=0;r<t.length;++r)t[r]=arguments[r]}return this.drawShape(new n.Polygon(t)),this},PIXI.Graphics.prototype.clear=function(){return this.lineWidth=0,this.filling=!1,this.dirty=!0,this.clearDirty=!0,this.graphicsData=[],this},PIXI.Graphics.prototype.generateTexture=function(e,t,n){void 0===e&&(e=1),void 0===t&&(t=PIXI.scaleModes.DEFAULT),void 0===n&&(n=0);var r=this.getBounds();r.width+=n,r.height+=n;var i=new PIXI.CanvasBuffer(r.width*e,r.height*e),s=PIXI.Texture.fromCanvas(i.canvas,t);return s.baseTexture.resolution=e,i.context.scale(e,e),i.context.translate(-r.x,-r.y),PIXI.CanvasGraphics.renderGraphics(this,i.context),s},PIXI.Graphics.prototype._renderWebGL=function(e){if(this.visible!==!1&&0!==this.alpha&&this.isMask!==!0){if(this._cacheAsBitmap)return(this.dirty||this.cachedSpriteDirty)&&(this._generateCachedSprite(),this.updateCachedSpriteTexture(),this.cachedSpriteDirty=!1,this.dirty=!1),this._cachedSprite.worldAlpha=this.worldAlpha,void PIXI.Sprite.prototype._renderWebGL.call(this._cachedSprite,e);if(e.spriteBatch.stop(),e.blendModeManager.setBlendMode(this.blendMode),this._mask&&e.maskManager.pushMask(this._mask,e),this._filters&&e.filterManager.pushFilter(this._filterBlock),this.blendMode!==e.spriteBatch.currentBlendMode){e.spriteBatch.currentBlendMode=this.blendMode;var t=PIXI.blendModesWebGL[e.spriteBatch.currentBlendMode];e.spriteBatch.gl.blendFunc(t[0],t[1])}if(this.webGLDirty&&(this.dirty=!0,this.webGLDirty=!1),PIXI.WebGLGraphics.renderGraphics(this,e),this.children.length){e.spriteBatch.start();for(var n=0;n<this.children.length;n++)this.children[n]._renderWebGL(e);e.spriteBatch.stop()}this._filters&&e.filterManager.popFilter(),this._mask&&e.maskManager.popMask(this.mask,e),e.drawCount++,e.spriteBatch.start()}},PIXI.Graphics.prototype._renderCanvas=function(e){if(this.visible!==!1&&0!==this.alpha&&this.isMask!==!0){if(this._prevTint!==this.tint&&(this.dirty=!0,this._prevTint=this.tint),this._cacheAsBitmap)return(this.dirty||this.cachedSpriteDirty)&&(this._generateCachedSprite(),this.updateCachedSpriteTexture(),this.cachedSpriteDirty=!1,this.dirty=!1),this._cachedSprite.alpha=this.alpha,void PIXI.Sprite.prototype._renderCanvas.call(this._cachedSprite,e);var t=e.context,n=this.worldTransform;this.blendMode!==e.currentBlendMode&&(e.currentBlendMode=this.blendMode,t.globalCompositeOperation=PIXI.blendModesCanvas[e.currentBlendMode]),this._mask&&e.maskManager.pushMask(this._mask,e);var r=e.resolution,i=n.tx*e.resolution+e.shakeX,s=n.ty*e.resolution+e.shakeY;t.setTransform(n.a*r,n.b*r,n.c*r,n.d*r,i,s),PIXI.CanvasGraphics.renderGraphics(this,t);for(var o=0;o<this.children.length;o++)this.children[o]._renderCanvas(e);this._mask&&e.maskManager.popMask(e)}},PIXI.Graphics.prototype.getBounds=function(e){if(!this._currentBounds){if(!this.renderable)return PIXI.EmptyRectangle;this.dirty&&(this.updateLocalBounds(),this.webGLDirty=!0,this.cachedSpriteDirty=!0,this.dirty=!1);var t=this._localBounds,n=t.x,r=t.width+t.x,i=t.y,s=t.height+t.y,o=e||this.worldTransform,u=o.a,a=o.b,f=o.c,l=o.d,c=o.tx,h=o.ty,p=u*r+f*s+c,d=l*s+a*r+h,v=u*n+f*s+c,m=l*s+a*n+h,g=u*n+f*i+c,y=l*i+a*n+h,b=u*r+f*i+c,w=l*i+a*r+h,E=p,S=d,x=p,T=d;x=x>v?v:x,x=x>g?g:x,x=x>b?b:x,T=T>m?m:T,T=T>y?y:T,T=T>w?w:T,E=v>E?v:E,E=g>E?g:E,E=b>E?b:E,S=m>S?m:S,S=y>S?y:S,S=w>S?w:S,this._bounds.x=x,this._bounds.width=E-x,this._bounds.y=T,this._bounds.height=S-T,this._currentBounds=this._bounds}return this._currentBounds},PIXI.Graphics.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,tempPoint);for(var t=this.graphicsData,n=0;n<t.length;n++){var r=t[n];if(r.fill&&r.shape&&r.shape.contains(tempPoint.x,tempPoint.y))return!0}return!1},PIXI.Graphics.prototype.updateLocalBounds=function(){var e=1/0,t=-1/0,r=1/0,i=-1/0;if(this.graphicsData.length)for(var s,o,u,a,f,l,c=0;c<this.graphicsData.length;c++){var h=this.graphicsData[c],p=h.type,d=h.lineWidth;if(s=h.shape,p===PIXI.Graphics.RECT||p===PIXI.Graphics.RREC)u=s.x-d/2,a=s.y-d/2,f=s.width+d,l=s.height+d,e=e>u?u:e,t=u+f>t?u+f:t,r=r>a?a:r,i=a+l>i?a+l:i;else if(p===PIXI.Graphics.CIRC)u=s.x,a=s.y,f=s.radius+d/2,l=s.radius+d/2,e=e>u-f?u-f:e,t=u+f>t?u+f:t,r=r>a-l?a-l:r,i=a+l>i?a+l:i;else if(p===PIXI.Graphics.ELIP)u=s.x,a=s.y,f=s.width+d/2,l=s.height+d/2,e=e>u-f?u-f:e,t=u+f>t?u+f:t,r=r>a-l?a-l:r,i=a+l>i?a+l:i;else{o=s.points;for(var v=0;v<o.length;v++)o[v]instanceof n.Point?(u=o[v].x,a=o[v].y):(u=o[v],a=o[v+1],v<o.length-1&&v++),e=e>u-d?u-d:e,t=u+d>t?u+d:t,r=r>a-d?a-d:r,i=a+d>i?a+d:i}}else e=0,t=0,r=0,i=0;var m=this.boundsPadding;this._localBounds.x=e-m,this._localBounds.width=t-e+2*m,this._localBounds.y=r-m,this._localBounds.height=i-r+2*m},PIXI.Graphics.prototype._generateCachedSprite=function(){var e=this.getLocalBounds();if(this._cachedSprite)this._cachedSprite.buffer.resize(e.width,e.height);else{var t=new PIXI.CanvasBuffer(e.width,e.height),n=PIXI.Texture.fromCanvas(t.canvas);this._cachedSprite=new PIXI.Sprite(n),this._cachedSprite.buffer=t,this._cachedSprite.worldTransform=this.worldTransform}this._cachedSprite.anchor.x=-(e.x/e.width),this._cachedSprite.anchor.y=-(e.y/e.height),this._cachedSprite.buffer.context.translate(-e.x,-e.y),this.worldAlpha=1,PIXI.CanvasGraphics.renderGraphics(this,this._cachedSprite.buffer.context),this._cachedSprite.alpha=this.alpha},PIXI.Graphics.prototype.updateCachedSpriteTexture=function(){var e=this._cachedSprite,t=e.texture,n=e.buffer.canvas;t.baseTexture.width=n.width,t.baseTexture.height=n.height,t.crop.width=t.frame.width=n.width,t.crop.height=t.frame.height=n.height,e._width=n.width,e._height=n.height,t.baseTexture.dirty()},PIXI.Graphics.prototype.destroyCachedSprite=function(){this._cachedSprite.texture.destroy(!0),this._cachedSprite=null},PIXI.Graphics.prototype.drawShape=function(e){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.currentPath=null,e instanceof n.Polygon&&(e=e.clone(),e.flatten());var t=new PIXI.GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,e);return this.graphicsData.push(t),t.type===PIXI.Graphics.POLY&&(t.shape.closed=this.filling,this.currentPath=t),this.dirty=!0,t},Object.defineProperty(PIXI.Graphics.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(e){this._cacheAsBitmap=e,this._cacheAsBitmap?this._generateCachedSprite():this.destroyCachedSprite(),this.dirty=!0,this.webGLDirty=!0}}),PIXI.GraphicsData=function(e,t,n,r,i,s,o){this.lineWidth=e,this.lineColor=t,this.lineAlpha=n,this._lineTint=t,this.fillColor=r,this.fillAlpha=i,this._fillTint=r,this.fill=s,this.shape=o,this.type=o.type},PIXI.GraphicsData.prototype.constructor=PIXI.GraphicsData,PIXI.GraphicsData.prototype.clone=function(){return new GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},PIXI.PolyK={},PIXI.PolyK.Triangulate=function(e){var t=!0,n=e.length>>1;if(3>n)return[];for(var r=[],i=[],s=0;n>s;s++)i.push(s);s=0;for(var o=n;o>3;){var u=i[(s+0)%o],a=i[(s+1)%o],f=i[(s+2)%o],l=e[2*u],c=e[2*u+1],h=e[2*a],p=e[2*a+1],d=e[2*f],v=e[2*f+1],m=!1;if(PIXI.PolyK._convex(l,c,h,p,d,v,t)){m=!0;for(var g=0;o>g;g++){var y=i[g];if(y!==u&&y!==a&&y!==f&&PIXI.PolyK._PointInTriangle(e[2*y],e[2*y+1],l,c,h,p,d,v)){m=!1;break}}}if(m)r.push(u,a,f),i.splice((s+1)%o,1),o--,s=0;else if(s++>3*o){if(!t)return null;for(r=[],i=[],s=0;n>s;s++)i.push(s);s=0,o=n,t=!1}}return r.push(i[0],i[1],i[2]),r},PIXI.PolyK._PointInTriangle=function(e,t,n,r,i,s,o,u){var a=o-n,f=u-r,l=i-n,c=s-r,h=e-n,p=t-r,d=a*a+f*f,v=a*l+f*c,m=a*h+f*p,g=l*l+c*c,y=l*h+c*p,b=1/(d*g-v*v),w=(g*m-v*y)*b,E=(d*y-v*m)*b;return w>=0&&E>=0&&1>w+E},PIXI.PolyK._convex=function(e,t,n,r,i,s,o){return(t-r)*(i-n)+(n-e)*(s-r)>=0===o},PIXI.EarCut={},PIXI.EarCut.Triangulate=function(e,t,n){n=n||2;var r=t&&t.length,i=r?t[0]*n:e.length,s=PIXI.EarCut.linkedList(e,0,i,n,!0),o=[];if(!s)return o;var u,a,f,l,c,h,p;if(r&&(s=PIXI.EarCut.eliminateHoles(e,t,s,n)),e.length>80*n){u=f=e[0],a=l=e[1];for(var d=n;i>d;d+=n)c=e[d],h=e[d+1],u>c&&(u=c),a>h&&(a=h),c>f&&(f=c),h>l&&(l=h);p=Math.max(f-u,l-a)}return PIXI.EarCut.earcutLinked(s,o,n,u,a,p),o},PIXI.EarCut.linkedList=function(e,t,n,r,i){var s,o,u,a=0;for(s=t,o=n-r;n>s;s+=r)a+=(e[o]-e[s])*(e[s+1]+e[o+1]),o=s;if(i===a>0)for(s=t;n>s;s+=r)u=PIXI.EarCut.insertNode(s,e[s],e[s+1],u);else for(s=n-r;s>=t;s-=r)u=PIXI.EarCut.insertNode(s,e[s],e[s+1],u);return u},PIXI.EarCut.filterPoints=function(e,t){if(!e)return e;t||(t=e);var n,r=e;do if(n=!1,r.steiner||!PIXI.EarCut.equals(r,r.next)&&0!==PIXI.EarCut.area(r.prev,r,r.next))r=r.next;else{if(PIXI.EarCut.removeNode(r),r=t=r.prev,r===r.next)return null;n=!0}while(n||r!==t);return t},PIXI.EarCut.earcutLinked=function(e,t,n,r,i,s,o){if(e){!o&&s&&PIXI.EarCut.indexCurve(e,r,i,s);for(var u,a,f=e;e.prev!==e.next;)if(u=e.prev,a=e.next,s?PIXI.EarCut.isEarHashed(e,r,i,s):PIXI.EarCut.isEar(e))t.push(u.i/n),t.push(e.i/n),t.push(a.i/n),PIXI.EarCut.removeNode(e),e=a.next,f=a.next;else if(e=a,e===f){o?1===o?(e=PIXI.EarCut.cureLocalIntersections(e,t,n),PIXI.EarCut.earcutLinked(e,t,n,r,i,s,2)):2===o&&PIXI.EarCut.splitEarcut(e,t,n,r,i,s):PIXI.EarCut.earcutLinked(PIXI.EarCut.filterPoints(e),t,n,r,i,s,1);break}}},PIXI.EarCut.isEar=function(e){var t=e.prev,n=e,r=e.next;if(PIXI.EarCut.area(t,n,r)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(PIXI.EarCut.pointInTriangle(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&PIXI.EarCut.area(i.prev,i,i.next)>=0)return!1;i=i.next}return!0},PIXI.EarCut.isEarHashed=function(e,t,n,r){var i=e.prev,s=e,o=e.next;if(PIXI.EarCut.area(i,s,o)>=0)return!1;for(var u=i.x<s.x?i.x<o.x?i.x:o.x:s.x<o.x?s.x:o.x,a=i.y<s.y?i.y<o.y?i.y:o.y:s.y<o.y?s.y:o.y,f=i.x>s.x?i.x>o.x?i.x:o.x:s.x>o.x?s.x:o.x,l=i.y>s.y?i.y>o.y?i.y:o.y:s.y>o.y?s.y:o.y,c=PIXI.EarCut.zOrder(u,a,t,n,r),h=PIXI.EarCut.zOrder(f,l,t,n,r),p=e.nextZ;p&&p.z<=h;){if(p!==e.prev&&p!==e.next&&PIXI.EarCut.pointInTriangle(i.x,i.y,s.x,s.y,o.x,o.y,p.x,p.y)&&PIXI.EarCut.area(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(p=e.prevZ;p&&p.z>=c;){if(p!==e.prev&&p!==e.next&&PIXI.EarCut.pointInTriangle(i.x,i.y,s.x,s.y,o.x,o.y,p.x,p.y)&&PIXI.EarCut.area(p.prev,p,p.next)>=0)return!1;p=p.prevZ}return!0},PIXI.EarCut.cureLocalIntersections=function(e,t,n){var r=e;do{var i=r.prev,s=r.next.next;PIXI.EarCut.intersects(i,r,r.next,s)&&PIXI.EarCut.locallyInside(i,s)&&PIXI.EarCut.locallyInside(s,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(s.i/n),PIXI.EarCut.removeNode(r),PIXI.EarCut.removeNode(r.next),r=e=s),r=r.next}while(r!==e);return r},PIXI.EarCut.splitEarcut=function(e,t,n,r,i,s){var o=e;do{for(var u=o.next.next;u!==o.prev;){if(o.i!==u.i&&PIXI.EarCut.isValidDiagonal(o,u)){var a=PIXI.EarCut.splitPolygon(o,u);return o=PIXI.EarCut.filterPoints(o,o.next),a=PIXI.EarCut.filterPoints(a,a.next),PIXI.EarCut.earcutLinked(o,t,n,r,i,s),void PIXI.EarCut.earcutLinked(a,t,n,r,i,s)}u=u.next}o=o.next}while(o!==e)},PIXI.EarCut.eliminateHoles=function(e,t,n,r){var i,s,o,u,a,f=[];for(i=0,s=t.length;s>i;i++)o=t[i]*r,u=s-1>i?t[i+1]*r:e.length,a=PIXI.EarCut.linkedList(e,o,u,r,!1),a===a.next&&(a.steiner=!0),f.push(PIXI.EarCut.getLeftmost(a));for(f.sort(compareX),i=0;i<f.length;i++)PIXI.EarCut.eliminateHole(f[i],n),n=PIXI.EarCut.filterPoints(n,n.next);return n},PIXI.EarCut.compareX=function(e,t){return e.x-t.x},PIXI.EarCut.eliminateHole=function(e,t){if(t=PIXI.EarCut.findHoleBridge(e,t)){var n=PIXI.EarCut.splitPolygon(t,e);PIXI.EarCut.filterPoints(n,n.next)}},PIXI.EarCut.findHoleBridge=function(e,t){var n,r=t,i=e.x,s=e.y,o=-1/0;do{if(s<=r.y&&s>=r.next.y){var u=r.x+(s-r.y)*(r.next.x-r.x)/(r.next.y-r.y);i>=u&&u>o&&(o=u,n=r.x<r.next.x?r:r.next)}r=r.next}while(r!==t);if(!n)return null;if(e.x===n.x)return n.prev;var a,f=n,l=1/0;for(r=n.next;r!==f;)i>=r.x&&r.x>=n.x&&PIXI.EarCut.pointInTriangle(s<n.y?i:o,s,n.x,n.y,s<n.y?o:i,s,r.x,r.y)&&(a=Math.abs(s-r.y)/(i-r.x),(l>a||a===l&&r.x>n.x)&&PIXI.EarCut.locallyInside(r,e)&&(n=r,l=a)),r=r.next;return n},PIXI.EarCut.indexCurve=function(e,t,n,r){var i=e;do null===i.z&&(i.z=PIXI.EarCut.zOrder(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,PIXI.EarCut.sortLinked(i)},PIXI.EarCut.sortLinked=function(e){var t,n,r,i,s,o,u,a,f=1;do{for(n=e,e=null,s=null,o=0;n;){for(o++,r=n,u=0,t=0;f>t&&(u++,r=r.nextZ,r);t++);for(a=f;u>0||a>0&&r;)0===u?(i=r,r=r.nextZ,a--):0!==a&&r?n.z<=r.z?(i=n,n=n.nextZ,u--):(i=r,r=r.nextZ,a--):(i=n,n=n.nextZ,u--),s?s.nextZ=i:e=i,i.prevZ=s,s=i;n=r}s.nextZ=null,f*=2}while(o>1);return e},PIXI.EarCut.zOrder=function(e,t,n,r,i){return e=32767*(e-n)/i,t=32767*(t-r)/i,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e|t<<1},PIXI.EarCut.getLeftmost=function(e){var t=e,n=e;do t.x<n.x&&(n=t),t=t.next;while(t!==e);return n},PIXI.EarCut.pointInTriangle=function(e,t,n,r,i,s,o,u){return(i-o)*(t-u)-(e-o)*(s-u)>=0&&(e-o)*(r-u)-(n-o)*(t-u)>=0&&(n-o)*(s-u)-(i-o)*(r-u)>=0},PIXI.EarCut.isValidDiagonal=function(e,t){return PIXI.EarCut.equals(e,t)||e.next.i!==t.i&&e.prev.i!==t.i&&!PIXI.EarCut.intersectsPolygon(e,t)&&PIXI.EarCut.locallyInside(e,t)&&PIXI.EarCut.locallyInside(t,e)&&PIXI.EarCut.middleInside(e,t)},PIXI.EarCut.area=function(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)},PIXI.EarCut.equals=function(e,t){return e.x===t.x&&e.y===t.y},PIXI.EarCut.intersects=function(e,t,n,r){return PIXI.EarCut.area(e,t,n)>0!=PIXI.EarCut.area(e,t,r)>0&&PIXI.EarCut.area(n,r,e)>0!=PIXI.EarCut.area(n,r,t)>0},PIXI.EarCut.intersectsPolygon=function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&PIXI.EarCut.intersects(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1},PIXI.EarCut.locallyInside=function(e,t){return PIXI.EarCut.area(e.prev,e,e.next)<0?PIXI.EarCut.area(e,t,e.next)>=0&&PIXI.EarCut.area(e,e.prev,t)>=0:PIXI.EarCut.area(e,t,e.prev)<0||PIXI.EarCut.area(e,e.next,t)<0},PIXI.EarCut.middleInside=function(e,t){var n=e,r=!1,i=(e.x+t.x)/2,s=(e.y+t.y)/2;do n.y>s!=n.next.y>s&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==e);return r},PIXI.EarCut.splitPolygon=function(e,t){var n=new PIXI.EarCut.Node(e.i,e.x,e.y),r=new PIXI.EarCut.Node(t.i,t.x,t.y),i=e.next,s=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r},PIXI.EarCut.insertNode=function(e,t,n,r){var i=new PIXI.EarCut.Node(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i},PIXI.EarCut.removeNode=function(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)},PIXI.EarCut.Node=function(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1},PIXI.WebGLGraphics=function(){},PIXI.WebGLGraphics.stencilBufferLimit=6,PIXI.WebGLGraphics.renderGraphics=function(e,t){var n,r=t.gl,i=t.projection,s=t.offset,o=t.shaderManager.primitiveShader;e.dirty&&PIXI.WebGLGraphics.updateGraphics(e,r);for(var u=e._webGL[r.id],a=0;a<u.data.length;a++)1===u.data[a].mode?(n=u.data[a],t.stencilManager.pushStencil(e,n,t),r.drawElements(r.TRIANGLE_FAN,4,r.UNSIGNED_SHORT,2*(n.indices.length-4)),t.stencilManager.popStencil(e,n,t)):(n=u.data[a],t.shaderManager.setShader(o),o=t.shaderManager.primitiveShader,r.uniformMatrix3fv(o.translationMatrix,!1,e.worldTransform.toArray(!0)),r.uniform1f(o.flipY,1),r.uniform2f(o.projectionVector,i.x,-i.y),r.uniform2f(o.offsetVector,-s.x,-s.y),r.uniform3fv(o.tintColor,PIXI.hex2rgb(e.tint)),r.uniform1f(o.alpha,e.worldAlpha),r.bindBuffer(r.ARRAY_BUFFER,n.buffer),r.vertexAttribPointer(o.aVertexPosition,2,r.FLOAT,!1,24,0),r.vertexAttribPointer(o.colorAttribute,4,r.FLOAT,!1,24,8),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,n.indexBuffer),r.drawElements(r.TRIANGLE_STRIP,n.indices.length,r.UNSIGNED_SHORT,0))},PIXI.WebGLGraphics.updateGraphics=function(e,t){var n=e._webGL[t.id];n||(n=e._webGL[t.id]={lastIndex:0,data:[],gl:t}),e.dirty=!1;var r;if(e.clearDirty){for(e.clearDirty=!1,r=0;r<n.data.length;r++){var i=n.data[r];i.reset(),PIXI.WebGLGraphics.graphicsDataPool.push(i)}n.data=[],n.lastIndex=0}var s;for(r=n.lastIndex;r<e.graphicsData.length;r++){var o=e.graphicsData[r];if(o.type===PIXI.Graphics.POLY){if(o.points=o.shape.points.slice(),o.shape.closed&&(o.points[0]!==o.points[o.points.length-2]||o.points[1]!==o.points[o.points.length-1])&&o.points.push(o.points[0],o.points[1]),o.fill&&o.points.length>=PIXI.WebGLGraphics.stencilBufferLimit)if(o.points.length<2*PIXI.WebGLGraphics.stencilBufferLimit){s=PIXI.WebGLGraphics.switchMode(n,0);var u=PIXI.WebGLGraphics.buildPoly(o,s);u||(s=PIXI.WebGLGraphics.switchMode(n,1),PIXI.WebGLGraphics.buildComplexPoly(o,s))}else s=PIXI.WebGLGraphics.switchMode(n,1),PIXI.WebGLGraphics.buildComplexPoly(o,s);o.lineWidth>0&&(s=PIXI.WebGLGraphics.switchMode(n,0),PIXI.WebGLGraphics.buildLine(o,s))}else s=PIXI.WebGLGraphics.switchMode(n,0),o.type===PIXI.Graphics.RECT?PIXI.WebGLGraphics.buildRectangle(o,s):o.type===PIXI.Graphics.CIRC||o.type===PIXI.Graphics.ELIP?PIXI.WebGLGraphics.buildCircle(o,s):o.type===PIXI.Graphics.RREC&&PIXI.WebGLGraphics.buildRoundedRectangle(o,s);n.lastIndex++}for(r=0;r<n.data.length;r++)s=n.data[r],s.dirty&&s.upload()},PIXI.WebGLGraphics.switchMode=function(e,t){var n;return e.data.length?(n=e.data[e.data.length-1],(n.mode!==t||1===t)&&(n=PIXI.WebGLGraphics.graphicsDataPool.pop()||new PIXI.WebGLGraphicsData(e.gl),n.mode=t,e.data.push(n))):(n=PIXI.WebGLGraphics.graphicsDataPool.pop()||new PIXI.WebGLGraphicsData(e.gl),n.mode=t,e.data.push(n)),n.dirty=!0,n},PIXI.WebGLGraphics.buildRectangle=function(e,t){var n=e.shape,r=n.x,i=n.y,s=n.width,o=n.height;if(e.fill){var u=PIXI.hex2rgb(e.fillColor),a=e.fillAlpha,f=u[0]*a,l=u[1]*a,c=u[2]*a,h=t.points,p=t.indices,d=h.length/6;h.push(r,i),h.push(f,l,c,a),h.push(r+s,i),h.push(f,l,c,a),h.push(r,i+o),h.push(f,l,c,a),h.push(r+s,i+o),h.push(f,l,c,a),p.push(d,d,d+1,d+2,d+3,d+3)}if(e.lineWidth){var v=e.points;e.points=[r,i,r+s,i,r+s,i+o,r,i+o,r,i],PIXI.WebGLGraphics.buildLine(e,t),e.points=v}},PIXI.WebGLGraphics.buildRoundedRectangle=function(e,t){var n=e.shape,r=n.x,i=n.y,s=n.width,o=n.height,u=n.radius,a=[];if(a.push(r,i+u),a=a.concat(PIXI.WebGLGraphics.quadraticBezierCurve(r,i+o-u,r,i+o,r+u,i+o)),a=a.concat(PIXI.WebGLGraphics.quadraticBezierCurve(r+s-u,i+o,r+s,i+o,r+s,i+o-u)),a=a.concat(PIXI.WebGLGraphics.quadraticBezierCurve(r+s,i+u,r+s,i,r+s-u,i)),a=a.concat(PIXI.WebGLGraphics.quadraticBezierCurve(r+u,i,r,i,r,i+u)),e.fill){var f=PIXI.hex2rgb(e.fillColor),l=e.fillAlpha,c=f[0]*l,h=f[1]*l,p=f[2]*l,d=t.points,v=t.indices,m=d.length/6,g=PIXI.EarCut.Triangulate(a,null,2),y=0;for(y=0;y<g.length;y+=3)v.push(g[y]+m),v.push(g[y]+m),v.push(g[y+1]+m),v.push(g[y+2]+m),v.push(g[y+2]+m);for(y=0;y<a.length;y++)d.push(a[y],a[++y],c,h,p,l)}if(e.lineWidth){var b=e.points;e.points=a,PIXI.WebGLGraphics.buildLine(e,t),e.points=b}},PIXI.WebGLGraphics.quadraticBezierCurve=function(e,t,n,r,i,s){function o(e,t,n){var r=t-e;return e+r*n}for(var u,a,f,l,c,h,p=20,d=[],v=0,m=0;p>=m;m++)v=m/p,u=o(e,n,v),a=o(t,r,v),f=o(n,i,v),l=o(r,s,v),c=o(u,f,v),h=o(a,l,v),d.push(c,h);return d},PIXI.WebGLGraphics.buildCircle=function(e,t){var n,r,i=e.shape,s=i.x,o=i.y;e.type===PIXI.Graphics.CIRC?(n=i.radius,r=i.radius):(n=i.width,r=i.height);var u=40,a=2*Math.PI/u,f=0;if(e.fill){var l=PIXI.hex2rgb(e.fillColor),c=e.fillAlpha,h=l[0]*c,p=l[1]*c,d=l[2]*c,v=t.points,m=t.indices,g=v.length/6;for(m.push(g),f=0;u+1>f;f++)v.push(s,o,h,p,d,c),v.push(s+Math.sin(a*f)*n,o+Math.cos(a*f)*r,h,p,d,c),m.push(g++,g++);m.push(g-1)}if(e.lineWidth){var y=e.points;for(e.points=[],f=0;u+1>f;f++)e.points.push(s+Math.sin(a*f)*n,o+Math.cos(a*f)*r);PIXI.WebGLGraphics.buildLine(e,t),e.points=y}},PIXI.WebGLGraphics.buildLine=function(e,t){var n=0,r=e.points;if(0!==r.length){if(e.lineWidth%2)for(n=0;n<r.length;n++)r[n]+=.5;var i=new PIXI.Point(r[0],r[1]),s=new PIXI.Point(r[r.length-2],r[r.length-1]);if(i.x===s.x&&i.y===s.y){r=r.slice(),r.pop(),r.pop(),s=new PIXI.Point(r[r.length-2],r[r.length-1]);var o=s.x+.5*(i.x-s.x),u=s.y+.5*(i.y-s.y);r.unshift(o,u),r.push(o,u)}var a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M=t.points,_=t.indices,D=r.length/2,P=r.length,H=M.length/6,B=e.lineWidth/2,j=PIXI.hex2rgb(e.lineColor),F=e.lineAlpha,I=j[0]*F,q=j[1]*F,R=j[2]*F;for(l=r[0],c=r[1],h=r[2],p=r[3],m=-(c-p),g=l-h,O=Math.sqrt(m*m+g*g),m/=O,g/=O,m*=B,g*=B,M.push(l-m,c-g,I,q,R,F),M.push(l+m,c+g,I,q,R,F),n=1;D-1>n;n++)l=r[2*(n-1)],c=r[2*(n-1)+1],h=r[2*n],p=r[2*n+1],d=r[2*(n+1)],v=r[2*(n+1)+1],m=-(c-p),g=l-h,O=Math.sqrt(m*m+g*g),m/=O,g/=O,m*=B,g*=B,y=-(p-v),b=h-d,O=Math.sqrt(y*y+b*b),y/=O,b/=O,y*=B,b*=B,S=-g+c-(-g+p),x=-m+h-(-m+l),T=(-m+l)*(-g+p)-(-m+h)*(-g+c),N=-b+v-(-b+p),C=-y+h-(-y+d),k=(-y+d)*(-b+p)-(-y+h)*(-b+v),L=S*C-N*x,Math.abs(L)<.1?(L+=10.1,M.push(h-m,p-g,I,q,R,F),M.push(h+m,p+g,I,q,R,F)):(a=(x*k-C*T)/L,f=(N*T-S*k)/L,A=(a-h)*(a-h)+(f-p)+(f-p),A>19600?(w=m-y,E=g-b,O=Math.sqrt(w*w+E*E),w/=O,E/=O,w*=B,E*=B,M.push(h-w,p-E),M.push(I,q,R,F),M.push(h+w,p+E),M.push(I,q,R,F),M.push(h-w,p-E),M.push(I,q,R,F),P++):(M.push(a,f),M.push(I,q,R,F),M.push(h-(a-h),p-(f-p)),M.push(I,q,R,F)));for(l=r[2*(D-2)],c=r[2*(D-2)+1],h=r[2*(D-1)],p=r[2*(D-1)+1],m=-(c-p),g=l-h,O=Math.sqrt(m*m+g*g),m/=O,g/=O,m*=B,g*=B,M.push(h-m,p-g),M.push(I,q,R,F),M.push(h+m,p+g),M.push(I,q,R,F),_.push(H),n=0;P>n;n++)_.push(H++);_.push(H-1)}},PIXI.WebGLGraphics.buildComplexPoly=function(e,t){var n=e.points.slice();if(!(n.length<6)){var r=t.indices;t.points=n,t.alpha=e.fillAlpha,t.color=PIXI.hex2rgb(e.fillColor);for(var i,s,o=1/0,u=-1/0,a=1/0,f=-1/0,l=0;l<n.length;l+=2)i=n[l],s=n[l+1],o=o>i?i:o,u=i>u?i:u,a=a>s?s:a,f=s>f?s:f;n.push(o,a,u,a,u,f,o,f);var c=n.length/2;for(l=0;c>l;l++)r.push(l)}},PIXI.WebGLGraphics.buildPoly=function(e,t){var n=e.points;if(!(n.length<6)){var r=t.points,i=t.indices,s=n.length/2,o=PIXI.hex2rgb(e.fillColor),u=e.fillAlpha,a=o[0]*u,f=o[1]*u,l=o[2]*u,c=PIXI.EarCut.Triangulate(n,null,2);if(!c)return!1;var h=r.length/6,p=0;for(p=0;p<c.length;p+=3)i.push(c[p]+h),i.push(c[p]+h),i.push(c[p+1]+h),i.push(c[p+2]+h),i.push(c[p+2]+h);for(p=0;s>p;p++)r.push(n[2*p],n[2*p+1],a,f,l,u);return!0}},PIXI.WebGLGraphics.graphicsDataPool=[],PIXI.WebGLGraphicsData=function(e){this.gl=e,this.color=[0,0,0],this.points=[],this.indices=[],this.buffer=e.createBuffer(),this.indexBuffer=e.createBuffer(),this.mode=1,this.alpha=1,this.dirty=!0},PIXI.WebGLGraphicsData.prototype.reset=function(){this.points=[],this.indices=[]},PIXI.WebGLGraphicsData.prototype.upload=function(){var e=this.gl;this.glPoints=new PIXI.Float32Array(this.points),e.bindBuffer(e.ARRAY_BUFFER,this.buffer),e.bufferData(e.ARRAY_BUFFER,this.glPoints,e.STATIC_DRAW),this.glIndicies=new PIXI.Uint16Array(this.indices),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.glIndicies,e.STATIC_DRAW),this.dirty=!1},PIXI.CanvasGraphics=function(){},PIXI.CanvasGraphics.renderGraphics=function(e,t){var n=e.worldAlpha;e.dirty&&(this.updateGraphicsTint(e),e.dirty=!1);for(var r=0;r<e.graphicsData.length;r++){var i=e.graphicsData[r],s=i.shape,o=i._fillTint,u=i._lineTint;if(t.lineWidth=i.lineWidth,i.type===PIXI.Graphics.POLY){t.beginPath();var a=s.points;t.moveTo(a[0],a[1]);for(var f=1;f<a.length/2;f++)t.lineTo(a[2*f],a[2*f+1]);s.closed&&t.lineTo(a[0],a[1]),a[0]===a[a.length-2]&&a[1]===a[a.length-1]&&t.closePath(),i.fill&&(t.globalAlpha=i.fillAlpha*n,t.fillStyle="#"+("00000"+(0|o).toString(16)).substr(-6),t.fill()),i.lineWidth&&(t.globalAlpha=i.lineAlpha*n,t.strokeStyle="#"+("00000"+(0|u).toString(16)).substr(-6),t.stroke())}else if(i.type===PIXI.Graphics.RECT)(i.fillColor||0===i.fillColor)&&(t.globalAlpha=i.fillAlpha*n,t.fillStyle="#"+("00000"+(0|o).toString(16)).substr(-6),t.fillRect(s.x,s.y,s.width,s.height)),i.lineWidth&&(t.globalAlpha=i.lineAlpha*n,t.strokeStyle="#"+("00000"+(0|u).toString(16)).substr(-6),t.strokeRect(s.x,s.y,s.width,s.height));else if(i.type===PIXI.Graphics.CIRC)t.beginPath(),t.arc(s.x,s.y,s.radius,0,2*Math.PI),t.closePath(),i.fill&&(t.globalAlpha=i.fillAlpha*n,t.fillStyle="#"+("00000"+(0|o).toString(16)).substr(-6),t.fill()),i.lineWidth&&(t.globalAlpha=i.lineAlpha*n,t.strokeStyle="#"+("00000"+(0|u).toString(16)).substr(-6),t.stroke());else if(i.type===PIXI.Graphics.ELIP){var l=2*s.width,c=2*s.height,h=s.x-l/2,p=s.y-c/2;t.beginPath();var d=.5522848,v=l/2*d,m=c/2*d,g=h+l,y=p+c,b=h+l/2,w=p+c/2;t.moveTo(h,w),t.bezierCurveTo(h,w-m,b-v,p,b,p),t.bezierCurveTo(b+v,p,g,w-m,g,w),t.bezierCurveTo(g,w+m,b+v,y,b,y),t.bezierCurveTo(b-v,y,h,w+m,h,w),t.closePath(),i.fill&&(t.globalAlpha=i.fillAlpha*n,t.fillStyle="#"+("00000"+(0|o).toString(16)).substr(-6),t.fill()),i.lineWidth&&(t.globalAlpha=i.lineAlpha*n,t.strokeStyle="#"+("00000"+(0|u).toString(16)).substr(-6),t.stroke())}else if(i.type===PIXI.Graphics.RREC){var E=s.x,S=s.y,x=s.width,T=s.height,N=s.radius,C=Math.min(x,T)/2|0;N=N>C?C:N,t.beginPath(),t.moveTo(E,S+N),t.lineTo(E,S+T-N),t.quadraticCurveTo(E,S+T,E+N,S+T),t.lineTo(E+x-N,S+T),t.quadraticCurveTo(E+x,S+T,E+x,S+T-N),t.lineTo(E+x,S+N),t.quadraticCurveTo(E+x,S,E+x-N,S),t.lineTo(E+N,S),t.quadraticCurveTo(E,S,E,S+N),t.closePath(),(i.fillColor||0===i.fillColor)&&(t.globalAlpha=i.fillAlpha*n,t.fillStyle="#"+("00000"+(0|o).toString(16)).substr(-6),t.fill()),i.lineWidth&&(t.globalAlpha=i.lineAlpha*n,t.strokeStyle="#"+("00000"+(0|u).toString(16)).substr(-6),t.stroke())}}},PIXI.CanvasGraphics.renderGraphicsMask=function(e,t){var n=e.graphicsData.length;if(0!==n){t.beginPath();for(var r=0;n>r;r++){var i=e.graphicsData[r],s=i.shape;if(i.type===PIXI.Graphics.POLY){var o=s.points;t.moveTo(o[0],o[1]);for(var u=1;u<o.length/2;u++)t.lineTo(o[2*u],o[2*u+1]);o[0]===o[o.length-2]&&o[1]===o[o.length-1]&&t.closePath()}else if(i.type===PIXI.Graphics.RECT)t.rect(s.x,s.y,s.width,s.height),t.closePath();else if(i.type===PIXI.Graphics.CIRC)t.arc(s.x,s.y,s.radius,0,2*Math.PI),t.closePath();else if(i.type===PIXI.Graphics.ELIP){var a=2*s.width,f=2*s.height,l=s.x-a/2,c=s.y-f/2,h=.5522848,p=a/2*h,d=f/2*h,v=l+a,m=c+f,g=l+a/2,y=c+f/2;t.moveTo(l,y),t.bezierCurveTo(l,y-d,g-p,c,g,c),t.bezierCurveTo(g+p,c,v,y-d,v,y),t.bezierCurveTo(v,y+d,g+p,m,g,m),t.bezierCurveTo(g-p,m,l,y+d,l,y),t.closePath()}else if(i.type===PIXI.Graphics.RREC){var b=s.x,w=s.y,E=s.width,S=s.height,x=s.radius,T=Math.min(E,S)/2|0;x=x>T?T:x,t.moveTo(b,w+x),t.lineTo(b,w+S-x),t.quadraticCurveTo(b,w+S,b+x,w+S),t.lineTo(b+E-x,w+S),t.quadraticCurveTo(b+E,w+S,b+E,w+S-x),t.lineTo(b+E,w+x),t.quadraticCurveTo(b+E,w,b+E-x,w),t.lineTo(b+x,w),t.quadraticCurveTo(b,w,b,w+x),t.closePath()}}}},PIXI.CanvasGraphics.updateGraphicsTint=function(e){if(16777215!==e.tint)for(var t=(e.tint>>16&255)/255,n=(e.tint>>8&255)/255,r=(255&e.tint)/255,i=0;i<e.graphicsData.length;i++){var s=e.graphicsData[i],o=0|s.fillColor,u=0|s.lineColor;s._fillTint=((o>>16&255)/255*t*255<<16)+((o>>8&255)/255*n*255<<8)+(255&o)/255*r*255,s._lineTint=((u>>16&255)/255*t*255<<16)+((u>>8&255)/255*n*255<<8)+(255&u)/255*r*255}},n.Graphics=function(e,t,r){void 0===t&&(t=0),void 0===r&&(r=0),this.type=n.GRAPHICS,this.physicsType=n.SPRITE,this.anchor=new n.Point,PIXI.Graphics.call(this),n.Component.Core.init.call(this,e,t,r,"",null)},n.Graphics.prototype=Object.create(PIXI.Graphics.prototype),n.Graphics.prototype.constructor=n.Graphics,n.Component.Core.install.call(n.Graphics.prototype,["Angle","AutoCull","Bounds","Destroy","FixedToCamera","InputEnabled","InWorld","LifeSpan","PhysicsBody","Reset"]),n.Graphics.prototype.preUpdatePhysics=n.Component.PhysicsBody.preUpdate,n.Graphics.prototype.preUpdateLifeSpan=n.Component.LifeSpan.preUpdate,n.Graphics.prototype.preUpdateInWorld=n.Component.InWorld.preUpdate,n.Graphics.prototype.preUpdateCore=n.Component.Core.preUpdate,n.Graphics.prototype.preUpdate=function(){return this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld()?this.preUpdateCore():!1},n.Graphics.prototype.destroy=function(e){this.clear(),n.Component.Destroy.prototype.destroy.call(this,e)},n.Graphics.prototype.drawTriangle=function(e,t){void 0===t&&(t=!1);var r=new n.Polygon(e);if(t){var i=new n.Point(this.game.camera.x-e[0].x,this.game.camera.y-e[0].y),s=new n.Point(e[1].x-e[0].x,e[1].y-e[0].y),o=new n.Point(e[1].x-e[2].x,e[1].y-e[2].y),u=o.cross(s);i.dot(u)>0&&this.drawPolygon(r)}else this.drawPolygon(r)},n.Graphics.prototype.drawTriangles=function(e,t,r){void 0===r&&(r=!1);var i,s=new n.Point,o=new n.Point,u=new n.Point,a=[];if(t)if(e[0]instanceof n.Point)for(i=0;i<t.length/3;i++)a.push(e[t[3*i]]),a.push(e[t[3*i+1]]),a.push(e[t[3*i+2]]),3===a.length&&(this.drawTriangle(a,r),a=[]);else for(i=0;i<t.length;i++)s.x=e[2*t[i]],s.y=e[2*t[i]+1],a.push(s.copyTo({})),3===a.length&&(this.drawTriangle(a,r),a=[]);else if(e[0]instanceof n.Point)for(i=0;i<e.length/3;i++)this.drawTriangle([e[3*i],e[3*i+1],e[3*i+2]],r);else for(i=0;i<e.length/6;i++)s.x=e[6*i+0],s.y=e[6*i+1],o.x=e[6*i+2],o.y=e[6*i+3],u.x=e[6*i+4],u.y=e[6*i+5],this.drawTriangle([s,o,u],r)},n.RenderTexture=function(e,t,r,i,s,o){void 0===i&&(i=""),void 0===s&&(s=n.scaleModes.DEFAULT),void 0===o&&(o=1),this.game=e,this.key=i,this.type=n.RENDERTEXTURE,this._tempMatrix=new PIXI.Matrix,PIXI.RenderTexture.call(this,t,r,this.game.renderer,s,o),this.render=n.RenderTexture.prototype.render},n.RenderTexture.prototype=Object.create(PIXI.RenderTexture.prototype),n.RenderTexture.prototype.constructor=n.RenderTexture,n.RenderTexture.prototype.renderXY=function(e,t,n,r){e.updateTransform(),this._tempMatrix.copyFrom(e.worldTransform),this._tempMatrix.tx=t,this._tempMatrix.ty=n,this.renderer.type===PIXI.WEBGL_RENDERER?this.renderWebGL(e,this._tempMatrix,r):this.renderCanvas(e,this._tempMatrix,r)},n.RenderTexture.prototype.renderRawXY=function(e,t,n,r){this._tempMatrix.identity().translate(t,n),this.renderer.type===PIXI.WEBGL_RENDERER?this.renderWebGL(e,this._tempMatrix,r):this.renderCanvas(e,this._tempMatrix,r)},n.RenderTexture.prototype.render=function(e,t,n){void 0===t||null===t?this._tempMatrix.copyFrom(e.worldTransform):this._tempMatrix.copyFrom(t),this.renderer.type===PIXI.WEBGL_RENDERER?this.renderWebGL(e,this._tempMatrix,n):this.renderCanvas(e,this._tempMatrix,n)},n.Text=function(e,t,r,i,s){t=t||0,r=r||0,i=void 0===i||null===i?"":i.toString(),s=n.Utils.extend({},s),this.type=n.TEXT,this.physicsType=n.SPRITE,this.padding=new n.Point,this.textBounds=null,this.canvas=PIXI.CanvasPool.create(this),this.context=this.canvas.getContext("2d"),this.colors=[],this.strokeColors=[],this.fontStyles=[],this.fontWeights=[],this.autoRound=!1,this.useAdvancedWrap=!1,this._res=e.renderer.resolution,this._text=i,this._fontComponents=null,this._lineSpacing=0,this._charCount=0,this._width=0,this._height=0,n.Sprite.call(this,e,t,r,PIXI.Texture.fromCanvas(this.canvas)),this.setStyle(s),""!==i&&this.updateText()},n.Text.prototype=Object.create(n.Sprite.prototype),n.Text.prototype.constructor=n.Text,n.Text.prototype.preUpdate=function(){return this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld()?this.preUpdateCore():!1},n.Text.prototype.update=function(){},n.Text.prototype.destroy=function(e){this.texture.destroy(!0),PIXI.CanvasPool.remove(this),n.Component.Destroy.prototype.destroy.call(this,e)},n.Text.prototype.setShadow=function(e,t,n,r,i,s){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n="rgba(0, 0, 0, 1)"),void 0===r&&(r=0),void 0===i&&(i=!0),void 0===s&&(s=!0),this.style.shadowOffsetX=e,this.style.shadowOffsetY=t,this.style.shadowColor=n,this.style.shadowBlur=r,this.style.shadowStroke=i,this.style.shadowFill=s,this.dirty=!0,this},n.Text.prototype.setStyle=function(e,t){void 0===t&&(t=!1),e=e||{},e.font=e.font||"bold 20pt Arial",e.backgroundColor=e.backgroundColor||null,e.fill=e.fill||"black",e.align=e.align||"left",e.boundsAlignH=e.boundsAlignH||"left",e.boundsAlignV=e.boundsAlignV||"top",e.stroke=e.stroke||"black",e.strokeThickness=e.strokeThickness||0,e.wordWrap=e.wordWrap||!1,e.wordWrapWidth=e.wordWrapWidth||100,e.maxLines=e.maxLines||0,e.shadowOffsetX=e.shadowOffsetX||0,e.shadowOffsetY=e.shadowOffsetY||0,e.shadowColor=e.shadowColor||"rgba(0,0,0,0)",e.shadowBlur=e.shadowBlur||0,e.tabs=e.tabs||0;var n=this.fontToComponents(e.font);return e.fontStyle&&(n.fontStyle=e.fontStyle),e.fontVariant&&(n.fontVariant=e.fontVariant),e.fontWeight&&(n.fontWeight=e.fontWeight),e.fontSize&&("number"==typeof e.fontSize&&(e.fontSize=e.fontSize+"px"),n.fontSize=e.fontSize),this._fontComponents=n,e.font=this.componentsToFont(this._fontComponents),this.style=e,this.dirty=!0,t&&this.updateText(),this},n.Text.prototype.updateText=function(){this.texture.baseTexture.resolution=this._res,this.context.font=this.style.font;var e=this.text;this.style.wordWrap&&(e=this.runWordWrap(this.text));var t=e.split(/(?:\r\n|\r|\n)/),n=this.style.tabs,r=[],i=0,s=this.determineFontProperties(this.style.font),o=t.length;this.style.maxLines>0&&this.style.maxLines<t.length&&(o=this.style.maxLines);for(var u=0;o>u;u++){if(0===n){var a=this.context.measureText(t[u]).width+this.style.strokeThickness+this.padding.x;this.style.wordWrap&&(a-=this.context.measureText(" ").width)}else{var f=t[u].split(/(?:\t)/),a=this.padding.x+this.style.strokeThickness;if(Array.isArray(n))for(var l=0,c=0;c<f.length;c++){var h=Math.ceil(this.context.measureText(f[c]).width);c>0&&(l+=n[c-1]),a=l+h}else for(var c=0;c<f.length;c++){a+=Math.ceil(this.context.measureText(f[c]).width);var p=this.game.math.snapToCeil(a,n)-a;a+=p}}r[u]=Math.ceil(a),i=Math.max(i,r[u])}this.canvas.width=i*this._res;var d=s.fontSize+this.style.strokeThickness+this.padding.y,v=d*o,m=this._lineSpacing;0>m&&Math.abs(m)>d&&(m=-d),0!==m&&(v+=m>0?m*t.length:m*(t.length-1)),this.canvas.height=v*this._res,this.context.scale(this._res,this._res),navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.style.backgroundColor&&(this.context.fillStyle=this.style.backgroundColor,this.context.fillRect(0,0,this.canvas.width,this.canvas.height)),this.context.fillStyle=this.style.fill,this.context.font=this.style.font,this.context.strokeStyle=this.style.stroke,this.context.textBaseline="alphabetic",this.context.lineWidth=this.style.strokeThickness,this.context.lineCap="round",this.context.lineJoin="round";var g,y;for(this._charCount=0,u=0;o>u;u++)g=this.style.strokeThickness/2,y=this.style.strokeThickness/2+u*d+s.ascent,u>0&&(y+=m*u),"right"===this.style.align?g+=i-r[u]:"center"===this.style.align&&(g+=(i-r[u])/2),this.autoRound&&(g=Math.round(g),y=Math.round(y)),this.colors.length>0||this.strokeColors.length>0||this.fontWeights.length>0||this.fontStyles.length>0?this.updateLine(t[u],g,y):(this.style.stroke&&this.style.strokeThickness&&(this.updateShadow(this.style.shadowStroke),0===n?this.context.strokeText(t[u],g,y):this.renderTabLine(t[u],g,y,!1)),this.style.fill&&(this.updateShadow(this.style.shadowFill),0===n?this.context.fillText(t[u],g,y):this.renderTabLine(t[u],g,y,!0)));this.updateTexture()},n.Text.prototype.renderTabLine=function(e,t,n,r){var i=e.split(/(?:\t)/),s=this.style.tabs,o=0;if(Array.isArray(s))for(var u=0,a=0;a<i.length;a++)a>0&&(u+=s[a-1]),o=t+u,r?this.context.fillText(i[a],o,n):this.context.strokeText(i[a],o,n);else for(var a=0;a<i.length;a++){var f=Math.ceil(this.context.measureText(i[a]).width);o=this.game.math.snapToCeil(t,s),r?this.context.fillText(i[a],o,n):this.context.strokeText(i[a],o,n),t=o+f}},n.Text.prototype.updateShadow=function(e){e?(this.context.shadowOffsetX=this.style.shadowOffsetX,this.context.shadowOffsetY=this.style.shadowOffsetY,this.context.shadowColor=this.style.shadowColor,this.context.shadowBlur=this.style.shadowBlur):(this.context.shadowOffsetX=0,this.context.shadowOffsetY=0,this.context.shadowColor=0,this.context.shadowBlur=0)},n.Text.prototype.updateLine=function(e,t,n){for(var r=0;r<e.length;r++){var i=e[r];if(this.fontWeights.length>0||this.fontStyles.length>0){var s=this.fontToComponents(this.context.font);this.fontStyles[this._charCount]&&(s.fontStyle=this.fontStyles[this._charCount]),this.fontWeights[this._charCount]&&(s.fontWeight=this.fontWeights[this._charCount]),this.context.font=this.componentsToFont(s)}this.style.stroke&&this.style.strokeThickness&&(this.strokeColors[this._charCount]&&(this.context.strokeStyle=this.strokeColors[this._charCount]),this.updateShadow(this.style.shadowStroke),this.context.strokeText(i,t,n)),this.style.fill&&(this.colors[this._charCount]&&(this.context.fillStyle=this.colors[this._charCount]),this.updateShadow(this.style.shadowFill),this.context.fillText(i,t,n)),t+=this.context.measureText(i).width,this._charCount++}},n.Text.prototype.clearColors=function(){return this.colors=[],this.strokeColors=[],this.dirty=!0,this},n.Text.prototype.clearFontValues=function(){return this.fontStyles=[],this.fontWeights=[],this.dirty=!0,this},n.Text.prototype.addColor=function(e,t){return this.colors[t]=e,this.dirty=!0,this},n.Text.prototype.addStrokeColor=function(e,t){return this.strokeColors[t]=e,this.dirty=!0,this},n.Text.prototype.addFontStyle=function(e,t){return this.fontStyles[t]=e,this.dirty=!0,this},n.Text.prototype.addFontWeight=function(e,t){return this.fontWeights[t]=e,this.dirty=!0,this},n.Text.prototype.precalculateWordWrap=function(e){this.texture.baseTexture.resolution=this._res,this.context.font=this.style.font;var t=this.runWordWrap(e);return t.split(/(?:\r\n|\r|\n)/)},n.Text.prototype.runWordWrap=function(e){return this.useAdvancedWrap?this.advancedWordWrap(e):this.basicWordWrap(e)},n.Text.prototype.advancedWordWrap=function(e){for(var t=this.context,n=this.style.wordWrapWidth,r="",i=e.replace(/ +/gi," ").split(/\r?\n/gi),s=i.length,o=0;s>o;o++){var u=i[o],a="";u=u.replace(/^ *|\s*$/gi,"");var f=t.measureText(u).width;if(n>f)r+=u+"\n";else{for(var l=n,c=u.split(" "),h=0;h<c.length;h++){var p=c[h],d=p+" ",v=t.measureText(d).width;if(v>l){if(0===h){for(var m=d;m.length&&(m=m.slice(0,-1),v=t.measureText(m).width,!(l>=v)););if(!m.length)throw new Error("This text's wordWrapWidth setting is less than a single character!");var g=p.substr(m.length);c[h]=g,a+=m}var y=c[h].length?h:h+1,b=c.slice(y).join(" ").replace(/[ \n]*$/gi,"");i[o+1]=b+" "+(i[o+1]||""),s=i.length;break}a+=d,l-=v}r+=a.replace(/[ \n]*$/gi,"")+"\n"}}return r=r.replace(/[\s|\n]*$/gi,"")},n.Text.prototype.basicWordWrap=function(e){for(var t="",n=e.split("\n"),r=0;r<n.length;r++){for(var i=this.style.wordWrapWidth,s=n[r].split(" "),o=0;o<s.length;o++){var u=this.context.measureText(s[o]).width,a=u+this.context.measureText(" ").width;a>i?(o>0&&(t+="\n"),t+=s[o]+" ",i=this.style.wordWrapWidth-u):(i-=a,t+=s[o]+" ")}r<n.length-1&&(t+="\n")}return t},n.Text.prototype.updateFont=function(e){var t=this.componentsToFont(e);this.style.font!==t&&(this.style.font=t,this.dirty=!0,this.parent&&this.updateTransform())},n.Text.prototype.fontToComponents=function(e){var t=e.match(/^\s*(?:\b(normal|italic|oblique|inherit)?\b)\s*(?:\b(normal|small-caps|inherit)?\b)\s*(?:\b(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit)?\b)\s*(?:\b(xx-small|x-small|small|medium|large|x-large|xx-large|larger|smaller|0|\d*(?:[.]\d*)?(?:%|[a-z]{2,5}))?\b)\s*(.*)\s*$/);if(t){var n=t[5].trim();return/^(?:inherit|serif|sans-serif|cursive|fantasy|monospace)$/.exec(n)||/['",]/.exec(n)||(n="'"+n+"'"),{font:e,fontStyle:t[1]||"normal",fontVariant:t[2]||"normal",fontWeight:t[3]||"normal",fontSize:t[4]||"medium",fontFamily:n}}return console.warn("Phaser.Text - unparsable CSS font: "+e),{font:e}},n.Text.prototype.componentsToFont=function(e){var t,n=[];return t=e.fontStyle,t&&"normal"!==t&&n.push(t),t=e.fontVariant,t&&"normal"!==t&&n.push(t),t=e.fontWeight,t&&"normal"!==t&&n.push(t),t=e.fontSize,t&&"medium"!==t&&n.push(t),t=e.fontFamily,t&&n.push(t),n.length||n.push(e.font),n.join(" ")},n.Text.prototype.setText=function(e){return this.text=e.toString()||"",this.dirty=!0,this},n.Text.prototype.parseList=function(e){if(!Array.isArray(e))return this;for(var t="",n=0;n<e.length;n++)Array.isArray(e[n])?(t+=e[n].join("	"),n<e.length-1&&(t+="\n")):(t+=e[n],n<e.length-1&&(t+="	"));return this.text=t,this.dirty=!0,this},n.Text.prototype.setTextBounds=function(e,t,r,i){return void 0===e?this.textBounds=null:(this.textBounds?this.textBounds.setTo(e,t,r,i):this.textBounds=new n.Rectangle(e,t,r,i),this.style.wordWrapWidth>r&&(this.style.wordWrapWidth=r)),this.updateTexture(),this},n.Text.prototype.updateTexture=function(){var e=this.texture.baseTexture,t=this.texture.crop,n=this.texture.frame,r=this.canvas.width,i=this.canvas.height;if(e.width=r,e.height=i,t.width=r,t.height=i,n.width=r,n.height=i,this.texture.width=r,this.texture.height=i,this._width=r,this._height=i,this.textBounds){var s=this.textBounds.x,o=this.textBounds.y;"right"===this.style.boundsAlignH?s+=this.textBounds.width-this.canvas.width:"center"===this.style.boundsAlignH&&(s+=this.textBounds.halfWidth-this.canvas.width/2),"bottom"===this.style.boundsAlignV?o+=this.textBounds.height-this.canvas.height:"middle"===this.style.boundsAlignV&&(o+=this.textBounds.halfHeight-this.canvas.height/2),this.pivot.x=-s,this.pivot.y=-o}this.renderable=0!==r&&0!==i,this.texture.requiresReTint=!0,this.texture.baseTexture.dirty()},n.Text.prototype._renderWebGL=function(e){this.dirty&&(this.updateText(),this.dirty=!1),PIXI.Sprite.prototype._renderWebGL.call(this,e)},n.Text.prototype._renderCanvas=function(e){this.dirty&&(this.updateText(),this.dirty=!1),PIXI.Sprite.prototype._renderCanvas.call(this,e)},n.Text.prototype.determineFontProperties=function(e){var t=n.Text.fontPropertiesCache[e];if(!t){t={};var r=n.Text.fontPropertiesCanvas,i=n.Text.fontPropertiesContext;i.font=e;var s=Math.ceil(i.measureText("|MÉq").width),o=Math.ceil(i.measureText("|MÉq").width),u=2*o;if(o=1.4*o|0,r.width=s,r.height=u,i.fillStyle="#f00",i.fillRect(0,0,s,u),i.font=e,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText("|MÉq",0,o),!i.getImageData(0,0,s,u))return t.ascent=o,t.descent=o+6,t.fontSize=t.ascent+t.descent,n.Text.fontPropertiesCache[e]=t,t;var a,f,l=i.getImageData(0,0,s,u).data,c=l.length,h=4*s,p=0,d=!1;for(a=0;o>a;a++){for(f=0;h>f;f+=4)if(255!==l[p+f]){d=!0;break}if(d)break;p+=h}for(t.ascent=o-a,p=c-h,d=!1,a=u;a>o;a--){for(f=0;h>f;f+=4)if(255!==l[p+f]){d=!0;break}if(d)break;p-=h}t.descent=a-o,t.descent+=6,t.fontSize=t.ascent+t.descent,n.Text.fontPropertiesCache[e]=t}return t},n.Text.prototype.getBounds=function(e){return this.dirty&&(this.updateText(),this.dirty=!1),PIXI.Sprite.prototype.getBounds.call(this,e)},Object.defineProperty(n.Text.prototype,"text",{get:function(){return this._text},set:function(e){e!==this._text&&(this._text=e.toString()||"",this.dirty=!0,this.parent&&this.updateTransform())}}),Object.defineProperty(n.Text.prototype,"cssFont",{get:function(){return this.componentsToFont(this._fontComponents)},set:function(e){e=e||"bold 20pt Arial",this._fontComponents=this.fontToComponents(e),this.updateFont(this._fontComponents)}}),Object.defineProperty(n.Text.prototype,"font",{get:function(){return this._fontComponents.fontFamily},set:function(e){e=e||"Arial",e=e.trim(),/^(?:inherit|serif|sans-serif|cursive|fantasy|monospace)$/.exec(e)||/['",]/.exec(e)||(e="'"+e+"'"),this._fontComponents.fontFamily=e,this.updateFont(this._fontComponents)}}),Object.defineProperty(n.Text.prototype,"fontSize",{get:function(){var e=this._fontComponents.fontSize;return e&&/(?:^0$|px$)/.exec(e)?parseInt(e,10):e},set:function(e){e=e||"0","number"==typeof e&&(e+="px"),this._fontComponents.fontSize=e,this.updateFont(this._fontComponents)}}),Object.defineProperty(n.Text.prototype,"fontWeight",{get:function(){return this._fontComponents.fontWeight||"normal"},set:function(e){e=e||"normal",this._fontComponents.fontWeight=e,this.updateFont(this._fontComponents)}}),Object.defineProperty(n.Text.prototype,"fontStyle",{get:function(){return this._fontComponents.fontStyle||"normal"},set:function(e){e=e||"normal",this._fontComponents.fontStyle=e,this.updateFont(this._fontComponents)}}),Object.defineProperty(n.Text.prototype,"fontVariant",{get:function(){return this._fontComponents.fontVariant||"normal"},set:function(e){e=e||"normal",this._fontComponents.fontVariant=e,this.updateFont(this._fontComponents)}}),Object.defineProperty(n.Text.prototype,"fill",{get:function(){return this.style.fill},set:function(e){e!==this.style.fill&&(this.style.fill=e,this.dirty=!0)}}),Object.defineProperty(n.Text.prototype,"align",{get:function(){return this.style.align},set:function(e){e!==this.style.align&&(this.style.align=e,this.dirty=!0)}}),Object.defineProperty(n.Text.prototype,"resolution",{get:function(){return this._res},set:function(e){e!==this._res&&(this._res=e,this.dirty=!0)}}),Object.defineProperty(n.Text.prototype,"tabs",{get:function(){return this.style.tabs},set:function(e){e!==this.style.tabs&&(this.style.tabs=e,this.dirty=!0)}}),Object.defineProperty(n.Text.prototype,"boundsAlignH",{get:function(){return this.style.boundsAlignH},set:function(e){e!==this.style.boundsAlignH&&(this.style.boundsAlignH=e,this.dirty=!0)}}),Object.defineProperty(n.Text.prototype,"boundsAlignV",{get:function(){return this.style.boundsAlignV},set:function(e){e!==this.style.boundsAlignV&&(this.style.boundsAlignV=e,this.dirty=!0)}}),Object.defineProperty(n.Text.prototype,"stroke",{get:function(){return this.style.stroke},set:function(e){e!==this.style.stroke&&(this.style.stroke=e,this.dirty=!0)}}),Object.defineProperty(n.Text.prototype,"strokeThickness",{get:function(){return this.style.strokeThickness},set:function(e){e!==this.style.strokeThickness&&(this.style.strokeThickness=e,this.dirty=!0)}}),Object.defineProperty(n.Text.prototype,"wordWrap",{get:function(){return this.style.wordWrap},set:function(e){e!==this.style.wordWrap&&(this.style.wordWrap=e,this.dirty=!0)}}),Object.defineProperty(n.Text.prototype,"wordWrapWidth",{get:function(){return this.style.wordWrapWidth},set:function(e){e!==this.style.wordWrapWidth&&(this.style.wordWrapWidth=e,this.dirty=!0)}}),Object.defineProperty(n.Text.prototype,"lineSpacing",{get:function(){return this._lineSpacing},set:function(e){e!==this._lineSpacing&&(this._lineSpacing=parseFloat(e),this.dirty=!0,this.parent&&this.updateTransform())}}),Object.defineProperty(n.Text.prototype,"shadowOffsetX",{get:function(){return this.style.shadowOffsetX},set:function(e){e!==this.style.shadowOffsetX&&(this.style.shadowOffsetX=e,this.dirty=!0)}}),Object.defineProperty(n.Text.prototype,"shadowOffsetY",{get:function(){return this.style.shadowOffsetY},set:function(e){e!==this.style.shadowOffsetY&&(this.style.shadowOffsetY=e,this.dirty=!0)}}),Object.defineProperty(n.Text.prototype,"shadowColor",{get:function(){return this.style.shadowColor},set:function(e){e!==this.style.shadowColor&&(this.style.shadowColor=e,this.dirty=!0)}}),Object.defineProperty(n.Text.prototype,"shadowBlur",{get:function(){return this.style.shadowBlur},set:function(e){e!==this.style.shadowBlur&&(this.style.shadowBlur=e,this.dirty=!0)}}),Object.defineProperty(n.Text.prototype,"shadowStroke",{get:function(){return this.style.shadowStroke},set:function(e){e!==this.style.shadowStroke&&(this.style.shadowStroke=e,this.dirty=!0)}}),Object.defineProperty(n.Text.prototype,"shadowFill",{get:function(){return this.style.shadowFill},set:function(e){e!==this.style.shadowFill&&(this.style.shadowFill=e,this.dirty=!0)}}),Object.defineProperty(n.Text.prototype,"width",{get:function(){return this.dirty&&(this.updateText(),this.dirty=!1),this.scale.x*this.texture.frame.width},set:function(e){this.scale.x=e/this.texture.frame.width,this._width=e}}),Object.defineProperty(n.Text.prototype,"height",{get:function(){return this.dirty&&(this.updateText(),this.dirty=!1),this.scale.y*this.texture.frame.height},set:function(e){this.scale.y=e/this.texture.frame.height,this._height=e}}),n.Text.fontPropertiesCache={},n.Text.fontPropertiesCanvas=PIXI.CanvasPool.create(n.Text.fontPropertiesCanvas),n.Text.fontPropertiesContext=n.Text.fontPropertiesCanvas.getContext("2d"),n.BitmapText=function(e,t,r,i,s,o,u){t=t||0,r=r||0,i=i||"",s=s||"",o=o||32,u=u||"left",PIXI.DisplayObjectContainer.call(this),this.type=n.BITMAPTEXT,this.physicsType=n.SPRITE,this.textWidth=0,this.textHeight=0,this.anchor=new n.Point,this._prevAnchor=new n.Point,this._glyphs=[],this._maxWidth=0,this._text=s.toString()||"",this._data=e.cache.getBitmapFont(i),this._font=i,this._fontSize=o,this._align=u,this._tint=16777215,this.updateText(),this.dirty=!1,n.Component.Core.init.call(this,e,t,r,"",null)},n.BitmapText.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),n.BitmapText.prototype.constructor=n.BitmapText,n.Component.Core.install.call(n.BitmapText.prototype,["Angle","AutoCull","Bounds","Destroy","FixedToCamera","InputEnabled","InWorld","LifeSpan","PhysicsBody","Reset"]),n.BitmapText.prototype.preUpdatePhysics=n.Component.PhysicsBody.preUpdate,n.BitmapText.prototype.preUpdateLifeSpan=n.Component.LifeSpan.preUpdate,n.BitmapText.prototype.preUpdateInWorld=n.Component.InWorld.preUpdate,n.BitmapText.prototype.preUpdateCore=n.Component.Core.preUpdate,n.BitmapText.prototype.preUpdate=function(){return this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld()?this.preUpdateCore():!1},n.BitmapText.prototype.postUpdate=function(){n.Component.PhysicsBody.postUpdate.call(this),n.Component.FixedToCamera.postUpdate.call(this),this.body&&this.body.type===n.Physics.ARCADE&&(this.textWidth!==this.body.sourceWidth||this.textHeight!==this.body.sourceHeight)&&this.body.setSize(this.textWidth,this.textHeight)},n.BitmapText.prototype.setText=function(e){this.text=e},n.BitmapText.prototype.scanLine=function(e,t,n){for(var r=0,i=0,s=-1,o=null,u=this._maxWidth>0?this._maxWidth:null,a=[],f=0;f<n.length;f++){var l=f===n.length-1?!0:!1;if(/(?:\r\n|\r|\n)/.test(n.charAt(f)))return{width:i,text:n.substr(0,f),end:l,chars:a};var c=n.charCodeAt(f),h=e.chars[c],p=0;void 0===h&&(c=32,h=e.chars[c]);var d=o&&h.kerning[o]?h.kerning[o]:0;if(s=/(\s)/.test(n.charAt(f))?f:s,p=(d+h.texture.width+h.xOffset)*t,u&&i+p>=u&&s>-1)return{width:i,text:n.substr(0,f-(f-s)),end:l,chars:a};i+=(h.xAdvance+d)*t,a.push(r+(h.xOffset+d)*t),r+=(h.xAdvance+d)*t,o=c}return{width:i,text:n,end:l,chars:a}},n.BitmapText.prototype.cleanText=function(e,t){void 0===t&&(t="");var n=this._data.font;if(!n)return"";for(var r=/\r\n|\n\r|\n|\r/g,i=e.replace(r,"\n").split("\n"),s=0;s<i.length;s++){for(var o="",u=i[s],a=0;a<u.length;a++)o=n.chars[u.charCodeAt(a)]?o.concat(u[a]):o.concat(t);i[s]=o}return i.join("\n")},n.BitmapText.prototype.updateText=function(){var e=this._data.font;if(e){var t=this.text,n=this._fontSize/e.size,r=[],i=0;this.textWidth=0;do{var s=this.scanLine(e,n,t);s.y=i,r.push(s),s.width>this.textWidth&&(this.textWidth=s.width),i+=e.lineHeight*n,t=t.substr(s.text.length+1)}while(s.end===!1);this.textHeight=i;for(var o=0,u=0,a=this.textWidth*this.anchor.x,f=this.textHeight*this.anchor.y,l=0;l<r.length;l++){var s=r[l];"right"===this._align?u=this.textWidth-s.width:"center"===this._align&&(u=(this.textWidth-s.width)/2);for(var c=0;c<s.text.length;c++){var h=s.text.charCodeAt(c),p=e.chars[h];void 0===p&&(h=32,p=e.chars[h]);var d=this._glyphs[o];d?d.texture=p.texture:(d=new PIXI.Sprite(p.texture),d.name=s.text[c],this._glyphs.push(d)),d.position.x=s.chars[c]+u-a,d.position.y=s.y+p.yOffset*n-f,d.scale.set(n),d.tint=this.tint,d.texture.requiresReTint=!0,d.parent||this.addChild(d),o++}}for(l=o;l<this._glyphs.length;l++)this.removeChild(this._glyphs[l])}},n.BitmapText.prototype.purgeGlyphs=function(){for(var e=this._glyphs.length,t=[],n=0;n<this._glyphs.length;n++)this._glyphs[n].parent!==this?this._glyphs[n].destroy():t.push(this._glyphs[n]);return this._glyphs=[],this._glyphs=t,this.updateText(),e-t.length},n.BitmapText.prototype.updateTransform=function(){(this.dirty||!this.anchor.equals(this._prevAnchor))&&(this.updateText(),this.dirty=!1,this._prevAnchor.copyFrom(this.anchor)),PIXI.DisplayObjectContainer.prototype.updateTransform.call(this)},Object.defineProperty(n.BitmapText.prototype,"align",{get:function(){return this._align},set:function(e){e===this._align||"left"!==e&&"center"!==e&&"right"!==e||(this._align=e,this.updateText())}}),Object.defineProperty(n.BitmapText.prototype,"tint",{get:function(){return this._tint},set:function(e){e!==this._tint&&(this._tint=e,this.updateText())}}),Object.defineProperty(n.BitmapText.prototype,"font",{get:function(){return this._font},set:function(e){e!==this._font&&(this._font=e.trim(),this._data=this.game.cache.getBitmapFont(this._font),this.updateText())}}),Object.defineProperty(n.BitmapText.prototype,"fontSize",{get:function(){return this._fontSize},set:function(e){e=parseInt(e,10),e!==this._fontSize&&e>0&&(this._fontSize=e,this.updateText())}}),Object.defineProperty(n.BitmapText.prototype,"text",{get:function(){return this._text},set:function(e){e!==this._text&&(this._text=e.toString()||"",this.updateText())}}),Object.defineProperty(n.BitmapText.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(e){e!==this._maxWidth&&(this._maxWidth=e,this.updateText())}}),Object.defineProperty(n.BitmapText.prototype,"smoothed",{get:function(){return!this._data.base.scaleMode},set:function(e){e?this._data.base.scaleMode=0:this._data.base.scaleMode=1}}),n.RetroFont=function(e,t,r,i,s,o,u,a,f,l){if(!e.cache.checkImageKey(t))return!1;(void 0===o||null===o)&&(o=e.cache.getImage(t).width/r),this.characterWidth=r,this.characterHeight=i,this.characterSpacingX=u||0,this.characterSpacingY=a||0,this.characterPerRow=o,this.offsetX=f||0,this.offsetY=l||0,this.align="left",this.multiLine=!1,this.autoUpperCase=!0,this.customSpacingX=0,this.customSpacingY=0,this.fixedWidth=0,this.fontSet=e.cache.getImage(t),this._text="",this.grabData=[],this.frameData=new n.FrameData;for(var c=this.offsetX,h=this.offsetY,p=0,d=0;d<s.length;d++){var v=this.frameData.addFrame(new n.Frame(d,c,h,this.characterWidth,this.characterHeight));this.grabData[s.charCodeAt(d)]=v.index,p++,p===this.characterPerRow?(p=0,c=this.offsetX,h+=this.characterHeight+this.characterSpacingY):c+=this.characterWidth+this.characterSpacingX}e.cache.updateFrameData(t,this.frameData),this.stamp=new n.Image(e,0,0,t,0),n.RenderTexture.call(this,e,100,100,"",n.scaleModes.NEAREST),this.type=n.RETROFONT},n.RetroFont.prototype=Object.create(n.RenderTexture.prototype),n.RetroFont.prototype.constructor=n.RetroFont,n.RetroFont.ALIGN_LEFT="left",n.RetroFont.ALIGN_RIGHT="right",n.RetroFont.ALIGN_CENTER="center",n.RetroFont.TEXT_SET1=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",n.RetroFont.TEXT_SET2=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ",n.RetroFont.TEXT_SET3="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ",n.RetroFont.TEXT_SET4="ABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789",n.RetroFont.TEXT_SET5="ABCDEFGHIJKLMNOPQRSTUVWXYZ.,/() '!?-*:0123456789",n.RetroFont.TEXT_SET6="ABCDEFGHIJKLMNOPQRSTUVWXYZ!?:;0123456789\"(),-.' ",n.RetroFont.TEXT_SET7="AGMSY+:4BHNTZ!;5CIOU.?06DJPV,(17EKQW\")28FLRX-'39",n.RetroFont.TEXT_SET8="0123456789 .ABCDEFGHIJKLMNOPQRSTUVWXYZ",n.RetroFont.TEXT_SET9="ABCDEFGHIJKLMNOPQRSTUVWXYZ()-0123456789.:,'\"?!",n.RetroFont.TEXT_SET10="ABCDEFGHIJKLMNOPQRSTUVWXYZ",n.RetroFont.TEXT_SET11="ABCDEFGHIJKLMNOPQRSTUVWXYZ.,\"-+!?()':;0123456789",n.RetroFont.prototype.setFixedWidth=function(e,t){void 0===t&&(t="left"),this.fixedWidth=e,this.align=t},n.RetroFont.prototype.setText=function(e,t,n,r,i,s){this.multiLine=t||!1,this.customSpacingX=n||0,this.customSpacingY=r||0,this.align=i||"left",s?this.autoUpperCase=!1:this.autoUpperCase=!0,e.length>0&&(this.text=e)},n.RetroFont.prototype.buildRetroFontText=function(){var e=0,t=0;if(this.clear(),this.multiLine){var r=this._text.split("\n");this.fixedWidth>0?this.resize(this.fixedWidth,r.length*(this.characterHeight+this.customSpacingY)-this.customSpacingY,!0):this.resize(this.getLongestLine()*(this.characterWidth+this.customSpacingX),r.length*(this.characterHeight+this.customSpacingY)-this.customSpacingY,!0);for(var i=0;i<r.length;i++)e=0,this.align===n.RetroFont.ALIGN_RIGHT?e=this.width-r[i].length*(this.characterWidth+this.customSpacingX):this.align===n.RetroFont.ALIGN_CENTER&&(e=this.width/2-r[i].length*(this.characterWidth+this.customSpacingX)/2,e+=this.customSpacingX/2),0>e&&(e=0),this.pasteLine(r[i],e,t,this.customSpacingX),t+=this.characterHeight+this.customSpacingY}else this.fixedWidth>0?this.resize(this.fixedWidth,this.characterHeight,!0):this.resize(this._text.length*(this.characterWidth+this.customSpacingX),this.characterHeight,!0),e=0,this.align===n.RetroFont.ALIGN_RIGHT?e=this.width-this._text.length*(this.characterWidth+this.customSpacingX):this.align===n.RetroFont.ALIGN_CENTER&&(e=this.width/2-this._text.length*(this.characterWidth+this.customSpacingX)/2,e+=this.customSpacingX/2),0>e&&(e=0),this.pasteLine(this._text,e,0,this.customSpacingX);this.requiresReTint=!0},n.RetroFont.prototype.pasteLine=function(e,t,n,r){for(var i=0;i<e.length;i++)if(" "===e.charAt(i))t+=this.characterWidth+r;else if(this.grabData[e.charCodeAt(i)]>=0&&(this.stamp.frame=this.grabData[e.charCodeAt(i)],this.renderXY(this.stamp,t,n,!1),t+=this.characterWidth+r,t>this.width))break},n.RetroFont.prototype.getLongestLine=function(){var e=0;if(this._text.length>0)for(var t=this._text.split("\n"),n=0;n<t.length;n++)t[n].length>e&&(e=t[n].length);return e},n.RetroFont.prototype.removeUnsupportedCharacters=function(e){for(var t="",n=0;n<this._text.length;n++){var r=this._text[n],i=r.charCodeAt(0);(this.grabData[i]>=0||!e&&"\n"===r)&&(t=t.concat(r))}return t},n.RetroFont.prototype.updateOffset=function(e,t){if(this.offsetX!==e||this.offsetY!==t){for(var n=e-this.offsetX,r=t-this.offsetY,i=this.game.cache.getFrameData(this.stamp.key).getFrames(),s=i.length;s--;)i[s].x+=n,i[s].y+=r;this.buildRetroFontText()}},Object.defineProperty(n.RetroFont.prototype,"text",{get:function(){return this._text},set:function(e){var t;t=this.autoUpperCase?e.toUpperCase():e,t!==this._text&&(this._text=t,this.removeUnsupportedCharacters(this.multiLine),this.buildRetroFontText())}}),Object.defineProperty(n.RetroFont.prototype,"smoothed",{get:function(){return this.stamp.smoothed},set:function(e){this.stamp.smoothed=e,this.buildRetroFontText()}}),n.Rope=function(e,t,r,i,s,o){this.points=[],this.points=o,this._hasUpdateAnimation=!1,this._updateAnimationCallback=null,t=t||0,r=r||0,i=i||null,s=s||null,this.type=n.ROPE,PIXI.Rope.call(this,PIXI.TextureCache.__default,this.points),n.Component.Core.init.call(this,e,t,r,i,s)},n.Rope.prototype=Object.create(PIXI.Rope.prototype),n.Rope.prototype.constructor=n.Rope,n.Component.Core.install.call(n.Rope.prototype,["Angle","Animation","AutoCull","Bounds","BringToTop","Crop","Delta","Destroy","FixedToCamera","InWorld","LifeSpan","LoadTexture","Overlap","PhysicsBody","Reset","ScaleMinMax","Smoothed"]),n.Rope.prototype.preUpdatePhysics=n.Component.PhysicsBody.preUpdate,n.Rope.prototype.preUpdateLifeSpan=n.Component.LifeSpan.preUpdate,n.Rope.prototype.preUpdateInWorld=n.Component.InWorld.preUpdate,n.Rope.prototype.preUpdateCore=n.Component.Core.preUpdate,n.Rope.prototype.preUpdate=function(){return this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld()?this.preUpdateCore():!1},n.Rope.prototype.update=function(){this._hasUpdateAnimation&&this.updateAnimation.call(this)},n.Rope.prototype.reset=function(e,t){return n.Component.Reset.prototype.reset.call(this,e,t),this},Object.defineProperty(n.Rope.prototype,"updateAnimation",{get:function(){return this._updateAnimation},set:function(e){e&&"function"==typeof e?(this._hasUpdateAnimation=!0,this._updateAnimation=e):(this._hasUpdateAnimation=!1,this._updateAnimation=null)}}),Object.defineProperty(n.Rope.prototype,"segments",{get:function(){for(var e,t,r,i,s,o,u,a,f=[],l=0;l<this.points.length;l++)e=4*l,t=this.vertices[e]*this.scale.x,r=this.vertices[e+1]*this.scale.y,i=this.vertices[e+4]*this.scale.x,s=this.vertices[e+3]*this.scale.y,o=n.Math.difference(t,i),u=n.Math.difference(r,s),t+=this.world.x,r+=this.world.y,a=new n.Rectangle(t,r,o,u),f.push(a);return f}}),n.TileSprite=function(e,t,r,i,s,o,u){t=t||0,r=r||0,i=i||256,s=s||256,o=o||null,u=u||null,this.type=n.TILESPRITE,this.physicsType=n.SPRITE,this._scroll=new n.Point;var a=e.cache.getImage("__default",!0);PIXI.TilingSprite.call(this,new PIXI.Texture(a.base),i,s),n.Component.Core.init.call(this,e,t,r,o,u)},n.TileSprite.prototype=Object.create(PIXI.TilingSprite.prototype),n.TileSprite.prototype.constructor=n.TileSprite,n.Component.Core.install.call(n.TileSprite.prototype,["Angle","Animation","AutoCull","Bounds","BringToTop","Destroy","FixedToCamera","Health","InCamera","InputEnabled","InWorld","LifeSpan","LoadTexture","Overlap","PhysicsBody","Reset","Smoothed"]),n.TileSprite.prototype.preUpdatePhysics=n.Component.PhysicsBody.preUpdate,n.TileSprite.prototype.preUpdateLifeSpan=n.Component.LifeSpan.preUpdate,n.TileSprite.prototype.preUpdateInWorld=n.Component.InWorld.preUpdate,n.TileSprite.prototype.preUpdateCore=n.Component.Core.preUpdate,n.TileSprite.prototype.preUpdate=function(){return 0!==this._scroll.x&&(this.tilePosition.x+=this._scroll.x*this.game.time.physicsElapsed),0!==this._scroll.y&&(this.tilePosition.y+=this._scroll.y*this.game.time.physicsElapsed),this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld()?this.preUpdateCore():!1},n.TileSprite.prototype.autoScroll=function(e,t){this._scroll.set(e,t)},n.TileSprite.prototype.stopScroll=function(){this._scroll.set(0,0)},n.TileSprite.prototype.destroy=function(e){n.Component.Destroy.prototype.destroy.call(this,e),PIXI.TilingSprite.prototype.destroy.call(this)},n.TileSprite.prototype.reset=function(e,t){return n.Component.Reset.prototype.reset.call(this,e,t),this.tilePosition.x=0,this.tilePosition.y=0,this},n.Device=function(){this.deviceReadyAt=0,this.initialized=!1,this.desktop=!1,this.iOS=!1,this.iOSVersion=0,this.cocoonJS=!1,this.cocoonJSApp=!1,this.cordova=!1,this.node=!1,this.nodeWebkit=!1,this.electron=!1,this.ejecta=!1,this.crosswalk=!1,this.android=!1,this.chromeOS=!1,this.linux=!1,this.macOS=!1,this.windows=!1,this.windowsPhone=!1,this.canvas=!1,this.canvasBitBltShift=null,this.webGL=!1,this.file=!1,this.fileSystem=!1,this.localStorage=!1,this.worker=!1,this.css3D=!1,this.pointerLock=!1,this.typedArray=!1,this.vibration=!1,this.getUserMedia=!0,this.quirksMode=!1,this.touch=!1,this.mspointer=!1,this.wheelEvent=null,this.arora=!1,this.chrome=!1,this.chromeVersion=0,this.epiphany=!1,this.firefox=!1,this.firefoxVersion=0,this.ie=!1,this.ieVersion=0,this.trident=!1,this.tridentVersion=0,this.edge=!1,this.mobileSafari=!1,this.midori=!1,this.opera=!1,this.safari=!1,this.safariVersion=0,this.webApp=!1,this.silk=!1,this.audioData=!1,this.webAudio=!1,this.ogg=!1,this.opus=!1,this.mp3=!1,this.wav=!1,this.m4a=!1,this.webm=!1,this.dolby=!1,this.oggVideo=!1,this.h264Video=!1,this.mp4Video=!1,this.webmVideo=!1,this.vp9Video=!1,this.hlsVideo=!1,this.iPhone=!1,this.iPhone4=!1,this.iPad=!1,this.pixelRatio=0,this.littleEndian=!1,this.LITTLE_ENDIAN=!1,this.support32bit=!1,this.fullscreen=!1,this.requestFullscreen="",this.cancelFullscreen="",this.fullscreenKeyboard=!1},n.Device=new n.Device,n.Device.onInitialized=new n.Signal,n.Device.whenReady=function(e,t,n){var r=this._readyCheck;if(this.deviceReadyAt||!r)e.call(t,this);else if(r._monitor||n)r._queue=r._queue||[],r._queue.push([e,t]);else{r._monitor=r.bind(this),r._queue=r._queue||[],r._queue.push([e,t]);var i="undefined"!=typeof window.cordova,s=navigator.isCocoonJS;"complete"===document.readyState||"interactive"===document.readyState?window.setTimeout(r._monitor,0):i&&!s?document.addEventListener("deviceready",r._monitor,!1):(document.addEventListener("DOMContentLoaded",r._monitor,!1),window.addEventListener("load",r._monitor,!1))}},n.Device._readyCheck=function(){var e=this._readyCheck;if(document.body){if(!this.deviceReadyAt){this.deviceReadyAt=Date.now(),document.removeEventListener("deviceready",e._monitor),document.removeEventListener("DOMContentLoaded",e._monitor),window.removeEventListener("load",e._monitor),this._initialize(),this.initialized=!0,this.onInitialized.dispatch(this);for(var t;t=e._queue.shift();){var n=t[0],r=t[1];n.call(r,this)}this._readyCheck=null,this._initialize=null,this.onInitialized=null}}else window.setTimeout(e._monitor,20)},n.Device._initialize=function(){function e(){var e=navigator.userAgent;/Playstation Vita/.test(e)?c.vita=!0:/Kindle/.test(e)||/\bKF[A-Z][A-Z]+/.test(e)||/Silk.*Mobile Safari/.test(e)?c.kindle=!0:/Android/.test(e)?c.android=!0:/CrOS/.test(e)?c.chromeOS=!0:/iP[ao]d|iPhone/i.test(e)?(c.iOS=!0,navigator.appVersion.match(/OS (\d+)/),c.iOSVersion=parseInt(RegExp.$1,10)):/Linux/.test(e)?c.linux=!0:/Mac OS/.test(e)?c.macOS=!0:/Windows/.test(e)&&(c.windows=!0),(/Windows Phone/i.test(e)||/IEMobile/i.test(e))&&(c.android=!1,c.iOS=!1,c.macOS=!1,c.windows=!0,c.windowsPhone=!0);var t=/Silk/.test(e);(c.windows||c.macOS||c.linux&&!t||c.chromeOS)&&(c.desktop=!0),(c.windowsPhone||/Windows NT/i.test(e)&&/Touch/i.test(e))&&(c.desktop=!1)}function t(){c.canvas=!!window.CanvasRenderingContext2D||c.cocoonJS;try{c.localStorage=!!localStorage.getItem}catch(e){c.localStorage=!1}c.file=!!(window.File&&window.FileReader&&window.FileList&&window.Blob),c.fileSystem=!!window.requestFileSystem,c.webGL=function(){try{var e=document.createElement("canvas");return e.screencanvas=!1,!!window.WebGLRenderingContext&&(e.getContext("webgl")||e.getContext("experimental-webgl"))}catch(t){return!1}}(),c.webGL=!!c.webGL,c.worker=!!window.Worker,c.pointerLock="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document,c.quirksMode="CSS1Compat"===document.compatMode?!1:!0,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia,window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,c.getUserMedia=c.getUserMedia&&!!navigator.getUserMedia&&!!window.URL,c.firefox&&c.firefoxVersion<21&&(c.getUserMedia=!1),!c.iOS&&(c.ie||c.firefox||c.chrome)&&(c.canvasBitBltShift=!0),(c.safari||c.mobileSafari)&&(c.canvasBitBltShift=!1)}function n(){("ontouchstart"in document.documentElement||window.navigator.maxTouchPoints&&window.navigator.maxTouchPoints>=1)&&(c.touch=!0),(window.navigator.msPointerEnabled||window.navigator.pointerEnabled)&&(c.mspointer=!0),c.cocoonJS||("onwheel"in window||c.ie&&"WheelEvent"in window?c.wheelEvent="wheel":"onmousewheel"in window?c.wheelEvent="mousewheel":c.firefox&&"MouseScrollEvent"in window&&(c.wheelEvent="DOMMouseScroll"))}function r(){for(var e=["requestFullscreen","requestFullScreen","webkitRequestFullscreen","webkitRequestFullScreen","msRequestFullscreen","msRequestFullScreen","mozRequestFullScreen","mozRequestFullscreen"],t=document.createElement("div"),n=0;n<e.length;n++)if(t[e[n]]){c.fullscreen=!0,c.requestFullscreen=e[n];break}var r=["cancelFullScreen","exitFullscreen","webkitCancelFullScreen","webkitExitFullscreen","msCancelFullScreen","msExitFullscreen","mozCancelFullScreen","mozExitFullscreen"];if(c.fullscreen)for(var n=0;n<r.length;n++)if(document[r[n]]){c.cancelFullscreen=r[n];break}window.Element&&Element.ALLOW_KEYBOARD_INPUT&&(c.fullscreenKeyboard=!0)}function i(){var e=navigator.userAgent;if(/Arora/.test(e)?c.arora=!0:/Edge\/\d+/.test(e)?c.edge=!0:/Chrome\/(\d+)/.test(e)&&!c.windowsPhone?(c.chrome=!0,c.chromeVersion=parseInt(RegExp.$1,10)):/Epiphany/.test(e)?c.epiphany=!0:/Firefox\D+(\d+)/.test(e)?(c.firefox=!0,c.firefoxVersion=parseInt(RegExp.$1,10)):/AppleWebKit/.test(e)&&c.iOS?c.mobileSafari=!0:/MSIE (\d+\.\d+);/.test(e)?(c.ie=!0,c.ieVersion=parseInt(RegExp.$1,10)):/Midori/.test(e)?c.midori=!0:/Opera/.test(e)?c.opera=!0:/Safari\/(\d+)/.test(e)&&!c.windowsPhone?(c.safari=!0,/Version\/(\d+)\./.test(e)&&(c.safariVersion=parseInt(RegExp.$1,10))):/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(e)&&(c.ie=!0,c.trident=!0,c.tridentVersion=parseInt(RegExp.$1,10),c.ieVersion=parseInt(RegExp.$3,10)),/Silk/.test(e)&&(c.silk=!0),navigator.standalone&&(c.webApp=!0),"undefined"!=typeof window.cordova&&(c.cordova=!0),"undefined"!=typeof process&&"undefined"!=typeof require&&(c.node=!0),c.node&&"object"==typeof process.versions&&(c.nodeWebkit=!!process.versions["node-webkit"],c.electron=!!process.versions.electron),navigator.isCocoonJS&&(c.cocoonJS=!0),c.cocoonJS)try{c.cocoonJSApp="undefined"!=typeof CocoonJS}catch(t){c.cocoonJSApp=!1}"undefined"!=typeof window.ejecta&&(c.ejecta=!0),/Crosswalk/.test(e)&&(c.crosswalk=!0)}function s(){var e=document.createElement("video"),t=!1;try{(t=!!e.canPlayType)&&(e.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,"")&&(c.oggVideo=!0),e.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,"")&&(c.h264Video=!0,c.mp4Video=!0),e.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,"")&&(c.webmVideo=!0),e.canPlayType('video/webm; codecs="vp9"').replace(/^no$/,"")&&(c.vp9Video=!0),e.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(/^no$/,"")&&(c.hlsVideo=!0))}catch(n){}}function o(){c.audioData=!!window.Audio,c.webAudio=!!window.AudioContext||!!window.webkitAudioContext;var e=document.createElement("audio"),t=!1;try{if((t=!!e.canPlayType)&&(e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")&&(c.ogg=!0),(e.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,"")||e.canPlayType("audio/opus;").replace(/^no$/,""))&&(c.opus=!0),e.canPlayType("audio/mpeg;").replace(/^no$/,"")&&(c.mp3=!0),e.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"")&&(c.wav=!0),(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/aac;").replace(/^no$/,""))&&(c.m4a=!0),e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")&&(c.webm=!0),""!==e.canPlayType('audio/mp4;codecs="ec-3"')))if(c.edge)c.dolby=!0;else if(c.safari&&c.safariVersion>=9&&/Mac OS X (\d+)_(\d+)/.test(navigator.userAgent)){var n=parseInt(RegExp.$1,10),r=parseInt(RegExp.$2,10);(10===n&&r>=11||n>10)&&(c.dolby=!0)}}catch(i){}}function u(){c.pixelRatio=window.devicePixelRatio||1,c.iPhone=-1!=navigator.userAgent.toLowerCase().indexOf("iphone"),c.iPhone4=2==c.pixelRatio&&c.iPhone,c.iPad=-1!=navigator.userAgent.toLowerCase().indexOf("ipad"),"undefined"!=typeof Int8Array?c.typedArray=!0:c.typedArray=!1,"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint32Array&&(c.littleEndian=a(),c.LITTLE_ENDIAN=c.littleEndian),c.support32bit="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof Int32Array&&null!==c.littleEndian&&f(),navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate,navigator.vibrate&&(c.vibration=!0)}function a(){var e=new ArrayBuffer(4),t=new Uint8Array(e),n=new Uint32Array(e);return t[0]=161,t[1]=178,t[2]=195,t[3]=212,3569595041==n[0]?!0:2712847316==n[0]?!1:null}function f(){if(void 0===Uint8ClampedArray)return!1;var e=PIXI.CanvasPool.create(this,1,1),t=e.getContext("2d");if(!t)return!1;var n=t.createImageData(1,1);return PIXI.CanvasPool.remove(this),n.data instanceof Uint8ClampedArray}function l(){var e,t=document.createElement("p"),n={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(t,null);for(var r in n)void 0!==t.style[r]&&(t.style[r]="translate3d(1px,1px,1px)",e=window.getComputedStyle(t).getPropertyValue(n[r]));document.body.removeChild(t),c.css3D=void 0!==e&&e.length>0&&"none"!==e}var c=this;e(),i(),o(),s(),l(),u(),t(),r(),n()},n.Device.canPlayAudio=function(e){return"mp3"===e&&this.mp3?!0:"ogg"===e&&(this.ogg||this.opus)?!0:"m4a"===e&&this.m4a?!0:"opus"===e&&this.opus?!0:"wav"===e&&this.wav?!0:"webm"===e&&this.webm?!0:"mp4"===e&&this.dolby?!0:!1},n.Device.canPlayVideo=function(e){return"webm"===e&&(this.webmVideo||this.vp9Video)?!0:"mp4"===e&&(this.mp4Video||this.h264Video)?!0:"ogg"!==e&&"ogv"!==e||!this.oggVideo?"mpeg"===e&&this.hlsVideo?!0:!1:!0},n.Device.isConsoleOpen=function(){return window.console&&window.console.firebug?!0:window.console&&(console.profile(),console.profileEnd(),console.clear&&console.clear(),console.profiles)?console.profiles.length>0:!1},n.Device.isAndroidStockBrowser=function(){var e=window.navigator.userAgent.match(/Android.*AppleWebKit\/([\d.]+)/);return e&&e[1]<537},n.Canvas={create:function(e,t,n,r,i){if(t=t||256,n=n||256,void 0===i)var s=PIXI.CanvasPool.create(e,t,n);else var s=document.createElement("canvas");return"string"==typeof r&&""!==r&&(s.id=r),s.width=t,s.height=n,s.style.display="block",s},setBackgroundColor:function(e,t){return t=t||"rgb(0,0,0)",e.style.backgroundColor=t,e},setTouchAction:function(e,t){return t=t||"none",e.style.msTouchAction=t,e.style["ms-touch-action"]=t,e.style["touch-action"]=t,e},setUserSelect:function(e,t){return t=t||"none",e.style["-webkit-touch-callout"]=t,e.style["-webkit-user-select"]=t,e.style["-khtml-user-select"]=t,e.style["-moz-user-select"]=t,e.style["-ms-user-select"]=t,e.style["user-select"]=t,e.style["-webkit-tap-highlight-color"]="rgba(0, 0, 0, 0)",e},addToDOM:function(e,t,n){var r;return void 0===n&&(n=!0),t&&("string"==typeof t?r=document.getElementById(t):"object"==typeof t&&1===t.nodeType&&(r=t)),r||(r=document.body),n&&r.style&&(r.style.overflow="hidden"),r.appendChild(e),e},removeFromDOM:function(e){e.parentNode&&e.parentNode.removeChild(e)},setTransform:function(e,t,n,r,i,s,o){return e.setTransform(r,s,o,i,t,n),e},setSmoothingEnabled:function(e,t){var r=n.Canvas.getSmoothingPrefix(e);return r&&(e[r]=t),e},getSmoothingPrefix:function(e){var t=["i","webkitI","msI","mozI","oI"];for(var n in t){var r=t[n]+"mageSmoothingEnabled";if(r in e)return r}return null},getSmoothingEnabled:function(e){var t=n.Canvas.getSmoothingPrefix(e);return t?e[t]:void 0},setImageRenderingCrisp:function(e){for(var t=["optimizeSpeed","crisp-edges","-moz-crisp-edges","-webkit-optimize-contrast","optimize-contrast","pixelated"],n=0;n<t.length;n++)e.style["image-rendering"]=t[n];return e.style.msInterpolationMode="nearest-neighbor",e},setImageRenderingBicubic:function(e){return e.style["image-rendering"]="auto",e.style.msInterpolationMode="bicubic",e}},n.RequestAnimationFrame=function(e,t){void 0===t&&(t=!1),this.game=e,this.isRunning=!1,this.forceSetTimeOut=t;for(var n=["ms","moz","webkit","o"],r=0;r<n.length&&!window.requestAnimationFrame;r++)window.requestAnimationFrame=window[n[r]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[n[r]+"CancelAnimationFrame"];this._isSetTimeOut=!1,this._onLoop=null,this._timeOutID=null},n.RequestAnimationFrame.prototype={start:function(){this.isRunning=!0;var e=this;!window.requestAnimationFrame||this.forceSetTimeOut?(this._isSetTimeOut=!0,this._onLoop=function(){return e.updateSetTimeout()},this._timeOutID=window.setTimeout(this._onLoop,0)):(this._isSetTimeOut=!1,this._onLoop=function(t){return e.updateRAF(t)},this._timeOutID=window.requestAnimationFrame(this._onLoop))},updateRAF:function(e){this.game.update(Math.floor(e)),this._timeOutID=window.requestAnimationFrame(this._onLoop)},updateSetTimeout:function(){this.game.update(Date.now()),this._timeOutID=window.setTimeout(this._onLoop,this.game.time.timeToCall)},stop:function(){this._isSetTimeOut?clearTimeout(this._timeOutID):window.cancelAnimationFrame(this._timeOutID),this.isRunning=!1},isSetTimeOut:function(){return this._isSetTimeOut},isRAF:function(){return this._isSetTimeOut===!1}},n.RequestAnimationFrame.prototype.constructor=n.RequestAnimationFrame,n.Math={PI2:2*Math.PI,fuzzyEqual:function(e,t,n){return void 0===n&&(n=1e-4),Math.abs(e-t)<n},fuzzyLessThan:function(e,t,n){return void 0===n&&(n=1e-4),t+n>e},fuzzyGreaterThan:function(e,t,n){return void 0===n&&(n=1e-4),e>t-n},fuzzyCeil:function(e,t){return void 0===t&&(t=1e-4),Math.ceil(e-t)},fuzzyFloor:function(e,t){return void 0===t&&(t=1e-4),Math.floor(e+t)},average:function(){for(var e=0,t=arguments.length,n=0;t>n;n++)e+=+arguments[n];return e/t},shear:function(e){return e%1},snapTo:function(e,t,n){return void 0===n&&(n=0),0===t?e:(e-=n,e=t*Math.round(e/t),n+e)},snapToFloor:function(e,t,n){return void 0===n&&(n=0),0===t?e:(e-=n,e=t*Math.floor(e/t),n+e)},snapToCeil:function(e,t,n){return void 0===n&&(n=0),0===t?e:(e-=n,e=t*Math.ceil(e/t),n+e)},roundTo:function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=10);var r=Math.pow(n,-t);return Math.round(e*r)/r},floorTo:function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=10);var r=Math.pow(n,-t);return Math.floor(e*r)/r},ceilTo:function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=10);var r=Math.pow(n,-t);return Math.ceil(e*r)/r},angleBetween:function(e,t,n,r){return Math.atan2(r-t,n-e)},angleBetweenY:function(e,t,n,r){return Math.atan2(n-e,r-t)},angleBetweenPoints:function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)},angleBetweenPointsY:function(e,t){return Math.atan2(t.x-e.x,t.y-e.y)},reverseAngle:function(e){return this.normalizeAngle(e+Math.PI,!0)},normalizeAngle:function(e){return e%=2*Math.PI,e>=0?e:e+2*Math.PI},maxAdd:function(e,t,n){return Math.min(e+t,n)},minSub:function(e,t,n){return Math.max(e-t,n)},wrap:function(e,t,n){var r=n-t;if(0>=r)return 0;var i=(e-t)%r;return 0>i&&(i+=r),i+t},wrapValue:function(e,t,n){var r;return e=Math.abs(e),t=Math.abs(t),n=Math.abs(n),r=(e+t)%n},isOdd:function(e){return!!(1&e)},isEven:function(e){return!(1&e)},min:function(){if(1===arguments.length&&"object"==typeof arguments[0])var e=arguments[0];else var e=arguments;for(var t=1,n=0,r=e.length;r>t;t++)e[t]<e[n]&&(n=t);return e[n]},max:function(){if(1===arguments.length&&"object"==typeof arguments[0])var e=arguments[0];else var e=arguments;for(var t=1,n=0,r=e.length;r>t;t++)e[t]>e[n]&&(n=t);return e[n]},minProperty:function(e){if(2===arguments.length&&"object"==typeof arguments[1])var t=arguments[1];else var t=arguments.slice(1);for(var n=1,r=0,i=t.length;i>n;n++)t[n][e]<t[r][e]&&(r=n);return t[r][e]},maxProperty:function(e){if(2===arguments.length&&"object"==typeof arguments[1])var t=arguments[1];else var t=arguments.slice(1);for(var n=1,r=0,i=t.length;i>n;n++)t[n][e]>t[r][e]&&(r=n);return t[r][e]},wrapAngle:function(e,t){return t?this.wrap(e,-Math.PI,Math.PI):this.wrap(e,-180,180)},linearInterpolation:function(e,t){var n=e.length-1,r=n*t,i=Math.floor(r);return 0>t?this.linear(e[0],e[1],r):t>1?this.linear(e[n],e[n-1],n-r):this.linear(e[i],e[i+1>n?n:i+1],r-i)},bezierInterpolation:function(e,t){for(var n=0,r=e.length-1,i=0;r>=i;i++)n+=Math.pow(1-t,r-i)*Math.pow(t,i)*e[i]*this.bernstein(r,i);return n},catmullRomInterpolation:function(e,t){var n=e.length-1,r=n*t,i=Math.floor(r);return e[0]===e[n]?(0>t&&(i=Math.floor(r=n*(1+t))),this.catmullRom(e[(i-1+n)%n],e[i],e[(i+1)%n],e[(i+2)%n],r-i)):0>t?e[0]-(this.catmullRom(e[0],e[0],e[1],e[1],-r)-e[0]):t>1?e[n]-(this.catmullRom(e[n],e[n],e[n-1],e[n-1],r-n)-e[n]):this.catmullRom(e[i?i-1:0],e[i],e[i+1>n?n:i+1],e[i+2>n?n:i+2],r-i)},linear:function(e,t,n){return(t-e)*n+e},bernstein:function(e,t){return this.factorial(e)/this.factorial(t)/this.factorial(e-t)},factorial:function(e){if(0===e)return 1;for(var t=e;--e;)t*=e;return t},catmullRom:function(e,t,n,r,i){var s=.5*(n-e),o=.5*(r-t),u=i*i,a=i*u;return(2*t-2*n+s+o)*a+(-3*t+3*n-2*s-o)*u+s*i+t},difference:function(e,t){return Math.abs(e-t)},roundAwayFromZero:function(e){return e>0?Math.ceil(e):Math.floor(e)},sinCosGenerator:function(e,t,n,r){void 0===t&&(t=1),void 0===n&&(n=1),void 0===r&&(r=1);for(var i=t,s=n,o=r*Math.PI/e,u=[],a=[],f=0;e>f;f++)s-=i*o,i+=s*o,u[f]=s,a[f]=i;return{sin:a,cos:u,length:e}},distance:function(e,t,n,r){var i=e-n,s=t-r;return Math.sqrt(i*i+s*s)},distanceSq:function(e,t,n,r){var i=e-n,s=t-r;return i*i+s*s},distancePow:function(e,t,n,r,i){return void 0===i&&(i=2),Math.sqrt(Math.pow(n-e,i)+Math.pow(r-t,i))},clamp:function(e,t,n){return t>e?t:e>n?n:e},clampBottom:function(e,t){return t>e?t:e},within:function(e,t,n){return Math.abs(e-t)<=n},mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},smoothstep:function(e,t,n){return e=Math.max(0,Math.min(1,(e-t)/(n-t))),e*e*(3-2*e)},smootherstep:function(e,t,n){return e=Math.max(0,Math.min(1,(e-t)/(n-t))),e*e*e*(e*(6*e-15)+10)},sign:function(e){return 0>e?-1:e>0?1:0},percent:function(e,t,n){return void 0===n&&(n=0),e>t||n>t?1:n>e||n>e?0:(e-n)/t}};var l=Math.PI/180,c=180/Math.PI;return n.Math.degToRad=function(e){return e*l},n.Math.radToDeg=function(e){return e*c},n.RandomDataGenerator=function(e){void 0===e&&(e=[]),this.c=1,this.s0=0,this.s1=0,this.s2=0,"string"==typeof e?this.state(e):this.sow(e)},n.RandomDataGenerator.prototype={rnd:function(){var e=2091639*this.s0+2.3283064365386963e-10*this.c;return this.c=0|e,this.s0=this.s1,this.s1=this.s2,this.s2=e-this.c,this.s2},sow:function(e){if(this.s0=this.hash(" "),this.s1=this.hash(this.s0),this.s2=this.hash(this.s1),this.c=1,e)for(var t=0;t<e.length&&null!=e[t];t++){var n=e[t];this.s0-=this.hash(n),this.s0+=~~(this.s0<0),this.s1-=this.hash(n),this.s1+=~~(this.s1<0),this.s2-=this.hash(n),this.s2+=~~(this.s2<0)}},hash:function(e){var t,n,r;for(r=4022871197,e=e.toString(),n=0;n<e.length;n++)r+=e.charCodeAt(n),t=.02519603282416938*r,r=t>>>0,t-=r,t*=r,r=t>>>0,t-=r,r+=4294967296*t;return 2.3283064365386963e-10*(r>>>0)},integer:function(){return 4294967296*this.rnd.apply(this)},frac:function(){return this.rnd.apply(this)+1.1102230246251565e-16*(2097152*this.rnd.apply(this)|0)},real:function(){return this.integer()+this.frac()},integerInRange:function(e,t){return Math.floor(this.realInRange(0,t-e+1)+e)},between:function(e,t){return this.integerInRange(e,t)},realInRange:function(e,t){return this.frac()*(t-e)+e},normal:function(){return 1-2*this.frac()},uuid:function(){var e="",t="";for(t=e="";e++<36;t+=~e%5|3*e&4?(15^e?8^this.frac()*(20^e?16:4):4).toString(16):"-");return t},pick:function(e){return e[this.integerInRange(0,e.length-1)]},sign:function(){return this.pick([-1,1])},weightedPick:function(e){return e[~~(Math.pow(this.frac(),2)*(e.length-1)+.5)]},timestamp:function(e,t){return this.realInRange(e||9466848e5,t||1577862e6)},angle:function(){return this.integerInRange(-180,180)},state:function(e){return"string"==typeof e&&e.match(/^!rnd/)&&(e=e.split(","),this.c=parseFloat(e[1]),this.s0=parseFloat(e[2]),this.s1=parseFloat(e[3]),this.s2=parseFloat(e[4])),["!rnd",this.c,this.s0,this.s1,this.s2].join(",")}},n.RandomDataGenerator.prototype.constructor=n.RandomDataGenerator,n.QuadTree=function(e,t,n,r,i,s,o){this.maxObjects=10,this.maxLevels=4,this.level=0,this.bounds={},this.objects=[],this.nodes=[],this._empty=[],this.reset(e,t,n,r,i,s,o)},n.QuadTree.prototype={reset:function(e,t,n,r,i,s,o){this.maxObjects=i||10,this.maxLevels=s||4,this.level=o||0,this.bounds={x:Math.round(e),y:Math.round(t),width:n,height:r,subWidth:Math.floor(n/2),subHeight:Math.floor(r/2),right:Math.round(e)+Math.floor(n/2),bottom:Math.round(t)+Math.floor(r/2)},this.objects.length=0,this.nodes.length=0},populate:function(e){e.forEach(this.populateHandler,this,!0)},populateHandler:function(e){e.body&&e.exists&&this.insert(e.body)},split:function(){this.nodes[0]=new n.QuadTree(this.bounds.right,this.bounds.y,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1),this.nodes[1]=new n.QuadTree(this.bounds.x,this.bounds.y,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1),this.nodes[2]=new n.QuadTree(this.bounds.x,this.bounds.bottom,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1),this.nodes[3]=new n.QuadTree(this.bounds.right,this.bounds.bottom,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1)},insert:function(e){var t,n=0;if(null!=this.nodes[0]&&(t=this.getIndex(e),-1!==t))return void this.nodes[t].insert(e);if(this.objects.push(e),this.objects.length>this.maxObjects&&this.level<this.maxLevels)for(null==this.nodes[0]&&this.split();n<this.objects.length;)t=this.getIndex(this.objects[n]),-1!==t?this.nodes[t].insert(this.objects.splice(n,1)[0]):n++},getIndex:function(e){var t=-1;return e.x<this.bounds.right&&e.right<this.bounds.right?e.y<this.bounds.bottom&&e.bottom<this.bounds.bottom?t=1:e.y>this.bounds.bottom&&(t=2):e.x>this.bounds.right&&(e.y<this.bounds.bottom&&e.bottom<this.bounds.bottom?t=0:e.y>this.bounds.bottom&&(t=3)),t},retrieve:function(e){if(e instanceof n.Rectangle)var t=this.objects,r=this.getIndex(e);else{if(!e.body)return this._empty;var t=this.objects,r=this.getIndex(e.body)}return this.nodes[0]&&(-1!==r?t=t.concat(this.nodes[r].retrieve(e)):(t=t.concat(this.nodes[0].retrieve(e)),t=t.concat(this.nodes[1].retrieve(e)),t=t.concat(this.nodes[2].retrieve(e)),t=t.concat(this.nodes[3].retrieve(e)))),t},clear:function(){this.objects.length=0;for(var e=this.nodes.length;e--;)this.nodes[e].clear(),this.nodes.splice(e,1);this.nodes.length=0}},n.QuadTree.prototype.constructor=n.QuadTree,n.Net=function(e){this.game=e},n.Net.prototype={getHostName:function(){return window.location&&window.location.hostname?window.location.hostname:null},checkDomainName:function(e){return-1!==window.location.hostname.indexOf(e)},updateQueryString:function(e,t,n,r){void 0===n&&(n=!1),(void 0===r||""===r)&&(r=window.location.href);var i="",s=new RegExp("([?|&])"+e+"=.*?(&|#|$)(.*)","gi");if(s.test(r))i="undefined"!=typeof t&&null!==t?r.replace(s,"$1"+e+"="+t+"$2$3"):r.replace(s,"$1$3").replace(/(&|\?)$/,"");else if("undefined"!=typeof t&&null!==t){var o=-1!==r.indexOf("?")?"&":"?",u=r.split("#");r=u[0]+o+e+"="+t,u[1]&&(r+="#"+u[1]),i=r}else i=r;return n?void (window.location.href=i):i},getQueryString:function(e){void 0===e&&(e="");var t={},n=location.search.substring(1).split("&");for(var r in n){var i=n[r].split("=");if(i.length>1){if(e&&e==this.decodeURI(i[0]))return this.decodeURI(i[1]);t[this.decodeURI(i[0])]=this.decodeURI(i[1])}}return t},decodeURI:function(e){return decodeURIComponent(e.replace(/\+/g," "))}},n.Net.prototype.constructor=n.Net,n.TweenManager=function(e){this.game=e,this.frameBased=!1,this._tweens=[],this._add=[],this.easeMap={Power0:n.Easing.Power0,Power1:n.Easing.Power1,Power2:n.Easing.Power2,Power3:n.Easing.Power3,Power4:n.Easing.Power4,Linear:n.Easing.Linear.None,Quad:n.Easing.Quadratic.Out,Cubic:n.Easing.Cubic.Out,Quart:n.Easing.Quartic.Out,Quint:n.Easing.Quintic.Out,Sine:n.Easing.Sinusoidal.Out,Expo:n.Easing.Exponential.Out,Circ:n.Easing.Circular.Out,Elastic:n.Easing.Elastic.Out,Back:n.Easing.Back.Out,Bounce:n.Easing.Bounce.Out,"Quad.easeIn":n.Easing.Quadratic.In,"Cubic.easeIn":n.Easing.Cubic.In,"Quart.easeIn":n.Easing.Quartic.In,"Quint.easeIn":n.Easing.Quintic.In,"Sine.easeIn":n.Easing.Sinusoidal.In,"Expo.easeIn":n.Easing.Exponential.In,"Circ.easeIn":n.Easing.Circular.In,"Elastic.easeIn":n.Easing.Elastic.In,"Back.easeIn":n.Easing.Back.In,"Bounce.easeIn":n.Easing.Bounce.In,"Quad.easeOut":n.Easing.Quadratic.Out,"Cubic.easeOut":n.Easing.Cubic.Out,"Quart.easeOut":n.Easing.Quartic.Out,"Quint.easeOut":n.Easing.Quintic.Out,"Sine.easeOut":n.Easing.Sinusoidal.Out,"Expo.easeOut":n.Easing.Exponential.Out,"Circ.easeOut":n.Easing.Circular.Out,"Elastic.easeOut":n.Easing.Elastic.Out,"Back.easeOut":n.Easing.Back.Out,"Bounce.easeOut":n.Easing.Bounce.Out,"Quad.easeInOut":n.Easing.Quadratic.InOut,"Cubic.easeInOut":n.Easing.Cubic.InOut,"Quart.easeInOut":n.Easing.Quartic.InOut,"Quint.easeInOut":n.Easing.Quintic.InOut,"Sine.easeInOut":n.Easing.Sinusoidal.InOut,"Expo.easeInOut":n.Easing.Exponential.InOut,"Circ.easeInOut":n.Easing.Circular.InOut,"Elastic.easeInOut":n.Easing.Elastic.InOut,"Back.easeInOut":n.Easing.Back.InOut,"Bounce.easeInOut":n.Easing.Bounce.InOut},this.game.onPause.add(this._pauseAll,this),this.game.onResume.add(this._resumeAll,this)},n.TweenManager.prototype={getAll:function(){return this._tweens},removeAll:function(){for(var e=0;e<this._tweens.length;e++)this._tweens[e].pendingDelete=!0;this._add=[]},removeFrom:function(e,t){void 0===t&&(t=!0);var r,i;if(Array.isArray(e))for(r=0,i=e.length;i>r;r++)this.removeFrom(e[r]);else if(e.type===n.GROUP&&t)for(var r=0,i=e.children.length;i>r;r++)this.removeFrom(e.children[r]);else{for(r=0,i=this._tweens.length;i>r;r++)e===this._tweens[r].target&&this.remove(this._tweens[r]);for(r=0,i=this._add.length;i>r;r++)e===this._add[r].target&&this.remove(this._add[r])}},add:function(e){e._manager=this,this._add.push(e)},create:function(e){return new n.Tween(e,this.game,this)},remove:function(e){var t=this._tweens.indexOf(e);-1!==t?this._tweens[t].pendingDelete=!0:(t=this._add.indexOf(e),-1!==t&&(this._add[t].pendingDelete=!0))},update:function(){var e=this._add.length,t=this._tweens.length;if(0===t&&0===e)return!1;for(var n=0;t>n;)this._tweens[n].update(this.game.time.time)?n++:(this._tweens.splice(n,1),t--);return e>0&&(this._tweens=this._tweens.concat(this._add),this._add.length=0),!0},isTweening:function(e){return this._tweens.some(function(t){return t.target===e})},_pauseAll:function(){for(var e=this._tweens.length-1;e>=0;e--)this._tweens[e]._pause()},_resumeAll:function(){for(var e=this._tweens.length-1;e>=0;e--)this._tweens[e]._resume()},pauseAll:function(){for(var e=this._tweens.length-1;e>=0;e--)this._tweens[e].pause()},resumeAll:function(){for(var e=this._tweens.length-1;e>=0;e--)this._tweens[e].resume(!0)}},n.TweenManager.prototype.constructor=n.TweenManager,n.Tween=function(e,t,r){this.game=t,this.target=e,this.manager=r,this.timeline=[],this.reverse=!1,this.timeScale=1,this.repeatCounter=0,this.pendingDelete=!1,this.onStart=new n.Signal,this.onLoop=new n.Signal,this.onRepeat=new n.Signal,this.onChildComplete=new n.Signal,this.onComplete=new n.Signal,this.isRunning=!1,this.current=0,this.properties={},this.chainedTween=null,this.isPaused=!1,this.frameBased=r.frameBased,this._onUpdateCallback=null,this._onUpdateCallbackContext=null,this._pausedTime=0,this._codePaused=!1,this._hasStarted=!1},n.Tween.prototype={to:function(e,t,r,i,s,o,u){return(void 0===t||0>=t)&&(t=1e3),(void 0===r||null===r)&&(r=n.Easing.Default),void 0===i&&(i=!1),void 0===s&&(s=0),void 0===o&&(o=0),void 0===u&&(u=!1),"string"==typeof r&&this.manager.easeMap[r]&&(r=this.manager.easeMap[r]),this.isRunning?(console.warn("Phaser.Tween.to cannot be called after Tween.start"),this):(this.timeline.push((new n.TweenData(this)).to(e,t,r,s,o,u)),i&&this.start(),this)},from:function(e,t,r,i,s,o,u){return void 0===t&&(t=1e3),(void 0===r||null===r)&&(r=n.Easing.Default),void 0===i&&(i=!1),void 0===s&&(s=0),void 0===o&&(o=0),void 0===u&&(u=!1),"string"==typeof r&&this.manager.easeMap[r]&&(r=this.manager.easeMap[r]),this.isRunning?(console.warn("Phaser.Tween.from cannot be called after Tween.start"),this):(this.timeline.push((new n.TweenData(this)).from(e,t,r,s,o,u)),i&&this.start(),this)},start:function(e){if(void 0===e&&(e=0),null===this.game||null===this.target||0===this.timeline.length||this.isRunning)return this;for(var t=0;t<this.timeline.length;t++)for(var n in this.timeline[t].vEnd)this.properties[n]=this.target[n]||0,Array.isArray(this.properties[n])||(this.properties[n]*=1);for(var t=0;t<this.timeline.length;t++)this.timeline[t].loadValues();return this.manager.add(this),this.isRunning=!0,(0>e||e>this.timeline.length-1)&&(e=0),this.current=e,this.timeline[this.current].start(),this},stop:function(e){return void 0===e&&(e=!1),this.isRunning=!1,this._onUpdateCallback=null,this._onUpdateCallbackContext=null,e&&(this.onComplete.dispatch(this.target,this),this._hasStarted=!1,this.chainedTween&&this.chainedTween.start()),this.manager.remove(this),this},updateTweenData:function(e,t,n){if(0===this.timeline.length)return this;if(void 0===n&&(n=0),-1===n)for(var r=0;r<this.timeline.length;r++)this.timeline[r][e]=t;else this.timeline[n][e]=t;return this},delay:function(e,t){return this.updateTweenData("delay",e,t)},repeat:function(e,t,n){return void 0===t&&(t=0),this.updateTweenData("repeatCounter",e,n),this.updateTweenData("repeatDelay",t,n)},repeatDelay:function(e,t){return this.updateTweenData("repeatDelay",e,t)},yoyo:function(e,t,n){return void 0===t&&(t=0),this.updateTweenData("yoyo",e,n),this.updateTweenData("yoyoDelay",t,n)},yoyoDelay:function(e,t){return this.updateTweenData("yoyoDelay",e,t)},easing:function(e,t){return"string"==typeof e&&this.manager.easeMap[e]&&(e=this.manager.easeMap[e]),this.updateTweenData("easingFunction",e,t)},interpolation:function(e,t,r){return void 0===t&&(t=n.Math),this.updateTweenData("interpolationFunction",e,r),this.updateTweenData("interpolationContext",t,r)},repeatAll:function(e){return void 0===e&&(e=0),this.repeatCounter=e,this},chain:function(){for(var e=arguments.length;e--;)e>0?arguments[e-1].chainedTween=arguments[e]:this.chainedTween=arguments[e];return this},loop:function(e){return void 0===e&&(e=!0),this.repeatCounter=e?-1:0,this},onUpdateCallback:function(e,t){return this._onUpdateCallback=e,this._onUpdateCallbackContext=t,this},pause:function(){this.isPaused=!0,this._codePaused=!0,this._pausedTime=this.game.time.time},_pause:function(){this._codePaused||(this.isPaused=!0,this._pausedTime=this.game.time.time)},resume:function(){if(this.isPaused){this.isPaused=!1,this._codePaused=!1;for(var e=0;e<this.timeline.length;e++)this.timeline[e].isRunning||(this.timeline[e].startTime+=this.game.time.time-this._pausedTime)}},_resume:function(){this._codePaused||this.resume()},update:function(e){if(this.pendingDelete||!this.target)return!1;if(this.isPaused)return!0;var t=this.timeline[this.current].update(e);if(t===n.TweenData.PENDING)return!0;if(t===n.TweenData.RUNNING)return this._hasStarted||(this.onStart.dispatch(this.target,this),this._hasStarted=!0),null!==this._onUpdateCallback&&this._onUpdateCallback.call(this._onUpdateCallbackContext,this,this.timeline[this.current].value,this.timeline[this.current]),this.isRunning;if(t===n.TweenData.LOOPED)return-1===this.timeline[this.current].repeatCounter?this.onLoop.dispatch(this.target,this):this.onRepeat.dispatch(this.target,this),!0;if(t===n.TweenData.COMPLETE){var r=!1;return this.reverse?(this.current--,this.current<0&&(this.current=this.timeline.length-1,r=!0)):(this.current++,this.current===this.timeline.length&&(this.current=0,r=!0)),r?-1===this.repeatCounter?(this.timeline[this.current].start(),this.onLoop.dispatch(this.target,this),!0):this.repeatCounter>0?(this.repeatCounter--,this.timeline[this.current].start(),this.onRepeat.dispatch(this.target,this),!0):(this.isRunning=!1,this.onComplete.dispatch(this.target,this),this._hasStarted=!1,this.chainedTween&&this.chainedTween.start(),!1):(this.onChildComplete.dispatch(this.target,this),this.timeline[this.current].start(),!0)}},generateData:function(e,t){if(null===this.game||null===this.target)return null;void 0===e&&(e=60),void 0===t&&(t=[]);for(var n=0;n<this.timeline.length;n++)for(var r in this.timeline[n].vEnd)this.properties[r]=this.target[r]||0,Array.isArray(this.properties[r])||(this.properties[r]*=1);for(var n=0;n<this.timeline.length;n++)this.timeline[n].loadValues();for(var n=0;n<this.timeline.length;n++)t=t.concat(this.timeline[n].generateData(e));return t}},Object.defineProperty(n.Tween.prototype,"totalDuration",{get:function(){for(var e=0,t=0;t<this.timeline.length;t++)e+=this.timeline[t].duration;return e}}),n.Tween.prototype.constructor=n.Tween,n.TweenData=function(e){this.parent=e,this.game=e.game,this.vStart={},this.vStartCache={},this.vEnd={},this.vEndCache={},this.duration=1e3,this.percent=0,this.value=0,this.repeatCounter=0,this.repeatDelay=0,this.repeatTotal=0,this.interpolate=!1,this.yoyo=!1,this.yoyoDelay=0,this.inReverse=!1,this.delay=0,this.dt=0,this.startTime=null,this.easingFunction=n.Easing.Default,this.interpolationFunction=n.Math.linearInterpolation,this.interpolationContext=n.Math,this.isRunning=!1,this.isFrom=!1},n.TweenData.PENDING=0,n.TweenData.RUNNING=1,n.TweenData.LOOPED=2,n.TweenData.COMPLETE=3,n.TweenData.prototype={to:function(e,t,n,r,i,s){return this.vEnd=e,this.duration=t,this.easingFunction=n,this.delay=r,this.repeatTotal=i,this.yoyo=s,this.isFrom=!1,this},from:function(e,t,n,r,i,s){return this.vEnd=e,this.duration=t,this.easingFunction=n,this.delay=r,this.repeatTotal=i,this.yoyo=s,this.isFrom=!0,this},start:function(){if(this.startTime=this.game.time.time+this.delay,this.parent.reverse?this.dt=this.duration:this.dt=0,this.delay>0?this.isRunning=!1:this.isRunning=!0,this.isFrom)for(var e in this.vStartCache)this.vStart[e]=this.vEndCache[e],this.vEnd[e]=this.vStartCache[e],this.parent.target[e]=this.vStart[e];return this.value=0,this.yoyoCounter=0,this.repeatCounter=this.repeatTotal,this},loadValues:function(){for(var e in this.parent.properties){if(this.vStart[e]=this.parent.properties[e],Array.isArray(this.vEnd[e])){if(0===this.vEnd[e].length)continue;0===this.percent&&(this.vEnd[e]=[this.vStart[e]].concat(this.vEnd[e]))}"undefined"!=typeof this.vEnd[e]?("string"==typeof this.vEnd[e]&&(this.vEnd[e]=this.vStart[e]+parseFloat(this.vEnd[e],10)),this.parent.properties[e]=this.vEnd[e]):this.vEnd[e]=this.vStart[e],this.vStartCache[e]=this.vStart[e],this.vEndCache[e]=this.vEnd[e]}return this},update:function(e){if(this.isRunning){if(e<this.startTime)return n.TweenData.RUNNING}else{if(!(e>=this.startTime))return n.TweenData.PENDING;this.isRunning=!0}var t=this.parent.frameBased?this.game.time.physicsElapsedMS:this.game.time.elapsedMS;this.parent.reverse?(this.dt-=t*this.parent.timeScale,this.dt=Math.max(this.dt,0)):(this.dt+=t*this.parent.timeScale,this.dt=Math.min(this.dt,this.duration)),this.percent=this.dt/this.duration,this.value=this.easingFunction(this.percent);for(var r in this.vEnd){var i=this.vStart[r],s=this.vEnd[r];Array.isArray(s)?this.parent.target[r]=this.interpolationFunction.call(this.interpolationContext,s,this.value):this.parent.target[r]=i+(s-i)*this.value}return!this.parent.reverse&&1===this.percent||this.parent.reverse&&0===this.percent?this.repeat():n.TweenData.RUNNING},generateData:function(e){this.parent.reverse?this.dt=this.duration:this.dt=0;var t=[],n=!1,r=1/e*1e3;do{this.parent.reverse?(this.dt-=r,this.dt=Math.max(this.dt,0)):(this.dt+=r,this.dt=Math.min(this.dt,this.duration)),this.percent=this.dt/this.duration,this.value=this.easingFunction(this.percent);var i={};for(var s in this.vEnd){var o=this.vStart[s],u=this.vEnd[s];Array.isArray(u)?i[s]=this.interpolationFunction(u,this.value):i[s]=o+(u-o)*this.value}t.push(i),(!this.parent.reverse&&1===this.percent||this.parent.reverse&&0===this.percent)&&(n=!0)}while(!n);if(this.yoyo){var a=t.slice();a.reverse(),t=t.concat(a)}return t},repeat:function(){if(this.yoyo){if(this.inReverse&&0===this.repeatCounter){for(var e in this.vStartCache)this.vStart[e]=this.vStartCache[e],this.vEnd[e]=this.vEndCache[e];return this.inReverse=!1,n.TweenData.COMPLETE}this.inReverse=!this.inReverse}else if(0===this.repeatCounter)return n.TweenData.COMPLETE;if(this.inReverse)for(var e in this.vStartCache)this.vStart[e]=this.vEndCache[e],this.vEnd[e]=this.vStartCache[e];else{for(var e in this.vStartCache)this.vStart[e]=this.vStartCache[e],this.vEnd[e]=this.vEndCache[e];this.repeatCounter>0&&this.repeatCounter--}return this.startTime=this.game.time.time,this.yoyo&&this.inReverse?this.startTime+=this.yoyoDelay:this.inReverse||(this.startTime+=this.repeatDelay),this.parent.reverse?this.dt=this.duration:this.dt=0,n.TweenData.LOOPED}},n.TweenData.prototype.constructor=n.TweenData,n.Easing={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-0.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-0.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 0===e?0:1===e?1:1-Math.cos(e*Math.PI/2)},Out:function(e){return 0===e?0:1===e?1:Math.sin(e*Math.PI/2)},InOut:function(e){return 0===e?0:1===e?1:.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(-Math.pow(2,-10*(e-1))+2)}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-0.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){var t,n=.1,r=.4;return 0===e?0:1===e?1:(!n||1>n?(n=1,t=r/4):t=r*Math.asin(1/n)/(2*Math.PI),-(n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*2*Math.PI/r)))},Out:function(e){var t,n=.1,r=.4;return 0===e?0:1===e?1:(!n||1>n?(n=1,t=r/4):t=r*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*e)*Math.sin((e-t)*2*Math.PI/r)+1)},InOut:function(e){var t,n=.1,r=.4;return 0===e?0:1===e?1:(!n||1>n?(n=1,t=r/4):t=r*Math.asin(1/n)/(2*Math.PI),(e*=2)<1?-0.5*n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*2*Math.PI/r):n*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*2*Math.PI/r)*.5+1)}},Back:{In:function(e){var t=1.70158;return e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?.5*e*e*((t+1)*e-t):.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:function(e){return 1-n.Easing.Bounce.Out(1-e)},Out:function(e){return 1/2.75>e?7.5625*e*e:2/2.75>e?7.5625*(e-=1.5/2.75)*e+.75:2.5/2.75>e?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return.5>e?.5*n.Easing.Bounce.In(2*e):.5*n.Easing.Bounce.Out(2*e-1)+.5}}},n.Easing.Default=n.Easing.Linear.None,n.Easing.Power0=n.Easing.Linear.None,n.Easing.Power1=n.Easing.Quadratic.Out,n.Easing.Power2=n.Easing.Cubic.Out,n.Easing.Power3=n.Easing.Quartic.Out,n.Easing.Power4=n.Easing.Quintic.Out,n.Time=function(e){this.game=e,this.time=0,this.prevTime=0,this.now=0,this.elapsed=0,this.elapsedMS=0,this.physicsElapsed=1/60,this.physicsElapsedMS=1/60*1e3,this.desiredFpsMult=1/60,this._desiredFps=60,this.suggestedFps=this.desiredFps,this.slowMotion=1,this.advancedTiming=!1,this.frames=0,this.fps=0,this.fpsMin=1e3,this.fpsMax=0,this.msMin=1e3,this.msMax=0,this.pauseDuration=0,this.timeToCall=0,this.timeExpected=0,this.events=new n.Timer(this.game,!1),this._frameCount=0,this._elapsedAccumulator=0,this._started=0,this._timeLastSecond=0,this._pauseStarted=0,this._justResumed=!1,this._timers=[]},n.Time.prototype={boot:function(){this._started=Date.now(),this.time=Date.now(),this.events.start(),this.timeExpected=this.time},add:function(e){return this._timers.push(e),e},create:function(e){void 0===e&&(e=!0);var t=new n.Timer(this.game,e);return this._timers.push(t),t},removeAll:function(){for(var e=0;e<this._timers.length;e++)this._timers[e].destroy();this._timers=[],this.events.removeAll()},refresh:function(){var e=this.time;this.time=Date.now(),this.elapsedMS=this.time-e},update:function(e){var t=this.time;this.time=Date.now(),this.elapsedMS=this.time-t,this.prevTime=this.now,this.now=e,this.elapsed=this.now-this.prevTime,this.game.raf._isSetTimeOut&&(this.timeToCall=Math.floor(Math.max(0,1e3/this._desiredFps-(this.timeExpected-e))),this.timeExpected=e+this.timeToCall),this.advancedTiming&&this.updateAdvancedTiming(),this.game.paused||(this.events.update(this.time),this._timers.length&&this.updateTimers())},updateTimers:function(){for(var e=0,t=this._timers.length;t>e;)this._timers[e].update(this.time)?e++:(this._timers.splice(e,1),t--)},updateAdvancedTiming:function(){this._frameCount++,this._elapsedAccumulator+=this.elapsed,this._frameCount>=2*this._desiredFps&&(this.suggestedFps=5*Math.floor(200/(this._elapsedAccumulator/this._frameCount)),this._frameCount=0,this._elapsedAccumulator=0),this.msMin=Math.min(this.msMin,this.elapsed),this.msMax=Math.max(this.msMax,this.elapsed),this.frames++,this.now>this._timeLastSecond+1e3&&(this.fps=Math.round(1e3*this.frames/(this.now-this._timeLastSecond)),this.fpsMin=Math.min(this.fpsMin,this.fps),this.fpsMax=Math.max(this.fpsMax,this.fps),this._timeLastSecond=this.now,this.frames=0)},gamePaused:function(){this._pauseStarted=Date.now(),this.events.pause();for(var e=this._timers.length;e--;)this._timers[e]._pause()},gameResumed:function(){this.time=Date.now(),this.pauseDuration=this.time-this._pauseStarted,this.events.resume();for(var e=this._timers.length;e--;)this._timers[e]._resume()},totalElapsedSeconds:function(){return.001*(this.time-this._started)},elapsedSince:function(e){return this.time-e},elapsedSecondsSince:function(e){return.001*(this.time-e)},reset:function(){this._started=this.time,this.removeAll()}},Object.defineProperty(n.Time.prototype,"desiredFps",{get:function(){return this._desiredFps},set:function(e){this._desiredFps=e,this.physicsElapsed=1/e,this.physicsElapsedMS=1e3*this.physicsElapsed,this.desiredFpsMult=1/e}}),n.Time.prototype.constructor=n.Time,n.Timer=function(e,t){void 0===t&&(t=!0),this.game=e,this.running=!1,this.autoDestroy=t,this.expired=!1,this.elapsed=0,this.events=[],this.onComplete=new n.Signal,this.nextTick=0,this.timeCap=1e3,this.paused=!1,this._codePaused=!1,this._started=0,this._pauseStarted=0,this._pauseTotal=0,this._now=Date.now(),this._len=0,this._marked=0,this._i=0,this._diff=0,this._newTick=0},n.Timer.MINUTE=6e4,n.Timer.SECOND=1e3,n.Timer.HALF=500,n.Timer.QUARTER=250,n.Timer.prototype={create:function(e,t,r,i,s,o){e=Math.round(e);var u=e;u+=0===this._now?this.game.time.time:this._now;var a=new n.TimerEvent(this,e,u,r,t,i,s,o);return this.events.push(a),this.order(),this.expired=!1,a},add:function(e,t,n){return this.create(e,!1,0,t,n,Array.prototype.slice.call(arguments,3))},repeat:function(e,t,n,r){return this.create(e,!1,t,n,r,Array.prototype.slice.call(arguments,4))},loop:function(e,t,n){return this.create(e,!0,0,t,n,Array.prototype.slice.call(arguments,3))},start:function(e){if(!this.running){this._started=this.game.time.time+(e||0),this.running=!0;for(var t=0;t<this.events.length;t++)this.events[t].tick=this.events[t].delay+this._started}},stop:function(e){this.running=!1,void 0===e&&(e=!0),e&&(this.events.length=0)},remove:function(e){for(var t=0;t<this.events.length;t++)if(this.events[t]===e)return this.events[t].pendingDelete=!0,!0;return!1},order:function(){this.events.length>0&&(this.events.sort(this.sortHandler),this.nextTick=this.events[0].tick)},sortHandler:function(e,t){return e.tick<t.tick?-1:e.tick>t.tick?1:0},clearPendingEvents:function(){for(this._i=this.events.length;this._i--;)this.events[this._i].pendingDelete&&this.events.splice(this._i,1);this._len=this.events.length,this._i=0},update:function(e){if(this.paused)return!0;if(this.elapsed=e-this._now,this._now=e,this.elapsed>this.timeCap&&this.adjustEvents(e-this.elapsed),this._marked=0,this.clearPendingEvents(),this.running&&this._now>=this.nextTick&&this._len>0){for(;this._i<this._len&&this.running&&this._now>=this.events[this._i].tick&&!this.events[this._i].pendingDelete;)this._newTick=this._now+this.events[this._i].delay-(this._now-this.events[this._i].tick),this._newTick<0&&(this._newTick=this._now+this.events[this._i].delay),this.events[this._i].loop===!0?(this.events[this._i].tick=this._newTick,this.events[this._i].callback.apply(this.events[this._i].callbackContext,this.events[this._i].args)):this.events[this._i].repeatCount>0?(this.events[this._i].repeatCount--,this.events[this._i].tick=this._newTick,this.events[this._i].callback.apply(this.events[this._i].callbackContext,this.events[this._i].args)):(this._marked++,this.events[this._i].pendingDelete=!0,this.events[this._i].callback.apply(this.events[this._i].callbackContext,this.events[this._i].args)),this._i++;this.events.length>this._marked?this.order():(this.expired=!0,this.onComplete.dispatch(this))}return this.expired&&this.autoDestroy?!1:!0},pause:function(){this.running&&(this._codePaused=!0,this.paused||(this._pauseStarted=this.game.time.time,this.paused=!0))},_pause:function(){!this.paused&&this.running&&(this._pauseStarted=this.game.time.time,this.paused=!0)},adjustEvents:function(e){for(var t=0;t<this.events.length;t++)if(!this.events[t].pendingDelete){var n=this.events[t].tick-e;0>n&&(n=0),this.events[t].tick=this._now+n}var r=this.nextTick-e;0>r?this.nextTick=this._now:this.nextTick=this._now+r},resume:function(){if(this.paused){var e=this.game.time.time;this._pauseTotal+=e-this._now,this._now=e,this.adjustEvents(this._pauseStarted),this.paused=!1,this._codePaused=!1}},_resume:function(){this._codePaused||this.resume()},removeAll:function(){this.onComplete.removeAll(),this.events.length=0,this._len=0,this._i=0},destroy:function(){this.onComplete.removeAll(),this.running=!1,this.events=[],this._len=0,this._i=0}},Object.defineProperty(n.Timer.prototype,"next",{get:function(){return this.nextTick}}),Object.defineProperty(n.Timer.prototype,"duration",{get:function(){return this.running&&this.nextTick>this._now?this.nextTick-this._now:0}}),Object.defineProperty(n.Timer.prototype,"length",{get:function(){return this.events.length}}),Object.defineProperty(n.Timer.prototype,"ms",{get:function(){return this.running?this._now-this._started-this._pauseTotal:0}}),Object.defineProperty(n.Timer.prototype,"seconds",{get:function(){return this.running?.001*this.ms:0}}),n.Timer.prototype.constructor=n.Timer,n.TimerEvent=function(e,t,n,r,i,s,o,u){this.timer=e,this.delay=t,this.tick=n,this.repeatCount=r-1,this.loop=i,this.callback=s,this.callbackContext=o,this.args=u,this.pendingDelete=!1},n.TimerEvent.prototype.constructor=n.TimerEvent,n.AnimationManager=function(e){this.sprite=e,this.game=e.game,this.currentFrame=null,this.currentAnim=null,this.updateIfVisible=!0,this.isLoaded=!1,this._frameData=null,this._anims={},this._outputFrames=[]},n.AnimationManager.prototype={loadFrameData:function(e,t){if(void 0===e)return!1;if(this.isLoaded)for(var n in this._anims)this._anims[n].updateFrameData(e);return this._frameData=e,void 0===t||null===t?this.frame=0:"string"==typeof t?this.frameName=t:this.frame=t,this.isLoaded=!0,!0},copyFrameData:function(e,t){if(this._frameData=e.clone(),this.isLoaded)for(var n in this._anims)this._anims[n].updateFrameData(this._frameData);return void 0===t||null===t?this.frame=0:"string"==typeof t?this.frameName=t:this.frame=t,this.isLoaded=!0,!0},add:function(e,t,r,i,s){return t=t||[],r=r||60,void 0===i&&(i=!1),void 0===s&&(s=t&&"number"==typeof t[0]?!0:!1),this._outputFrames=[],this._frameData.getFrameIndexes(t,s,this._outputFrames),this._anims[e]=new n.Animation(this.game,this.sprite,e,this._frameData,this._outputFrames,r,i),this.currentAnim=this._anims[e],this.sprite.tilingTexture&&(this.sprite.refreshTexture=!0),this._anims[e]},validateFrames:function(e,t){void 0===t&&(t=!0);for(var n=0;n<e.length;n++)if(t===!0){if(e[n]>this._frameData.total)return!1}else if(this._frameData.checkFrameName(e[n])===!1)return!1;return!0},play:function(e,t,n,r){return this._anims[e]?this.currentAnim===this._anims[e]?this.currentAnim.isPlaying===!1?(this.currentAnim.paused=!1,this.currentAnim.play(t,n,r)):this.currentAnim:(this.currentAnim&&this.currentAnim.isPlaying&&this.currentAnim.stop(),this.currentAnim=this._anims[e],this.currentAnim.paused=!1,this.currentFrame=this.currentAnim.currentFrame,this.currentAnim.play(t,n,r)):void 0},stop:function(e,t){void 0===t&&(t=!1),!this.currentAnim||"string"==typeof e&&e!==this.currentAnim.name||this.currentAnim.stop(t)},update:function(){return this.updateIfVisible&&!this.sprite.visible?!1:this.currentAnim&&this.currentAnim.update()?(this.currentFrame=this.currentAnim.currentFrame,!0):!1},next:function(e){this.currentAnim&&(this.currentAnim.next(e),this.currentFrame=this.currentAnim.currentFrame)},previous:function(e){this.currentAnim&&(this.currentAnim.previous(e),this.currentFrame=this.currentAnim.currentFrame)},getAnimation:function(e){return"string"==typeof e&&this._anims[e]?this._anims[e]:null},refreshFrame:function(){this.sprite.setTexture(PIXI.TextureCache[this.currentFrame.uuid])},destroy:function(){var e=null;for(var e in this._anims)this._anims.hasOwnProperty(e)&&this._anims[e].destroy();this._anims={},this._outputFrames=[],this._frameData=null,this.currentAnim=null,this.currentFrame=null,this.sprite=null,this.game=null}},n.AnimationManager.prototype.constructor=n.AnimationManager,Object.defineProperty(n.AnimationManager.prototype,"frameData",{get:function(){return this._frameData}}),Object.defineProperty(n.AnimationManager.prototype,"frameTotal",{get:function(){return this._frameData.total}}),Object.defineProperty(n.AnimationManager.prototype,"paused",{get:function(){return this.currentAnim.isPaused},set:function(e){this.currentAnim.paused=e}}),Object.defineProperty(n.AnimationManager.prototype,"name",{get:function(){return this.currentAnim?this.currentAnim.name:void 0}}),Object.defineProperty(n.AnimationManager.prototype,"frame",{get:function(){return this.currentFrame?this.currentFrame.index:void 0},set:function(e){"number"==typeof e&&this._frameData&&null!==this._frameData.getFrame(e)&&(this.currentFrame=this._frameData.getFrame(e),this.currentFrame&&this.sprite.setFrame(this.currentFrame))}}),Object.defineProperty(n.AnimationManager.prototype,"frameName",{get:function(){return this.currentFrame?this.currentFrame.name:void 0},set:function(e){"string"==typeof e&&this._frameData&&null!==this._frameData.getFrameByName(e)?(this.currentFrame=this._frameData.getFrameByName(e),this.currentFrame&&(this._frameIndex=this.currentFrame.index,this.sprite.setFrame(this.currentFrame))):console.warn("Cannot set frameName: "+e)}}),n.Animation=function(e,t,r,i,s,o,u){void 0===u&&(u=!1),this.game=e,this._parent=t,this._frameData=i,this.name=r,this._frames=[],this._frames=this._frames.concat(s),this.delay=1e3/o,this.loop=u,this.loopCount=0,this.killOnComplete=!1,this.isFinished=!1,this.isPlaying=!1,this.isPaused=!1,this._pauseStartTime=0,this._frameIndex=0,this._frameDiff=0,this._frameSkip=1,this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this.onStart=new n.Signal,this.onUpdate=null,this.onComplete=new n.Signal,this.onLoop=new n.Signal,this.game.onPause.add(this.onPause,this),this.game.onResume.add(this.onResume,this)},n.Animation.prototype={play:function(e,t,n){return"number"==typeof e&&(this.delay=1e3/e),"boolean"==typeof t&&(this.loop=t),"undefined"!=typeof n&&(this.killOnComplete=n),this.isPlaying=!0,this.isFinished=!1,this.paused=!1,this.loopCount=0,this._timeLastFrame=this.game.time.time,this._timeNextFrame=this.game.time.time+this.delay,this._frameIndex=0,this.updateCurrentFrame(!1,!0),this._parent.events.onAnimationStart$dispatch(this._parent,this),this.onStart.dispatch(this._parent,this),this._parent.animations.currentAnim=this,this._parent.animations.currentFrame=this.currentFrame,this},restart:function(){this.isPlaying=!0,this.isFinished=!1,this.paused=!1,this.loopCount=0,this._timeLastFrame=this.game.time.time,this._timeNextFrame=this.game.time.time+this.delay,this._frameIndex=0,this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this._parent.setFrame(this.currentFrame),this._parent.animations.currentAnim=this,this._parent.animations.currentFrame=this.currentFrame,this.onStart.dispatch(this._parent,this)},setFrame:function(e,t){var n;if(void 0===t&&(t=!1),"string"==typeof e)for(var r=0;r<this._frames.length;r++)this._frameData.getFrame(this._frames[r]).name===e&&(n=r);else if("number"==typeof e)if(t)n=e;else for(var r=0;r<this._frames.length;r++)this._frames[r]===n&&(n=r);n&&(this._frameIndex=n-1,this._timeNextFrame=this.game.time.time,this.update())},stop:function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1),this.isPlaying=!1,this.isFinished=!0,this.paused=!1,e&&(this.currentFrame=this._frameData.getFrame(this._frames[0]),this._parent.setFrame(this.currentFrame)),t&&(this._parent.events.onAnimationComplete$dispatch(this._parent,this),this.onComplete.dispatch(this._parent,this))},onPause:function(){this.isPlaying&&(this._frameDiff=this._timeNextFrame-this.game.time.time)},onResume:function(){this.isPlaying&&(this._timeNextFrame=this.game.time.time+this._frameDiff)},update:function(){return this.isPaused?!1:this.isPlaying&&this.game.time.time>=this._timeNextFrame?(this._frameSkip=1,this._frameDiff=this.game.time.time-this._timeNextFrame,this._timeLastFrame=this.game.time.time,this._frameDiff>this.delay&&(this._frameSkip=Math.floor(this._frameDiff/this.delay),this._frameDiff-=this._frameSkip*this.delay),this._timeNextFrame=this.game.time.time+(this.delay-this._frameDiff),this._frameIndex+=this._frameSkip,this._frameIndex>=this._frames.length?this.loop?(this._frameIndex%=this._frames.length,this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this.currentFrame&&this._parent.setFrame(this.currentFrame),this.loopCount++,this._parent.events.onAnimationLoop$dispatch(this._parent,this),this.onLoop.dispatch(this._parent,this),this.onUpdate?(this.onUpdate.dispatch(this,this.currentFrame),!!this._frameData):!0):(this.complete(),!1):this.updateCurrentFrame(!0)):!1},updateCurrentFrame:function(e,t){if(void 0===t&&(t=!1),!this._frameData)return!1;var n=this.currentFrame.index;return this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this.currentFrame&&(t||!t&&n!==this.currentFrame.index)&&this._parent.setFrame(this.currentFrame),this.onUpdate&&e?(this.onUpdate.dispatch(this,this.currentFrame),!!this._frameData):!0},next:function(e){void 0===e&&(e=1);var t=this._frameIndex+e;t>=this._frames.length&&(this.loop?t%=this._frames.length:t=this._frames.length-1),t!==this._frameIndex&&(this._frameIndex=t,this.updateCurrentFrame(!0))},previous:function(e){void 0===e&&(e=1);var t=this._frameIndex-e;0>t&&(this.loop?t=this._frames.length+t:t++),t!==this._frameIndex&&(this._frameIndex=t,this.updateCurrentFrame(!0))},updateFrameData:function(e){this._frameData=e,this.currentFrame=this._frameData?this._frameData.getFrame(this._frames[this._frameIndex%this._frames.length]):null},destroy:function(){this._frameData&&(this.game.onPause.remove(this.onPause,this),this.game.onResume.remove(this.onResume,this),this.game=null,this._parent=null,this._frames=null,this._frameData=null,this.currentFrame=null,this.isPlaying=!1,this.onStart.dispose(),this.onLoop.dispose(),this.onComplete.dispose(),this.onUpdate&&this.onUpdate.dispose())},complete:function(){this._frameIndex=this._frames.length-1,this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this.isPlaying=!1,this.isFinished=!0,this.paused=!1,this._parent.events.onAnimationComplete$dispatch(this._parent,this),this.onComplete.dispatch(this._parent,this),this.killOnComplete&&this._parent.kill()}},n.Animation.prototype.constructor=n.Animation,Object.defineProperty(n.Animation.prototype,"paused",{get:function(){return this.isPaused},set:function(e){this.isPaused=e,e?this._pauseStartTime=this.game.time.time:this.isPlaying&&(this._timeNextFrame=this.game.time.time+this.delay)}}),Object.defineProperty(n.Animation.prototype,"frameTotal",{get:function(){return this._frames.length}}),Object.defineProperty(n.Animation.prototype,"frame",{get:function(){return null!==this.currentFrame?this.currentFrame.index:this._frameIndex},set:function(e){this.currentFrame=this._frameData.getFrame(this._frames[e]),null!==this.currentFrame&&(this._frameIndex=e,this._parent.setFrame(this.currentFrame),this.onUpdate&&this.onUpdate.dispatch(this,this.currentFrame))}}),Object.defineProperty(n.Animation.prototype,"speed",{get:function(){return Math.round(1e3/this.delay)},set:function(e){e>=1&&(this.delay=1e3/e)}}),Object.defineProperty(n.Animation.prototype,"enableUpdate",{get:function(){return null!==this.onUpdate},set:function(e){e&&null===this.onUpdate?this.onUpdate=new n.Signal:e||null===this.onUpdate||(this.onUpdate.dispose(),this.onUpdate=null)}}),n.Animation.generateFrameNames=function(e,t,r,i,s){void 0===i&&(i="");var o=[],u="";if(r>t)for(var a=t;r>=a;a++)u="number"==typeof s?n.Utils.pad(a.toString(),s,"0",1):a.toString(),u=e+u+i,o.push(u);else for(var a=t;a>=r;a--)u="number"==typeof s?n.Utils.pad(a.toString(),s,"0",1):a.toString(),u=e+u+i,o.push(u);return o},n.Frame=function(e,t,r,i,s,o){this.index=e,this.x=t,this.y=r,this.width=i,this.height=s,this.name=o,this.centerX=Math.floor(i/2),this.centerY=Math.floor(s/2),this.distance=n.Math.distance(0,0,i,s),this.rotated=!1,this.rotationDirection="cw",this.trimmed=!1,this.sourceSizeW=i,this.sourceSizeH=s,this.spriteSourceSizeX=0,this.spriteSourceSizeY=0,this.spriteSourceSizeW=0,this.spriteSourceSizeH=0,this.right=this.x+this.width,this.bottom=this.y+this.height},n.Frame.prototype={resize:function(e,t){this.width=e,this.height=t,this.centerX=Math.floor(e/2),this.centerY=Math.floor(t/2),this.distance=n.Math.distance(0,0,e,t),this.sourceSizeW=e,this.sourceSizeH=t,this.right=this.x+e,this.bottom=this.y+t},setTrim:function(e,t,n,r,i,s,o){this.trimmed=e,e&&(this.sourceSizeW=t,this.sourceSizeH=n,this.centerX=Math.floor(t/2),this.centerY=Math.floor(n/2),this.spriteSourceSizeX=r,this.spriteSourceSizeY=i,this.spriteSourceSizeW=s,this.spriteSourceSizeH=o)},clone:function(){var e=new n.Frame(this.index,this.x,this.y,this.width,this.height,this.name);for(var t in this)this.hasOwnProperty(t)&&(e[t]=this[t]);return e},getRect:function(e){return void 0===e?e=new n.Rectangle(this.x,this.y,this.width,this.height):e.setTo(this.x,this.y,this.width,this.height),e}},n.Frame.prototype.constructor=n.Frame,n.FrameData=function(){this._frames=[],this._frameNames=[]},n.FrameData.prototype={addFrame:function(e){return e.index=this._frames.length,this._frames.push(e),""!==e.name&&(this._frameNames[e.name]=e.index),e},getFrame:function(e){return e>=this._frames.length&&(e=0),this._frames[e]},getFrameByName:function(e){return"number"==typeof this._frameNames[e]?this._frames[this._frameNames[e]]:null},checkFrameName:function(e){return null==this._frameNames[e]?!1:!0},clone:function(){for(var e=new n.FrameData,t=0;t<this._frames.length;t++)e._frames.push(this._frames[t].clone());for(var r in this._frameNames)this._frameNames.hasOwnProperty(r)&&e._frameNames.push(this._frameNames[r]);return e},getFrameRange:function(e,t,n){void 0===n&&(n=[]);for(var r=e;t>=r;r++)n.push(this._frames[r]);return n},getFrames:function(e,t,n){if(void 0===t&&(t=!0),void 0===n&&(n=[]),void 0===e||0===e.length)for(var r=0;r<this._frames.length;r++)n.push(this._frames[r]);else for(var r=0;r<e.length;r++)t?n.push(this.getFrame(e[r])):n.push(this.getFrameByName(e[r]));return n},getFrameIndexes:function(e,t,n){if(void 0===t&&(t=!0),void 0===n&&(n=[]),void 0===e||0===e.length)for(var r=0;r<this._frames.length;r++)n.push(this._frames[r].index);else for(var r=0;r<e.length;r++)t&&this._frames[e[r]]?n.push(this._frames[e[r]].index):this.getFrameByName(e[r])&&n.push(this.getFrameByName(e[r]).index);return n},destroy:function(){this._frames=null,this._frameNames=null}},n.FrameData.prototype.constructor=n.FrameData,Object.defineProperty(n.FrameData.prototype,"total",{get:function(){return this._frames.length}}),n.AnimationParser={spriteSheet:function(e,t,r,i,s,o,u){var a=t;if("string"==typeof t&&(a=e.cache.getImage(t)),null===a)return null;var f=a.width,l=a.height;0>=r&&(r=Math.floor(-f/Math.min(-1,r))),0>=i&&(i=Math.floor(-l/Math.min(-1,i)));var c=Math.floor((f-o)/(r+u)),h=Math.floor((l-o)/(i+u)),p=c*h;if(-1!==s&&(p=s),0===f||0===l||r>f||i>l||0===p)return console.warn("Phaser.AnimationParser.spriteSheet: '"+t+"'s width/height zero or width/height < given frameWidth/frameHeight"),null;for(var d=new n.FrameData,v=o,m=o,g=0;p>g;g++)d.addFrame(new n.Frame(g,v,m,r,i,"")),v+=r+u,v+r>f&&(v=o,m+=i+u);return d},JSONData:function(e,t){if(!t.frames)return console.warn("Phaser.AnimationParser.JSONData: Invalid Texture Atlas JSON given, missing 'frames' array"),void console.log(t);for(var r,i=new n.FrameData,s=t.frames,o=0;o<s.length;o++)r=i.addFrame(new n.Frame(o,s[o].frame.x,s[o].frame.y,s[o].frame.w,s[o].frame.h,s[o].filename)),s[o].trimmed&&r.setTrim(s[o].trimmed,s[o].sourceSize.w,s[o].sourceSize.h,s[o].spriteSourceSize.x,s[o].spriteSourceSize.y,s[o].spriteSourceSize.w,s[o].spriteSourceSize.h);return i},JSONDataPyxel:function(e,t){var r=["layers","tilewidth","tileheight","tileswide","tileshigh"];if(r.forEach(function(e){return t[e]?void 0:(console.warn("Phaser.AnimationParser.JSONDataPyxel: Invalid Pyxel Tilemap JSON given, missing '"+e+"' key."),void console.log(t))}),1!=t.layers.length)return console.warn("Phaser.AnimationParser.JSONDataPyxel: Too many layers, this parser only supports flat Tilemaps."),void console.log(t);for(var i,s=new n.FrameData,o=t.tileheight,u=t.tilewidth,a=t.layers[0].tiles,f=0;f<a.length;f++)i=s.addFrame(new n.Frame(f,a[f].x,a[f].y,u,o,"frame_"+f)),i.setTrim(!1);return s},JSONDataHash:function(e,t){if(!t.frames)return console.warn("Phaser.AnimationParser.JSONDataHash: Invalid Texture Atlas JSON given, missing 'frames' object"),void console.log(t);var r,i=new n.FrameData,s=t.frames,o=0;for(var u in s)r=i.addFrame(new n.Frame(o,s[u].frame.x,s[u].frame.y,s[u].frame.w,s[u].frame.h,u)),s[u].trimmed&&r.setTrim(s[u].trimmed,s[u].sourceSize.w,s[u].sourceSize.h,s[u].spriteSourceSize.x,s[u].spriteSourceSize.y,s[u].spriteSourceSize.w,s[u].spriteSourceSize.h),o++;return i},XMLData:function(e,t){if(!t.getElementsByTagName("TextureAtlas"))return void console.warn("Phaser.AnimationParser.XMLData: Invalid Texture Atlas XML given, missing <TextureAtlas> tag");for(var r,i,s,o,u,a,f,l,c,h,p,d=new n.FrameData,v=t.getElementsByTagName("SubTexture"),m=0;m<v.length;m++)s=v[m].attributes,i=s.name.value,o=parseInt(s.x.value,10),u=parseInt(s.y.value,10),a=parseInt(s.width.value,10),f=parseInt(s.height.value,10),l=null,c=null,s.frameX&&(l=Math.abs(parseInt(s.frameX.value,10)),c=Math.abs(parseInt(s.frameY.value,10)),h=parseInt(s.frameWidth.value,10),p=parseInt(s.frameHeight.value,10)),r=d.addFrame(new n.Frame(m,o,u,a,f,i)),(null!==l||null!==c)&&r.setTrim(!0,a,f,l,c,h,p);return d}},n.Cache=function(e){this.game=e,this.autoResolveURL=!1,this._cache={canvas:{},image:{},texture:{},sound:{},video:{},text:{},json:{},xml:{},physics:{},tilemap:{},binary:{},bitmapData:{},bitmapFont:{},shader:{},renderTexture:{}},this._urlMap={},this._urlResolver=new Image,this._urlTemp=null,this.onSoundUnlock=new n.Signal,this._cacheMap=[],this._cacheMap[n.Cache.CANVAS]=this._cache.canvas,this._cacheMap[n.Cache.IMAGE]=this._cache.image,this._cacheMap[n.Cache.TEXTURE]=this._cache.texture,this._cacheMap[n.Cache.SOUND]=this._cache.sound,this._cacheMap[n.Cache.TEXT]=this._cache.text,this._cacheMap[n.Cache.PHYSICS]=this._cache.physics,this._cacheMap[n.Cache.TILEMAP]=this._cache.tilemap,this._cacheMap[n.Cache.BINARY]=this._cache.binary,this._cacheMap[n.Cache.BITMAPDATA]=this._cache.bitmapData,this._cacheMap[n.Cache.BITMAPFONT]=this._cache.bitmapFont,this._cacheMap[n.Cache.JSON]=this._cache.json,this._cacheMap[n.Cache.XML]=this._cache.xml,this._cacheMap[n.Cache.VIDEO]=this._cache.video,this._cacheMap[n.Cache.SHADER]=this._cache.shader,this._cacheMap[n.Cache.RENDER_TEXTURE]=this._cache.renderTexture,this.addDefaultImage(),this.addMissingImage()},n.Cache.CANVAS=1,n.Cache.IMAGE=2,n.Cache.TEXTURE=3,n.Cache.SOUND=4,n.Cache.TEXT=5,n.Cache.PHYSICS=6,n.Cache.TILEMAP=7,n.Cache.BINARY=8,n.Cache.BITMAPDATA=9,n.Cache.BITMAPFONT=10,n.Cache.JSON=11,n.Cache.XML=12,n.Cache.VIDEO=13,n.Cache.SHADER=14,n.Cache.RENDER_TEXTURE=15,n.Cache.prototype={addCanvas:function(e,t,n){void 0===n&&(n=t.getContext("2d")),this._cache.canvas[e]={canvas:t,context:n}},addImage:function(e,t,r){this.checkImageKey(e)&&this.removeImage(e);var i={key:e,url:t,data:r,base:new PIXI.BaseTexture(r),frame:new n.Frame(0,0,0,r.width,r.height,e),frameData:new n.FrameData};return i.frameData.addFrame(new n.Frame(0,0,0,r.width,r.height,t)),this._cache.image[e]=i,this._resolveURL(t,i),i},addDefaultImage:function(){var e=new Image;e.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAQMAAABJtOi3AAAAA1BMVEX///+nxBvIAAAAAXRSTlMAQObYZgAAABVJREFUeF7NwIEAAAAAgKD9qdeocAMAoAABm3DkcAAAAABJRU5ErkJggg==";var t=this.addImage("__default",null,e);t.base.skipRender=!0,PIXI.TextureCache.__default=new PIXI.Texture(t.base)},addMissingImage:function(){var e=new Image;e.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJ9JREFUeNq01ssOwyAMRFG46v//Mt1ESmgh+DFmE2GPOBARKb2NVjo+17PXLD8a1+pl5+A+wSgFygymWYHBb0FtsKhJDdZlncG2IzJ4ayoMDv20wTmSMzClEgbWYNTAkQ0Z+OJ+A/eWnAaR9+oxCF4Os0H8htsMUp+pwcgBBiMNnAwF8GqIgL2hAzaGFFgZauDPKABmowZ4GL369/0rwACp2yA/ttmvsQAAAABJRU5ErkJggg==";var t=this.addImage("__missing",null,e);PIXI.TextureCache.__missing=new PIXI.Texture(t.base)},addSound:function(e,t,n,r,i){void 0===r&&(r=!0,i=!1),void 0===i&&(r=!1,i=!0);var s=!1;i&&(s=!0),this._cache.sound[e]={url:t,data:n,isDecoding:!1,decoded:s,webAudio:r,audioTag:i,locked:this.game.sound.touchLocked},this._resolveURL(t,this._cache.sound[e])},addText:function(e,t,n){this._cache.text[e]={url:t,data:n},this._resolveURL(t,this._cache.text[e])},addPhysicsData:function(e,t,n,r){this._cache.physics[e]={url:t,data:n,format:r},this._resolveURL(t,this._cache.physics[e])},addTilemap:function(e,t,n,r){this._cache.tilemap[e]={url:t,data:n,format:r},this._resolveURL(t,this._cache.tilemap[e])},addBinary:function(e,t){this._cache.binary[e]=t},addBitmapData:function(e,t,r){return t.key=e,void 0===r&&(r=new n.FrameData,r.addFrame(t.textureFrame)),this._cache.bitmapData[e]={data:t,frameData:r},t},addBitmapFont:function(e,t,r,i,s,o,u){var a={url:t,data:r,font:null,base:new PIXI.BaseTexture(r)};void 0===o&&(o=0),void 0===u&&(u=0),"json"===s?a.font=n.LoaderParser.jsonBitmapFont(i,a.base,o,u):a.font=n.LoaderParser.xmlBitmapFont(i,a.base,o,u),this._cache.bitmapFont[e]=a,this._resolveURL(t,a)},addJSON:function(e,t,n){this._cache.json[e]={url:t,data:n},this._resolveURL(t,this._cache.json[e])},addXML:function(e,t,n){this._cache.xml[e]={url:t,data:n},this._resolveURL(t,this._cache.xml[e])},addVideo:function(e,t,n,r){this._cache.video[e]={url:t,data:n,isBlob:r,locked:!0},this._resolveURL(t,this._cache.video[e])},addShader:function(e,t,n){this._cache.shader[e]={url:t,data:n},this._resolveURL(t,this._cache.shader[e])},addRenderTexture:function(e,t){this._cache.renderTexture[e]={texture:t,frame:new n.Frame(0,0,0,t.width,t.height,"","")}},addSpriteSheet:function(e,t,r,i,s,o,u,a){void 0===o&&(o=-1),void 0===u&&(u=0),void 0===a&&(a=0);var f={key:e,url:t,data:r,frameWidth:i,frameHeight:s,margin:u,spacing:a,base:new PIXI.BaseTexture(r),frameData:n.AnimationParser.spriteSheet(this.game,r,i,s,o,u,a)};this._cache.image[e]=f,this._resolveURL(t,f)},addTextureAtlas:function(e,t,r,i,s){var o={key:e,url:t,data:r,base:new PIXI.BaseTexture(r)};s===n.Loader.TEXTURE_ATLAS_XML_STARLING?o.frameData=n.AnimationParser.XMLData(this.game,i,e):s===n.Loader.TEXTURE_ATLAS_JSON_PYXEL?o.frameData=n.AnimationParser.JSONDataPyxel(this.game,i,e):Array.isArray(i.frames)?o.frameData=n.AnimationParser.JSONData(this.game,i,e):o.frameData=n.AnimationParser.JSONDataHash(this.game,i,e),this._cache.image[e]=o,this._resolveURL(t,o)},reloadSound:function(e){var t=this,n=this.getSound(e);n&&(n.data.src=n.url,n.data.addEventListener("canplaythrough",function(){return t.reloadSoundComplete(e)},!1),n.data.load())},reloadSoundComplete:function(e){var t=this.getSound(e);t&&(t.locked=!1,this.onSoundUnlock.dispatch(e))},updateSound:function(e,t,n){var r=this.getSound(e);r&&(r[t]=n)},decodedSound:function(e,t){var n=this.getSound(e);n.data=t,n.decoded=!0,n.isDecoding=!1},isSoundDecoded:function(e){var t=this.getItem(e,n.Cache.SOUND,"isSoundDecoded");return t?t.decoded:void 0},isSoundReady:function(e){var t=this.getItem(e,n.Cache.SOUND,"isSoundDecoded");return t?t.decoded&&!this.game.sound.touchLocked:void 0},checkKey:function(e,t){return this._cacheMap[e][t]?!0:!1},checkURL:function(e){return this._urlMap[this._resolveURL(e)]?!0:!1},checkCanvasKey:function(e){return this.checkKey(n.Cache.CANVAS,e)},checkImageKey:function(e){return this.checkKey(n.Cache.IMAGE,e)},checkTextureKey:function(e){return this.checkKey(n.Cache.TEXTURE,e)},checkSoundKey:function(e){return this.checkKey(n.Cache.SOUND,e)},checkTextKey:function(e){return this.checkKey(n.Cache.TEXT,e)},checkPhysicsKey:function(e){return this.checkKey(n.Cache.PHYSICS,e)},checkTilemapKey:function(e){return this.checkKey(n.Cache.TILEMAP,e)},checkBinaryKey:function(e){return this.checkKey(n.Cache.BINARY,e)},checkBitmapDataKey:function(e){return this.checkKey(n.Cache.BITMAPDATA,e)},checkBitmapFontKey:function(e){return this.checkKey(n.Cache.BITMAPFONT,e)},checkJSONKey:function(e){return this.checkKey(n.Cache.JSON,e)},checkXMLKey:function(e){return this.checkKey(n.Cache.XML,e)},checkVideoKey:function(e){return this.checkKey(n.Cache.VIDEO,e)},checkShaderKey:function(e){return this.checkKey(n.Cache.SHADER,e)},checkRenderTextureKey:function(e){return this.checkKey(n.Cache.RENDER_TEXTURE,e)},getItem:function(e,t,n,r){return this.checkKey(t,e)?void 0===r?this._cacheMap[t][e]:this._cacheMap[t][e][r]:(n&&console.warn("Phaser.Cache."+n+': Key "'+e+'" not found in Cache.'),null)},getCanvas:function(e){return this.getItem(e,n.Cache.CANVAS,"getCanvas","canvas")},getImage:function(e,t){(void 0===e||null===e)&&(e="__default"),void 0===t&&(t=!1);var r=this.getItem(e,n.Cache.IMAGE,"getImage");return null===r&&(r=this.getItem("__missing",n.Cache.IMAGE,"getImage")),t?r:r.data},getTextureFrame:function(e){return this.getItem(e,n.Cache.TEXTURE,"getTextureFrame","frame")},getSound:function(e){return this.getItem(e,n.Cache.SOUND,"getSound")},getSoundData:function(e){return this.getItem(e,n.Cache.SOUND,"getSoundData","data")},getText:function(e){return this.getItem(e,n.Cache.TEXT,"getText","data")},getPhysicsData:function(e,t,r){var i=this.getItem(e,n.Cache.PHYSICS,"getPhysicsData","data");if(null===i||void 0===t||null===t)return i;if(i[t]){var s=i[t];if(!s||!r)return s;for(var o in s)if(o=s[o],o.fixtureKey===r)return o;console.warn('Phaser.Cache.getPhysicsData: Could not find given fixtureKey: "'+r+" in "+e+'"')}else console.warn('Phaser.Cache.getPhysicsData: Invalid key/object: "'+e+" / "+t+'"');return null},getTilemapData:function(e){return this.getItem(e,n.Cache.TILEMAP,"getTilemapData")},getBinary:function(e){return this.getItem(e,n.Cache.BINARY,"getBinary")},getBitmapData:function(e){return this.getItem(e,n.Cache.BITMAPDATA,"getBitmapData","data")},getBitmapFont:function(e){return this.getItem(e,n.Cache.BITMAPFONT,"getBitmapFont")},getJSON:function(e,t){var r=this.getItem(e,n.Cache.JSON,"getJSON","data");return r?t?n.Utils.extend(!0,r):r:null},getXML:function(e){return this.getItem(e,n.Cache.XML,"getXML","data")},getVideo:function(e){return this.getItem(e,n.Cache.VIDEO,"getVideo")},getShader:function(e){return this.getItem(e,n.Cache.SHADER,"getShader","data")},getRenderTexture:function(e){return this.getItem(e,n.Cache.RENDER_TEXTURE,"getRenderTexture")},getBaseTexture:function(e,t){return void 0===t&&(t=n.Cache.IMAGE),this.getItem(e,t,"getBaseTexture","base")},getFrame:function(e,t){return void 0===t&&(t=n.Cache.IMAGE),this.getItem(e,t,"getFrame","frame")},getFrameCount:function(e,t){var n=this.getFrameData(e,t);return n?n.total:0},getFrameData:function(e,t){return void 0===t&&(t=n.Cache.IMAGE),this.getItem(e,t,"getFrameData","frameData")},hasFrameData:function(e,t){return void 0===t&&(t=n.Cache.IMAGE),null!==this.getItem(e,t,"","frameData")},updateFrameData:function(e,t,r){void 0===r&&(r=n.Cache.IMAGE),this._cacheMap[r][e]&&(this._cacheMap[r][e].frameData=t)},getFrameByIndex:function(e,t,n){var r=this.getFrameData(e,n);return r?r.getFrame(t):null},getFrameByName:function(e,t,n){var r=this.getFrameData(e,n);return r?r.getFrameByName(t):null},getPixiTexture:function(e){if(PIXI.TextureCache[e])return PIXI.TextureCache[e];var t=this.getPixiBaseTexture(e);return t?new PIXI.Texture(t):null},getPixiBaseTexture:function(e){if(PIXI.BaseTextureCache[e])return PIXI.BaseTextureCache[e];var t=this.getItem(e,n.Cache.IMAGE,"getPixiBaseTexture");return null!==t?t.base:null},getURL:function(e){var e=this._resolveURL(e);return e?this._urlMap[e]:(console.warn('Phaser.Cache.getUrl: Invalid url: "'+e+'" or Cache.autoResolveURL was false'),null)},getKeys:function(e){void 0===e&&(e=n.Cache.IMAGE);var t=[];if(this._cacheMap[e])for(var r in this._cacheMap[e])"__default"!==r&&"__missing"!==r&&t.push(r);return t},removeCanvas:function(e){delete this._cache.canvas[e]},removeImage:function(e,t){void 0===t&&(t=!0);var n=this.getImage(e,!0);t&&n.base&&n.base.destroy(),delete this._cache.image[e]},removeSound:function(e){delete this._cache.sound[e]},removeText:function(e){delete this._cache.text[e]},removePhysics:function(e){delete this._cache.physics[e]},removeTilemap:function(e){delete this._cache.tilemap[e]},removeBinary:function(e){delete this._cache.binary[e]},removeBitmapData:function(e){delete this._cache.bitmapData[e]},removeBitmapFont:function(e){delete this._cache.bitmapFont[e]},removeJSON:function(e){delete this._cache.json[e]},removeXML:function(e){delete this._cache.xml[e]},removeVideo:function(e){delete this._cache.video[e]},removeShader:function(e){delete this._cache.shader[e]},removeRenderTexture:function(e){delete this._cache.renderTexture[e]},removeSpriteSheet:function(e){delete this._cache.spriteSheet[e]},removeTextureAtlas:function(e){delete this._cache.atlas[e]},clearGLTextures:function(){for(var e in this._cache.image)this._cache.image[e].base._glTextures=[]},_resolveURL:function(e,t){return this.autoResolveURL?(this._urlResolver.src=this.game.load.baseURL+e,this._urlTemp=this._urlResolver.src,this._urlResolver.src="",t&&(this._urlMap[this._urlTemp]=t),this._urlTemp):null},destroy:function(){for(var e=0;e<this._cacheMap.length;e++){var t=this._cacheMap[e];for(var n in t)"__default"!==n&&"__missing"!==n&&(t[n].destroy&&t[n].destroy(),delete t[n])}this._urlMap=null,this._urlResolver=null,this._urlTemp=null}},n.Cache.prototype.constructor=n.Cache,n.Loader=function(e){this.game=e,this.cache=e.cache,this.resetLocked=!1,this.isLoading=!1,this.hasLoaded=!1,this.preloadSprite=null,this.crossOrigin=!1,this.baseURL="",this.path="",this.onLoadStart=new n.Signal,this.onLoadComplete=new n.Signal,this.onPackComplete=new n.Signal,this.onFileStart=new n.Signal,this.onFileComplete=new n.Signal,this.onFileError=new n.Signal,this.useXDomainRequest=!1,this._warnedAboutXDomainRequest=!1,this.enableParallel=!0,this.maxParallelDownloads=4,this._withSyncPointDepth=0,this._fileList=[],this._flightQueue=[],this._processingHead=0,this._fileLoadStarted=!1,this._totalPackCount=0,this._totalFileCount=0,this._loadedPackCount=0,this._loadedFileCount=0},n.Loader.TEXTURE_ATLAS_JSON_ARRAY=0,n.Loader.TEXTURE_ATLAS_JSON_HASH=1,n.Loader.TEXTURE_ATLAS_XML_STARLING=2,n.Loader.PHYSICS_LIME_CORONA_JSON=3,n.Loader.PHYSICS_PHASER_JSON=4,n.Loader.TEXTURE_ATLAS_JSON_PYXEL=5,n.Loader.prototype={setPreloadSprite:function(e,t){t=t||0,this.preloadSprite={sprite:e,direction:t,width:e.width,height:e.height,rect:null},0===t?this.preloadSprite.rect=new n.Rectangle(0,0,1,e.height):this.preloadSprite.rect=new n.Rectangle(0,0,e.width,1),e.crop(this.preloadSprite.rect),e.visible=!0},resize:function(){this.preloadSprite&&this.preloadSprite.height!==this.preloadSprite.sprite.height&&(this.preloadSprite.rect.height=this.preloadSprite.sprite.height)},checkKeyExists:function(e,t){return this.getAssetIndex(e,t)>-1},getAssetIndex:function(e,t){for(var n=-1,r=0;r<this._fileList.length;r++){var i=this._fileList[r];if(i.type===e&&i.key===t&&(n=r,!i.loaded&&!i.loading))break}return n},getAsset:function(e,t){var n=this.getAssetIndex(e,t);return n>-1?{index:n,file:this._fileList[n]}:!1},reset:function(e,t){void 0===t&&(t=!1),this.resetLocked||(e&&(this.preloadSprite=null),this.isLoading=!1,this._processingHead=0,this._fileList.length=0,this._flightQueue.length=0,this._fileLoadStarted=!1,this._totalFileCount=0,this._totalPackCount=0,this._loadedPackCount=0,this._loadedFileCount=0,t&&(this.onLoadStart.removeAll(),this.onLoadComplete.removeAll(),this.onPackComplete.removeAll(),this.onFileStart.removeAll(),this.onFileComplete.removeAll(),this.onFileError.removeAll()))},addToFileList:function(e,t,n,r,i,s){if(void 0===i&&(i=!1),void 0===t||""===t)return console.warn("Phaser.Loader: Invalid or no key given of type "+e),this;if(void 0===n||null===n){if(!s)return console.warn("Phaser.Loader: No URL given for file type: "+e+" key: "+t),this;n=t+s}var o={type:e,key:t,path:this.path,url:n,syncPoint:this._withSyncPointDepth>0,data:null,loading:!1,loaded:!1,error:!1};if(r)for(var u in r)o[u]=r[u];var a=this.getAssetIndex(e,t);if(i&&a>-1){var f=this._fileList[a];f.loading||f.loaded?(this._fileList.push(o),this._totalFileCount++):this._fileList[a]=o}else-1===a&&(this._fileList.push(o),this._totalFileCount++);return this},replaceInFileList:function(e,t,n,r){return this.addToFileList(e,t,n,r,!0)},pack:function(e,t,n,r){if(void 0===t&&(t=null),void 0===n&&(n=null),void 0===r&&(r=null),!t&&!n)return console.warn("Phaser.Loader.pack - Both url and data are null. One must be set."),this;var i={type:"packfile",key:e,url:t,path:this.path,syncPoint:!0,data:null,loading:!1,loaded:!1,error:!1,callbackContext:r};n&&("string"==typeof n&&(n=JSON.parse(n)),i.data=n||{},i.loaded=!0);for(var s=0;s<this._fileList.length+1;s++){var o=this._fileList[s];if(!o||!o.loaded&&!o.loading&&"packfile"!==o.type){this._fileList.splice(s,0,i),this._totalPackCount++;break}}return this},image:function(e,t,n){return this.addToFileList("image",e,t,void 0,n,".png")},images:function(e,t){if(Array.isArray(t))for(var n=0;n<e.length;n++)this.image(e[n],t[n]);else for(var n=0;n<e.length;n++)this.image(e[n]);return this},text:function(e,t,n){return this.addToFileList("text",e,t,void 0,n,".txt")},json:function(e,t,n){return this.addToFileList("json",e,t,void 0,n,".json")},shader:function(e,t,n){return this.addToFileList("shader",e,t,void 0,n,".frag")},xml:function(e,t,n){return this.addToFileList("xml",e,t,void 0,n,".xml")},script:function(e,t,n,r){return void 0===n&&(n=!1),n!==!1&&void 0===r&&(r=this),this.addToFileList("script",e,t,{syncPoint:!0,callback:n,callbackContext:r},!1,".js")},binary:function(e,t,n,r){return void 0===n&&(n=!1),n!==!1&&void 0===r&&(r=n),this.addToFileList("binary",e,t,{callback:n,callbackContext:r},!1,".bin")},spritesheet:function(e,t,n,r,i,s,o){return void 0===i&&(i=-1),void 0===s&&(s=0),void 0===o&&(o=0),this.addToFileList("spritesheet",e,t,{frameWidth:n,frameHeight:r,frameMax:i,margin:s,spacing:o},!1,".png")},audio:function(e,t,n){return this.game.sound.noAudio?this:(void 0===n&&(n=!0),"string"==typeof t&&(t=[t]),this.addToFileList("audio",e,t,{buffer:null,autoDecode:n}))},audioSprite:function(e,t,n,r,i){return this.game.sound.noAudio?this:(void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=!0),this.audio(e,t,i),n?this.json(e+"-audioatlas",n):r?("string"==typeof r&&(r=JSON.parse(r)),this.cache.addJSON(e+"-audioatlas","",r)):console.warn("Phaser.Loader.audiosprite - You must specify either a jsonURL or provide a jsonData object"),this)},audiosprite:function(e,t,n,r,i){return this.audioSprite(e,t,n,r,i)},video:function(e,t,n,r){return void 0===n&&(n=this.game.device.firefox?"loadeddata":"canplaythrough"),void 0===r&&(r=!1),"string"==typeof t&&(t=[t]),this.addToFileList("video",e,t,{buffer:null,asBlob:r,loadEvent:n})},tilemap:function(e,t,r,i){if(void 0===t&&(t=null),void 0===r&&(r=null),void 0===i&&(i=n.Tilemap.CSV),t||r||(t=i===n.Tilemap.CSV?e+".csv":e+".json"),r){switch(i){case n.Tilemap.CSV:break;case n.Tilemap.TILED_JSON:"string"==typeof r&&(r=JSON.parse(r))}this.cache.addTilemap(e,null,r,i)}else this.addToFileList("tilemap",e,t,{format:i});return this},physics:function(e,t,r,i){return void 0===t&&(t=null),void 0===r&&(r=null),void 0===i&&(i=n.Physics.LIME_CORONA_JSON),t||r||(t=e+".json"),r?("string"==typeof r&&(r=JSON.parse(r)),this.cache.addPhysicsData(e,null,r,i)):this.addToFileList("physics",e,t,{format:i}),this},bitmapFont:function(e,t,n,r,i,s){if((void 0===t||null===t)&&(t=e+".png"),void 0===n&&(n=null),void 0===r&&(r=null),null===n&&null===r&&(n=e+".xml"),void 0===i&&(i=0),void 0===s&&(s=0),n)this.addToFileList("bitmapfont",e,t,{atlasURL:n,xSpacing:i,ySpacing:s});else if("string"==typeof r){var o,u;try{o=JSON.parse(r)}catch(a){u=this.parseXml(r)}if(!u&&!o)throw new Error("Phaser.Loader. Invalid Bitmap Font atlas given");this.addToFileList("bitmapfont",e,t,{atlasURL:null,atlasData:o||u,atlasType:o?"json":"xml",xSpacing:i,ySpacing:s})}return this},atlasJSONArray:function(e,t,r,i){return this.atlas(e,t,r,i,n.Loader.TEXTURE_ATLAS_JSON_ARRAY)},atlasJSONHash:function(e,t,r,i){return this.atlas(e,t,r,i,n.Loader.TEXTURE_ATLAS_JSON_HASH)},atlasXML:function(e,t,r,i){return void 0===r&&(r=null),void 0===i&&(i=null),r||i||(r=e+".xml"),this.atlas(e,t,r,i,n.Loader.TEXTURE_ATLAS_XML_STARLING)},atlas:function(e,t,r,i,s){if((void 0===t||null===t)&&(t=e+".png"),void 0===r&&(r=null),void 0===i&&(i=null),void 0===s&&(s=n.Loader.TEXTURE_ATLAS_JSON_ARRAY),r||i||(r=s===n.Loader.TEXTURE_ATLAS_XML_STARLING?e+".xml":e+".json"),r)this.addToFileList("textureatlas",e,t,{atlasURL:r,format:s});else{switch(s){case n.Loader.TEXTURE_ATLAS_JSON_ARRAY:"string"==typeof i&&(i=JSON.parse(i));break;case n.Loader.TEXTURE_ATLAS_XML_STARLING:if("string"==typeof i){var o=this.parseXml(i);if(!o)throw new Error("Phaser.Loader. Invalid Texture Atlas XML given");i=o}}this.addToFileList("textureatlas",e,t,{atlasURL:null,atlasData:i,format:s})}return this},withSyncPoint:function(e,t){this._withSyncPointDepth++;try{e.call(t||this,this)}finally{this._withSyncPointDepth--}return this},addSyncPoint:function(e,t){var n=this.getAsset(e,t);return n&&(n.file.syncPoint=!0),this},removeFile:function(e,t){var n=this.getAsset(e,t);n&&(n.loaded||n.loading||this._fileList.splice(n.index,1))},removeAll:function(){this._fileList.length=0,this._flightQueue.length=0},start:function(){this.isLoading||(this.hasLoaded=!1,this.isLoading=!0,this.updateProgress(),this.processLoadQueue())},processLoadQueue:function(){if(!this.isLoading)return console.warn("Phaser.Loader - active loading canceled / reset"),void this.finishedLoading(!0);for(var e=0;e<this._flightQueue.length;e++){var t=this._flightQueue[e];(t.loaded||t.error)&&(this._flightQueue.splice(e,1),e--,t.loading=!1,t.requestUrl=null,t.requestObject=null,t.error&&this.onFileError.dispatch(t.key,t),"packfile"!==t.type?(this._loadedFileCount++,this.onFileComplete.dispatch(this.progress,t.key,!t.error,this._loadedFileCount,this._totalFileCount)):"packfile"===t.type&&t.error&&(this._loadedPackCount++,this.onPackComplete.dispatch(t.key,!t.error,this._loadedPackCount,this._totalPackCount)))}for(var r=!1,i=this.enableParallel?n.Math.clamp(this.maxParallelDownloads,1,12):1,e=this._processingHead;e<this._fileList.length;e++){var t=this._fileList[e];if("packfile"===t.type&&!t.error&&t.loaded&&e===this._processingHead&&(this.processPack(t),this._loadedPackCount++,this.onPackComplete.dispatch(t.key,!t.error,this._loadedPackCount,this._totalPackCount)),t.loaded||t.error?e===this._processingHead&&(this._processingHead=e+1):!t.loading&&this._flightQueue.length<i&&("packfile"!==t.type||t.data?r||(this._fileLoadStarted||(this._fileLoadStarted=!0,this.onLoadStart.dispatch()),this._flightQueue.push(t),t.loading=!0,this.onFileStart.dispatch(this.progress,t.key,t.url),this.loadFile(t)):(this._flightQueue.push(t),t.loading=!0,this.loadFile(t))),!t.loaded&&t.syncPoint&&(r=!0),this._flightQueue.length>=i||r&&this._loadedPackCount===this._totalPackCount)break}if(this.updateProgress(),this._processingHead>=this._fileList.length)this.finishedLoading();else if(!this._flightQueue.length){console.warn("Phaser.Loader - aborting: processing queue empty, loading may have stalled");var s=this;setTimeout(function(){s.finishedLoading(!0)},2e3)}},finishedLoading:function(e){this.hasLoaded||(this.hasLoaded=!0,this.isLoading=!1,e||this._fileLoadStarted||(this._fileLoadStarted=!0,this.onLoadStart.dispatch()),this.onLoadComplete.dispatch(),this.game.state.loadComplete(),this.reset())},asyncComplete:function(e,t){void 0===t&&(t=""),e.loaded=!0,e.error=!!t,t&&(e.errorMessage=t,console.warn("Phaser.Loader - "+e.type+"["+e.key+"]: "+t)),this.processLoadQueue()},processPack:function(e){var t=e.data[e.key];if(!t)return void console.warn("Phaser.Loader - "+e.key+": pack has data, but not for pack key");for(var r=0;r<t.length;r++){var i=t[r];switch(i.type){case"image":this.image(i.key,i.url,i.overwrite);break;case"text":this.text(i.key,i.url,i.overwrite);break;case"json":this.json(i.key,i.url,i.overwrite);break;case"xml":this.xml(i.key,i.url,i.overwrite);break;case"script":this.script(i.key,i.url,i.callback,e.callbackContext||this);break;case"binary":this.binary(i.key,i.url,i.callback,e.callbackContext||this);break;case"spritesheet":this.spritesheet(i.key,i.url,i.frameWidth,i.frameHeight,i.frameMax,i.margin,i.spacing);break;case"video":this.video(i.key,i.urls);break;case"audio":this.audio(i.key,i.urls,i.autoDecode);break;case"audiosprite":this.audiosprite(i.key,i.urls,i.jsonURL,i.jsonData,i.autoDecode);break;case"tilemap":this.tilemap(i.key,i.url,i.data,n.Tilemap[i.format]);break;case"physics":this.physics(i.key,i.url,i.data,n.Loader[i.format]);break;case"bitmapFont":this.bitmapFont(i.key,i.textureURL,i.atlasURL,i.atlasData,i.xSpacing,i.ySpacing);break;case"atlasJSONArray":this.atlasJSONArray(i.key,i.textureURL,i.atlasURL,i.atlasData);break;case"atlasJSONHash":this.atlasJSONHash(i.key,i.textureURL,i.atlasURL,i.atlasData);break;case"atlasXML":this.atlasXML(i.key,i.textureURL,i.atlasURL,i.atlasData);break;case"atlas":this.atlas(i.key,i.textureURL,i.atlasURL,i.atlasData,n.Loader[i.format]);break;case"shader":this.shader(i.key,i.url,i.overwrite)}}},transformUrl:function(e,t){return e?e.match(/^(?:blob:|data:|http:\/\/|https:\/\/|\/\/)/)?e:this.baseURL+t.path+e:!1},loadFile:function(e){switch(e.type){case"packfile":this.xhrLoad(e,this.transformUrl(e.url,e),"text",this.fileComplete);break;case"image":case"spritesheet":case"textureatlas":case"bitmapfont":this.loadImageTag(e);break;case"audio":e.url=this.getAudioURL(e.url),e.url?this.game.sound.usingWebAudio?this.xhrLoad(e,this.transformUrl(e.url,e),"arraybuffer",this.fileComplete):this.game.sound.usingAudioTag&&this.loadAudioTag(e):this.fileError(e,null,"No supported audio URL specified or device does not have audio playback support");break;case"video":e.url=this.getVideoURL(e.url),e.url?e.asBlob?this.xhrLoad(e,this.transformUrl(e.url,e),"blob",this.fileComplete):this.loadVideoTag(e):this.fileError(e,null,"No supported video URL specified or device does not have video playback support");break;case"json":this.xhrLoad(e,this.transformUrl(e.url,e),"text",this.jsonLoadComplete);break;case"xml":this.xhrLoad(e,this.transformUrl(e.url,e),"text",this.xmlLoadComplete);break;case"tilemap":e.format===n.Tilemap.TILED_JSON?this.xhrLoad(e,this.transformUrl(e.url,e),"text",this.jsonLoadComplete):e.format===n.Tilemap.CSV?this.xhrLoad(e,this.transformUrl(e.url,e),"text",this.csvLoadComplete):this.asyncComplete(e,"invalid Tilemap format: "+e.format);break;case"text":case"script":case"shader":case"physics":this.xhrLoad(e,this.transformUrl(e.url,e),"text",this.fileComplete);break;case"binary":this.xhrLoad(e,this.transformUrl(e.url,e),"arraybuffer",this.fileComplete)}},loadImageTag:function(e){var t=this;e.data=new Image,e.data.name=e.key,this.crossOrigin&&(e.data.crossOrigin=this.crossOrigin),e.data.onload=function(){e.data.onload&&(e.data.onload=null,e.data.onerror=null,t.fileComplete(e))},e.data.onerror=function(){e.data.onload&&(e.data.onload=null,e.data.onerror=null,t.fileError(e))},e.data.src=this.transformUrl(e.url,e),e.data.complete&&e.data.width&&e.data.height&&(e.data.onload=null,e.data.onerror=null,this.fileComplete(e))},loadVideoTag:function(e){var t=this;e.data=document.createElement("video"),e.data.name=e.key,e.data.controls=!1,e.data.autoplay=!1;var r=function(){e.data.removeEventListener(e.loadEvent,r,!1),e.data.onerror=null,e.data.canplay=!0,n.GAMES[t.game.id].load.fileComplete(e)};e.data.onerror=function(){e.data.removeEventListener(e.loadEvent,r,!1),e.data.onerror=null,e.data.canplay=!1,t.fileError(e)},e.data.addEventListener(e.loadEvent,r,!1),e.data.src=this.transformUrl(e.url,e),e.data.load()},loadAudioTag:function(e){var t=this;if(this.game.sound.touchLocked)e.data=new Audio,e.data.name=e.key,e.data.preload="auto",e.data.src=this.transformUrl(e.url,e),this.fileComplete(e);else{e.data=new Audio,e.data.name=e.key;var n=function(){e.data.removeEventListener("canplaythrough",n,!1),e.data.onerror=null,t.fileComplete(e)};e.data.onerror=function(){e.data.removeEventListener("canplaythrough",n,!1),e.data.onerror=null,t.fileError(e)},e.data.preload="auto",e.data.src=this.transformUrl(e.url,e),e.data.addEventListener("canplaythrough",n,!1),e.data.load()}},xhrLoad:function(e,t,n,r,i){if(this.useXDomainRequest&&window.XDomainRequest)return void this.xhrLoadWithXDR(e,t,n,r,i);var s=new XMLHttpRequest;s.open("GET",t,!0),s.responseType=n,i=i||this.fileError;var o=this;s.onload=function(){try{return 4==s.readyState&&s.status>=400&&s.status<=599?i.call(o,e,s):r.call(o,e,s)}catch(t){o.hasLoaded?window.console&&console.error(t):o.asyncComplete(e,t.message||"Exception")}},s.onerror=function(){try{return i.call(o,e,s)}catch(t){o.hasLoaded?window.console&&console.error(t):o.asyncComplete(e,t.message||"Exception")}},e.requestObject=s,e.requestUrl=t,s.send()},xhrLoadWithXDR:function(e,t,n,r,i){this._warnedAboutXDomainRequest||this.game.device.ie&&!(this.game.device.ieVersion>=10)||(this._warnedAboutXDomainRequest=!0,console.warn("Phaser.Loader - using XDomainRequest outside of IE 9"));var s=new window.XDomainRequest;s.open("GET",t,!0),s.responseType=n,s.timeout=3e3,i=i||this.fileError;var o=this;s.onerror=function(){try{return i.call(o,e,s)}catch(t){o.asyncComplete(e,t.message||"Exception")}},s.ontimeout=function(){try{return i.call(o,e,s)}catch(t){o.asyncComplete(e,t.message||"Exception")}},s.onprogress=function(){},s.onload=function(){try{return 4==s.readyState&&s.status>=400&&s.status<=599?i.call(o,e,s):r.call(o,e,s)}catch(t){o.asyncComplete(e,t.message||"Exception")}},e.requestObject=s,e.requestUrl=t,setTimeout(function(){s.send()},0)},getVideoURL:function(e){for(var t=0;t<e.length;t++){var n,r=e[t];if(r.uri){if(n=r.type,r=r.uri,this.game.device.canPlayVideo(n))return r}else{if(0===r.indexOf("blob:")||0===r.indexOf("data:"))return r;r.indexOf("?")>=0&&(r=r.substr(0,r.indexOf("?")));var i=r.substr((Math.max(0,r.lastIndexOf("."))||1/0)+1);if(n=i.toLowerCase(),this.game.device.canPlayVideo(n))return e[t]}}return null},getAudioURL:function(e){if(this.game.sound.noAudio)return null;for(var t=0;t<e.length;t++){var n,r=e[t];if(r.uri){if(n=r.type,r=r.uri,this.game.device.canPlayAudio(n))return r}else{if(0===r.indexOf("blob:")||0===r.indexOf("data:"))return r;r.indexOf("?")>=0&&(r=r.substr(0,r.indexOf("?")));var i=r.substr((Math.max(0,r.lastIndexOf("."))||1/0)+1);if(n=i.toLowerCase(),this.game.device.canPlayAudio(n))return e[t]}}return null},fileError:function(e,t,n){var r=e.requestUrl||this.transformUrl(e.url,e),i="error loading asset from URL "+r;!n&&t&&(n=t.status),n&&(i=i+" ("+n+")"),this.asyncComplete(e,i)},fileComplete:function(e,t){var r=!0;switch(e.type){case"packfile":var i=JSON.parse(t.responseText);e.data=i||{};break;case"image":this.cache.addImage(e.key,e.url,e.data);break;case"spritesheet":this.cache.addSpriteSheet(e.key,e.url,e.data,e.frameWidth,e.frameHeight,e.frameMax,e.margin,e.spacing);break;case"textureatlas":if(null==e.atlasURL)this.cache.addTextureAtlas(e.key,e.url,e.data,e.atlasData,e.format);else if(r=!1,e.format==n.Loader.TEXTURE_ATLAS_JSON_ARRAY||e.format==n.Loader.TEXTURE_ATLAS_JSON_HASH||e.format==n.Loader.TEXTURE_ATLAS_JSON_PYXEL)this.xhrLoad(e,this.transformUrl(e.atlasURL,e),"text",this.jsonLoadComplete);else{if(e.format!=n.Loader.TEXTURE_ATLAS_XML_STARLING)throw new Error("Phaser.Loader. Invalid Texture Atlas format: "+e.format);this.xhrLoad(e,this.transformUrl(e.atlasURL,e),"text",this.xmlLoadComplete)}break;case"bitmapfont":e.atlasURL?(r=!1,this.xhrLoad(e,this.transformUrl(e.atlasURL,e),"text",function(e,t){var n;try{n=JSON.parse(t.responseText)}catch(r){}n?(e.atlasType="json",this.jsonLoadComplete(e,t)):(e.atlasType="xml",this.xmlLoadComplete(e,t))})):this.cache.addBitmapFont(e.key,e.url,e.data,e.atlasData,e.atlasType,e.xSpacing,e.ySpacing);break;case"video":if(e.asBlob)try{e.data=t.response}catch(s){throw new Error("Phaser.Loader. Unable to parse video file as Blob: "+e.key)}this.cache.addVideo(e.key,e.url,e.data,e.asBlob);break;case"audio":this.game.sound.usingWebAudio?(e.data=t.response,this.cache.addSound(e.key,e.url,e.data,!0,!1),e.autoDecode&&this.game.sound.decode(e.key)):this.cache.addSound(e.key,e.url,e.data,!1,!0);break;case"text":e.data=t.responseText,this.cache.addText(e.key,e.url,e.data);break;case"shader":e.data=t.responseText,this.cache.addShader(e.key,e.url,e.data);break;case"physics":var i=JSON.parse(t.responseText);this.cache.addPhysicsData(e.key,e.url,i,e.format);break;case"script":e.data=document.createElement("script"),e.data.language="javascript",e.data.type="text/javascript",e.data.defer=!1,e.data.text=t.responseText,document.head.appendChild(e.data),e.callback&&(e.data=e.callback.call(e.callbackContext,e.key,t.responseText));break;case"binary":e.callback?e.data=e.callback.call(e.callbackContext,e.key,t.response):e.data=t.response,this.cache.addBinary(e.key,e.data)}r&&this.asyncComplete(e)},jsonLoadComplete:function(e,t){var n=JSON.parse(t.responseText);"tilemap"===e.type?this.cache.addTilemap(e.key,e.url,n,e.format):"bitmapfont"===e.type?this.cache.addBitmapFont(e.key,e.url,e.data,n,e.atlasType,e.xSpacing,e.ySpacing):"json"===e.type?this.cache.addJSON(e.key,e.url,n):this.cache.addTextureAtlas(e.key,e.url,e.data,n,e.format),this.asyncComplete(e)},csvLoadComplete:function(e,t){var n=t.responseText;this.cache.addTilemap(e.key,e.url,n,e.format),this.asyncComplete(e)},xmlLoadComplete:function(e,t){var n=t.responseText,r=this.parseXml(n);if(!r){var i=t.responseType||t.contentType;return console.warn("Phaser.Loader - "+e.key+": invalid XML ("+i+")"),void this.asyncComplete(e,"invalid XML")}"bitmapfont"===e.type?this.cache.addBitmapFont(e.key,e.url,e.data,r,e.atlasType,e.xSpacing,e.ySpacing):"textureatlas"===e.type?this.cache.addTextureAtlas(e.key,e.url,e.data,r,e.format):"xml"===e.type&&this.cache.addXML(e.key,e.url,r),this.asyncComplete(e)},parseXml:function(e){var t;try{if(window.DOMParser){var n=new DOMParser;t=n.parseFromString(e,"text/xml")}else t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e)}catch(r){t=null}return t&&t.documentElement&&!t.getElementsByTagName("parsererror").length?t:null},updateProgress:function(){this.preloadSprite&&(0===this.preloadSprite.direction?this.preloadSprite.rect.width=Math.floor(this.preloadSprite.width/100*this.progress):this.preloadSprite.rect.height=Math.floor(this.preloadSprite.height/100*this.progress),this.preloadSprite.sprite?this.preloadSprite.sprite.updateCrop():this.preloadSprite=null)},totalLoadedFiles:function(){return this._loadedFileCount},totalQueuedFiles:function(){return this._totalFileCount-this._loadedFileCount},totalLoadedPacks:function(){return this._totalPackCount},totalQueuedPacks:function(){return this._totalPackCount-this._loadedPackCount}},Object.defineProperty(n.Loader.prototype,"progressFloat",{get:function(){var e=this._loadedFileCount/this._totalFileCount*100;return n.Math.clamp(e||0,0,100)}}),Object.defineProperty(n.Loader.prototype,"progress",{get:function(){return Math.round(this.progressFloat)}}),n.Loader.prototype.constructor=n.Loader,n.LoaderParser={bitmapFont:function(e,t,n,r){return this.xmlBitmapFont(e,t,n,r)},xmlBitmapFont:function(e,t,n,r){var i={},s=e.getElementsByTagName("info")[0],o=e.getElementsByTagName("common")[0];i.font=s.getAttribute("face"),i.size=parseInt(s.getAttribute("size"),10),i.lineHeight=parseInt(o.getAttribute("lineHeight"),10)+r,i.chars={};for(var u=e.getElementsByTagName("char"),a=0;a<u.length;a++){var f=parseInt(u[a].getAttribute("id"),10);i.chars[f]={x:parseInt(u[a].getAttribute("x"),10),y:parseInt(u[a].getAttribute("y"),10),width:parseInt(u[a].getAttribute("width"),10),height:parseInt(u[a].getAttribute("height"),10),xOffset:parseInt(u[a].getAttribute("xoffset"),10),yOffset:parseInt(u[a].getAttribute("yoffset"),10),xAdvance:parseInt(u[a].getAttribute("xadvance"),10)+n,kerning:{}}}var l=e.getElementsByTagName("kerning");for(a=0;a<l.length;a++){var c=parseInt(l[a].getAttribute("first"),10),h=parseInt(l[a].getAttribute("second"),10),p=parseInt(l[a].getAttribute("amount"),10);i.chars[h].kerning[c]=p}return this.finalizeBitmapFont(t,i)},jsonBitmapFont:function(e,t,n,r){var i={font:e.font.info._face,size:parseInt(e.font.info._size,10),lineHeight:parseInt(e.font.common._lineHeight,10)+r,chars:{}};return e.font.chars["char"].forEach(function(e){var t=parseInt(e._id,10);i.chars[t]={x:parseInt(e._x,10),y:parseInt(e._y,10),width:parseInt(e._width,10),height:parseInt(e._height,10),xOffset:parseInt(e._xoffset,10),yOffset:parseInt(e._yoffset,10),xAdvance:parseInt(e._xadvance,10)+n,kerning:{}}}),e.font.kernings&&e.font.kernings.kerning&&e.font.kernings.kerning.forEach(function(e){i.chars[e._second].kerning[e._first]=parseInt(e._amount,10)}),this.finalizeBitmapFont(t,i)},finalizeBitmapFont:function(e,t){return Object.keys(t.chars).forEach(function(r){var i=t.chars[r];i.texture=new PIXI.Texture(e,new n.Rectangle(i.x,i.y,i.width,i.height))}),t}},n.AudioSprite=function(e,t){this.game=e,this.key=t,this.config=this.game.cache.getJSON(t+"-audioatlas"),this.autoplayKey=null,this.autoplay=!1,this.sounds={};for(var n in this.config.spritemap){var r=this.config.spritemap[n],i=this.game.add.sound(this.key);i.addMarker(n,r.start,r.end-r.start,null,r.loop),this.sounds[n]=i}this.config.autoplay&&(this.autoplayKey=this.config.autoplay,this.play(this.autoplayKey),this.autoplay=this.sounds[this.autoplayKey])},n.AudioSprite.prototype={play:function(e,t){return void 0===t&&(t=1),this.sounds[e].play(e,null,t)},stop:function(e){if(e)this.sounds[e].stop();else for(var t in this.sounds)this.sounds[t].stop()},get:function(e){return this.sounds[e]}},n.AudioSprite.prototype.constructor=n.AudioSprite,n.Sound=function(e,t,r,i,s){void 0===r&&(r=1),void 0===i&&(i=!1),void 0===s&&(s=e.sound.connectToMaster),this.game=e,this.name=t,this.key=t,this.loop=i,this.volume=r,this.markers={},this.context=null,this.autoplay=!1,this.totalDuration=0,this.startTime=0,this.currentTime=0,this.duration=0,this.durationMS=0,this.position=0,this.stopTime=0,this.paused=!1,this.pausedPosition=0,this.pausedTime=0,this.isPlaying=!1,this.currentMarker="",this.fadeTween=null,this.pendingPlayback=!1,this.override=!1,this.allowMultiple=!1,this.usingWebAudio=this.game.sound.usingWebAudio,this.usingAudioTag=this.game.sound.usingAudioTag,this.externalNode=null,this.masterGainNode=null,this.gainNode=null,this._sound=null,this.usingWebAudio?(this.context=this.game.sound.context,this.masterGainNode=this.game.sound.masterGain,void 0===this.context.createGain?this.gainNode=this.context.createGainNode():this.gainNode=this.context.createGain(),this.gainNode.gain.value=r*this.game.sound.volume,s&&this.gainNode.connect(this.masterGainNode)):this.usingAudioTag&&(this.game.cache.getSound(t)&&this.game.cache.isSoundReady(t)?(this._sound=this.game.cache.getSoundData(t),this.totalDuration=0,this._sound.duration&&(this.totalDuration=this._sound.duration)):this.game.cache.onSoundUnlock.add(this.soundHasUnlocked,this)),this.onDecoded=new n.Signal,this.onPlay=new n.Signal,this.onPause=new n.Signal,this.onResume=new n.Signal,this.onLoop=new n.Signal,this.onStop=new n.Signal,this.onMute=new n.Signal,this.onMarkerComplete=new n.Signal,this.onFadeComplete=new n.Signal,this._volume=r,this._buffer=null,this._muted=!1,this._tempMarker=0,this._tempPosition=0,this._tempVolume=0,this._tempPause=0,this._muteVolume=0,this._tempLoop=0,this._paused=!1,this._onDecodedEventDispatched=!1},n.Sound.prototype={soundHasUnlocked:function(e){e===this.key&&(this._sound=this.game.cache.getSoundData(this.key),this.totalDuration=this._sound.duration)},addMarker:function(e,t,n,r,i){(void 0===r||null===r)&&(r=1),void 0===i&&(i=!1),this.markers[e]={name:e,start:t,stop:t+n,volume:r,duration:n,durationMS:1e3*n,loop:i}},removeMarker:function(e){delete this.markers[e]},onEndedHandler:function(){this._sound.onended=null,this.isPlaying=!1,this.currentTime=this.durationMS,this.stop()},update:function(){return this.game.cache.checkSoundKey(this.key)?(this.isDecoded&&!this._onDecodedEventDispatched&&(this.onDecoded.dispatch(this),this._onDecodedEventDispatched=!0),this.pendingPlayback&&this.game.cache.isSoundReady(this.key)&&(this.pendingPlayback=!1,this.play(this._tempMarker,this._tempPosition,this._tempVolume,this._tempLoop)),void (this.isPlaying&&(this.currentTime=this.game.time.time-this.startTime,this.currentTime>=this.durationMS&&(this.usingWebAudio?this.loop?(this.onLoop.dispatch(this),this.isPlaying=!1,""===this.currentMarker?(this.currentTime=0,this.startTime=this.game.time.time):(this.onMarkerComplete.dispatch(this.currentMarker,this),this.play(this.currentMarker,0,this.volume,!0,!0))):""!==this.currentMarker&&this.stop():this.loop?(this.onLoop.dispatch(this),""===this.currentMarker&&(this.currentTime=0,this.startTime=this.game.time.time),this.isPlaying=!1,this.play(this.currentMarker,0,this.volume,!0,!0)):this.stop())))):void this.destroy()},loopFull:function(e){this.play(null,0,e,!0)},play:function(e,t,n,r,i){if((void 0===e||e===!1||null===e)&&(e=""),void 0===i&&(i=!0),this.isPlaying&&!this.allowMultiple&&!i&&!this.override)return this;if(this._sound&&this.isPlaying&&!this.allowMultiple&&(this.override||i))if(this.usingWebAudio){if(void 0===this._sound.stop)this._sound.noteOff(0);else try{this._sound.stop(0)}catch(s){}this.externalNode?this._sound.disconnect(this.externalNode):this._sound.disconnect(this.gainNode)}else this.usingAudioTag&&(this._sound.pause(),this._sound.currentTime=0);if(""===e&&Object.keys(this.markers).length>0)return this;if(""!==e){if(this.currentMarker=e,!this.markers[e])return this;this.position=this.markers[e].start,this.volume=this.markers[e].volume,this.loop=this.markers[e].loop,this.duration=this.markers[e].duration,this.durationMS=this.markers[e].durationMS,"undefined"!=typeof n&&(this.volume=n),"undefined"!=typeof r&&(this.loop=r),this._tempMarker=e,this._tempPosition=this.position,this._tempVolume=this.volume,this._tempLoop=this.loop}else t=t||0,void 0===n&&(n=this._volume),void 0===r&&(r=this.loop),this.position=Math.max(0,t),this.volume=n,this.loop=r,this.duration=0,this.durationMS=0,this._tempMarker=e,this._tempPosition=t,this._tempVolume=n,this._tempLoop=r;return this.usingWebAudio?this.game.cache.isSoundDecoded(this.key)?(this._sound=this.context.createBufferSource(),this.externalNode?this._sound.connect(this.externalNode):this._sound.connect(this.gainNode),this._buffer=this.game.cache.getSoundData(this.key),this._sound.buffer=this._buffer,this.loop&&""===e&&(this._sound.loop=!0),this.loop||""!==e||(this._sound.onended=this.onEndedHandler.bind(this)),this.totalDuration=this._sound.buffer.duration,0===this.duration&&(this.duration=this.totalDuration,this.durationMS=Math.ceil(1e3*this.totalDuration)),void 0===this._sound.start?this._sound.noteGrainOn(0,this.position,this.duration):this.loop&&""===e?this._sound.start(0,0):this._sound.start(0,this.position,this.duration),this.isPlaying=!0,this.startTime=this.game.time.time,this.currentTime=0,this.stopTime=this.startTime+this.durationMS,this.onPlay.dispatch(this)):(this.pendingPlayback=!0,this.game.cache.getSound(this.key)&&this.game.cache.getSound(this.key).isDecoding===!1&&this.game.sound.decode(this.key,this)):this.game.cache.getSound(this.key)&&this.game.cache.getSound(this.key).locked?(this.game.cache.reloadSound(this.key),this.pendingPlayback=!0):this._sound&&(this.game.device.cocoonJS||4===this._sound.readyState)?(this._sound.play(),this.totalDuration=this._sound.duration,0===this.duration&&(this.duration=this.totalDuration,this.durationMS=1e3*this.totalDuration),this._sound.currentTime=this.position,this._sound.muted=this._muted,this._muted||this.game.sound.mute?this._sound.volume=0:this._sound.volume=this._volume,this.isPlaying=!0,this.startTime=this.game.time.time,this.currentTime=0,this.stopTime=this.startTime+this.durationMS,this.onPlay.dispatch(this)):this.pendingPlayback=!0,this},restart:function(e,t,n,r){e=e||"",t=t||0,n=n||1,void 0===r&&(r=!1),this.play(e,t,n,r,!0)},pause:function(){this.isPlaying&&this._sound&&(this.paused=!0,this.pausedPosition=this.currentTime,this.pausedTime=this.game.time.time,this._tempPause=this._sound.currentTime,this.onPause.dispatch(this),this.stop())},resume:function(){if(this.paused&&this._sound){if(this.usingWebAudio){var e=Math.max(0,this.position+this.pausedPosition/1e3);this._sound=this.context.createBufferSource(),this._sound.buffer=this._buffer,this.externalNode?this._sound.connect(this.externalNode):this._sound.connect(this.gainNode),this.loop&&(this._sound.loop=!0),this.loop||""!==this.currentMarker||(this._sound.onended=this.onEndedHandler.bind(this));var t=this.duration-this.pausedPosition/1e3;void 0===this._sound.start?this._sound.noteGrainOn(0,e,t):this.loop&&this.game.device.chrome?42===this.game.device.chromeVersion?this._sound.start(0):this._sound.start(0,e):this._sound.start(0,e,t)}else this._sound.currentTime=this._tempPause,this._sound.play();this.isPlaying=!0,this.paused=!1,this.startTime+=this.game.time.time-this.pausedTime,this.onResume.dispatch(this)}},stop:function(){if(this.isPlaying&&this._sound)if(this.usingWebAudio){if(void 0===this._sound.stop)this._sound.noteOff(0);else try{this._sound.stop(0)}catch(e){}this.externalNode?this._sound.disconnect(this.externalNode):this._sound.disconnect(this.gainNode)}else this.usingAudioTag&&(this._sound.pause(),this._sound.currentTime=0);if(this.pendingPlayback=!1,this.isPlaying=!1,!this.paused){var t=this.currentMarker;""!==this.currentMarker&&this.onMarkerComplete.dispatch(this.currentMarker,this),this.currentMarker="",null!==this.fadeTween&&this.fadeTween.stop(),this.onStop.dispatch(this,t)}},fadeIn:function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=this.currentMarker),this.paused||(this.play(n,0,0,t),this.fadeTo(e,1))},fadeOut:function(e){this.fadeTo(e,0)},fadeTo:function(e,t){if(this.isPlaying&&!this.paused&&t!==this.volume){if(void 0===e&&(e=1e3),void 0===t)return void console.warn("Phaser.Sound.fadeTo: No Volume Specified.");this.fadeTween=this.game.add.tween(this).to({volume:t},e,n.Easing.Linear.None,!0),this.fadeTween.onComplete.add(this.fadeComplete,this)}},fadeComplete:function(){this.onFadeComplete.dispatch(this,this.volume),0===this.volume&&this.stop()},updateGlobalVolume:function(e){this.usingAudioTag&&this._sound&&(this._sound.volume=e*this._volume)},destroy:function(e){void 0===e&&(e=!0),this.stop(),e?this.game.sound.remove(this):(this.markers={},this.context=null,this._buffer=null,this.externalNode=null,this.onDecoded.dispose(),this.onPlay.dispose(),this.onPause.dispose(),this.onResume.dispose(),this.onLoop.dispose(),this.onStop.dispose(),this.onMute.dispose(),this.onMarkerComplete.dispose())}},n.Sound.prototype.constructor=n.Sound,Object.defineProperty(n.Sound.prototype,"isDecoding",{get:function(){return this.game.cache.getSound(this.key).isDecoding}}),Object.defineProperty(n.Sound.prototype,"isDecoded",{get:function(){return this.game.cache.isSoundDecoded(this.key)}}),Object.defineProperty(n.Sound.prototype,"mute",{get:function(){return this._muted||this.game.sound.mute},set:function(e){e=e||!1,e!==this._muted&&(e?(this._muted=!0,this._muteVolume=this._tempVolume,this.usingWebAudio?this.gainNode.gain.value=0:this.usingAudioTag&&this._sound&&(this._sound.volume=0)):(this._muted=!1,this.usingWebAudio?this.gainNode.gain.value=this._muteVolume:this.usingAudioTag&&this._sound&&(this._sound.volume=this._muteVolume)),this.onMute.dispatch(this))}}),Object.defineProperty(n.Sound.prototype,"volume",{get:function(){return this._volume},set:function(e){return this.game.device.firefox&&this.usingAudioTag&&(e=this.game.math.clamp(e,0,1)),this._muted?void (this._muteVolume=e):(this._tempVolume=e,this._volume=e,void (this.usingWebAudio?this.gainNode.gain.value=e:this.usingAudioTag&&this._sound&&(this._sound.volume=e)))}}),n.SoundManager=function(e){this.game=e,this.onSoundDecode=new n.Signal,this.onVolumeChange=new n.Signal,this.onMute=new n.Signal,this.onUnMute=new n.Signal,this.context=null,this.usingWebAudio=!1,this.usingAudioTag=!1,this.noAudio=!1,this.connectToMaster=!0,this.touchLocked=!1,this.channels=32,this.muteOnPause=!0,this._codeMuted=!1,this._muted=!1,this._unlockSource=null,this._volume=1,this._sounds=[],this._watchList=new n.ArraySet,this._watching=!1,this._watchCallback=null,this._watchContext=null},n.SoundManager.prototype={boot:function(){if(this.game.device.iOS&&this.game.device.webAudio===!1&&(this.channels=1),window.PhaserGlobal){if(window.PhaserGlobal.disableAudio===!0)return this.noAudio=!0,void (this.touchLocked=!1);if(window.PhaserGlobal.disableWebAudio===!0)return this.usingAudioTag=!0,void (this.touchLocked=!1)}if(window.PhaserGlobal&&window.PhaserGlobal.audioContext)this.context=window.PhaserGlobal.audioContext;else if(window.AudioContext)try{this.context=new window.AudioContext}catch(e){this.context=null,this.usingWebAudio=!1,this.touchLocked=!1}else if(window.webkitAudioContext)try{this.context=new window.webkitAudioContext}catch(e){this.context=null,this.usingWebAudio=!1,this.touchLocked=!1}if(null===this.context){if(void 0===window.Audio)return void (this.noAudio=!0);this.usingAudioTag=!0}else this.usingWebAudio=!0,void 0===this.context.createGain?this.masterGain=this.context.createGainNode():this.masterGain=this.context.createGain(),this.masterGain.gain.value=1,this.masterGain.connect(this.context.destination);this.noAudio||(!this.game.device.cocoonJS&&this.game.device.iOS||window.PhaserGlobal&&window.PhaserGlobal.fakeiOSTouchLock)&&this.setTouchLock()},setTouchLock:function(){this.noAudio||window.PhaserGlobal&&window.PhaserGlobal.disableAudio===!0||(this.game.device.iOSVersion>8?this.game.input.touch.addTouchLockCallback(this.unlock,this,!0):this.game.input.touch.addTouchLockCallback(this.unlock,this),this.touchLocked=!0)},unlock:function(){if(this.noAudio||!this.touchLocked||null!==this._unlockSource)return!0;if(this.usingAudioTag)this.touchLocked=!1,this._unlockSource=null;else if(this.usingWebAudio){var e=this.context.createBuffer(1,1,22050);this._unlockSource=this.context.createBufferSource(),this._unlockSource.buffer=e,this._unlockSource.connect(this.context.destination),void 0===this._unlockSource.start?this._unlockSource.noteOn(0):this._unlockSource.start(0)}return!0},stopAll:function(){if(!this.noAudio)for(var e=0;e<this._sounds.length;e++)this._sounds[e]&&this._sounds[e].stop()},pauseAll:function(){if(!this.noAudio)for(var e=0;e<this._sounds.length;e++)this._sounds[e]&&this._sounds[e].pause()},resumeAll:function(){if(!this.noAudio)for(var e=0;e<this._sounds.length;e++)this._sounds[e]&&this._sounds[e].resume()},decode:function(e,t){t=t||null;var n=this.game.cache.getSoundData(e);if(n&&this.game.cache.isSoundDecoded(e)===!1){this.game.cache.updateSound(e,"isDecoding",!0);var r=this;try{this.context.decodeAudioData(n,function(n){n&&(r.game.cache.decodedSound(e,n),r.onSoundDecode.dispatch(e,t))})}catch(i){}}},setDecodedCallback:function(e,t,r){"string"==typeof e&&(e=[e]),this._watchList.reset();for(var i=0;i<e.length;i++)e[i]instanceof n.Sound?this.game.cache.isSoundDecoded(e[i].key)||this._watchList.add(e[i].key):this.game.cache.isSoundDecoded(e[i])||this._watchList.add(e[i]);0===this._watchList.total?(this._watching=!1,t.call(r)):(this._watching=!0,this._watchCallback=t,this._watchContext=r)},update:function(){if(!this.noAudio){!this.touchLocked||null===this._unlockSource||this._unlockSource.playbackState!==this._unlockSource.PLAYING_STATE&&this._unlockSource.playbackState!==this._unlockSource.FINISHED_STATE||(this.touchLocked=!1,this._unlockSource=null);for(var e=0;e<this._sounds.length;e++)this._sounds[e].update();if(this._watching){for(var t=this._watchList.first;t;)this.game.cache.isSoundDecoded(t)&&this._watchList.remove(t),t=this._watchList.next;0===this._watchList.total&&(this._watching=!1,this._watchCallback.call(this._watchContext))}}},add:function(e,t,r,i){void 0===t&&(t=1),void 0===r&&(r=!1),void 0===i&&(i=this.connectToMaster);var s=new n.Sound(this.game,e,t,r,i);return this._sounds.push(s),s},addSprite:function(e){var t=new n.AudioSprite(this.game,e);return t},remove:function(e){for(var t=this._sounds.length;t--;)if(this._sounds[t]===e)return this._sounds[t].destroy(!1),this._sounds.splice(t,1),!0;return!1},removeByKey:function(e){for(var t=this._sounds.length,n=0;t--;)this._sounds[t].key===e&&(this._sounds[t].destroy(!1),this._sounds.splice(t,1),n++);return n},play:function(e,t,n){if(!this.noAudio){var r=this.add(e,t,n);return r.play(),r}},setMute:function(){if(!this._muted){this._muted=!0,this.usingWebAudio&&(this._muteVolume=this.masterGain.gain.value,this.masterGain.gain.value=0);for(var e=0;e<this._sounds.length;e++)this._sounds[e].usingAudioTag&&(this._sounds[e].mute=!0);this.onMute.dispatch()}},unsetMute:function(){if(this._muted&&!this._codeMuted){this._muted=!1,this.usingWebAudio&&(this.masterGain.gain.value=this._muteVolume);for(var e=0;e<this._sounds.length;e++)this._sounds[e].usingAudioTag&&(this._sounds[e].mute=!1);this.onUnMute.dispatch()}},destroy:function(){this.stopAll();for(var e=0;e<this._sounds.length;e++)this._sounds[e]&&this._sounds[e].destroy();this._sounds=[],this.onSoundDecode.dispose(),this.context&&(window.PhaserGlobal?window.PhaserGlobal.audioContext=this.context:this.context.close&&this.context.close())}},n.SoundManager.prototype.constructor=n.SoundManager,Object.defineProperty(n.SoundManager.prototype,"mute",{get:function(){return this._muted},set:function(e){if(e=e||!1){if(this._muted)return;this._codeMuted=!0,this.setMute()}else{if(!this._muted)return;this._codeMuted=!1,this.unsetMute()}}}),Object.defineProperty(n.SoundManager.prototype,"volume",{get:function(){return this._volume},set:function(e){if(0>e?e=0:e>1&&(e=1),this._volume!==e){if(this._volume=e,this.usingWebAudio)this.masterGain.gain.value=e;else for(var t=0;t<this._sounds.length;t++)this._sounds[t].usingAudioTag&&this._sounds[t].updateGlobalVolume(e);this.onVolumeChange.dispatch(e)}}}),n.ScaleManager=function(e,t,r){this.game=e,this.dom=n.DOM,this.grid=null,this.width=0,this.height=0,this.minWidth=null,this.maxWidth=null,this.minHeight=null,this.maxHeight=null,this.offset=new n.Point,this.forceLandscape=!1,this.forcePortrait=!1,this.incorrectOrientation=!1,this._pageAlignHorizontally=!1,this._pageAlignVertically=!1,this.onOrientationChange=new n.Signal,this.enterIncorrectOrientation=new n.Signal,this.leaveIncorrectOrientation=new n.Signal,this.fullScreenTarget=null,this._createdFullScreenTarget=null,this.onFullScreenInit=new n.Signal,this.onFullScreenChange=new n.Signal,this.onFullScreenError=new n.Signal,this.screenOrientation=this.dom.getScreenOrientation(),this.scaleFactor=new n.Point(1,1),this.scaleFactorInversed=new n.Point(1,1),this.margin={left:0,top:0,right:0,bottom:0,x:0,y:0},this.bounds=new n.Rectangle,this.aspectRatio=0,this.sourceAspectRatio=0,this.event=null,this.windowConstraints={right:"layout",bottom:""},this.compatibility={supportsFullScreen:!1,orientationFallback:null,noMargins:!1,scrollTo:null,forceMinimumDocumentHeight:!1,canExpandParent:!0,clickTrampoline:""},this._scaleMode=n.ScaleManager.NO_SCALE,this._fullScreenScaleMode=n.ScaleManager.NO_SCALE,this.parentIsWindow=!1,this.parentNode=null,this.parentScaleFactor=new n.Point(1,1),this.trackParentInterval=2e3,this.onSizeChange=new n.Signal,this.onResize=null,this.onResizeContext=null,this._pendingScaleMode=null,this._fullScreenRestore=null,this._gameSize=new n.Rectangle,this._userScaleFactor=new n.Point(1,1),this._userScaleTrim=new n.Point(0,0),this._lastUpdate=0,this._updateThrottle=0,this._updateThrottleReset=100,this._parentBounds=new n.Rectangle,this._tempBounds=new n.Rectangle,this._lastReportedCanvasSize=new n.Rectangle,this._lastReportedGameSize=new n.Rectangle,this._booted=!1,e.config&&this.parseConfig(e.config),this.setupScale(t,r)},n.ScaleManager.EXACT_FIT=0,n.ScaleManager.NO_SCALE=1,n.ScaleManager.SHOW_ALL=2,n.ScaleManager.RESIZE=3,n.ScaleManager.USER_SCALE=4,n.ScaleManager.prototype={boot:function(){var e=this.compatibility;e.supportsFullScreen=this.game.device.fullscreen&&!this.game.device.cocoonJS,this.game.device.iPad||this.game.device.webApp||this.game.device.desktop||(this.game.device.android&&!this.game.device.chrome?e.scrollTo=new n.Point(0,1):e.scrollTo=new n.Point(0,0)),this.game.device.desktop?(e.orientationFallback="screen",e.clickTrampoline="when-not-mouse"):(e.orientationFallback="",e.clickTrampoline="");var t=this;this._orientationChange=function(e){return t.orientationChange(e)},this._windowResize=function(e){return t.windowResize(e)},window.addEventListener("orientationchange",this._orientationChange,!1),window.addEventListener("resize",this._windowResize,!1),this.compatibility.supportsFullScreen&&(this._fullScreenChange=function(e){return t.fullScreenChange(e)},this._fullScreenError=function(e){return t.fullScreenError(e)},document.addEventListener("webkitfullscreenchange",this._fullScreenChange,!1),document.addEventListener("mozfullscreenchange",this._fullScreenChange,!1),document.addEventListener("MSFullscreenChange",this._fullScreenChange,!1),document.addEventListener("fullscreenchange",this._fullScreenChange,!1),document.addEventListener("webkitfullscreenerror",this._fullScreenError,!1),document.addEventListener("mozfullscreenerror",this._fullScreenError,!1),document.addEventListener("MSFullscreenError",this._fullScreenError,!1),document.addEventListener("fullscreenerror",this._fullScreenError,!1)),this.game.onResume.add(this._gameResumed,this),this.dom.getOffset(this.game.canvas,this.offset),this.bounds.setTo(this.offset.x,this.offset.y,this.width,this.height),this.setGameSize(this.game.width,this.game.height),this.screenOrientation=this.dom.getScreenOrientation(this.compatibility.orientationFallback),n.FlexGrid&&(this.grid=new n.FlexGrid(this,this.width,this.height)),this._booted=!0,null!==this._pendingScaleMode&&(this.scaleMode=this._pendingScaleMode,this._pendingScaleMode=null)},parseConfig:function(e){void 0!==e.scaleMode&&(this._booted?this.scaleMode=e.scaleMode:this._pendingScaleMode=e.scaleMode),void 0!==e.fullScreenScaleMode&&(this.fullScreenScaleMode=e.fullScreenScaleMode),e.fullScreenTarget&&(this.fullScreenTarget=e.fullScreenTarget)},setupScale:function(e,t){var r,i=new n.Rectangle;""!==this.game.parent&&("string"==typeof this.game.parent?r=document.getElementById(this.game.parent):this.game.parent&&1===this.game.parent.nodeType&&(r=this.game.parent)),r?(this.parentNode=r,this.parentIsWindow=!1,this.getParentBounds(this._parentBounds),i.width=this._parentBounds.width,i.height=this._parentBounds.height,this.offset.set(this._parentBounds.x,this._parentBounds.y)):(this.parentNode=null,this.parentIsWindow=!0,i.width=this.dom.visualBounds.width,i.height=this.dom.visualBounds.height,this.offset.set(0,0));var s=0,o=0;"number"==typeof e?s=e:(this.parentScaleFactor.x=parseInt(e,10)/100,s=i.width*this.parentScaleFactor.x),"number"==typeof t?o=t:(this.parentScaleFactor.y=parseInt(t,10)/100,o=i.height*this.parentScaleFactor.y),s=Math.floor(s),o=Math.floor(o),this._gameSize.setTo(0,0,s,o),this.updateDimensions(s,o,!1)},_gameResumed:function(){this.queueUpdate(!0)},setGameSize:function(e,t){this._gameSize.setTo(0,0,e,t),this.currentScaleMode!==n.ScaleManager.RESIZE&&this.updateDimensions(e,t,!0),this.queueUpdate(!0)},setUserScale:function(e,t,n,r){this._userScaleFactor.setTo(e,t),this._userScaleTrim.setTo(0|n,0|r),this.queueUpdate(!0)},setResizeCallback:function(e,t){this.onResize=e,this.onResizeContext=t},signalSizeChange:function(){if(!n.Rectangle.sameDimensions(this,this._lastReportedCanvasSize)||!n.Rectangle.sameDimensions(this.game,this._lastReportedGameSize)){var e=this.width,t=this.height;this._lastReportedCanvasSize.setTo(0,0,e,t),this._lastReportedGameSize.setTo(0,0,this.game.width,this.game.height),this.grid&&this.grid.onResize(e,t),this.onSizeChange.dispatch(this,e,t),this.currentScaleMode===n.ScaleManager.RESIZE&&(this.game.state.resize(e,t),this.game.load.resize(e,t))}},setMinMax:function(e,t,n,r){this.minWidth=e,this.minHeight=t,"undefined"!=typeof n&&(this.maxWidth=n),"undefined"!=typeof r&&(this.maxHeight=r)},preUpdate:function(){if(!(this.game.time.time<this._lastUpdate+this._updateThrottle)){var e=this._updateThrottle;this._updateThrottleReset=e>=400?0:100,this.dom.getOffset(this.game.canvas,this.offset);var t=this._parentBounds.width,r=this._parentBounds.height,i=this.getParentBounds(this._parentBounds),s=i.width!==t||i.height!==r,o=this.updateOrientationState();(s||o)&&(this.onResize&&this.onResize.call(this.onResizeContext,this,i),this.updateLayout(),this.signalSizeChange());var u=2*this._updateThrottle;this._updateThrottle<e&&(u=Math.min(e,this._updateThrottleReset)),this._updateThrottle=n.Math.clamp(u,25,this.trackParentInterval),this._lastUpdate=this.game.time.time}},pauseUpdate:function(){this.preUpdate(),this._updateThrottle=this.trackParentInterval},updateDimensions:function(e,t,n){this.width=e*this.parentScaleFactor.x,this.height=t*this.parentScaleFactor.y,this.game.width=this.width,this.game.height=this.height,this.sourceAspectRatio=this.width/this.height,this.updateScalingAndBounds(),n&&(this.game.renderer.resize(this.width,this.height),this.game.camera.setSize(this.width,this.height),this.game.world.resize(this.width,this.height))},updateScalingAndBounds:function(){this.scaleFactor.x=this.game.width/this.width,this.scaleFactor.y=this.game.height/this.height,this.scaleFactorInversed.x=this.width/this.game.width,this.scaleFactorInversed.y=this.height/this.game.height,this.aspectRatio=this.width/this.height,this.game.canvas&&this.dom.getOffset(this.game.canvas,this.offset),this.bounds.setTo(this.offset.x,this.offset.y,this.width,this.height),this.game.input&&this.game.input.scale&&this.game.input.scale.setTo(this.scaleFactor.x,this.scaleFactor.y)},forceOrientation:function(e,t){void 0===t&&(t=!1),this.forceLandscape=e,this.forcePortrait=t,this.queueUpdate(!0)},classifyOrientation:function(e){return"portrait-primary"===e||"portrait-secondary"===e?"portrait":"landscape-primary"===e||"landscape-secondary"===e?"landscape":null},updateOrientationState:function(){var e=this.screenOrientation,t=this.incorrectOrientation;this.screenOrientation=this.dom.getScreenOrientation(this.compatibility.orientationFallback),this.incorrectOrientation=this.forceLandscape&&!this.isLandscape||this.forcePortrait&&!this.isPortrait;var n=e!==this.screenOrientation,r=t!==this.incorrectOrientation;return r&&(this.incorrectOrientation?this.enterIncorrectOrientation.dispatch():this.leaveIncorrectOrientation.dispatch()),(n||r)&&this.onOrientationChange.dispatch(this,e,t),n||r},orientationChange:function(e){this.event=e,this.queueUpdate(!0)},windowResize:function(e){this.event=e,this.queueUpdate(!0)},scrollTop:function(){var e=this.compatibility.scrollTo;e&&window.scrollTo(e.x,e.y)},refresh:function(){this.scrollTop(),this.queueUpdate(!0)},updateLayout:function(){var e=this.currentScaleMode;if(e===n.ScaleManager.RESIZE)return void this.reflowGame();if(this.scrollTop(),this.compatibility.forceMinimumDocumentHeight&&(document.documentElement.style.minHeight=window.innerHeight+"px"),this.incorrectOrientation?this.setMaximum():e===n.ScaleManager.EXACT_FIT?this.setExactFit():e===n.ScaleManager.SHOW_ALL?!this.isFullScreen&&this.boundingParent&&this.compatibility.canExpandParent?(this.setShowAll(!0),this.resetCanvas(),this.setShowAll()):this.setShowAll():e===n.ScaleManager.NO_SCALE?(this.width=this.game.width,this.height=this.game.height):e===n.ScaleManager.USER_SCALE&&(this.width=this.game.width*this._userScaleFactor.x-this._userScaleTrim.x,this.height=this.game.height*this._userScaleFactor.y-this._userScaleTrim.y),!this.compatibility.canExpandParent&&(e===n.ScaleManager.SHOW_ALL||e===n.ScaleManager.USER_SCALE)){var t=this.getParentBounds(this._tempBounds);this.width=Math.min(this.width,t.width),this.height=Math.min(this.height,t.height)}this.width=0|this.width,this.height=0|this.height,this.reflowCanvas()},getParentBounds:function(e){var t=e||new n.Rectangle,r=this.boundingParent,i=this.dom.visualBounds,s=this.dom.layoutBounds;if(r){var o=r.getBoundingClientRect(),u=r.offsetParent?r.offsetParent.getBoundingClientRect():r.getBoundingClientRect();t.setTo(o.left-u.left,o.top-u.top,o.width,o.height);var a=this.windowConstraints;if(a.right){var f="layout"===a.right?s:i;t.right=Math.min(t.right,f.width)}if(a.bottom){var f="layout"===a.bottom?s:i;t.bottom=Math.min(t.bottom,f.height)}}else t.setTo(0,0,i.width,i.height);return t.setTo(Math.round(t.x),Math.round(t.y),Math.round(t.width),Math.round(t.height)),t},alignCanvas:function(e,t){var n=this.getParentBounds(this._tempBounds),r=this.game.canvas,i=this.margin;if(e){i.left=i.right=0;var s=r.getBoundingClientRect();if(this.width<n.width&&!this.incorrectOrientation){var o=s.left-n.x,u=n.width/2-this.width/2;u=Math.max(u,0);var a=u-o;i.left=Math.round(a)}r.style.marginLeft=i.left+"px",0!==i.left&&(i.right=-(n.width-s.width-i.left),r.style.marginRight=i.right+"px")}if(t){i.top=i.bottom=0;var s=r.getBoundingClientRect();if(this.height<n.height&&!this.incorrectOrientation){var o=s.top-n.y,u=n.height/2-this.height/2;u=Math.max(u,0);var a=u-o;i.top=Math.round(a)}r.style.marginTop=i.top+"px",0!==i.top&&(i.bottom=-(n.height-s.height-i.top),r.style.marginBottom=i.bottom+"px")}i.x=i.left,i.y=i.top},reflowGame:function(){this.resetCanvas("","");var e=this.getParentBounds(this._tempBounds);this.updateDimensions(e.width,e.height,!0)},reflowCanvas:function(){this.incorrectOrientation||(this.width=n.Math.clamp(this.width,this.minWidth||0,this.maxWidth||this.width),this.height=n.Math.clamp(this.height,this.minHeight||0,this.maxHeight||this.height)),this.resetCanvas(),this.compatibility.noMargins||(this.isFullScreen&&this._createdFullScreenTarget?this.alignCanvas(!0,!0):this.alignCanvas(this.pageAlignHorizontally,this.pageAlignVertically)),this.updateScalingAndBounds()},resetCanvas:function(e,t){void 0===e&&(e=this.width+"px"),void 0===t&&(t=this.height+"px");var n=this.game.canvas;this.compatibility.noMargins||(n.style.marginLeft="",n.style.marginTop="",n.style.marginRight="",n.style.marginBottom=""),n.style.width=e,n.style.height=t},queueUpdate:function(e){e&&(this._parentBounds.width=0,this._parentBounds.height=0),this._updateThrottle=this._updateThrottleReset},reset:function(e){e&&this.grid&&this.grid.reset()},setMaximum:function(){this.width=this.dom.visualBounds.width,this.height=this.dom.visualBounds.height},setShowAll:function(e){var t,n=this.getParentBounds(this._tempBounds),r=n.width,i=n.height;t=e?Math.max(i/this.game.height,r/this.game.width):Math.min(i/this.game.height,r/this.game.width),this.width=Math.round(this.game.width*t),this.height=Math.round(this.game.height*t)},setExactFit:function(){var e=this.getParentBounds(this._tempBounds);this.width=e.width,this.height=e.height,this.isFullScreen||(this.maxWidth&&(this.width=Math.min(this.width,this.maxWidth)),this.maxHeight&&(this.height=Math.min(this.height,this.maxHeight)))},createFullScreenTarget:function(){var e=document.createElement("div");return e.style.margin="0",e.style.padding="0",e.style.background="#000",e},startFullScreen:function(e,t){if(this.isFullScreen)return!1;if(!this.compatibility.supportsFullScreen){var r=this;return void setTimeout(function(){r.fullScreenError()},10)}if("when-not-mouse"===this.compatibility.clickTrampoline){var i=this.game.input;if(i.activePointer&&i.activePointer!==i.mousePointer&&(t||t!==!1))return void i.activePointer.addClickTrampoline("startFullScreen",this.startFullScreen,this,[e,!1])}"undefined"!=typeof e&&this.game.renderType===n.CANVAS&&(this.game.stage.smoothed=e);var s=this.fullScreenTarget;s||(this.cleanupCreatedTarget(),this._createdFullScreenTarget=this.createFullScreenTarget(),s=this._createdFullScreenTarget);var o={targetElement:s};if(this.onFullScreenInit.dispatch(this,o),this._createdFullScreenTarget){var u=this.game.canvas,a=u.parentNode;a.insertBefore(s,u),s.appendChild(u)}return this.game.device.fullscreenKeyboard?s[this.game.device.requestFullscreen](Element.ALLOW_KEYBOARD_INPUT):s[this.game.device.requestFullscreen](),!0},stopFullScreen:function(){return this.isFullScreen&&this.compatibility.supportsFullScreen?(document[this.game.device.cancelFullscreen](),!0):!1},cleanupCreatedTarget:function(){var e=this._createdFullScreenTarget;if(e&&e.parentNode){var t=e.parentNode;t.insertBefore(this.game.canvas,e),t.removeChild(e)}this._createdFullScreenTarget=null},prepScreenMode:function(e){var t=!!this._createdFullScreenTarget,r=this._createdFullScreenTarget||this.fullScreenTarget;e?(t||this.fullScreenScaleMode===n.ScaleManager.EXACT_FIT)&&r!==this.game.canvas&&(this._fullScreenRestore={targetWidth:r.style.width,targetHeight:r.style.height},r.style.width="100%",r.style.height="100%"):(this._fullScreenRestore&&(r.style.width=this._fullScreenRestore.targetWidth,r.style.height=this._fullScreenRestore.targetHeight,this._fullScreenRestore=null),this.updateDimensions(this._gameSize.width,this._gameSize.height,!0),this.resetCanvas())},fullScreenChange:function(e){this.event=e,this.isFullScreen?(this.prepScreenMode(!0),this.updateLayout(),this.queueUpdate(!0)):(this.prepScreenMode(!1),this.cleanupCreatedTarget(),this.updateLayout(),this.queueUpdate(!0)),this.onFullScreenChange.dispatch(this,this.width,this.height)},fullScreenError:function(e){this.event=e,this.cleanupCreatedTarget(),console.warn("Phaser.ScaleManager: requestFullscreen failed or device does not support the Fullscreen API"),this.onFullScreenError.dispatch(this)},scaleSprite:function(e,t,n,r){if(void 0===t&&(t=this.width),void 0===n&&(n=this.height),void 0===r&&(r=!1),!e||!e.scale)return e;if(e.scale.x=1,e.scale.y=1,e.width<=0||e.height<=0||0>=t||0>=n)return e;var i=t,s=e.height*t/e.width,o=e.width*n/e.height,u=n,a=o>t;return a=a?r:!r,a?(e.width=Math.floor(i),e.height=Math.floor(s)):(e.width=Math.floor(o),e.height=Math.floor(u)),e},destroy:function(){this.game.onResume.remove(this._gameResumed,this),window.removeEventListener("orientationchange",this._orientationChange,!1),window.removeEventListener("resize",this._windowResize,!1),this.compatibility.supportsFullScreen&&(document.removeEventListener("webkitfullscreenchange",this._fullScreenChange,!1),document.removeEventListener("mozfullscreenchange",this._fullScreenChange,!1),document.removeEventListener("MSFullscreenChange",this._fullScreenChange,!1),document.removeEventListener("fullscreenchange",this._fullScreenChange,!1),document.removeEventListener("webkitfullscreenerror",this._fullScreenError,!1),document.removeEventListener("mozfullscreenerror",this._fullScreenError,!1),document.removeEventListener("MSFullscreenError",this._fullScreenError,!1),document.removeEventListener("fullscreenerror",this._fullScreenError,!1))}},n.ScaleManager.prototype.constructor=n.ScaleManager,Object.defineProperty(n.ScaleManager.prototype,"boundingParent",{get:function(){if(this.parentIsWindow||this.isFullScreen&&!this._createdFullScreenTarget)return null;var e=this.game.canvas&&this.game.canvas.parentNode;return e||null}}),Object.defineProperty(n.ScaleManager.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(e){return e!==this._scaleMode&&(this.isFullScreen||(this.updateDimensions(this._gameSize.width,this._gameSize.height,!0),this.queueUpdate(!0)),this._scaleMode=e),this._scaleMode}}),Object.defineProperty(n.ScaleManager.prototype,"fullScreenScaleMode",{get:function(){return this._fullScreenScaleMode},set:function(e){return e!==this._fullScreenScaleMode&&(this.isFullScreen?(this.prepScreenMode(!1),this._fullScreenScaleMode=e,this.prepScreenMode(!0),this.queueUpdate(!0)):this._fullScreenScaleMode=e),this._fullScreenScaleMode}}),Object.defineProperty(n.ScaleManager.prototype,"currentScaleMode",{get:function(){return this.isFullScreen?this._fullScreenScaleMode:this._scaleMode}}),Object.defineProperty(n.ScaleManager.prototype,"pageAlignHorizontally",{get:function(){return this._pageAlignHorizontally},set:function(e){e!==this._pageAlignHorizontally&&(this._pageAlignHorizontally=e,this.queueUpdate(!0))}}),Object.defineProperty(n.ScaleManager.prototype,"pageAlignVertically",{get:function(){return this._pageAlignVertically},set:function(e){e!==this._pageAlignVertically&&(this._pageAlignVertically=e,this.queueUpdate(!0))}}),Object.defineProperty(n.ScaleManager.prototype,"isFullScreen",{get:function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)}}),Object.defineProperty(n.ScaleManager.prototype,"isPortrait",{get:function(){return"portrait"===this.classifyOrientation(this.screenOrientation)}}),Object.defineProperty(n.ScaleManager.prototype,"isLandscape",{get:function(){return"landscape"===this.classifyOrientation(this.screenOrientation)}}),Object.defineProperty(n.ScaleManager.prototype,"isGamePortrait",{get:function(){return this.height>this.width}}),Object.defineProperty(n.ScaleManager.prototype,"isGameLandscape",{get:function(){return this.width>this.height}}),n.Utils.Debug=function(e){this.game=e,this.sprite=null,this.bmd=null,this.canvas=null,this.context=null,this.font="14px Courier",this.columnWidth=100,this.lineHeight=16,this.renderShadow=!0,this.currentX=0,this.currentY=0,this.currentAlpha=1,this.dirty=!1},n.Utils.Debug.prototype={boot:function(){this.game.renderType===n.CANVAS?this.context=this.game.context:(this.bmd=this.game.make.bitmapData(this.game.width,this.game.height),this.sprite=this.game.make.image(0,0,this.bmd),this.game.stage.addChild(this.sprite),this.game.scale.onSizeChange.add(this.resize,this),this.canvas=PIXI.CanvasPool.create(this,this.game.width,this.game.height),this.context=this.canvas.getContext("2d"))},resize:function(e,t,n){this.bmd.resize(t,n),this.canvas.width=t,this.canvas.height=n},preUpdate:function(){this.dirty&&this.sprite&&(this.bmd.clear(),this.bmd.draw(this.canvas,0,0),this.context.clearRect(0,0,this.game.width,this.game.height),this.dirty=!1)},reset:function(){this.context&&this.context.clearRect(0,0,this.game.width,this.game.height),this.sprite&&this.bmd.clear()},start:function(e,t,n,r){"number"!=typeof e&&(e=0),"number"!=typeof t&&(t=0),n=n||"rgb(255,255,255)",void 0===r&&(r=0),this.currentX=e,this.currentY=t,this.currentColor=n,this.columnWidth=r,this.dirty=!0,this.context.save(),this.context.setTransform(1,0,0,1,0,0),this.context.strokeStyle=n,this.context.fillStyle=n,this.context.font=this.font,this.context.globalAlpha=this.currentAlpha},stop:function(){this.context.restore()},line:function(){for(var e=this.currentX,t=0;t<arguments.length;t++)this.renderShadow&&(this.context.fillStyle="rgb(0,0,0)",this.context.fillText(arguments[t],e+1,this.currentY+1),this.context.fillStyle=this.currentColor),this.context.fillText(arguments[t],e,this.currentY),e+=this.columnWidth;this.currentY+=this.lineHeight},soundInfo:function(e,t,n,r){this.start(t,n,r),this.line("Sound: "+e.key+" Locked: "+e.game.sound.touchLocked),this.line("Is Ready?: "+this.game.cache.isSoundReady(e.key)+" Pending Playback: "+e.pendingPlayback),this.line("Decoded: "+e.isDecoded+" Decoding: "+e.isDecoding),this.line("Total Duration: "+e.totalDuration+" Playing: "+e.isPlaying),this.line("Time: "+e.currentTime),this.line("Volume: "+e.volume+" Muted: "+e.mute),this.line("WebAudio: "+e.usingWebAudio+" Audio: "+e.usingAudioTag),""!==e.currentMarker&&(this.line("Marker: "+e.currentMarker+" Duration: "+e.duration+" (ms: "+e.durationMS+")"),this.line("Start: "+e.markers[e.currentMarker].start+" Stop: "+e.markers[e.currentMarker].stop),this.line("Position: "+e.position)),this.stop()},cameraInfo:function(e,t,n,r){this.start(t,n,r),this.line("Camera ("+e.width+" x "+e.height+")"),this.line("X: "+e.x+" Y: "+e.y),e.bounds&&this.line("Bounds x: "+e.bounds.x+" Y: "+e.bounds.y+" w: "+e.bounds.width+" h: "+e.bounds.height),this.line("View x: "+e.view.x+" Y: "+e.view.y+" w: "+e.view.width+" h: "+e.view.height),this.line("Total in view: "+e.totalInView),this.stop()},timer:function(e,t,n,r){this.start(t,n,r),this.line("Timer (running: "+e.running+" expired: "+e.expired+")"),this.line("Next Tick: "+e.next+" Duration: "+e.duration),this.line("Paused: "+e.paused+" Length: "+e.length),this.stop()},pointer:function(e,t,n,r,i){null!=e&&(void 0===t&&(t=!1),n=n||"rgba(0,255,0,0.5)",r=r||"rgba(255,0,0,0.5)",(t!==!0||e.isUp!==!0)&&(this.start(e.x,e.y-100,i),this.context.beginPath(),this.context.arc(e.x,e.y,e.circle.radius,0,2*Math.PI),e.active?this.context.fillStyle=n:this.context.fillStyle=r,this.context.fill(),this.context.closePath(),this.context.beginPath(),this.context.moveTo(e.positionDown.x,e.positionDown.y),this.context.lineTo(e.position.x,e.position.y),this.context.lineWidth=2,this.context.stroke(),this.context.closePath(),this.line("ID: "+e.id+" Active: "+e.active),this.line("World X: "+e.worldX+" World Y: "+e.worldY),this.line("Screen X: "+e.x+" Screen Y: "+e.y+" In: "+e.withinGame),this.line("Duration: "+e.duration+" ms"),this.line("is Down: "+e.isDown+" is Up: "+e.isUp),this.stop()))},spriteInputInfo:function(e,t,n,r){this.start(t,n,r),this.line("Sprite Input: ("+e.width+" x "+e.height+")"),this.line("x: "+e.input.pointerX().toFixed(1)+" y: "+e.input.pointerY().toFixed(1)),this.line("over: "+e.input.pointerOver()+" duration: "+e.input.overDuration().toFixed(0)),this.line("down: "+e.input.pointerDown()+" duration: "+e.input.downDuration().toFixed(0)),this.line("just over: "+e.input.justOver()+" just out: "+e.input.justOut()),this.stop()},key:function(e,t,n,r){this.start(t,n,r,150),this.line("Key:",e.keyCode,"isDown:",e.isDown),this.line("justDown:",e.justDown,"justUp:",e.justUp),this.line("Time Down:",e.timeDown.toFixed(0),"duration:",e.duration.toFixed(0)),this.stop()},inputInfo:function(e,t,n){this.start(e,t,n),this.line("Input"),this.line("X: "+this.game.input.x+" Y: "+this.game.input.y),this.line("World X: "+this.game.input.worldX+" World Y: "+this.game.input.worldY),this.line("Scale X: "+this.game.input.scale.x.toFixed(1)+" Scale Y: "+this.game.input.scale.x.toFixed(1)),this.line("Screen X: "+this.game.input.activePointer.screenX+" Screen Y: "+this.game.input.activePointer.screenY),this.stop()},spriteBounds:function(e,t,n){var r=e.getBounds();r.x+=this.game.camera.x,r.y+=this.game.camera.y,this.rectangle(r,t,n)},ropeSegments:function(e,t,n){var r=e.segments,i=this;r.forEach(function(e){i.rectangle(e,t,n)},this)},spriteInfo:function(e,t,n,r){this.start(t,n,r),this.line("Sprite:  ("+e.width+" x "+e.height+") anchor: "+e.anchor.x+" x "+e.anchor.y),this.line("x: "+e.x.toFixed(1)+" y: "+e.y.toFixed(1)),this.line("angle: "+e.angle.toFixed(1)+" rotation: "+e.rotation.toFixed(1)),this.line("visible: "+e.visible+" in camera: "+e.inCamera),this.line("bounds x: "+e._bounds.x.toFixed(1)+" y: "+e._bounds.y.toFixed(1)+" w: "+e._bounds.width.toFixed(1)+" h: "+e._bounds.height.toFixed(1)),this.stop()},spriteCoords:function(e,t,n,r){this.start(t,n,r,100),e.name&&this.line(e.name),this.line("x:",e.x.toFixed(2),"y:",e.y.toFixed(2)),this.line("pos x:",e.position.x.toFixed(2),"pos y:",e.position.y.toFixed(2)),this.line("world x:",e.world.x.toFixed(2),"world y:",e.world.y.toFixed(2)),this.stop()},lineInfo:function(e,t,n,r){this.start(t,n,r,80),this.line("start.x:",e.start.x.toFixed(2),"start.y:",e.start.y.toFixed(2)),this.line("end.x:",e.end.x.toFixed(2),"end.y:",e.end.y.toFixed(2)),this.line("length:",e.length.toFixed(2),"angle:",e.angle),this.stop()},pixel:function(e,t,n,r){r=r||2,this.start(),this.context.fillStyle=n,this.context.fillRect(e,t,r,r),this.stop()},geom:function(e,t,r,i){void 0===r&&(r=!0),void 0===i&&(i=0),t=t||"rgba(0,255,0,0.4)",this.start(),this.context.fillStyle=t,this.context.strokeStyle=t,e instanceof n.Rectangle||1===i?r?this.context.fillRect(e.x-this.game.camera.x,e.y-this.game.camera.y,e.width,e.height):this.context.strokeRect(e.x-this.game.camera.x,e.y-this.game.camera.y,e.width,e.height):e instanceof n.Circle||2===i?(this.context.beginPath(),this.context.arc(e.x-this.game.camera.x,e.y-this.game.camera.y,e.radius,0,2*Math.PI,!1),this.context.closePath(),r?this.context.fill():this.context.stroke()):e instanceof n.Point||3===i?this.context.fillRect(e.x-this.game.camera.x,e.y-this.game.camera.y,4,4):(e instanceof n.Line||4===i)&&(this.context.lineWidth=1,this.context.beginPath(),this.context.moveTo(e.start.x+.5-this.game.camera.x,e.start.y+.5-this.game.camera.y),this.context.lineTo(e.end.x+.5-this.game.camera.x,e.end.y+.5-this.game.camera.y),this.context.closePath(),this.context.stroke()),this.stop()},rectangle:function(e,t,n){void 0===n&&(n=!0),t=t||"rgba(0, 255, 0, 0.4)",this.start(),n?(this.context.fillStyle=t,this.context.fillRect(e.x-this.game.camera.x,e.y-this.game.camera.y,e.width,e.height)):(this.context.strokeStyle=t,this.context.strokeRect(e.x-this.game.camera.x,e.y-this.game.camera.y,e.width,e.height)),this.stop()},text:function(e,t,n,r,i){r=r||"rgb(255,255,255)",i=i||"16px Courier",this.start(),this.context.font=i,this.renderShadow&&(this.context.fillStyle="rgb(0,0,0)",this.context.fillText(e,t+1,n+1)),this.context.fillStyle=r,this.context.fillText(e,t,n),this.stop()},quadTree:function(e,t){t=t||"rgba(255,0,0,0.3)",this.start();var n=e.bounds;if(0===e.nodes.length){this.context.strokeStyle=t,this.context.strokeRect(n.x,n.y,n.width,n.height),this.text("size: "+e.objects.length,n.x+4,n.y+16,"rgb(0,200,0)","12px Courier"),this.context.strokeStyle="rgb(0,255,0)";for(var r=0;r<e.objects.length;r++)this.context.strokeRect(e.objects[r].x,e.objects[r].y,e.objects[r].width,e.objects[r].height)}else for(var r=0;r<e.nodes.length;r++)this.quadTree(e.nodes[r]);this.stop()},body:function(e,t,r){e.body&&(this.start(),e.body.type===n.Physics.ARCADE?n.Physics.Arcade.Body.render(this.context,e.body,t,r):e.body.type===n.Physics.NINJA?n.Physics.Ninja.Body.render(this.context,e.body,t,r):e.body.type===n.Physics.BOX2D&&n.Physics.Box2D.renderBody(this.context,e.body,t),this.stop())},bodyInfo:function(e,t,r,i){e.body&&(this.start(t,r,i,210),e.body.type===n.Physics.ARCADE?n.Physics.Arcade.Body.renderBodyInfo(this,e.body):e.body.type===n.Physics.BOX2D&&this.game.physics.box2d.renderBodyInfo(this,e.body),this.stop())},box2dWorld:function(){this.start(),this.context.translate(-this.game.camera.view.x,-this.game.camera.view.y,0),this.game.physics.box2d.renderDebugDraw(this.context),this.stop()},box2dBody:function(e,t){this.start(),n.Physics.Box2D.renderBody(this.context,e,t),this.stop()},destroy:function(){PIXI.CanvasPool.remove(this)}},n.Utils.Debug.prototype.constructor=n.Utils.Debug,n.DOM={getOffset:function(e,t){t=t||new n.Point;var r=e.getBoundingClientRect(),i=n.DOM.scrollY,s=n.DOM.scrollX,o=document.documentElement.clientTop,u=document.documentElement.clientLeft;return t.x=r.left+s-u,t.y=r.top+i-o,t},getBounds:function(e,t){return void 0===t&&(t=0),e=e&&!e.nodeType?e[0]:e,e&&1===e.nodeType?this.calibrate(e.getBoundingClientRect(),t):!1},calibrate:function(e,t){t=+t||0;var n={width:0,height:0,left:0,right:0,top:0,bottom:0};return n.width=(n.right=e.right+t)-(n.left=e.left-t),n.height=(n.bottom=e.bottom+t)-(n.top=e.top-t),n},getAspectRatio:function(e){e=null==e?this.visualBounds:1===e.nodeType?this.getBounds(e):e;var t=e.width,n=e.height;return"function"==typeof t&&(t=t.call(e)),"function"==typeof n&&(n=n.call(e)),t/n},inLayoutViewport:function(e,t){var n=this.getBounds(e,t);return!!n&&n.bottom>=0&&n.right>=0&&n.top<=this.layoutBounds.width&&n.left<=this.layoutBounds.height},getScreenOrientation:function(e){var t=window.screen,n=t.orientation||t.mozOrientation||t.msOrientation;if(n&&"string"==typeof n.type)return n.type;if("string"==typeof n)return n;var r="portrait-primary",i="landscape-primary";if("screen"===e)return t.height>t.width?r:i;if("viewport"===e)return this.visualBounds.height>this.visualBounds.width?r:i;if("window.orientation"===e&&"number"==typeof window.orientation)return 0===window.orientation||180===window.orientation?r:i;if(window.matchMedia){if(window.matchMedia("(orientation: portrait)").matches)return r;if(window.matchMedia("(orientation: landscape)").matches)return i}return this.visualBounds.height>this.visualBounds.width?r:i},visualBounds:new n.Rectangle,layoutBounds:new n.Rectangle,documentBounds:new n.Rectangle},n.Device.whenReady(function(e){var t=window&&"pageXOffset"in window?function(){return window.pageXOffset}:function(){return document.documentElement.scrollLeft},r=window&&"pageYOffset"in window?function(){return window.pageYOffset}:function(){return document.documentElement.scrollTop};Object.defineProperty(n.DOM,"scrollX",{get:t}),Object.defineProperty(n.DOM,"scrollY",{get:r}),Object.defineProperty(n.DOM.visualBounds,"x",{get:t}),Object.defineProperty(n.DOM.visualBounds,"y",{get:r}),Object.defineProperty(n.DOM.layoutBounds,"x",{value:0}),Object.defineProperty(n.DOM.layoutBounds,"y",{value:0});var i=e.desktop&&document.documentElement.clientWidth<=window.innerWidth&&document.documentElement.clientHeight<=window.innerHeight;if(i){var s=function(){return Math.max(window.innerWidth,document.documentElement.clientWidth)},o=function(){return Math.max(window.innerHeight,document.documentElement.clientHeight)};Object.defineProperty(n.DOM.visualBounds,"width",{get:s}),Object.defineProperty(n.DOM.visualBounds,"height",{get:o}),Object.defineProperty(n.DOM.layoutBounds,"width",{get:s}),Object.defineProperty(n.DOM.layoutBounds,"height",{get:o})}else Object.defineProperty(n.DOM.visualBounds,"width",{get:function(){return window.innerWidth}}),Object.defineProperty(n.DOM.visualBounds,"height",{get:function(){return window.innerHeight}}),Object.defineProperty(n.DOM.layoutBounds,"width",{get:function(){var e=document.documentElement.clientWidth,t=window.innerWidth;return t>e?t:e}}),Object.defineProperty(n.DOM.layoutBounds,"height",{get:function(){var e=document.documentElement.clientHeight,t=window.innerHeight;return t>e?t:e}});Object.defineProperty(n.DOM.documentBounds,"x",{value:0}),Object.defineProperty(n.DOM.documentBounds,"y",{value:0}),Object.defineProperty(n.DOM.documentBounds,"width",{get:function(){var e=document.documentElement;return Math.max(e.clientWidth,e.offsetWidth,e.scrollWidth)}}),Object.defineProperty(n.DOM.documentBounds,"height",{get:function(){var e=document.documentElement;return Math.max(e.clientHeight,e.offsetHeight,e.scrollHeight)}})},null,!0),n.ArraySet=function(e){this.position=0,this.list=e||[]},n.ArraySet.prototype={add:function(e){return this.exists(e)||this.list.push(e),e},getIndex:function(e){return this.list.indexOf(e)},getByKey:function(e,t){for(var n=this.list.length;n--;)if(this.list[n][e]===t)return this.list[n];return null},exists:function(e){return this.list.indexOf(e)>-1},reset:function(){this.list.length=0},remove:function(e){var t=this.list.indexOf(e);return t>-1?(this.list.splice(t,1),e):void 0},setAll:function(e,t){for(var n=this.list.length;n--;)this.list[n]&&(this.list[n][e]=t)},callAll:function(e){for(var t=Array.prototype.slice.call(arguments,1),n=this.list.length;n--;)this.list[n]&&this.list[n][e]&&this.list[n][e].apply(this.list[n],t)},removeAll:function(e){void 0===e&&(e=!1);for(var t=this.list.length;t--;)if(this.list[t]){var n=this.remove(this.list[t]);e&&n.destroy()}this.position=0,this.list=[]}},Object.defineProperty(n.ArraySet.prototype,"total",{get:function(){return this.list.length}}),Object.defineProperty(n.ArraySet.prototype,"first",{get:function(){return this.position=0,this.list.length>0?this.list[0]:null}}),Object.defineProperty(n.ArraySet.prototype,"next",{get:function(){return this.position<this.list.length?(this.position++,this.list[this.position]):null}}),n.ArraySet.prototype.constructor=n.ArraySet,n.ArrayUtils={getRandomItem:function(e,t,n){if(null===e)return null;void 0===t&&(t=0),void 0===n&&(n=e.length);var r=t+Math.floor(Math.random()*n);return void 0===e[r]?null:e[r]},removeRandomItem:function(e,t,n){if(null==e)return null;void 0===t&&(t=0),void 0===n&&(n=e.length);var r=t+Math.floor(Math.random()*n);if(r<e.length){var i=e.splice(r,1);return void 0===i[0]?null:i[0]}return null},shuffle:function(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),r=e[t];e[t]=e[n],e[n]=r}return e},transposeMatrix:function(e){for(var t=e.length,n=e[0].length,r=new Array(n),i=0;n>i;i++){r[i]=new Array(t);for(var s=t-1;s>-1;s--)r[i][s]=e[s][i]}return r},rotateMatrix:function(e,t){if("string"!=typeof t&&(t=(t%360+360)%360),90===t||-270===t||"rotateLeft"===t)e=n.ArrayUtils.transposeMatrix(e),e=e.reverse();else if(-90===t||270===t||"rotateRight"===t)e=e.reverse(),e=n.ArrayUtils.transposeMatrix(e);else if(180===Math.abs(t)||"rotate180"===t){for(var r=0;r<e.length;r++)e[r].reverse();e=e.reverse()}return e},findClosest:function(e,t){if(!t.length)return NaN;if(1===t.length||e<t[0])return t[0];for(var n=1;t[n]<e;)n++;var r=t[n-1],i=n<t.length?t[n]:Number.POSITIVE_INFINITY;return e-r>=i-e?i:r},rotate:function(e){var t=e.shift();return e.push(t),t},numberArray:function(e,t){for(var n=[],r=e;t>=r;r++)n.push(r);return n},numberArrayStep:function(e,t,r){(void 0===e||null===e)&&(e=0),(void 0===t||null===t)&&(t=e,e=0),void 0===r&&(r=1);for(var i=[],s=Math.max(n.Math.roundAwayFromZero((t-e)/(r||1)),0),o=0;s>o;o++)i.push(e),e+=r;return i}},n.LinkedList=function(){this.next=null,this.prev=null,this.first=null,this.last=null,this.total=0},n.LinkedList.prototype={add:function(e){return 0===this.total&&null===this.first&&null===this.last?(this.first=e,this.last=e,this.next=e,e.prev=this,this.total++,e):(this.last.next=e,e.prev=this.last,this.last=e,this.total++,e)},reset:function(){this.first=null,this.last=null,this.next=null,this.prev=null,this.total=0},remove:function(e){return 1===this.total?(this.reset(),void (e.next=e.prev=null)):(e===this.first?this.first=this.first.next:e===this.last&&(this.last=this.last.prev),e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e.next=e.prev=null,null===this.first&&(this.last=null),void (this.total--))},callAll:function(e){if(this.first&&this.last){var t=this.first;do t&&t[e]&&t[e].call(t),t=t.next;while(t!=this.last.next)}}},n.LinkedList.prototype.constructor=n.LinkedList,n.Create=function(e){this.game=e,this.bmd=null,this.canvas=null,this.ctx=null,this.palettes=[{0:"#000",1:"#9D9D9D",2:"#FFF",3:"#BE2633",4:"#E06F8B",5:"#493C2B",6:"#A46422",7:"#EB8931",8:"#F7E26B",9:"#2F484E",A:"#44891A",B:"#A3CE27",C:"#1B2632",D:"#005784",E:"#31A2F2",F:"#B2DCEF"},{0:"#000",1:"#191028",2:"#46af45",3:"#a1d685",4:"#453e78",5:"#7664fe",6:"#833129",7:"#9ec2e8",8:"#dc534b",9:"#e18d79",A:"#d6b97b",B:"#e9d8a1",C:"#216c4b",D:"#d365c8",E:"#afaab9",F:"#f5f4eb"},{0:"#000",1:"#2234d1",2:"#0c7e45",3:"#44aacc",4:"#8a3622",5:"#5c2e78",6:"#aa5c3d",7:"#b5b5b5",8:"#5e606e",9:"#4c81fb",A:"#6cd947",B:"#7be2f9",C:"#eb8a60",D:"#e23d69",E:"#ffd93f",F:"#fff"},{0:"#000",1:"#fff",2:"#8b4131",3:"#7bbdc5",4:"#8b41ac",5:"#6aac41",6:"#3931a4",7:"#d5de73",8:"#945a20",9:"#5a4100",A:"#bd736a",B:"#525252",C:"#838383",D:"#acee8b",E:"#7b73de",F:"#acacac"},{0:"#000",1:"#191028",2:"#46af45",3:"#a1d685",4:"#453e78",5:"#7664fe",6:"#833129",7:"#9ec2e8",8:"#dc534b",9:"#e18d79",A:"#d6b97b",B:"#e9d8a1",C:"#216c4b",D:"#d365c8",E:"#afaab9",F:"#fff"}]},n.Create.PALETTE_ARNE=0,n.Create.PALETTE_JMP=1,n.Create.PALETTE_CGA=2,n.Create.PALETTE_C64=3,n.Create.PALETTE_JAPANESE_MACHINE=4,n.Create.prototype={texture:function(e,t,n,r,i){void 0===n&&(n=8),void 0===r&&(r=n),void 0===i&&(i=0);var s=t[0].length*n,o=t.length*r;null===this.bmd&&(this.bmd=this.game.make.bitmapData(),this.canvas=this.bmd.canvas,this.ctx=this.bmd.context),this.bmd.resize(s,o),this.bmd.clear();for(var u=0;u<t.length;u++)for(var a=t[u],f=0;f<a.length;f++){var l=a[f];"."!==l&&" "!==l&&(this.ctx.fillStyle=this.palettes[i][l],this.ctx.fillRect(f*n,u*r,n,r))}return this.bmd.generateTexture(e)},grid:function(e,t,n,r,i,s){null===this.bmd&&(this.bmd=this.game.make.bitmapData(),this.canvas=this.bmd.canvas,this.ctx=this.bmd.context),this.bmd.resize(t,n),this.ctx.fillStyle=s;for(var o=0;n>o;o+=i)this.ctx.fillRect(0,o,t,1);for(var u=0;t>u;u+=r)this.ctx.fillRect(u,0,1,n);return this.bmd.generateTexture(e)}},n.Create.prototype.constructor=n.Create,n.FlexGrid=function(e,t,r){this.game=e.game,this.manager=e,this.width=t,this.height=r,this.boundsCustom=new n.Rectangle(0,0,t,r),this.boundsFluid=new n.Rectangle(0,0,t,r),this.boundsFull=new n.Rectangle(0,0,t,r),this.boundsNone=new n.Rectangle(0,0,t,r),this.positionCustom=new n.Point(0,0),this.positionFluid=new n.Point(0,0),this.positionFull=new n.Point(0,0),this.positionNone=new n.Point(0,0),this.scaleCustom=new n.Point(1,1),this.scaleFluid=new n.Point(1,1),this.scaleFluidInversed=new n.Point(1,1),this.scaleFull=new n.Point(1,1),this.scaleNone=new n.Point(1,1),this.customWidth=0,this.customHeight=0,this.customOffsetX=0,this.customOffsetY=0,this.ratioH=t/r,this.ratioV=r/t,this.multiplier=0,this.layers=[]},n.FlexGrid.prototype={setSize:function(e,t){this.width=e,this.height=t,this.ratioH=e/t,this.ratioV=t/e,this.scaleNone=new n.Point(1,1),this.boundsNone.width=this.width,this.boundsNone.height=this.height,this.refresh()},createCustomLayer:function(e,t,r,i){void 0===i&&(i=!0),this.customWidth=e,this.customHeight=t,this.boundsCustom.width=e,this.boundsCustom.height=t;var s=new n.FlexLayer(this,this.positionCustom,this.boundsCustom,this.scaleCustom);return i&&this.game.world.add(s),this.layers.push(s),"undefined"!=typeof r&&null!==typeof r&&s.addMultiple(r),s},createFluidLayer:function(e,t){void 0===t&&(t=!0);var r=new n.FlexLayer(this,this.positionFluid,this.boundsFluid,this.scaleFluid);return t&&this.game.world.add(r),this.layers.push(r),"undefined"!=typeof e&&null!==typeof e&&r.addMultiple(e),r},createFullLayer:function(e){var t=new n.FlexLayer(this,this.positionFull,this.boundsFull,this.scaleFluid);return this.game.world.add(t),this.layers.push(t),"undefined"!=typeof e&&t.addMultiple(e),t},createFixedLayer:function(e){var t=new n.FlexLayer(this,this.positionNone,this.boundsNone,this.scaleNone);return this.game.world.add(t),this.layers.push(t),"undefined"!=typeof e&&t.addMultiple(e),t},reset:function(){for(var e=this.layers.length;e--;)this.layers[e].persist||(this.layers[e].position=null,this.layers[e].scale=null,this.layers.slice(e,1))},onResize:function(e,t){this.ratioH=e/t,this.ratioV=t/e,this.refresh(e,t)},refresh:function(){this.multiplier=Math.min(this.manager.height/this.height,this.manager.width/this.width),this.boundsFluid.width=Math.round(this.width*this.multiplier),this.boundsFluid.height=Math.round(this.height*this.multiplier),this.scaleFluid.set(this.boundsFluid.width/this.width,this.boundsFluid.height/this.height),this.scaleFluidInversed.set(this.width/this.boundsFluid.width,this.height/this.boundsFluid.height),this.scaleFull.set(this.boundsFull.width/this.width,this.boundsFull.height/this.height),this.boundsFull.width=Math.round(this.manager.width*this.scaleFluidInversed.x),this.boundsFull.height=Math.round(this.manager.height*this.scaleFluidInversed.y),this.boundsFluid.centerOn(this.manager.bounds.centerX,this.manager.bounds.centerY),this.boundsNone.centerOn(this.manager.bounds.centerX,this.manager.bounds.centerY),this.positionFluid.set(this.boundsFluid.x,this.boundsFluid.y),this.positionNone.set(this.boundsNone.x,this.boundsNone.y)},fitSprite:function(e){this.manager.scaleSprite(e),e.x=this.manager.bounds.centerX,e.y=this.manager.bounds.centerY},debug:function(){this.game.debug.text(this.boundsFluid.width+" x "+this.boundsFluid.height,this.boundsFluid.x+4,this.boundsFluid.y+16),this.game.debug.geom(this.boundsFluid,"rgba(255,0,0,0.9",!1)}},n.FlexGrid.prototype.constructor=n.FlexGrid,n.FlexLayer=function(e,t,r,i){n.Group.call(this,e.game,null,"__flexLayer"+e.game.rnd.uuid(),!1),this.manager=e.manager,this.grid=e,this.persist=!1,this.position=t,this.bounds=r,this.scale=i,this.topLeft=r.topLeft,this.topMiddle=new n.Point(r.halfWidth,0),this.topRight=r.topRight,this.bottomLeft=r.bottomLeft,this.bottomMiddle=new n.Point(r.halfWidth,r.bottom),this.bottomRight=r.bottomRight},n.FlexLayer.prototype=Object.create(n.Group.prototype),n.FlexLayer.prototype.constructor=n.FlexLayer,n.FlexLayer.prototype.resize=function(){},n.FlexLayer.prototype.debug=function(){this.game.debug.text(this.bounds.width+" x "+this.bounds.height,this.bounds.x+4,this.bounds.y+16),this.game.debug.geom(this.bounds,"rgba(0,0,255,0.9",!1),this.game.debug.geom(this.topLeft,"rgba(255,255,255,0.9"),this.game.debug.geom(this.topMiddle,"rgba(255,255,255,0.9"),this.game.debug.geom(this.topRight,"rgba(255,255,255,0.9")},n.Color={packPixel:function(e,t,r,i){return n.Device.LITTLE_ENDIAN?(i<<24|r<<16|t<<8|e)>>>0:(e<<24|t<<16|r<<8|i)>>>0},unpackPixel:function(e,t,r,i){return(void 0===t||null===t)&&(t=n.Color.createColor()),(void 0===r||null===r)&&(r=!1),(void 0===i||null===i)&&(i=!1),n.Device.LITTLE_ENDIAN?(t.a=(4278190080&e)>>>24,t.b=(16711680&e)>>>16,t.g=(65280&e)>>>8,t.r=255&e):(t.r=(4278190080&e)>>>24,t.g=(16711680&e)>>>16,t.b=(65280&e)>>>8,t.a=255&e),t.color=e,t.rgba="rgba("+t.r+","+t.g+","+t.b+","+t.a/255+")",r&&n.Color.RGBtoHSL(t.r,t.g,t.b,t),i&&n.Color.RGBtoHSV(t.r,t.g,t.b,t),t},fromRGBA:function(e,t){return t||(t=n.Color.createColor()),t.r=(4278190080&e)>>>24,t.g=(16711680&e)>>>16,t.b=(65280&e)>>>8,t.a=255&e,t.rgba="rgba("+t.r+","+t.g+","+t.b+","+t.a+")",t},toRGBA:function(e,t,n,r){return e<<24|t<<16|n<<8|r},RGBtoHSL:function(e,t,r,i){i||(i=n.Color.createColor(e,t,r,1)),e/=255,t/=255,r/=255;var s=Math.min(e,t,r),o=Math.max(e,t,r);if(i.h=0,i.s=0,i.l=(o+s)/2,o!==s){var u=o-s;i.s=i.l>.5?u/(2-o-s):u/(o+s),o===e?i.h=(t-r)/u+(r>t?6:0):o===t?i.h=(r-e)/u+2:o===r&&(i.h=(e-t)/u+4),i.h/=6}return i},HSLtoRGB:function(e,t,r,i){if(i?(i.r=r,i.g=r,i.b=r):i=n.Color.createColor(r,r,r),0!==t){var s=.5>r?r*(1+t):r+t-r*t,o=2*r-s;i.r=n.Color.hueToColor(o,s,e+1/3),i.g=n.Color.hueToColor(o,s,e),i.b=n.Color.hueToColor(o,s,e-1/3)}return i.r=Math.floor(255*i.r|0),i.g=Math.floor(255*i.g|0),i.b=Math.floor(255*i.b|0),n.Color.updateColor(i),i},RGBtoHSV:function(e,t,r,i){i||(i=n.Color.createColor(e,t,r,255)),e/=255,t/=255,r/=255;var s=Math.min(e,t,r),o=Math.max(e,t,r),u=o-s;return i.h=0,i.s=0===o?0:u/o,i.v=o,o!==s&&(o===e?i.h=(t-r)/u+(r>t?6:0):o===t?i.h=(r-e)/u+2:o===r&&(i.h=(e-t)/u+4),i.h/=6),i},HSVtoRGB:function(e,t,r,i){void 0===i&&(i=n.Color.createColor(0,0,0,1,e,t,0,r));var s,o,u,a=Math.floor(6*e),f=6*e-a,l=r*(1-t),c=r*(1-f*t),h=r*(1-(1-f)*t);switch(a%6){case 0:s=r,o=h,u=l;break;case 1:s=c,o=r,u=l;break;case 2:s=l,o=r,u=h;break;case 3:s=l,o=c,u=r;break;case 4:s=h,o=l,u=r;break;case 5:s=r,o=l,u=c}return i.r=Math.floor(255*s),i.g=Math.floor(255*o),i.b=Math.floor(255*u),n.Color.updateColor(i),i},hueToColor:function(e,t,n){return 0>n&&(n+=1),n>1&&(n-=1),1/6>n?e+6*(t-e)*n:.5>n?t:2/3>n?e+(t-e)*(2/3-n)*6:e},createColor:function(e,t,r,i,s,o,u,a){var f={r:e||0,g:t||0,b:r||0,a:i||1,h:s||0,s:o||0,l:u||0,v:a||0,color:0,color32:0,rgba:""};return n.Color.updateColor(f)},updateColor:function(e){return e.rgba="rgba("+e.r.toString()+","+e.g.toString()+","+e.b.toString()+","+e.a.toString()+")",e.color=n.Color.getColor(e.r,e.g,e.b),e.color32=n.Color.getColor32(255*e.a,e.r,e.g,e.b),e},getColor32:function(e,t,n,r){return e<<24|t<<16|n<<8|r},getColor:function(e,t,n){return e<<16|t<<8|n},RGBtoString:function(e,t,r,i,s){return void 0===i&&(i=255),void 0===s&&(s="#"),"#"===s?"#"+((1<<24)+(e<<16)+(t<<8)+r).toString(16).slice(1):"0x"+n.Color.componentToHex(i)+n.Color.componentToHex(e)+n.Color.componentToHex(t)+n.Color.componentToHex(r)},hexToRGB:function(e){var t=n.Color.hexToColor(e);return t?n.Color.getColor32(t.a,t.r,t.g,t.b):void 0},hexToColor:function(e,t){e=e.replace(/^(?:#|0x)?([a-f\d])([a-f\d])([a-f\d])$/i,function(e,t,n,r){return t+t+n+n+r+r});var r=/^(?:#|0x)?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(r){var i=parseInt(r[1],16),s=parseInt(r[2],16),o=parseInt(r[3],16);t?(t.r=i,t.g=s,t.b=o):t=n.Color.createColor(i,s,o)}return t},webToColor:function(e,t){t||(t=n.Color.createColor());var r=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(e);return r&&(t.r=parseInt(r[1],10),t.g=parseInt(r[2],10),t.b=parseInt(r[3],10),t.a=void 0!==r[4]?parseFloat(r[4]):1,n.Color.updateColor(t)),t},valueToColor:function(e,t){if(t||(t=n.Color.createColor()),"string"==typeof e)return 0===e.indexOf("rgb")?n.Color.webToColor(e,t):(t.a=1,n.Color.hexToColor(e,t));if("number"==typeof e){var r=n.Color.getRGB(e);return t.r=r.r,t.g=r.g,t.b=r.b,t.a=r.a/255,t}return t},componentToHex:function(e){var t=e.toString(16);return 1==t.length?"0"+t:t},HSVColorWheel:function(e,t){void 0===e&&(e=1),void 0===t&&(t=1);for(var r=[],i=0;359>=i;i++)r.push(n.Color.HSVtoRGB(i/359,e,t));return r},HSLColorWheel:function(e,t){void 0===e&&(e=.5),void 0===t&&(t=.5);for(var r=[],i=0;359>=i;i++)r.push(n.Color.HSLtoRGB(i/359,e,t));return r},interpolateColor:function(e,t,r,i,s){void 0===s&&(s=255);var o=n.Color.getRGB(e),u=n.Color.getRGB(t),a=(u.red-o.red)*i/r+o.red,f=(u.green-o.green)*i/r+o.green,l=(u.blue-o.blue)*i/r+o.blue;return n.Color.getColor32(s,a,f,l)},interpolateColorWithRGB:function(e,t,r,i,s,o){var u=n.Color.getRGB(e),a=(t-u.red)*o/s+u.red,f=(r-u.green)*o/s+u.green,l=(i-u.blue)*o/s+u.blue;return n.Color.getColor(a,f,l)},interpolateRGB:function(e,t,r,i,s,o,u,a){var f=(i-e)*a/u+e,l=(s-t)*a/u+t,c=(o-r)*a/u+r;return n.Color.getColor(f,l,c)},getRandomColor:function(e,t,r){if(void 0===e&&(e=0),void 0===t&&(t=255),void 0===r&&(r=255),t>255||e>t)return n.Color.getColor(255,255,255);var i=e+Math.round(Math.random()*(t-e)),s=e+Math.round(Math.random()*(t-e)),o=e+Math.round(Math.random()*(t-e));return n.Color.getColor32(r,i,s,o)},getRGB:function(e){return e>16777215?{alpha:e>>>24,red:e>>16&255,green:e>>8&255,blue:255&e,a:e>>>24,r:e>>16&255,g:e>>8&255,b:255&e}:{alpha:255,red:e>>16&255,green:e>>8&255,blue:255&e,a:255,r:e>>16&255,g:e>>8&255,b:255&e}},getWebRGB:function(e){if("object"==typeof e)return"rgba("+e.r.toString()+","+e.g.toString()+","+e.b.toString()+","+(e.a/255).toString()+")";var t=n.Color.getRGB(e);return"rgba("+t.r.toString()+","+t.g.toString()+","+t.b.toString()+","+(t.a/255).toString()+")"},getAlpha:function(e){return e>>>24},getAlphaFloat:function(e){return(e>>>24)/255},getRed:function(e){return e>>16&255},getGreen:function(e){return e>>8&255},getBlue:function(e){return 255&e},blendNormal:function(e){return e},blendLighten:function(e,t){return t>e?t:e},blendDarken:function(e,t){return t>e?e:t},blendMultiply:function(e,t){return e*t/255},blendAverage:function(e,t){return(e+t)/2},blendAdd:function(e,t){return Math.min(255,e+t)},blendSubtract:function(e,t){return Math.max(0,e+t-255)},blendDifference:function(e,t){return Math.abs(e-t)},blendNegation:function(e,t){return 255-Math.abs(255-e-t)},blendScreen:function(e,t){return 255-((255-e)*(255-t)>>8)},blendExclusion:function(e,t){return e+t-2*e*t/255},blendOverlay:function(e,t){return 128>t?2*e*t/255:255-2*(255-e)*(255-t)/255},blendSoftLight:function(e,t){return 128>t?2*((e>>1)+64)*(t/255):255-2*(255-((e>>1)+64))*(255-t)/255},blendHardLight:function(e,t){return n.Color.blendOverlay(t,e)},blendColorDodge:function(e,t){return 255===t?t:Math.min(255,(e<<8)/(255-t))},blendColorBurn:function(e,t){return 0===t?t:Math.max(0,255-(255-e<<8)/t)},blendLinearDodge:function(e,t){return n.Color.blendAdd(e,t)},blendLinearBurn:function(e,t){return n.Color.blendSubtract(e,t)},blendLinearLight:function(e,t){return 128>t?n.Color.blendLinearBurn(e,2*t):n.Color.blendLinearDodge(e,2*(t-128))},blendVividLight:function(e,t){return 128>t?n.Color.blendColorBurn(e,2*t):n.Color.blendColorDodge(e,2*(t-128))},blendPinLight:function(e,t){return 128>t?n.Color.blendDarken(e,2*t):n.Color.blendLighten(e,2*(t-128))},blendHardMix:function(e,t){return n.Color.blendVividLight(e,t)<128?0:255},blendReflect:function(e,t){return 255===t?t:Math.min(255,e*e/(255-t))},blendGlow:function(e,t){return n.Color.blendReflect(t,e)},blendPhoenix:function(e,t){return Math.min(e,t)-Math.max(e,t)+255}},n.Physics=function(e,t){t=t||{},this.game=e,this.config=t,this.arcade=null,this.p2=null,this.ninja=null,this.box2d=null,this.chipmunk=null,this.matter=null,this.parseConfig()},n.Physics.ARCADE=0,n.Physics.P2JS=1,n.Physics.NINJA=2,n.Physics.BOX2D=3,n.Physics.CHIPMUNK=4,n.Physics.MATTERJS=5,n.Physics.prototype={parseConfig:function(){this.config.hasOwnProperty("arcade")&&this.config.arcade!==!0||!n.Physics.hasOwnProperty("Arcade")||(this.arcade=new n.Physics.Arcade(this.game)),this.config.hasOwnProperty("ninja")&&this.config.ninja===!0&&n.Physics.hasOwnProperty("Ninja")&&(this.ninja=new n.Physics.Ninja(this.game)),this.config.hasOwnProperty("p2")&&this.config.p2===!0&&n.Physics.hasOwnProperty("P2")&&(this.p2=new n.Physics.P2(this.game,this.config)),this.config.hasOwnProperty("box2d")&&this.config.box2d===!0&&n.Physics.hasOwnProperty("BOX2D")&&(this.box2d=new n.Physics.BOX2D(this.game,this.config)),this.config.hasOwnProperty("matter")&&this.config.matter===!0&&n.Physics.hasOwnProperty("Matter")&&(this.matter=new n.Physics.Matter(this.game,this.config))},startSystem:function(e){e===n.Physics.ARCADE?this.arcade=new n.Physics.Arcade(this.game):e===n.Physics.P2JS?null===this.p2?this.p2=new n.Physics.P2(this.game,this.config):this.p2.reset():e===n.Physics.NINJA?this.ninja=new n.Physics.Ninja(this.game):e===n.Physics.BOX2D?null===this.box2d?this.box2d=new n.Physics.Box2D(this.game,this.config):this.box2d.reset():e===n.Physics.MATTERJS&&(null===this.matter?this.matter=new n.Physics.Matter(this.game,this.config):this.matter.reset())},enable:function(e,t,r){void 0===t&&(t=n.Physics.ARCADE),void 0===r&&(r=!1),t===n.Physics.ARCADE?this.arcade.enable(e):t===n.Physics.P2JS&&this.p2?this.p2.enable(e,r):t===n.Physics.NINJA&&this.ninja?this.ninja.enableAABB(e):t===n.Physics.BOX2D&&this.box2d?this.box2d.enable(e):t===n.Physics.MATTERJS&&this.matter?this.matter.enable(e):console.warn(e.key+" is attempting to enable a physics body using an unknown physics system.")},preUpdate:function(){this.p2&&this.p2.preUpdate(),this.box2d&&this.box2d.preUpdate(),this.matter&&this.matter.preUpdate()},update:function(){this.p2&&this.p2.update(),this.box2d&&this.box2d.update(),this.matter&&this.matter.update()},setBoundsToWorld:function(){this.arcade&&this.arcade.setBoundsToWorld(),this.ninja&&this.ninja.setBoundsToWorld(),this.p2&&this.p2.setBoundsToWorld(),this.box2d&&this.box2d.setBoundsToWorld(),this.matter&&this.matter.setBoundsToWorld()},clear:function(){this.p2&&this.p2.clear(),this.box2d&&this.box2d.clear(),this.matter&&this.matter.clear()},reset:function(){this.p2&&this.p2.reset(),this.box2d&&this.box2d.reset(),this.matter&&this.matter.reset()},destroy:function(){this.p2&&this.p2.destroy(),this.box2d&&this.box2d.destroy(),this.matter&&this.matter.destroy(),this.arcade=null,this.ninja=null,this.p2=null,this.box2d=null,this.matter=null}},n.Physics.prototype.constructor=n.Physics,n.Physics.Arcade=function(e){this.game=e,this.gravity=new n.Point,this.bounds=new n.Rectangle(0,0,e.world.width,e.world.height),this.checkCollision={up:!0,down:!0,left:!0,right:!0},this.maxObjects=10,this.maxLevels=4,this.OVERLAP_BIAS=4,this.forceX=!1,this.sortDirection=n.Physics.Arcade.LEFT_RIGHT,this.skipQuadTree=!0,this.isPaused=!1,this.quadTree=new n.QuadTree(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,this.maxObjects,this.maxLevels),this._total=0,this.setBoundsToWorld()},n.Physics.Arcade.prototype.constructor=n.Physics.Arcade,n.Physics.Arcade.SORT_NONE=0,n.Physics.Arcade.LEFT_RIGHT=1,n.Physics.Arcade.RIGHT_LEFT=2,n.Physics.Arcade.TOP_BOTTOM=3,n.Physics.Arcade.BOTTOM_TOP=4,n.Physics.Arcade.prototype={setBounds:function(e,t,n,r){this.bounds.setTo(e,t,n,r)},setBoundsToWorld:function(){this.bounds.copyFrom(this.game.world.bounds)},enable:function(e,t){void 0===t&&(t=!0);var r=1;if(Array.isArray(e))for(r=e.length;r--;)e[r]instanceof n.Group?this.enable(e[r].children,t):(this.enableBody(e[r]),t&&e[r].hasOwnProperty("children")&&e[r].children.length>0&&this.enable(e[r],!0));else e instanceof n.Group?this.enable(e.children,t):(this.enableBody(e),t&&e.hasOwnProperty("children")&&e.children.length>0&&this.enable(e.children,!0))},enableBody:function(e){e.hasOwnProperty("body")&&null===e.body&&(e.body=new n.Physics.Arcade.Body(e),e.parent&&e.parent instanceof n.Group&&e.parent.addToHash(e))},updateMotion:function(e){var t=this.computeVelocity(0,e,e.angularVelocity,e.angularAcceleration,e.angularDrag,e.maxAngular)-e.angularVelocity;e.angularVelocity+=t,e.rotation+=e.angularVelocity*this.game.time.physicsElapsed,e.velocity.x=this.computeVelocity(1,e,e.velocity.x,e.acceleration.x,e.drag.x,e.maxVelocity.x),e.velocity.y=this.computeVelocity(2,e,e.velocity.y,e.acceleration.y,e.drag.y,e.maxVelocity.y)},computeVelocity:function(e,t,n,r,i,s){return void 0===s&&(s=1e4),1===e&&t.allowGravity?n+=(this.gravity.x+t.gravity.x)*this.game.time.physicsElapsed:2===e&&t.allowGravity&&(n+=(this.gravity.y+t.gravity.y)*this.game.time.physicsElapsed),r?n+=r*this.game.time.physicsElapsed:i&&(i*=this.game.time.physicsElapsed,n-i>0?n-=i:0>n+i?n+=i:n=0),n>s?n=s:-s>n&&(n=-s),n},overlap:function(e,t,n,r,i){if(n=n||null,r=r||null,i=i||n,this._total=0,!Array.isArray(e)&&Array.isArray(t))for(var s=0;s<t.length;s++)this.collideHandler(e,t[s],n,r,i,!0);else if(Array.isArray(e)&&!Array.isArray(t))for(var s=0;s<e.length;s++)this.collideHandler(e[s],t,n,r,i,!0);else if(Array.isArray(e)&&Array.isArray(t))for(var s=0;s<e.length;s++)for(var o=0;o<t.length;o++)this.collideHandler(e[s],t[o],n,r,i,!0);else this.collideHandler(e,t,n,r,i,!0);return this._total>0},collide:function(e,t,n,r,i){if(n=n||null,r=r||null,i=i||n,this._total=0,!Array.isArray(e)&&Array.isArray(t))for(var s=0;s<t.length;s++)this.collideHandler(e,t[s],n,r,i,!1);else if(Array.isArray(e)&&!Array.isArray(t))for(var s=0;s<e.length;s++)this.collideHandler(e[s],t,n,r,i,!1);else if(Array.isArray(e)&&Array.isArray(t))for(var s=0;s<e.length;s++)for(var o=0;o<t.length;o++)this.collideHandler(e[s],t[o],n,r,i,!1);else this.collideHandler(e,t,n,r,i,!1);return this._total>0},sortLeftRight:function(e,t){return e.body&&t.body?e.body.x-t.body.x:0},sortRightLeft:function(e,t){return e.body&&t.body?t.body.x-e.body.x:0},sortTopBottom:function(e,t){return e.body&&t.body?e.body.y-t.body.y:0},sortBottomTop:function(e,t){return e.body&&t.body?t.body.y-e.body.y:0},sort:function(e,t){null!==e.physicsSortDirection?t=e.physicsSortDirection:void 0===t&&(t=this.sortDirection),t===n.Physics.Arcade.LEFT_RIGHT?e.hash.sort(this.sortLeftRight):t===n.Physics.Arcade.RIGHT_LEFT?e.hash.sort(this.sortRightLeft):t===n.Physics.Arcade.TOP_BOTTOM?e.hash.sort(this.sortTopBottom):t===n.Physics.Arcade.BOTTOM_TOP&&e.hash.sort(this.sortBottomTop)},collideHandler:function(e,t,r,i,s,o){return void 0===t&&e.physicsType===n.GROUP?(this.sort(e),void this.collideGroupVsSelf(e,r,i,s,o)):void (e&&t&&e.exists&&t.exists&&(this.sortDirection!==n.Physics.Arcade.SORT_NONE&&(e.physicsType===n.GROUP&&this.sort(e),t.physicsType===n.GROUP&&this.sort(t)),e.physicsType===n.SPRITE?t.physicsType===n.SPRITE?this.collideSpriteVsSprite(e,t,r,i,s,o):t.physicsType===n.GROUP?this.collideSpriteVsGroup(e,t,r,i,s,o):t.physicsType===n.TILEMAPLAYER&&this.collideSpriteVsTilemapLayer(e,t,r,i,s,o):e.physicsType===n.GROUP?t.physicsType===n.SPRITE?this.collideSpriteVsGroup(t,e,r,i,s,o):t.physicsType===n.GROUP?this.collideGroupVsGroup(e,t,r,i,s,o):t.physicsType===n.TILEMAPLAYER&&this.collideGroupVsTilemapLayer(e,t,r,i,s,o):e.physicsType===n.TILEMAPLAYER&&(t.physicsType===n.SPRITE?this.collideSpriteVsTilemapLayer(t,e,r,i,s,o):t.physicsType===n.GROUP&&this.collideGroupVsTilemapLayer(t,e,r,i,s,o))))},collideSpriteVsSprite:function(e,t,n,r,i,s){return e.body&&t.body?(this.separate(e.body,t.body,r,i,s)&&(n&&n.call(i,e,t),this._total++),!0):!1},collideSpriteVsGroup:function(e,t,r,i,s,o){if(0!==t.length&&e.body){var u;if(this.skipQuadTree||e.body.skipQuadTree){for(var a=0;a<t.hash.length;a++)if(t.hash[a]&&t.hash[a].exists&&t.hash[a].body){if(u=t.hash[a].body,this.sortDirection===n.Physics.Arcade.LEFT_RIGHT){if(e.body.right<u.x)break;if(u.right<e.body.x)continue}else if(this.sortDirection===n.Physics.Arcade.RIGHT_LEFT){if(e.body.x>u.right)break;if(u.x>e.body.right)continue}else if(this.sortDirection===n.Physics.Arcade.TOP_BOTTOM){if(e.body.bottom<u.y)break;if(u.bottom<e.body.y)continue}else if(this.sortDirection===n.Physics.Arcade.BOTTOM_TOP){if(e.body.y>u.bottom)break;if(u.y>e.body.bottom)continue}this.collideSpriteVsSprite(e,t.hash[a],r,i,s,o)}}else{this.quadTree.clear(),this.quadTree.reset(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,this.maxObjects,this.maxLevels),this.quadTree.populate(t);for(var f=this.quadTree.retrieve(e),a=0;a<f.length;a++)this.separate(e.body,f[a],i,s,o)&&(r&&r.call(s,e,f[a].sprite),this._total++)}}},collideGroupVsSelf:function(e,t,r,i,s){if(0!==e.length)for(var o=0;o<e.hash.length;o++)if(e.hash[o]&&e.hash[o].exists&&e.hash[o].body)for(var u=e.hash[o],a=o+1;a<e.hash.length;a++)if(e.hash[a]&&e.hash[a].exists&&e.hash[a].body){var f=e.hash[a];if(this.sortDirection===n.Physics.Arcade.LEFT_RIGHT){if(u.body.right<f.body.x)break;if(f.body.right<u.body.x)continue}else if(this.sortDirection===n.Physics.Arcade.RIGHT_LEFT){if(u.body.x>f.body.right)continue;if(f.body.x>u.body.right)break}else if(this.sortDirection===n.Physics.Arcade.TOP_BOTTOM){if(u.body.bottom<f.body.y)continue;if(f.body.bottom<u.body.y)break}else if(this.sortDirection===n.Physics.Arcade.BOTTOM_TOP){if(u.body.y>f.body.bottom)continue;if(f.body.y>u.body.bottom)break}this.collideSpriteVsSprite(u,f,t,r,i,s)}},collideGroupVsGroup:function(e,t,r,i,s,o){if(0!==e.length&&0!==t.length)for(var u=0;u<e.children.length;u++)e.children[u].exists&&(e.children[u].physicsType===n.GROUP?this.collideGroupVsGroup(e.children[u],t,r,i,s,o):this.collideSpriteVsGroup(e.children[u],t,r,i,s,o))},separate:function(e,t,n,r,i){if(!e.enable||!t.enable||!this.intersects(e,t))return!1;if(n&&n.call(r,e.sprite,t.sprite)===!1)return!1;var s=!1,o=!1;return this.forceX||Math.abs(this.gravity.y+e.gravity.y)<Math.abs(this.gravity.x+e.gravity.x)?(s=this.separateX(e,t,i),this.intersects(e,t)&&(o=this.separateY(e,t,i))):(o=this.separateY(e,t,i),this.intersects(e,t)&&(s=this.separateX(e,t,i))),s||o},intersects:function(e,t){return e.right<=t.position.x?!1:e.bottom<=t.position.y?!1:e.position.x>=t.right?!1:e.position.y>=t.bottom?!1:!0},getOverlapX:function(e,t,n){var r=0,i=e.deltaAbsX()+t.deltaAbsX()+this.OVERLAP_BIAS;return 0===e.deltaX()&&0===t.deltaX()?(e.embedded=!0,t.embedded=!0):e.deltaX()>t.deltaX()?(r=e.right-t.x,r>i&&!n||e.checkCollision.right===!1||t.checkCollision.left===!1?r=0:(e.touching.none=!1,e.touching.right=!0,t.touching.none=!1,t.touching.left=!0)):e.deltaX()<t.deltaX()&&(r=e.x-t.width-t.x,-r>i&&!n||e.checkCollision.left===!1||t.checkCollision.right===!1?r=0:(e.touching.none=!1,e.touching.left=!0,t.touching.none=!1,t.touching.right=!0)),e.overlapX=r,t.overlapX=r,r},getOverlapY:function(e,t,n){var r=0,i=e.deltaAbsY()+t.deltaAbsY()+this.OVERLAP_BIAS;return 0===e.deltaY()&&0===t.deltaY()?(e.embedded=!0,t.embedded=!0):e.deltaY()>t.deltaY()?(r=e.bottom-t.y,r>i&&!n||e.checkCollision.down===!1||t.checkCollision.up===!1?r=0:(e.touching.none=!1,e.touching.down=!0,t.touching.none=!1,t.touching.up=!0)):e.deltaY()<t.deltaY()&&(r=e.y-t.bottom,-r>i&&!n||e.checkCollision.up===!1||t.checkCollision.down===!1?r=0:(e.touching.none=!1,e.touching.up=!0,t.touching.none=!1,t.touching.down=!0)),e.overlapY=r,t.overlapY=r,r},separateX:function(e,t,n){var r=this.getOverlapX(e,t,n);if(n||0===r||e.immovable&&t.immovable||e.customSeparateX||t.customSeparateX)return 0!==r||e.embedded&&t.embedded;var i=e.velocity.x,s=t.velocity.x;if(e.immovable||t.immovable)e.immovable?(t.x+=r,t.velocity.x=i-s*t.bounce.x,e.moves&&(t.y+=(e.y-e.prev.y)*e.friction.y)):(e.x-=r,e.velocity.x=s-i*e.bounce.x,t.moves&&(e.y+=(t.y-t.prev.y)*t.friction.y));else{r*=.5,e.x-=r,t.x+=r;var o=Math.sqrt(s*s*t.mass/e.mass)*(s>0?1:-1),u=Math.sqrt(i*i*e.mass/t.mass)*(i>0?1:-1),a=.5*(o+u);o-=a,u-=a,e.velocity.x=a+o*e.bounce.x,t.velocity.x=a+u*t.bounce.x}return!0},separateY:function(e,t,n){var r=this.getOverlapY(e,t,n);if(n||0===r||e.immovable&&t.immovable||e.customSeparateY||t.customSeparateY)return 0!==r||e.embedded&&t.embedded;var i=e.velocity.y,s=t.velocity.y;if(e.immovable||t.immovable)e.immovable?(t.y+=r,t.velocity.y=i-s*t.bounce.y,e.moves&&(t.x+=(e.x-e.prev.x)*e.friction.x)):(e.y-=r,e.velocity.y=s-i*e.bounce.y,t.moves&&(e.x+=(t.x-t.prev.x)*t.friction.x));else{r*=.5,e.y-=r,t.y+=r;var o=Math.sqrt(s*s*t.mass/e.mass)*(s>0?1:-1),u=Math.sqrt(i*i*e.mass/t.mass)*(i>0?1:-1),a=.5*(o+u);o-=a,u-=a,e.velocity.y=a+o*e.bounce.y,t.velocity.y=a+u*t.bounce.y}return!0},getObjectsUnderPointer:function(e,t,n,r){return 0!==t.length&&e.exists?this.getObjectsAtLocation(e.x,e.y,t,n,r,e):void 0},getObjectsAtLocation:function(e,t,r,i,s,o){this.quadTree.clear(),this.quadTree.reset(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,this.maxObjects,this.maxLevels),this.quadTree.populate(r);for(var u=new n.Rectangle(e,t,1,1),a=[],f=this.quadTree.retrieve(u),l=0;l<f.length;l++)f[l].hitTest(e,t)&&(i&&i.call(s,o,f[l].sprite),a.push(f[l].sprite));return a},moveToObject:function(e,t,n,r){void 0===n&&(n=60),void 0===r&&(r=0);var i=Math.atan2(t.y-e.y,t.x-e.x);return r>0&&(n=this.distanceBetween(e,t)/(r/1e3)),e.body.velocity.x=Math.cos(i)*n,e.body.velocity.y=Math.sin(i)*n,i},moveToPointer:function(e,t,n,r){void 0===t&&(t=60),n=n||this.game.input.activePointer,void 0===r&&(r=0);var i=this.angleToPointer(e,n);return r>0&&(t=this.distanceToPointer(e,n)/(r/1e3)),e.body.velocity.x=Math.cos(i)*t,e.body.velocity.y=Math.sin(i)*t,i},moveToXY:function(e,t,n,r,i){void 0===r&&(r=60),void 0===i&&(i=0);var s=Math.atan2(n-e.y,t-e.x);return i>0&&(r=this.distanceToXY(e,t,n)/(i/1e3)),e.body.velocity.x=Math.cos(s)*r,e.body.velocity.y=Math.sin(s)*r,s},velocityFromAngle:function(e,t,r){return void 0===t&&(t=60),r=r||new n.Point,r.setTo(Math.cos(this.game.math.degToRad(e))*t,Math.sin(this.game.math.degToRad(e))*t)},velocityFromRotation:function(e,t,r){return void 0===t&&(t=60),r=r||new n.Point,r.setTo(Math.cos(e)*t,Math.sin(e)*t)},accelerationFromRotation:function(e,t,r){return void 0===t&&(t=60),r=r||new n.Point,r.setTo(Math.cos(e)*t,Math.sin(e)*t)},accelerateToObject:function(e,t,n,r,i){void 0===n&&(n=60),void 0===r&&(r=1e3),void 0===i&&(i=1e3);var s=this.angleBetween(e,t);return e.body.acceleration.setTo(Math.cos(s)*n,Math.sin(s)*n),e.body.maxVelocity.setTo(r,i),s},accelerateToPointer:function(e,t,n,r,i){void 0===n&&(n=60),void 0===t&&(t=this.game.input.activePointer),void 0===r&&(r=1e3),void 0===i&&(i=1e3);var s=this.angleToPointer(e,t);return e.body.acceleration.setTo(Math.cos(s)*n,Math.sin(s)*n),e.body.maxVelocity.setTo(r,i),s},accelerateToXY:function(e,t,n,r,i,s){void 0===r&&(r=60),void 0===i&&(i=1e3),void 0===s&&(s=1e3);var o=this.angleToXY(e,t,n);return e.body.acceleration.setTo(Math.cos(o)*r,Math.sin(o)*r),e.body.maxVelocity.setTo(i,s),o},distanceBetween:function(e,t,n){void 0===n&&(n=!1);var r=n?e.world.x-t.world.x:e.x-t.x,i=n?e.world.y-t.world.y:e.y-t.y;return Math.sqrt(r*r+i*i)},distanceToXY:function(e,t,n,r){void 0===r&&(r=!1);var i=r?e.world.x-t:e.x-t,s=r?e.world.y-n:e.y-n;return Math.sqrt(i*i+s*s)},distanceToPointer:function(e,t,n){void 0===t&&(t=this.game.input.activePointer),void 0===n&&(n=!1);var r=n?e.world.x-t.worldX:e.x-t.worldX,i=n?e.world.y-t.worldY:e.y-t.worldY;return Math.sqrt(r*r+i*i)},angleBetween:function(e,t,n){return void 0===n&&(n=!1),n?Math.atan2(t.world.y-e.world.y,t.world.x-e.world.x):Math.atan2(t.y-e.y,t.x-e.x)},angleToXY:function(e,t,n,r){return void 0===r&&(r=!1),r?Math.atan2(n-e.world.y,t-e.world.x):Math.atan2(n-e.y,t-e.x)},angleToPointer:function(e,t,n){return void 0===t&&(t=this.game.input.activePointer),void 0===n&&(n=!1),n?Math.atan2(t.worldY-e.world.y,t.worldX-e.world.x):Math.atan2(t.worldY-e.y,t.worldX-e.x)},worldAngleToPointer:function(e,t){return this.angleToPointer(e,t,!0)}},n.Physics.Arcade.Body=function(e){this.sprite=e,this.game=e.game,this.type=n.Physics.ARCADE,this.enable=!0,this.offset=new n.Point,this.position=new n.Point(e.x,e.y),this.prev=new n.Point(this.position.x,this.position.y),this.allowRotation=!0,this.rotation=e.rotation,this.preRotation=e.rotation,this.width=e.width,this.height=e.height,this.sourceWidth=e.width,this.sourceHeight=e.height,e.texture&&(this.sourceWidth=e.texture.frame.width,this.sourceHeight=e.texture.frame.height),this.halfWidth=Math.abs(e.width/2),this.halfHeight=Math.abs(e.height/2),this.center=new n.Point(e.x+this.halfWidth,e.y+this.halfHeight),this.velocity=new n.Point,this.newVelocity=new n.Point(0,0),this.deltaMax=new n.Point(0,0),this.acceleration=new n.Point,this.drag=new n.Point,this.allowGravity=!0,this.gravity=new n.Point(0,0),this.bounce=new n.Point,this.worldBounce=null,this.maxVelocity=new n.Point(1e4,1e4),this.friction=new n.Point(1,0),this.angularVelocity=0,this.angularAcceleration=0,this.angularDrag=0,this.maxAngular=1e3,this.mass=1,this.angle=0,this.speed=0,this.facing=n.NONE,this.immovable=!1,this.moves=!0,this.customSeparateX=!1,this.customSeparateY=!1,this.overlapX=0,this.overlapY=0,this.embedded=!1,this.collideWorldBounds=!1,this.checkCollision={none:!1,any:!0,up:!0,down:!0,left:!0,right:!0},this.touching={none:!0,up:!1,down:!1,left:!1,right:!1},this.wasTouching={none:!0,up:!1,down:!1,left:!1,right:!1},this.blocked={up:!1,down:!1,left:!1,right:!1},this.tilePadding=new n.Point,this.dirty=!1,this.skipQuadTree=!1,this.syncBounds=!1,this._reset=!0,this._sx=e.scale.x,this._sy=e.scale.y,this._dx=0,this._dy=0},n.Physics.Arcade.Body.prototype={updateBounds:function(){if(this.syncBounds){var e=this.sprite.getBounds();e.ceilAll(),(e.width!==this.width||e.height!==this.height)&&(this.width=e.width,this.height=e.height,this._reset=!0)}else{var t=Math.abs(this.sprite.scale.x),n=Math.abs(this.sprite.scale.y);(t!==this._sx||n!==this._sy)&&(this.width=this.sourceWidth*t,this.height=this.sourceHeight*n,this._sx=t,this._sy=n,this._reset=!0)}this._reset&&(this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.center.setTo(this.position.x+this.halfWidth,this.position.y+this.halfHeight))},preUpdate:function(){this.enable&&!this.game.physics.arcade.isPaused&&(this.dirty=!0,this.wasTouching.none=this.touching.none,this.wasTouching.up=this.touching.up,this.wasTouching.down=this.touching.down,this.wasTouching.left=this.touching.left,this.wasTouching.right=this.touching.right,this.touching.none=!0,this.touching.up=!1,this.touching.down=!1,this.touching.left=!1,this.touching.right=!1,this.blocked.up=!1,this.blocked.down=!1,this.blocked.left=!1,this.blocked.right=!1,this.embedded=!1,this.updateBounds(),this.position.x=this.sprite.world.x-this.sprite.anchor.x*this.sprite.width+this.offset.x,this.position.y=this.sprite.world.y-this.sprite.anchor.y*this.sprite.height+this.offset.y,this.rotation=this.sprite.angle,this.preRotation=this.rotation,(this._reset||this.sprite.fresh)&&(this.prev.x=this.position.x,this.prev.y=this.position.y),this.moves&&(this.game.physics.arcade.updateMotion(this),this.newVelocity.set(this.velocity.x*this.game.time.physicsElapsed,this.velocity.y*this.game.time.physicsElapsed),this.position.x+=this.newVelocity.x,this.position.y+=this.newVelocity.y,(this.position.x!==this.prev.x||this.position.y!==this.prev.y)&&(this.angle=Math.atan2(this.velocity.y,this.velocity.x)),this.speed=Math.sqrt(this.velocity.x*this.velocity.x+this.velocity.y*this.velocity.y),this.collideWorldBounds&&this.checkWorldBounds()),this._dx=this.deltaX(),this._dy=this.deltaY(),this._reset=!1)},postUpdate:function(){this.enable&&this.dirty&&(this.dirty=!1,this.deltaX()<0?this.facing=n.LEFT:this.deltaX()>0&&(this.facing=n.RIGHT),this.deltaY()<0?this.facing=n.UP:this.deltaY()>0&&(this.facing=n.DOWN),this.moves&&(this._dx=this.deltaX(),this._dy=this.deltaY(),0!==this.deltaMax.x&&0!==this._dx&&(this._dx<0&&this._dx<-this.deltaMax.x?this._dx=-this.deltaMax.x:this._dx>0&&this._dx>this.deltaMax.x&&(this._dx=this.deltaMax.x)),0!==this.deltaMax.y&&0!==this._dy&&(this._dy<0&&this._dy<-this.deltaMax.y?this._dy=-this.deltaMax.y:this._dy>0&&this._dy>this.deltaMax.y&&(this._dy=this.deltaMax.y)),this.sprite.position.x+=this._dx,this.sprite.position.y+=this._dy,this._reset=!0),this.center.setTo(this.position.x+this.halfWidth,this.position.y+this.halfHeight),this.allowRotation&&(this.sprite.angle+=this.deltaZ()),this.prev.x=this.position.x,this.prev.y=this.position.y)},checkWorldBounds:function(){var e=this.position,t=this.game.physics.arcade.bounds,n=this.game.physics.arcade.checkCollision,r=this.worldBounce?-this.worldBounce.x:-this.bounce.x,i=this.worldBounce?-this.worldBounce.y:-this.bounce.y;e.x<t.x&&n.left?(e.x=t.x,this.velocity.x*=r,this.blocked.left=!0):this.right>t.right&&n.right&&(e.x=t.right-this.width,this.velocity.x*=r,this.blocked.right=!0),e.y<t.y&&n.up?(e.y=t.y,this.velocity.y*=i,this.blocked.up=!0):this.bottom>t.bottom&&n.down&&(e.y=t.bottom-this.height,this.velocity.y*=i,this.blocked.down=!0)},setSize:function(e,t,n,r){this.isCircle||(void 0===n&&(n=this.offset.x),void 0===r&&(r=this.offset.y),this.sourceWidth=e,this.sourceHeight=t,this.width=this.sourceWidth*this._sx,this.height=this.sourceHeight*this._sy,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.offset.setTo(n,r),this.center.setTo(this.position.x+this.halfWidth,this.position.y+this.halfHeight))},setCircle:function(e,t,n){void 0===t&&(t=this.offset.x),void 0===n&&(n=this.offset.y),e>0?(this.isCircle=!0,this.radius=e,this.sourceWidth=2*e,this.sourceHeight=2*e,this.width=this.sourceWidth*this._sx,this.height=this.sourceHeight*this._sy,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.offset.setTo(t,n),this.center.setTo(this.position.x+this.halfWidth,this.position.y+this.halfHeight)):this.isCircle=!1},reset:function(e,t){this.velocity.set(0),this.acceleration.set(0),this.speed=0,this.angularVelocity=0,this.angularAcceleration=0,this.position.x=e-this.sprite.anchor.x*this.sprite.width+this.offset.x,this.position.y=t-this.sprite.anchor.y*this.sprite.height+this.offset.y,this.prev.x=this.position.x,this.prev.y=this.position.y,this.rotation=this.sprite.angle,this.preRotation=this.rotation,this._sx=this.sprite.scale.x,this._sy=this.sprite.scale.y,this.center.setTo(this.position.x+this.halfWidth,this.position.y+this.halfHeight)},hitTest:function(e,t){return this.isCircle?n.Circle.contains(this,e,t):n.Rectangle.contains(this,e,t)},onFloor:function(){return this.blocked.down},onCeiling:function(){return this.blocked.up},onWall:function(){return this.blocked.left||this.blocked.right},deltaAbsX:function(){return this.deltaX()>0?this.deltaX():-this.deltaX()},deltaAbsY:function(){return this.deltaY()>0?this.deltaY():-this.deltaY()},deltaX:function(){return this.position.x-this.prev.x},deltaY:function(){return this.position.y-this.prev.y},deltaZ:function(){return this.rotation-this.preRotation},destroy:function(){this.sprite.parent&&this.sprite.parent instanceof n.Group&&this.sprite.parent.removeFromHash(this.sprite),this.sprite.body=null,this.sprite=null}},Object.defineProperty(n.Physics.Arcade.Body.prototype,"left",{get:function(){return this.position.x}}),Object.defineProperty(n.Physics.Arcade.Body.prototype,"right",{get:function(){return this.position.x+this.width}}),Object.defineProperty(n.Physics.Arcade.Body.prototype,"top",{get:function(){return this.position.y}}),Object.defineProperty(n.Physics.Arcade.Body.prototype,"bottom",{get:function(){return this.position.y+this.height}}),Object.defineProperty(n.Physics.Arcade.Body.prototype,"x",{get:function(){return this.position.x},set:function(e){this.position.x=e}}),Object.defineProperty(n.Physics.Arcade.Body.prototype,"y",{get:function(){return this.position.y},set:function(e){this.position.y=e}}),n.Physics.Arcade.Body.render=function(e,t,n,r){void 0===r&&(r=!0),n=n||"rgba(0,255,0,0.4)",r?(e.fillStyle=n,e.fillRect(t.position.x-t.game.camera.x,t.position.y-t.game.camera.y,t.width,t.height)):(e.strokeStyle=n,e.strokeRect(t.position.x-t.game.camera.x,t.position.y-t.game.camera.y,t.width,t.height))},n.Physics.Arcade.Body.renderBodyInfo=function(e,t){e.line("x: "+t.x.toFixed(2),"y: "+t.y.toFixed(2),"width: "+t.width,"height: "+t.height),e.line("velocity x: "+t.velocity.x.toFixed(2),"y: "+t.velocity.y.toFixed(2),"deltaX: "+t._dx.toFixed(2),"deltaY: "+t._dy.toFixed(2)),e.line("acceleration x: "+t.acceleration.x.toFixed(2),"y: "+t.acceleration.y.toFixed(2),"speed: "+t.speed.toFixed(2),"angle: "+t.angle.toFixed(2)),e.line("gravity x: "+t.gravity.x,"y: "+t.gravity.y,"bounce x: "+t.bounce.x.toFixed(2),"y: "+t.bounce.y.toFixed(2)),e.line("touching left: "+t.touching.left,"right: "+t.touching.right,"up: "+t.touching.up,"down: "+t.touching.down),e.line("blocked left: "+t.blocked.left,"right: "+t.blocked.right,"up: "+t.blocked.up,"down: "+t.blocked.down)},n.Physics.Arcade.Body.prototype.constructor=n.Physics.Arcade.Body,n.Physics.Arcade.TilemapCollision=function(){},n.Physics.Arcade.TilemapCollision.prototype={TILE_BIAS:16,collideSpriteVsTilemapLayer:function(e,t,n,r,i,s){if(e.body){var o=t.getTiles(e.body.position.x-e.body.tilePadding.x,e.body.position.y-e.body.tilePadding.y,e.body.width+e.body.tilePadding.x,e.body.height+e.body.tilePadding.y,!1,!1);if(0!==o.length)for(var u=0;u<o.length;u++)r?r.call(i,e,o[u])&&this.separateTile(u,e.body,o[u],s)&&(this._total++,n&&n.call(i,e,o[u])):this.separateTile(u,e.body,o[u],s)&&(this._total++,n&&n.call(i,e,o[u]))}},collideGroupVsTilemapLayer:function(e,t,n,r,i,s){if(0!==e.length)for(var o=0;o<e.children.length;o++)e.children[o].exists&&this.collideSpriteVsTilemapLayer(e.children[o],t,n,r,i,s)},separateTile:function(e,t,n,r){if(!t.enable)return!1;if(!n.intersects(t.position.x,t.position.y,t.right,t.bottom))return!1;if(r)return!0;if(n.collisionCallback&&!n.collisionCallback.call(n.collisionCallbackContext,t.sprite,n))return!1;if(n.layer.callbacks[n.index]&&!n.layer.callbacks[n.index].callback.call(n.layer.callbacks[n.index].callbackContext,t.sprite,n))return!1;if(!(n.faceLeft||n.faceRight||n.faceTop||n.faceBottom))return!1;var i=0,s=0,o=0,u=1;if(t.deltaAbsX()>t.deltaAbsY()?o=-1:t.deltaAbsX()<t.deltaAbsY()&&(u=-1),0!==t.deltaX()&&0!==t.deltaY()&&(n.faceLeft||n.faceRight)&&(n.faceTop||n.faceBottom)&&(o=Math.min(Math.abs(t.position.x-n.right),Math.abs(t.right-n.left)),u=Math.min(Math.abs(t.position.y-n.bottom),Math.abs(t.bottom-n.top))),u>o){if((n.faceLeft||n.faceRight)&&(i=this.tileCheckX(t,n),0!==i&&!n.intersects(t.position.x,t.position.y,t.right,t.bottom)))return!0;(n.faceTop||n.faceBottom)&&(s=this.tileCheckY(t,n))}else{if((n.faceTop||n.faceBottom)&&(s=this.tileCheckY(t,n),0!==s&&!n.intersects(t.position.x,t.position.y,t.right,t.bottom)))return!0;(n.faceLeft||n.faceRight)&&(i=this.tileCheckX(t,n))}return 0!==i||0!==s},tileCheckX:function(e,t){var n=0;return e.deltaX()<0&&!e.blocked.left&&t.collideRight&&e.checkCollision.left?t.faceRight&&e.x<t.right&&(n=e.x-t.right,n<-this.TILE_BIAS&&(n=0)):e.deltaX()>0&&!e.blocked.right&&t.collideLeft&&e.checkCollision.right&&t.faceLeft&&e.right>t.left&&(n=e.right-t.left,n>this.TILE_BIAS&&(n=0)),0!==n&&(e.customSeparateX?e.overlapX=n:this.processTileSeparationX(e,n)),n},tileCheckY:function(e,t){var n=0;return e.deltaY()<0&&!e.blocked.up&&t.collideDown&&e.checkCollision.up?t.faceBottom&&e.y<t.bottom&&(n=e.y-t.bottom,n<-this.TILE_BIAS&&(n=0)):e.deltaY()>0&&!e.blocked.down&&t.collideUp&&e.checkCollision.down&&t.faceTop&&e.bottom>t.top&&(n=e.bottom-t.top,n>this.TILE_BIAS&&(n=0)),0!==n&&(e.customSeparateY?e.overlapY=n:this.processTileSeparationY(e,n)),n},processTileSeparationX:function(e,t){0>t?e.blocked.left=!0:t>0&&(e.blocked.right=!0),e.position.x-=t,0===e.bounce.x?e.velocity.x=0:e.velocity.x=-e.velocity.x*e.bounce.x},processTileSeparationY:function(e,t){0>t?e.blocked.up=!0:t>0&&(e.blocked.down=!0),e.position.y-=t,0===e.bounce.y?e.velocity.y=0:e.velocity.y=-e.velocity.y*e.bounce.y}},n.Utils.mixinPrototype(n.Physics.Arcade.prototype,n.Physics.Arcade.TilemapCollision.prototype),p2.Body.prototype.parent=null,p2.Spring.prototype.parent=null,n.Physics.P2=function(e,t){this.game=e,void 0===t?t={gravity:[0,0],broadphase:new p2.SAPBroadphase}:(t.hasOwnProperty("gravity")||(t.gravity=[0,0]),t.hasOwnProperty("broadphase")||(t.broadphase=new p2.SAPBroadphase)),this.config=t,this.world=new p2.World(this.config),this.frameRate=1/60,this.useElapsedTime=!1,this.paused=!1,this.materials=[],this.gravity=new n.Physics.P2.InversePointProxy(this,this.world.gravity),this.walls={left:null,right:null,top:null,bottom:null},this.onBodyAdded=new n.Signal,this.onBodyRemoved=new n.Signal,this.onSpringAdded=new n.Signal,this.onSpringRemoved=new n.Signal,this.onConstraintAdded=new n.Signal,this.onConstraintRemoved=new n.Signal,this.onContactMaterialAdded=new n.Signal,this.onContactMaterialRemoved=new n.Signal,this.postBroadphaseCallback=null,this.callbackContext=null,this.onBeginContact=new n.Signal,this.onEndContact=new n.Signal,t.hasOwnProperty("mpx")&&t.hasOwnProperty("pxm")&&t.hasOwnProperty("mpxi")&&t.hasOwnProperty("pxmi")&&(this.mpx=t.mpx,this.mpxi=t.mpxi,this.pxm=t.pxm,this.pxmi=t.pxmi),this.world.on("beginContact",this.beginContactHandler,this),this.world.on("endContact",this.endContactHandler,this),this.collisionGroups=[],this.nothingCollisionGroup=new n.Physics.P2.CollisionGroup(1),this.boundsCollisionGroup=new n.Physics.P2.CollisionGroup(2),this.everythingCollisionGroup=new n.Physics.P2.CollisionGroup(2147483648),this.boundsCollidesWith=[],this._toRemove=[],this._collisionGroupID=2,this._boundsLeft=!0,this._boundsRight=!0,this._boundsTop=!0,this._boundsBottom=!0,this._boundsOwnGroup=!1,this.setBoundsToWorld(!0,!0,!0,!0,!1)},n.Physics.P2.prototype={removeBodyNextStep:function(e){this._toRemove.push(e)},preUpdate:function(){for(var e=this._toRemove.length;e--;)this.removeBody(this._toRemove[e]);this._toRemove.length=0},enable:function(e,t,r){void 0===t&&(t=!1),void 0===r&&(r=!0);var i=1;if(Array.isArray(e))for(i=e.length;i--;)e[i]instanceof n.Group?this.enable(e[i].children,t,r):(this.enableBody(e[i],t),r&&e[i].hasOwnProperty("children")&&e[i].children.length>0&&this.enable(e[i],t,!0));else e instanceof n.Group?this.enable(e.children,t,r):(this.enableBody(e,t),r&&e.hasOwnProperty("children")&&e.children.length>0&&this.enable(e.children,t,!0))},enableBody:function(e,t){e.hasOwnProperty("body")&&null===e.body&&(e.body=new n.Physics.P2.Body(this.game,e,e.x,e.y,1),e.body.debug=t,"undefined"!=typeof e.anchor&&e.anchor.set(.5))},setImpactEvents:function(e){e?this.world.on("impact",this.impactHandler,this):this.world.off("impact",this.impactHandler,this)},setPostBroadphaseCallback:function(e,t){this.postBroadphaseCallback=e,this.callbackContext=t,null!==e?this.world.on("postBroadphase",this.postBroadphaseHandler,this):this.world.off("postBroadphase",this.postBroadphaseHandler,this)},postBroadphaseHandler:function(e){if(this.postBroadphaseCallback&&0!==e.pairs.length)for(var t=e.pairs.length-2;t>=0;t-=2)e.pairs[t].parent&&e.pairs[t+1].parent&&!this.postBroadphaseCallback.call(this.callbackContext,e.pairs[t].parent,e.pairs[t+1].parent)&&e.pairs.splice(t,2)},impactHandler:function(e){if(e.bodyA.parent&&e.bodyB.parent){var t=e.bodyA.parent,n=e.bodyB.parent;t._bodyCallbacks[e.bodyB.id]&&t._bodyCallbacks[e.bodyB.id].call(t._bodyCallbackContext[e.bodyB.id],t,n,e.shapeA,e.shapeB),n._bodyCallbacks[e.bodyA.id]&&n._bodyCallbacks[e.bodyA.id].call(n._bodyCallbackContext[e.bodyA.id],n,t,e.shapeB,e.shapeA),t._groupCallbacks[e.shapeB.collisionGroup]&&t._groupCallbacks[e.shapeB.collisionGroup].call(t._groupCallbackContext[e.shapeB.collisionGroup],t,n,e.shapeA,e.shapeB),n._groupCallbacks[e.shapeA.collisionGroup]&&n._groupCallbacks[e.shapeA.collisionGroup].call(n._groupCallbackContext[e.shapeA.collisionGroup],n,t,e.shapeB,e.shapeA)}},beginContactHandler:function(e){e.bodyA&&e.bodyB&&(this.onBeginContact.dispatch(e.bodyA,e.bodyB,e.shapeA,e.shapeB,e.contactEquations),e.bodyA.parent&&e.bodyA.parent.onBeginContact.dispatch(e.bodyB.parent,e.bodyB,e.shapeA,e.shapeB,e.contactEquations),e.bodyB.parent&&e.bodyB.parent.onBeginContact.dispatch(e.bodyA.parent,e.bodyA,e.shapeB,e.shapeA,e.contactEquations))},endContactHandler:function(e){e.bodyA&&e.bodyB&&(this.onEndContact.dispatch(e.bodyA,e.bodyB,e.shapeA,e.shapeB),e.bodyA.parent&&e.bodyA.parent.onEndContact.dispatch(e.bodyB.parent,e.bodyB,e.shapeA,e.shapeB),e.bodyB.parent&&e.bodyB.parent.onEndContact.dispatch(e.bodyA.parent,e.bodyA,e.shapeB,e.shapeA))},setBoundsToWorld:function(e,t,n,r,i){this.setBounds(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,e,t,n,r,i)},setWorldMaterial:function(e,t,n,r,i){void 0===t&&(t=!0),void 0===n&&(n=!0),void 0===r&&(r=!0),void 0===i&&(i=!0),t&&this.walls.left&&(this.walls.left.shapes[0].material=e),n&&this.walls.right&&(this.walls.right.shapes[0].material=e),r&&this.walls.top&&(this.walls.top.shapes[0].material=e),i&&this.walls.bottom&&(this.walls.bottom.shapes[0].material=e)},updateBoundsCollisionGroup:function(e){void 0===e&&(e=!0);var t=e?this.boundsCollisionGroup.mask:this.everythingCollisionGroup.mask;this.walls.left&&(this.walls.left.shapes[0].collisionGroup=t),this.walls.right&&(this.walls.right.shapes[0].collisionGroup=t),this.walls.top&&(this.walls.top.shapes[0].collisionGroup=t),this.walls.bottom&&(this.walls.bottom.shapes[0].collisionGroup=t),this._boundsOwnGroup=e},setBounds:function(e,t,n,r,i,s,o,u,a){void 0===i&&(i=this._boundsLeft),void 0===s&&(s=this._boundsRight),void 0===o&&(o=this._boundsTop),void 0===u&&(u=this._boundsBottom),void 0===a&&(a=this._boundsOwnGroup),this.setupWall(i,"left",e,t,1.5707963267948966,a),this.setupWall(s,"right",e+n,t,-1.5707963267948966,a),this.setupWall(o,"top",e,t,-3.141592653589793,a),this.setupWall(u,"bottom",e,t+r,0,a),this._boundsLeft=i,this._boundsRight=s,this._boundsTop=o,this._boundsBottom=u,this._boundsOwnGroup=a},setupWall:function(e,t,n,r,i,s){e?this.walls[t]?this.walls[t].position=[this.pxmi(n),this.pxmi(r)]:(this.walls[t]=new p2.Body({mass:0,position:[this.pxmi(n),this.pxmi(r)],angle:i}),this.walls[t].addShape(new p2.Plane),s&&(this.walls[t].shapes[0].collisionGroup=this.boundsCollisionGroup.mask),this.world.addBody(this.walls[t])):this.walls[t]&&(this.world.removeBody(this.walls[t]),this.walls[t]=null)},pause:function(){this.paused=!0},resume:function(){this.paused=!1},update:function(){this.paused||(this.useElapsedTime?this.world.step(this.game.time.physicsElapsed):this.world.step(this.frameRate))},reset:function(){this.world.on("beginContact",this.beginContactHandler,this),this.world.on("endContact",this.endContactHandler,this),this.nothingCollisionGroup=new n.Physics.P2.CollisionGroup(1),this.boundsCollisionGroup=new n.Physics.P2.CollisionGroup(2),this.everythingCollisionGroup=new n.Physics.P2.CollisionGroup(2147483648),this._collisionGroupID=2,this.setBoundsToWorld(!0,!0,!0,!0,!1)},clear:function(){this.world.time=0,this.world.fixedStepTime=0,this.world.solver&&this.world.solver.equations.length&&this.world.solver.removeAllEquations();for(var e=this.world.constraints,t=e.length-1;t>=0;t--)this.world.removeConstraint(e[t]);for(var n=this.world.bodies,t=n.length-1;t>=0;t--)this.world.removeBody(n[t]);for(var r=this.world.springs,t=r.length-1;t>=0;t--)this.world.removeSpring(r[t]);for(var i=this.world.contactMaterials,t=i.length-1;t>=0;t--)this.world.removeContactMaterial(i[t]);this.world.off("beginContact",this.beginContactHandler,this),this.world.off("endContact",this.endContactHandler,this),this.postBroadphaseCallback=null,this.callbackContext=null,this.impactCallback=null,this.collisionGroups=[],this._toRemove=[],this.boundsCollidesWith=[]},destroy:function(){this.clear(),this.game=null},addBody:function(e){return e.data.world?!1:(this.world.addBody(e.data),this.onBodyAdded.dispatch(e),!0)},removeBody:function(e){return e.data.world==this.world&&(this.world.removeBody(e.data),this.onBodyRemoved.dispatch(e)),e},addSpring:function(e){return e instanceof n.Physics.P2.Spring||e instanceof n.Physics.P2.RotationalSpring?this.world.addSpring(e.data):this.world.addSpring(e),this.onSpringAdded.dispatch(e),e},removeSpring:function(e){return e instanceof n.Physics.P2.Spring||e instanceof n.Physics.P2.RotationalSpring?this.world.removeSpring(e.data):this.world.removeSpring(e),this.onSpringRemoved.dispatch(e),e},createDistanceConstraint:function(e,t,r,i,s,o){return e=this.getBody(e),t=this.getBody(t),e&&t?this.addConstraint(new n.Physics.P2.DistanceConstraint(this,e,t,r,i,s,o)):void console.warn("Cannot create Constraint, invalid body objects given")},createGearConstraint:function(e,t,r,i){return e=this.getBody(e),t=this.getBody(t),e&&t?this.addConstraint(new n.Physics.P2.GearConstraint(this,e,t,r,i)):void console.warn("Cannot create Constraint, invalid body objects given")},createRevoluteConstraint:function(e,t,r,i,s,o){return e=this.getBody(e),r=this.getBody(r),e&&r?this.addConstraint(new n.Physics.P2.RevoluteConstraint(this,e,t,r,i,s,o)):void console.warn("Cannot create Constraint, invalid body objects given")},createLockConstraint:function(e,t,r,i,s){return e=this.getBody(e),t=this.getBody(t),e&&t?this.addConstraint(new n.Physics.P2.LockConstraint(this,e,t,r,i,s)):void console.warn("Cannot create Constraint, invalid body objects given")},createPrismaticConstraint:function(e,t,r,i,s,o,u){return e=this.getBody(e),t=this.getBody(t),e&&t?this.addConstraint(new n.Physics.P2.PrismaticConstraint(this,e,t,r,i,s,o,u)):void console.warn("Cannot create Constraint, invalid body objects given")},addConstraint:function(e){return this.world.addConstraint(e),this.onConstraintAdded.dispatch(e),e},removeConstraint:function(e){return this.world.removeConstraint(e),this.onConstraintRemoved.dispatch(e),e},addContactMaterial:function(e){return this.world.addContactMaterial(e),this.onContactMaterialAdded.dispatch(e),e},removeContactMaterial:function(e){return this.world.removeContactMaterial(e),this.onContactMaterialRemoved.dispatch(e),e},getContactMaterial:function(e,t){return this.world.getContactMaterial(e,t)},setMaterial:function(e,t){for(var n=t.length;n--;)t[n].setMaterial(e)},createMaterial:function(e,t){e=e||"";var r=new n.Physics.P2.Material(e);return this.materials.push(r),"undefined"!=typeof t&&t.setMaterial(r),r},createContactMaterial:function(e,t,r){void 0===e&&(e=this.createMaterial()),void 0===t&&(t=this.createMaterial());var i=new n.Physics.P2.ContactMaterial(e,t,r);return this.addContactMaterial(i)},getBodies:function(){for(var e=[],t=this.world.bodies.length;t--;)e.push(this.world.bodies[t].parent);return e},getBody:function(e){return e instanceof p2.Body?e:e instanceof n.Physics.P2.Body?e.data:e.body&&e.body.type===n.Physics.P2JS?e.body.data:null},getSprings:function(){for(var e=[],t=this.world.springs.length;t--;)e.push(this.world.springs[t].parent);return e},getConstraints:function(){for(var e=[],t=this.world.constraints.length;t--;)e.push(this.world.constraints[t]);return e},hitTest:function(e,t,r,i){void 0===t&&(t=this.world.bodies),void 0===r&&(r=5),void 0===i&&(i=!1);for(var s=[this.pxmi(e.x),this.pxmi(e.y)],o=[],u=t.length;u--;)t[u]instanceof n.Physics.P2.Body&&(!i||t[u].data.type!==p2.Body.STATIC)?o.push(t[u].data):t[u]instanceof p2.Body&&t[u].parent&&(!i||t[u].type!==p2.Body.STATIC)?o.push(t[u]):t[u]instanceof n.Sprite&&t[u].hasOwnProperty("body")&&(!i||t[u].body.data.type!==p2.Body.STATIC)&&o.push(t[u].body.data);return this.world.hitTest(s,o,r)},toJSON:function(){return this.world.toJSON()},createCollisionGroup:function(e){var t=Math.pow(2,this._collisionGroupID);this.walls.left&&(this.walls.left.shapes[0].collisionMask=this.walls.left.shapes[0].collisionMask|t),this.walls.right&&(this.walls.right.shapes[0].collisionMask=this.walls.right.shapes[0].collisionMask|t),this.walls.top&&(this.walls.top.shapes[0].collisionMask=this.walls.top.shapes[0].collisionMask|t),this.walls.bottom&&(this.walls.bottom.shapes[0].collisionMask=this.walls.bottom.shapes[0].collisionMask|t),this._collisionGroupID++;var r=new n.Physics.P2.CollisionGroup(t);return this.collisionGroups.push(r),e&&this.setCollisionGroup(e,r),r},setCollisionGroup:function(e,t){if(e instanceof n.Group)for(var r=0;r<e.total;r++)e.children[r].body&&e.children[r].body.type===n.Physics.P2JS&&e.children[r].body.setCollisionGroup(t);else e.body.setCollisionGroup(t)},createSpring:function(e,t,r,i,s,o,u,a,f){return e=this.getBody(e),t=this.getBody(t),e&&t?this.addSpring(new n.Physics.P2.Spring(this,e,t,r,i,s,o,u,a,f)):void console.warn("Cannot create Spring, invalid body objects given")},createRotationalSpring:function(e,t,r,i,s){return e=this.getBody(e),t=this.getBody(t),e&&t?this.addSpring(new n.Physics.P2.RotationalSpring(this,e,t,r,i,s)):void console.warn("Cannot create Rotational Spring, invalid body objects given")},createBody:function(e,t,r,i,s,o){void 0===i&&(i=!1);var u=new n.Physics.P2.Body(this.game,null,e,t,r);if(o){var a=u.addPolygon(s,o);if(!a)return!1}return i&&this.world.addBody(u.data),u},createParticle:function(e,t,r,i,s,o){void 0===i&&(i=!1);var u=new n.Physics.P2.Body(this.game,null,e,t,r);if(o){var a=u.addPolygon(s,o);if(!a)return!1}return i&&this.world.addBody(u.data),u},convertCollisionObjects:function(e,t,n){void 0===n&&(n=!0);for(var r=[],i=0,s=e.collision[t].length;s>i;i++){var o=e.collision[t][i],u=this.createBody(o.x,o.y,0,n,{},o.polyline);u&&r.push(u)}return r},clearTilemapLayerBodies:function(e,t){t=e.getLayer(t);for(var n=e.layers[t].bodies.length;n--;)e.layers[t].bodies[n].destroy();e.layers[t].bodies.length=0},convertTilemap:function(e,t,n,r){t=e.getLayer(t),void 0===n&&(n=!0),void 0===r&&(r=!0),this.clearTilemapLayerBodies(e,t);for(var i=0,s=0,o=0,u=0,a=e.layers[t].height;a>u;u++){i=0;for(var f=0,l=e.layers[t].width;l>f;f++){var c=e.layers[t].data[u][f];if(c&&c.index>-1&&c.collides)if(r){var h=e.getTileRight(t,f,u);if(0===i&&(s=c.x*c.width,o=c.y*c.height,i=c.width),h&&h.collides)i+=c.width;else{var p=this.createBody(s,o,0,!1);p.addRectangle(i,c.height,i/2,c.height/2,0),n&&this.addBody(p),e.layers[t].bodies.push(p),i=0}}else{var p=this.createBody(c.x*c.width,c.y*c.height,0,!1);p.addRectangle(c.width,c.height,c.width/2,c.height/2,0),n&&this.addBody(p),e.layers[t].bodies.push(p)}}}return e.layers[t].bodies},mpx:function(e){return e*=20},pxm:function(e){return.05*e},mpxi:function(e){return e*=-20},pxmi:function(e){return e*-0.05}},Object.defineProperty(n.Physics.P2.prototype,"friction",{get:function(){return this.world.defaultContactMaterial.friction},set:function(e){this.world.defaultContactMaterial.friction=e}}),Object.defineProperty(n.Physics.P2.prototype,"restitution",{get:function(){return this.world.defaultContactMaterial.restitution},set:function(e){this.world.defaultContactMaterial.restitution=e}}),Object.defineProperty(n.Physics.P2.prototype,"contactMaterial",{get:function(){return this.world.defaultContactMaterial},set:function(e){this.world.defaultContactMaterial=e}}),Object.defineProperty(n.Physics.P2.prototype,"applySpringForces",{get:function(){return this.world.applySpringForces},set:function(e){this.world.applySpringForces=e}}),Object.defineProperty(n.Physics.P2.prototype,"applyDamping",{get:function(){return this.world.applyDamping},set:function(e){this.world.applyDamping=e}}),Object.defineProperty(n.Physics.P2.prototype,"applyGravity",{get:function(){return this.world.applyGravity},set:function(e){this.world.applyGravity=e}}),Object.defineProperty(n.Physics.P2.prototype,"solveConstraints",{get:function(){return this.world.solveConstraints},set:function(e){this.world.solveConstraints=e}}),Object.defineProperty(n.Physics.P2.prototype,"time",{get:function(){return this.world.time}}),Object.defineProperty(n.Physics.P2.prototype,"emitImpactEvent",{get:function(){return this.world.emitImpactEvent},set:function(e){this.world.emitImpactEvent=e}}),Object.defineProperty(n.Physics.P2.prototype,"sleepMode",{get:function(){return this.world.sleepMode},set:function(e){this.world.sleepMode=e}}),Object.defineProperty(n.Physics.P2.prototype,"total",{get:function(){return this.world.bodies.length}}),n.Physics.P2.FixtureList=function(e){Array.isArray(e)||(e=[e]),this.rawList=e,this.init(),this.parse(this.rawList)},n.Physics.P2.FixtureList.prototype={init:function(){this.namedFixtures={},this.groupedFixtures=[],this.allFixtures=[]},setCategory:function(e,t){var n=function(t){t.collisionGroup=e};this.getFixtures(t).forEach(n)},setMask:function(e,t){var n=function(t){t.collisionMask=e};this.getFixtures(t).forEach(n)},setSensor:function(e,t){var n=function(t){t.sensor=e};this.getFixtures(t).forEach(n)},setMaterial:function(e,t){var n=function(t){t.material=e};this.getFixtures(t).forEach(n)},getFixtures:function(e){var t=[];if(e){e instanceof Array||(e=[e]);var n=this;return e.forEach(function(e){n.namedFixtures[e]&&t.push(n.namedFixtures[e])}),this.flatten(t)}return this.allFixtures},getFixtureByKey:function(e){return this.namedFixtures[e]},getGroup:function(e){return this.groupedFixtures[e]},parse:function(){var e,t,n,r;n=this.rawList,r=[];for(e in n)t=n[e],isNaN(e-0)?this.namedFixtures[e]=this.flatten(t):(this.groupedFixtures[e]=this.groupedFixtures[e]||[],this.groupedFixtures[e]=this.groupedFixtures[e].concat(t)),r.push(this.allFixtures=this.flatten(this.groupedFixtures))},flatten:function(e){var t,n;return t=[],n=arguments.callee,e.forEach(function(e){return Array.prototype.push.apply(t,Array.isArray(e)?n(e):[e])}),t}},n.Physics.P2.PointProxy=function(e,t){this.world=e,this.destination=t},n.Physics.P2.PointProxy.prototype.constructor=n.Physics.P2.PointProxy,Object.defineProperty(n.Physics.P2.PointProxy.prototype,"x",{get:function(){return this.world.mpx(this.destination[0])},set:function(e){this.destination[0]=this.world.pxm(e)}}),Object.defineProperty(n.Physics.P2.PointProxy.prototype,"y",{get:function(){return this.world.mpx(this.destination[1])},set:function(e){this.destination[1]=this.world.pxm(e)}}),Object.defineProperty(n.Physics.P2.PointProxy.prototype,"mx",{get:function(){return this.destination[0]},set:function(e){this.destination[0]=e}}),Object.defineProperty(n.Physics.P2.PointProxy.prototype,"my",{get:function(){return this.destination[1]},set:function(e){this.destination[1]=e}}),n.Physics.P2.InversePointProxy=function(e,t){this.world=e,this.destination=t},n.Physics.P2.InversePointProxy.prototype.constructor=n.Physics.P2.InversePointProxy,Object.defineProperty(n.Physics.P2.InversePointProxy.prototype,"x",{get:function(){return this.world.mpxi(this.destination[0])},set:function(e){this.destination[0]=this.world.pxmi(e)}}),Object.defineProperty(n.Physics.P2.InversePointProxy.prototype,"y",{get:function(){return this.world.mpxi(this.destination[1])},set:function(e){this.destination[1]=this.world.pxmi(e)}}),Object.defineProperty(n.Physics.P2.InversePointProxy.prototype,"mx",{get:function(){return this.destination[0]},set:function(e){this.destination[0]=-e}}),Object.defineProperty(n.Physics.P2.InversePointProxy.prototype,"my",{get:function(){return this.destination[1]},set:function(e){this.destination[1]=-e}}),n.Physics.P2.Body=function(e,t,r,i,s){t=t||null,r=r||0,i=i||0,void 0===s&&(s=1),this.game=e,this.world=e.physics.p2,this.sprite=t,this.type=n.Physics.P2JS,this.offset=new n.Point,this.data=new p2.Body({position:[this.world.pxmi(r),this.world.pxmi(i)],mass:s}),this.data.parent=this,this.velocity=new n.Physics.P2.InversePointProxy(this.world,this.data.velocity),this.force=new n.Physics.P2.InversePointProxy(this.world,this.data.force),this.gravity=new n.Point,this.onBeginContact=new n.Signal,this.onEndContact=new n.Signal,this.collidesWith=[],this.removeNextStep=!1,this.debugBody=null,this.dirty=!1,this._collideWorldBounds=!0,this._bodyCallbacks={},this._bodyCallbackContext={},this._groupCallbacks={},this._groupCallbackContext={},this._reset=!1,t&&(this.setRectangleFromSprite(t),t.exists&&this.game.physics.p2.addBody(this))},n.Physics.P2.Body.prototype={createBodyCallback:function(e,t,n){var r=-1;e.id?r=e.id:e.body&&(r=e.body.id),r>-1&&(null===t?(delete this._bodyCallbacks[r],delete this._bodyCallbackContext[r]):(this._bodyCallbacks[r]=t,this._bodyCallbackContext[r]=n))},createGroupCallback:function(e,t,n){null===t?(delete this._groupCallbacks[e.mask],delete this._groupCallbackContext[e.mask]):(this._groupCallbacks[e.mask]=t,this._groupCallbackContext[e.mask]=n)},getCollisionMask:function(){var e=0;this._collideWorldBounds&&(e=this.game.physics.p2.boundsCollisionGroup.mask);for(var t=0;t<this.collidesWith.length;t++)e|=this.collidesWith[t].mask;return e},updateCollisionMask:function(e){var t=this.getCollisionMask();if(void 0===e)for(var n=this.data.shapes.length-1;n>=0;n--)this.data.shapes[n].collisionMask=t;else e.collisionMask=t},setCollisionGroup:function(e,t){var n=this.getCollisionMask();if(void 0===t)for(var r=this.data.shapes.length-1;r>=0;r--)this.data.shapes[r].collisionGroup=e.mask,this.data.shapes[r].collisionMask=n;else t.collisionGroup=e.mask,t.collisionMask=n},clearCollision:function(e,t,n){if(void 0===e&&(e=!0),void 0===t&&(t=!0),void 0===n)for(var r=this.data.shapes.length-1;r>=0;r--)e&&(this.data.shapes[r].collisionGroup=null),t&&(this.data.shapes[r].collisionMask=null);else e&&(n.collisionGroup=null),t&&(n.collisionMask=null);e&&(this.collidesWith.length=0)},removeCollisionGroup:function(e,t,n){void 0===t&&(t=!0);var r;if(Array.isArray(e))for(var i=0;i<e.length;i++)r=this.collidesWith.indexOf(e[i]),r>-1&&(this.collidesWith.splice(r,1),t&&(delete this._groupCallbacks[e.mask],delete this._groupCallbackContext[e.mask]));else r=this.collidesWith.indexOf(e),r>-1&&(this.collidesWith.splice(r,1),t&&(delete this._groupCallbacks[e.mask],delete this._groupCallbackContext[e.mask]));var s=this.getCollisionMask();if(void 0===n)for(var i=this.data.shapes.length-1;i>=0;i--)this.data.shapes[i].collisionMask=s;else n.collisionMask=s},collides:function(e,t,n,r){if(Array.isArray(e))for(var i=0;i<e.length;i++)-1===this.collidesWith.indexOf(e[i])&&(this.collidesWith.push(e[i]),t&&this.createGroupCallback(e[i],t,n));else-1===this.collidesWith.indexOf(e)&&(this.collidesWith.push(e),t&&this.createGroupCallback(e,t,n));var s=this.getCollisionMask();if(void 0===r)for(var i=this.data.shapes.length-1;i>=0;i--)this.data.shapes[i].collisionMask=s;else r.collisionMask=s},adjustCenterOfMass:function(){this.data.adjustCenterOfMass(),this.shapeChanged()},getVelocityAtPoint:function(e,t){return this.data.getVelocityAtPoint(e,t)},applyDamping:function(e){this.data.applyDamping(e)},applyImpulse:function(e,t,n){this.data.applyImpulse(e,[this.world.pxmi(t),this.world.pxmi(n)])},applyImpulseLocal:function(e,t,n){this.data.applyImpulseLocal(e,[this.world.pxmi(t),this.world.pxmi(n)])},applyForce:function(e,t,n){this.data.applyForce(e,[this.world.pxmi(t),this.world.pxmi(n)])},setZeroForce:function(){this.data.setZeroForce()},setZeroRotation:function(){this.data.angularVelocity=0},setZeroVelocity:function(){this.data.velocity[0]=0,this.data.velocity[1]=0},setZeroDamping:function(){this.data.damping=0,this.data.angularDamping=0},toLocalFrame:function(e,t){return this.data.toLocalFrame(e,t)},toWorldFrame:function(e,t){return this.data.toWorldFrame(e,t)},rotateLeft:function(e){this.data.angularVelocity=this.world.pxm(-e)},rotateRight:function(e){this.data.angularVelocity=this.world.pxm(e)},moveForward:function(e){var t=this.world.pxmi(-e),n=this.data.angle+Math.PI/2;this.data.velocity[0]=t*Math.cos(n),this.data.velocity[1]=t*Math.sin(n)},moveBackward:function(e){var t=this.world.pxmi(-e),n=this.data.angle+Math.PI/2;this.data.velocity[0]=-(t*Math.cos(n)),this.data.velocity[1]=-(t*Math.sin(n))},thrust:function(e){var t=this.world.pxmi(-e),n=this.data.angle+Math.PI/2;this.data.force[0]+=t*Math.cos(n),this.data.force[1]+=t*Math.sin(n)},thrustLeft:function(e){var t=this.world.pxmi(-e),n=this.data.angle;this.data.force[0]+=t*Math.cos(n),this.data.force[1]+=t*Math.sin(n)},thrustRight:function(e){var t=this.world.pxmi(-e),n=this.data.angle;this.data.force[0]-=t*Math.cos(n),this.data.force[1]-=t*Math.sin(n)},reverse:function(e){var t=this.world.pxmi(-e),n=this.data.angle+Math.PI/2;this.data.force[0]-=t*Math.cos(n),this.data.force[1]-=t*Math.sin(n)},moveLeft:function(e){this.data.velocity[0]=this.world.pxmi(-e)},moveRight:function(e){this.data.velocity[0]=this.world.pxmi(e)},moveUp:function(e){this.data.velocity[1]=this.world.pxmi(-e)},moveDown:function(e){this.data.velocity[1]=this.world.pxmi(e)},preUpdate:function(){this.dirty=!0,this.removeNextStep&&(this.removeFromWorld(),this.removeNextStep=!1)},postUpdate:function(){this.sprite.x=this.world.mpxi(this.data.position[0])+this.offset.x,this.sprite.y=this.world.mpxi(this.data.position[1])+this.offset.y,this.fixedRotation||(this.sprite.rotation=this.data.angle),this.debugBody&&this.debugBody.updateSpriteTransform(),this.dirty=!1},reset:function(e,t,n,r){void 0===n&&(n=!1),void 0===r&&(r=!1),this.setZeroForce(),this.setZeroVelocity(),this.setZeroRotation(),n&&this.setZeroDamping(),r&&(this.mass=1),this.x=e,this.y=t},addToWorld:function(){if(this.game.physics.p2._toRemove)for(var e=0;e<this.game.physics.p2._toRemove.length;e++)this.game.physics.p2._toRemove[e]===this&&this.game.physics.p2._toRemove.splice(e,1);this.data.world!==this.game.physics.p2.world&&this.game.physics.p2.addBody(this)},removeFromWorld:function(){this.data.world===this.game.physics.p2.world&&this.game.physics.p2.removeBodyNextStep(this)},destroy:function(){this.removeFromWorld(),this.clearShapes(),this._bodyCallbacks={},this._bodyCallbackContext={},this._groupCallbacks={},this._groupCallbackContext={},this.debugBody&&this.debugBody.destroy(!0,!0),this.debugBody=null,this.sprite&&(this.sprite.body=null,this.sprite=null)},clearShapes:function(){for(var e=this.data.shapes.length;e--;)this.data.removeShape(this.data.shapes[e]);this.shapeChanged()},addShape:function(e,t,n,r){return void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0),this.data.addShape(e,[this.world.pxmi(t),this.world.pxmi(n)],r),this.shapeChanged(),e},addCircle:function(e,t,n,r){var i=new p2.Circle({radius:this.world.pxm(e)});return this.addShape(i,t,n,r)},addRectangle:function(e,t,n,r,i){var s=new p2.Box({width:this.world.pxm(e),height:this.world.pxm(t)});return this.addShape(s,n,r,i)},addPlane:function(e,t,n){var r=new p2.Plane;return this.addShape(r,e,t,n)},addParticle:function(e,t,n){var r=new p2.Particle;return this.addShape(r,e,t,n)},addLine:function(e,t,n,r){var i=new p2.Line({length:this.world.pxm(e)});return this.addShape(i,t,n,r)},addCapsule:function(e,t,n,r,i){var s=new p2.Capsule({length:this.world.pxm(e),radius:this.world.pxm(t)});return this.addShape(s,n,r,i)},addPolygon:function(e,t){e=e||{},Array.isArray(t)||(t=Array.prototype.slice.call(arguments,1));var n=[];if(1===t.length&&Array.isArray(t[0]))n=t[0].slice(0);else if(Array.isArray(t[0]))n=t.slice();else if("number"==typeof t[0])for(var r=0,i=t.length;i>r;r+=2)n.push([t[r],t[r+1]]);var s=n.length-1;n[s][0]===n[0][0]&&n[s][1]===n[0][1]&&n.pop();for(var o=0;o<n.length;o++)n[o][0]=this.world.pxmi(n[o][0]),n[o][1]=this.world.pxmi(n[o][1]);var u=this.data.fromPolygon(n,e);return this.shapeChanged(),u},removeShape:function(e){var t=this.data.removeShape(e);return this.shapeChanged(),t},setCircle:function(e,t,n,r){return this.clearShapes(),this.addCircle(e,t,n,r)},setRectangle:function(e,t,n,r,i){return void 0===e&&(e=16),void 0===t&&(t=16),this.clearShapes(),this.addRectangle(e,t,n,r,i)},setRectangleFromSprite:function(e){return void 0===e&&(e=this.sprite),this.clearShapes(),this.addRectangle(e.width,e.height,0,0,e.rotation)},setMaterial:function(e,t){if(void 0===t)for(var n=this.data.shapes.length-1;n>=0;n--)this.data.shapes[n].material=e;else t.material=e},shapeChanged:function(){this.debugBody&&this.debugBody.draw()},addPhaserPolygon:function(e,t){for(var n=this.game.cache.getPhysicsData(e,t),r=[],i=0;i<n.length;i++){var s=n[i],o=this.addFixture(s);r[s.filter.group]=r[s.filter.group]||[],r[s.filter.group]=r[s.filter.group].concat(o),s.fixtureKey&&(r[s.fixtureKey]=o)}return this.data.aabbNeedsUpdate=!0,this.shapeChanged(),r},addFixture:function(e){var t=[];if(e.circle){var n=new p2.Circle({radius:this.world.pxm(e.circle.radius)});n.collisionGroup=e.filter.categoryBits,n.collisionMask=e.filter.maskBits,n.sensor=e.isSensor;var r=p2.vec2.create();r[0]=this.world.pxmi(e.circle.position[0]-this.sprite.width/2),r[1]=this.world.pxmi(e.circle.position[1]-this.sprite.height/2),this.data.addShape(n,r),t.push(n)}else for(var i=e.polygons,s=p2.vec2.create(),o=0;o<i.length;o++){for(var u=i[o],a=[],f=0;f<u.length;f+=2)a.push([this.world.pxmi(u[f]),this.world.pxmi(u[f+1])]);for(var n=new p2.Convex({vertices:a}),l=0;l!==n.vertices.length;l++){var c=n.vertices[l];p2.vec2.sub(c,c,n.centerOfMass)}p2.vec2.scale(s,n.centerOfMass,1),s[0]-=this.world.pxmi(this.sprite.width/2),s[1]-=this.world.pxmi(this.sprite.height/2),n.updateTriangles(),n.updateCenterOfMass(),n.updateBoundingRadius(),n.collisionGroup=e.filter.categoryBits,n.collisionMask=e.filter.maskBits,n.sensor=e.isSensor,this.data.addShape(n,s),t.push(n)}return t},loadPolygon:function(e,t){if(null===e)var n=t;else var n=this.game.cache.getPhysicsData(e,t);for(var r=p2.vec2.create(),i=0;i<n.length;i++){for(var s=[],o=0;o<n[i].shape.length;o+=2)s.push([this.world.pxmi(n[i].shape[o]),this.world.pxmi(n[i].shape[o+1])]);for(var u=new p2.Convex({vertices:s}),a=0;a!==u.vertices.length;a++){var f=u.vertices[a];p2.vec2.sub(f,f,u.centerOfMass)}p2.vec2.scale(r,u.centerOfMass,1),r[0]-=this.world.pxmi(this.sprite.width/2),r[1]-=this.world.pxmi(this.sprite.height/2),u.updateTriangles(),u.updateCenterOfMass(),u.updateBoundingRadius(),this.data.addShape(u,r)}return this.data.aabbNeedsUpdate=!0,this.shapeChanged(),!0}},n.Physics.P2.Body.prototype.constructor=n.Physics.P2.Body,n.Physics.P2.Body.DYNAMIC=1,n.Physics.P2.Body.STATIC=2,n.Physics.P2.Body.KINEMATIC=4,Object.defineProperty(n.Physics.P2.Body.prototype,"static",{get:function(){return this.data.type===n.Physics.P2.Body.STATIC},set:function(e){e&&this.data.type!==n.Physics.P2.Body.STATIC?(this.data.type=n.Physics.P2.Body.STATIC,this.mass=0):e||this.data.type!==n.Physics.P2.Body.STATIC||(this.data.type=n.Physics.P2.Body.DYNAMIC,this.mass=1)}}),Object.defineProperty(n.Physics.P2.Body.prototype,"dynamic",{get:function(){return this.data.type===n.Physics.P2.Body.DYNAMIC},set:function(e){e&&this.data.type!==n.Physics.P2.Body.DYNAMIC?(this.data.type=n.Physics.P2.Body.DYNAMIC,this.mass=1):e||this.data.type!==n.Physics.P2.Body.DYNAMIC||(this.data.type=n.Physics.P2.Body.STATIC,this.mass=0)}}),Object.defineProperty(n.Physics.P2.Body.prototype,"kinematic",{get:function(){return this.data.type===n.Physics.P2.Body.KINEMATIC},set:function(e){e&&this.data.type!==n.Physics.P2.Body.KINEMATIC?(this.data.type=n.Physics.P2.Body.KINEMATIC,this.mass=4):e||this.data.type!==n.Physics.P2.Body.KINEMATIC||(this.data.type=n.Physics.P2.Body.STATIC,this.mass=0)}}),Object.defineProperty(n.Physics.P2.Body.prototype,"allowSleep",{get:function(){return this.data.allowSleep},set:function(e){e!==this.data.allowSleep&&(this.data.allowSleep=e)}}),Object.defineProperty(n.Physics.P2.Body.prototype,"angle",{get:function(){return n.Math.wrapAngle(n.Math.radToDeg(this.data.angle))},set:function(e){this.data.angle=n.Math.degToRad(n.Math.wrapAngle(e))}}),Object.defineProperty(n.Physics.P2.Body.prototype,"angularDamping",{get:function(){return this.data.angularDamping},set:function(e){this.data.angularDamping=e}}),Object.defineProperty(n.Physics.P2.Body.prototype,"angularForce",{get:function(){return this.data.angularForce},set:function(e){this.data.angularForce=e}}),Object.defineProperty(n.Physics.P2.Body.prototype,"angularVelocity",{get:function(){return this.data.angularVelocity},set:function(e){this.data.angularVelocity=e}}),Object.defineProperty(n.Physics.P2.Body.prototype,"damping",{get:function(){return this.data.damping},set:function(e){this.data.damping=e}}),Object.defineProperty(n.Physics.P2.Body.prototype,"fixedRotation",{get:function(){return this.data.fixedRotation},set:function(e){e!==this.data.fixedRotation&&(this.data.fixedRotation=e)}}),Object.defineProperty(n.Physics.P2.Body.prototype,"inertia",{get:function(){return this.data.inertia},set:function(e){this.data.inertia=e}}),Object.defineProperty(n.Physics.P2.Body.prototype,"mass",{get:function(){return this.data.mass},set:function(e){e!==this.data.mass&&(this.data.mass=e,this.data.updateMassProperties())}}),Object.defineProperty(n.Physics.P2.Body.prototype,"motionState",{get:function(){return this.data.type},set:function(e){e!==this.data.type&&(this.data.type=e)}}),Object.defineProperty(n.Physics.P2.Body.prototype,"rotation",{get:function(){return this.data.angle},set:function(e){this.data.angle=e}}),Object.defineProperty(n.Physics.P2.Body.prototype,"sleepSpeedLimit",{get:function(){return this.data.sleepSpeedLimit},set:function(e){this.data.sleepSpeedLimit=e}}),Object.defineProperty(n.Physics.P2.Body.prototype,"x",{get:function(){return this.world.mpxi(this.data.position[0])},set:function(e){this.data.position[0]=this.world.pxmi(e)}}),Object.defineProperty(n.Physics.P2.Body.prototype,"y",{get:function(){return this.world.mpxi(this.data.position[1])},set:function(e){this.data.position[1]=this.world.pxmi(e)}}),Object.defineProperty(n.Physics.P2.Body.prototype,"id",{get:function(){return this.data.id}}),Object.defineProperty(n.Physics.P2.Body.prototype,"debug",{get:function(){return null!==this.debugBody},set:function(e){e&&!this.debugBody?this.debugBody=new n.Physics.P2.BodyDebug(this.game,this.data):!e&&this.debugBody&&(this.debugBody.destroy(),this.debugBody=null)}}),Object.defineProperty(n.Physics.P2.Body.prototype,"collideWorldBounds",{get:function(){return this._collideWorldBounds},set:function(e){e&&!this._collideWorldBounds?(this._collideWorldBounds=!0,this.updateCollisionMask()):!e&&this._collideWorldBounds&&(this._collideWorldBounds=!1,this.updateCollisionMask())}}),n.Physics.P2.BodyDebug=function(e,t,r){n.Group.call(this,e);var i={pixelsPerLengthUnit:e.physics.p2.mpx(1),debugPolygons:!1,lineWidth:1,alpha:.5};this.settings=n.Utils.extend(i,r),this.ppu=this.settings.pixelsPerLengthUnit,this.ppu=-1*this.ppu,this.body=t,this.canvas=new n.Graphics(e),this.canvas.alpha=this.settings.alpha,this.add(this.canvas),this.draw(),this.updateSpriteTransform()},n.Physics.P2.BodyDebug.prototype=Object.create(n.Group.prototype),n.Physics.P2.BodyDebug.prototype.constructor=n.Physics.P2.BodyDebug,n.Utils.extend(n.Physics.P2.BodyDebug.prototype,{updateSpriteTransform:function(){this.position.x=this.body.position[0]*this.ppu,this.position.y=this.body.position[1]*this.ppu,this.rotation=this.body.angle},draw:function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d;if(u=this.body,f=this.canvas,f.clear(),n=parseInt(this.randomPastelHex(),16),s=16711680,o=this.lineWidth,u instanceof p2.Body&&u.shapes.length){var v=u.shapes.length;for(r=0;r!==v;){if(t=u.shapes[r],a=t.position||0,e=t.angle||0,t instanceof p2.Circle)this.drawCircle(f,a[0]*this.ppu,a[1]*this.ppu,e,t.radius*this.ppu,n,o);else if(t instanceof p2.Capsule)this.drawCapsule(f,a[0]*this.ppu,a[1]*this.ppu,e,t.length*this.ppu,t.radius*this.ppu,s,n,o);else if(t instanceof p2.Plane)this.drawPlane(f,a[0]*this.ppu,-a[1]*this.ppu,n,s,5*o,10*o,10*o,100*this.ppu,e);else if(t instanceof p2.Line)this.drawLine(f,t.length*this.ppu,s,o);else if(t instanceof p2.Box)this.drawRectangle(f,a[0]*this.ppu,a[1]*this.ppu,e,t.width*this.ppu,t.height*this.ppu,s,n,o);else if(t instanceof p2.Convex){for(c=[],h=p2.vec2.create(),i=p=0,d=t.vertices.length;d>=0?d>p:p>d;i=d>=0?++p:--p)l=t.vertices[i],p2.vec2.rotate(h,l,e),c.push([(h[0]+a[0])*this.ppu,-(h[1]+a[1])*this.ppu]);this.drawConvex(f,c,t.triangles,s,n,o,this.settings.debugPolygons,[a[0]*this.ppu,-a[1]*this.ppu])}r++}}},drawRectangle:function(e,t,n,r,i,s,o,u,a){void 0===a&&(a=1),void 0===o&&(o=0),e.lineStyle(a,o,1),e.beginFill(u),e.drawRect(t-i/2,n-s/2,i,s)},drawCircle:function(e,t,n,r,i,s,o){void 0===o&&(o=1),void 0===s&&(s=16777215),e.lineStyle(o,0,1),e.beginFill(s,1),e.drawCircle(t,n,2*-i),e.endFill(),e.moveTo(t,n),e.lineTo(t+i*Math.cos(-r),n+i*Math.sin(-r))},drawLine:function(e,t,n,r){void 0===r&&(r=1),void 0===n&&(n=0),e.lineStyle(5*r,n,1),e.moveTo(-t/2,0),e.lineTo(t/2,0)},drawConvex:function(e,t,n,r,i,s,o,u){var a,f,l,c,h,p,d,v,m,g,y;if(void 0===s&&(s=1),void 0===r&&(r=0),o){for(a=[16711680,65280,255],f=0;f!==t.length+1;)c=t[f%t.length],h=t[(f+1)%t.length],d=c[0],g=c[1],v=h[0],y=h[1],e.lineStyle(s,a[f%a.length],1),e.moveTo(d,-g),e.lineTo(v,-y),e.drawCircle(d,-g,2*s),f++;return e.lineStyle(s,0,1),e.drawCircle(u[0],u[1],2*s)}for(e.lineStyle(s,r,1),e.beginFill(i),f=0;f!==t.length;)l=t[f],p=l[0],m=l[1],0===f?e.moveTo(p,-m):e.lineTo(p,-m),f++;return e.endFill(),t.length>2?(e.moveTo(t[t.length-1][0],-t[t.length-1][1]),e.lineTo(t[0][0],-t[0][1])):void 0},drawPath:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m,g;for(void 0===i&&(i=1),void 0===n&&(n=0),e.lineStyle(i,n,1),"number"==typeof r&&e.beginFill(r),u=null,a=null,o=0;o<t.length;)v=t[o],m=v[0],g=v[1],(m!==u||g!==a)&&(0===o?e.moveTo(m,g):(f=u,l=a,c=m,h=g,p=t[(o+1)%t.length][0],d=t[(o+1)%t.length][1],s=(c-f)*(d-l)-(p-f)*(h-l),0!==s&&e.lineTo(m,g)),u=m,a=g),o++;"number"==typeof r&&e.endFill(),t.length>2&&"number"==typeof r&&(e.moveTo(t[t.length-1][0],t[t.length-1][1]),e.lineTo(t[0][0],t[0][1]))},drawPlane:function(e,t,n,r,i,s,o,u,a,f){var l,c,h;void 0===s&&(s=1),void 0===r&&(r=16777215),e.lineStyle(s,i,11),e.beginFill(r),l=a,e.moveTo(t,-n),c=t+Math.cos(f)*this.game.width,h=n+Math.sin(f)*this.game.height,e.lineTo(c,-h),e.moveTo(t,-n),c=t+Math.cos(f)*-this.game.width,h=n+Math.sin(f)*-this.game.height,e.lineTo(c,-h)},drawCapsule:function(e,t,n,r,i,s,o,u,a){void 0===a&&(a=1),void 0===o&&(o=0),e.lineStyle(a,o,1);var f=Math.cos(r),l=Math.sin(r);e.beginFill(u,1),e.drawCircle(-i/2*f+t,-i/2*l+n,2*-s),e.drawCircle(i/2*f+t,i/2*l+n,2*-s),e.endFill(),e.lineStyle(a,o,0),e.beginFill(u,1),e.moveTo(-i/2*f+s*l+t,-i/2*l+s*f+n),e.lineTo(i/2*f+s*l+t,i/2*l+s*f+n),e.lineTo(i/2*f-s*l+t,i/2*l-s*f+n),e.lineTo(-i/2*f-s*l+t,-i/2*l-s*f+n),e.endFill(),e.lineStyle(a,o,1),e.moveTo(-i/2*f+s*l+t,-i/2*l+s*f+n),e.lineTo(i/2*f+s*l+t,i/2*l+s*f+n),e.moveTo(-i/2*f-s*l+t,-i/2*l-s*f+n),e.lineTo(i/2*f-s*l+t,i/2*l-s*f+n)},randomPastelHex:function(){var e,t,n,r;return n=[255,255,255],r=Math.floor(256*Math.random()),t=Math.floor(256*Math.random()),e=Math.floor(256*Math.random()),r=Math.floor((r+3*n[0])/4),t=Math.floor((t+3*n[1])/4),e=Math.floor((e+3*n[2])/4),this.rgbToHex(r,t,e)},rgbToHex:function(e,t,n){return this.componentToHex(e)+this.componentToHex(t)+this.componentToHex(n)},componentToHex:function(e){var t;return t=e.toString(16),2===t.length?t:t+"0"}}),n.Physics.P2.Spring=function(e,t,n,r,i,s,o,u,a,f){this.game=e.game,this.world=e,void 0===r&&(r=1),void 0===i&&(i=100),void 0===s&&(s=1),r=e.pxm(r);var l={restLength:r,stiffness:i,damping:s};"undefined"!=typeof o&&null!==o&&(l.worldAnchorA=[e.pxm(o[0]),e.pxm(o[1])]),"undefined"!=typeof u&&null!==u&&(l.worldAnchorB=[e.pxm(u[0]),e.pxm(u[1])]),"undefined"!=typeof a&&null!==a&&(l.localAnchorA=[e.pxm(a[0]),e.pxm(a[1])]),"undefined"!=typeof f&&null!==f&&(l.localAnchorB=[e.pxm(f[0]),e.pxm(f[1])]),this.data=new p2.LinearSpring(t,n,l),this.data.parent=this},n.Physics.P2.Spring.prototype.constructor=n.Physics.P2.Spring,n.Physics.P2.RotationalSpring=function(e,t,n,r,i,s){this.game=e.game,this.world=e,void 0===r&&(r=null),void 0===i&&(i=100),void 0===s&&(s=1),r&&(r=e.pxm(r));var o={restAngle:r,stiffness:i,damping:s};this.data=new p2.RotationalSpring(t,n,o),this.data.parent=this},n.Physics.P2.Spring.prototype.constructor=n.Physics.P2.Spring,n.Physics.P2.Material=function(e){this.name=e,p2.Material.call(this)},n.Physics.P2.Material.prototype=Object.create(p2.Material.prototype),n.Physics.P2.Material.prototype.constructor=n.Physics.P2.Material,n.Physics.P2.ContactMaterial=function(e,t,n){p2.ContactMaterial.call(this,e,t,n)},n.Physics.P2.ContactMaterial.prototype=Object.create(p2.ContactMaterial.prototype),n.Physics.P2.ContactMaterial.prototype.constructor=n.Physics.P2.ContactMaterial,n.Physics.P2.CollisionGroup=function(e){this.mask=e},n.Physics.P2.DistanceConstraint=function(e,t,n,r,i,s,o){void 0===r&&(r=100),void 0===i&&(i=[0,0]),void 0===s&&(s=[0,0]),void 0===o&&(o=Number.MAX_VALUE),this.game=e.game,this.world=e,r=e.pxm(r),i=[e.pxmi(i[0]),e.pxmi(i[1])],s=[e.pxmi(s[0]),e.pxmi(s[1])];var u={distance:r,localAnchorA:i,localAnchorB:s,maxForce:o};p2.DistanceConstraint.call(this,t,n,u)},n.Physics.P2.DistanceConstraint.prototype=Object.create(p2.DistanceConstraint.prototype),n.Physics.P2.DistanceConstraint.prototype.constructor=n.Physics.P2.DistanceConstraint,n.Physics.P2.GearConstraint=function(e,t,n,r,i){void 0===r&&(r=0),void 0===i&&(i=1),this.game=e.game,this.world=e;var s={angle:r,ratio:i};p2.GearConstraint.call(this,t,n,s)},n.Physics.P2.GearConstraint.prototype=Object.create(p2.GearConstraint.prototype),n.Physics.P2.GearConstraint.prototype.constructor=n.Physics.P2.GearConstraint,n.Physics.P2.LockConstraint=function(e,t,n,r,i,s){void 0===r&&(r=[0,0]),void 0===i&&(i=0),void 0===s&&(s=Number.MAX_VALUE),this.game=e.game,this.world=e,r=[e.pxm(r[0]),e.pxm(r[1])];var o={localOffsetB:r,localAngleB:i,maxForce:s};p2.LockConstraint.call(this,t,n,o)},n.Physics.P2.LockConstraint.prototype=Object.create(p2.LockConstraint.prototype),n.Physics.P2.LockConstraint.prototype.constructor=n.Physics.P2.LockConstraint,n.Physics.P2.PrismaticConstraint=function(e,t,n,r,i,s,o,u){void 0===r&&(r=!0),void 0===i&&(i=[0,0]),void 0===s&&(s=[0,0]),void 0===o&&(o=[0,0]),void 0===u&&(u=Number.MAX_VALUE),this.game=e.game,this.world=e,i=[e.pxmi(i[0]),e.pxmi(i[1])],s=[e.pxmi(s[0]),e.pxmi(s[1])];var a={localAnchorA:i,localAnchorB:s,localAxisA:o,maxForce:u,disableRotationalLock:!r};p2.PrismaticConstraint.call(this,t,n,a)},n.Physics.P2.PrismaticConstraint.prototype=Object.create(p2.PrismaticConstraint.prototype),n.Physics.P2.PrismaticConstraint.prototype.constructor=n.Physics.P2.PrismaticConstraint,n.Physics.P2.RevoluteConstraint=function(e,t,n,r,i,s,o){void 0===s&&(s=Number.MAX_VALUE),void 0===o&&(o=null),this.game=e.game,this.world=e,n=[e.pxmi(n[0]),e.pxmi(n[1])],i=[e.pxmi(i[0]),e.pxmi(i[1])],o&&(o=[e.pxmi(o[0]),e.pxmi(o[1])]);var u={worldPivot:o,localPivotA:n,localPivotB:i,maxForce:s};p2.RevoluteConstraint.call(this,t,r,u)},n.Physics.P2.RevoluteConstraint.prototype=Object.create(p2.RevoluteConstraint.prototype),n.Physics.P2.RevoluteConstraint.prototype.constructor=n.Physics.P2.RevoluteConstraint,n.ImageCollection=function(e,t,n,r,i,s,o){(void 0===n||0>=n)&&(n=32),(void 0===r||0>=r)&&(r=32),void 0===i&&(i=0),void 0===s&&(s=0),this.name=e,this.firstgid=0|t,this.imageWidth=0|n,this.imageHeight=0|r,this.imageMargin=0|i,this.imageSpacing=0|s,this.properties=o||{},this.images=[],this.total=0},n.ImageCollection.prototype={containsImageIndex:function(e){return e>=this.firstgid&&e<this.firstgid+this.total},addImage:function(e,t){this.images.push({gid:e,image:t}),this.total++}},n.ImageCollection.prototype.constructor=n.ImageCollection,n.Tile=function(e,t,n,r,i,s){this.layer=e,this.index=t,this.x=n,this.y=r,this.rotation=0,this.flipped=!1,this.worldX=n*i,this.worldY=r*s,this.width=i,this.height=s,this.centerX=Math.abs(i/2),this.centerY=Math.abs(s/2),this.alpha=1,this.properties={},this.scanned=!1,this.faceTop=!1,this.faceBottom=!1,this.faceLeft=!1,this.faceRight=!1,this.collideLeft=!1,this.collideRight=!1,this.collideUp=!1,this.collideDown=!1,this.collisionCallback=null,this.collisionCallbackContext=this},n.Tile.prototype={containsPoint:function(e,t){return!(e<this.worldX||t<this.worldY||e>this.right||t>this.bottom)},intersects:function(e,t,n,r){return n<=this.worldX?!1:r<=this.worldY?!1:e>=this.worldX+this.width?!1:t>=this.worldY+this.height?!1:!0},setCollisionCallback:function(e,t){this.collisionCallback=e,this.collisionCallbackContext=t},destroy:function(){this.collisionCallback=null,this.collisionCallbackContext=null,this.properties=null},setCollision:function(e,t,n,r){this.collideLeft=e,this.collideRight=t,this.collideUp=n,this.collideDown=r,this.faceLeft=e,this.faceRight=t,this.faceTop=n,this.faceBottom=r},resetCollision:function(){this.collideLeft=!1,this.collideRight=!1,this.collideUp=!1,this.collideDown=!1,this.faceTop=!1,this.faceBottom=!1,this.faceLeft=!1,this.faceRight=!1},isInteresting:function(e,t){return e&&t?this.collideLeft||this.collideRight||this.collideUp||this.collideDown||this.faceTop||this.faceBottom||this.faceLeft||this.faceRight||this.collisionCallback:e?this.collideLeft||this.collideRight||this.collideUp||this.collideDown:t?this.faceTop||this.faceBottom||this.faceLeft||this.faceRight:!1},copy:function(e){this.index=e.index,this.alpha=e.alpha,this.properties=e.properties,this.collideUp=e.collideUp,this.collideDown=e.collideDown,this.collideLeft=e.collideLeft,this.collideRight=e.collideRight,this.collisionCallback=e.collisionCallback,this.collisionCallbackContext=e.collisionCallbackContext}},n.Tile.prototype.constructor=n.Tile,Object.defineProperty(n.Tile.prototype,"collides",{get:function(){return this.collideLeft||this.collideRight||this.collideUp||this.collideDown}}),Object.defineProperty(n.Tile.prototype,"canCollide",{get:function(){return this.collideLeft||this.collideRight||this.collideUp||this.collideDown||this.collisionCallback}}),Object.defineProperty(n.Tile.prototype,"left",{get:function(){return this.worldX}}),Object.defineProperty(n.Tile.prototype,"right",{get:function(){return this.worldX+this.width}}),Object.defineProperty(n.Tile.prototype,"top",{get:function(){return this.worldY}}),Object.defineProperty(n.Tile.prototype,"bottom",{get:function(){return this.worldY+this.height}}),n.Tilemap=function(e,t,r,i,s,o){this.game=e,this.key=t;var u=n.TilemapParser.parse(this.game,t,r,i,s,o);null!==u&&(this.width=u.width,this.height=u.height,this.tileWidth=u.tileWidth,this.tileHeight=u.tileHeight,this.orientation=u.orientation,this.format=u.format,this.version=u.version,this.properties=u.properties,this.widthInPixels=u.widthInPixels,this.heightInPixels=u.heightInPixels,this.layers=u.layers,this.tilesets=u.tilesets,this.imagecollections=u.imagecollections,this.tiles=u.tiles,this.objects=u.objects,this.collideIndexes=[],this.collision=u.collision,this.images=u.images,this.currentLayer=0,this.debugMap=[],this._results=[],this._tempA=0,this._tempB=0)},n.Tilemap.CSV=0,n.Tilemap.TILED_JSON=1,n.Tilemap.NORTH=0,n.Tilemap.EAST=1,n.Tilemap.SOUTH=2,n.Tilemap.WEST=3,n.Tilemap.prototype={create:function(e,t,n,r,i,s){return void 0===s&&(s=this.game.world),this.width=t,this.height=n,this.setTileSize(r,i),this.layers.length=0,this.createBlankLayer(e,t,n,r,i,s)},setTileSize:function(e,t){this.tileWidth=e,this.tileHeight=t,this.widthInPixels=this.width*e,this.heightInPixels=this.height*t},addTilesetImage:function(e,t,r,i,s,o,u){if(void 0===e)return null;void 0===r&&(r=this.tileWidth),void 0===i&&(i=this.tileHeight),void 0===s&&(s=0),void 0===o&&(o=0),void 0===u&&(u=0),0===r&&(r=32),0===i&&(i=32);var a=null;if((void 0===t||null===t)&&(t=e),t instanceof n.BitmapData)a=t.canvas;else{if(!this.game.cache.checkImageKey(t))return console.warn('Phaser.Tilemap.addTilesetImage: Invalid image key given: "'+t+'"'),null;a=this.game.cache.getImage(t)}var f=this.getTilesetIndex(e);if(null===f&&this.format===n.Tilemap.TILED_JSON)return console.warn('Phaser.Tilemap.addTilesetImage: No data found in the JSON matching the tileset name: "'+e+'"'),null;if(this.tilesets[f])return this.tilesets[f].setImage(a),this.tilesets[f];var l=new n.Tileset(e,u,r,i,s,o,{});l.setImage(a),this.tilesets.push(l);for(var c=this.tilesets.length-1,h=s,p=s,d=0,v=0,m=0,g=u;g<u+l.total&&(this.tiles[g]=[h,p,c],h+=r+o,d++,d!==l.total)&&(v++,v!==l.columns||(h=s,p+=i+o,v=0,m++,m!==l.rows));g++);return l},createFromObjects:function(e,t,r,i,s,o,u,a,f){if(void 0===s&&(s=!0),void 0===o&&(o=!1),void 0===u&&(u=this.game.world),void 0===a&&(a=n.Sprite),void 0===f&&(f=!0),!this.objects[e])return void console.warn("Tilemap.createFromObjects: Invalid objectgroup name given: "+e);for(var l=0;l<this.objects[e].length;l++){var c=!1,h=this.objects[e][l];if(void 0!==h.gid&&"number"==typeof t&&h.gid===t?c=!0:void 0!==h.id&&"number"==typeof t&&h.id===t?c=!0:void 0!==h.name&&"string"==typeof t&&h.name===t&&(c=!0),c){var p=new a(this.game,parseFloat(h.x,10),parseFloat(h.y,10),r,i);p.name=h.name,p.visible=h.visible,p.autoCull=o,p.exists=s,h.width&&(p.width=h.width),h.height&&(p.height=h.height),h.rotation&&(p.angle=h.rotation),f&&(p.y-=p.height),u.add(p);for(var d in h.properties)u.set(p,d,h.properties[d],!1,!1,0,!0)}}},createFromTiles:function(e,t,r,i,s,o){"number"==typeof e&&(e=[e]),void 0===t||null===t?t=[]:"number"==typeof t&&(t=[t]),i=this.getLayer(i),void 0===s&&(s=this.game.world),void 0===o&&(o={}),void 0===o.customClass&&(o.customClass=n.Sprite),void 0===o.adjustY&&(o.adjustY=!0);var u=this.layers[i].width,a=this.layers[i].height;if(this.copy(0,0,u,a,i),this._results.length<2)return 0;for(var f,l=0,c=1,h=this._results.length;h>c;c++)if(-1!==e.indexOf(this._results[c].index)){f=new o.customClass(this.game,this._results[c].worldX,this._results[c].worldY,r);for(var p in o)f[p]=o[p];s.add(f),l++}if(1===t.length)for(c=0;c<e.length;c++)this.replace(e[c],t[0],0,0,u,a,i);else if(t.length>1)for(c=0;c<e.length;c++)this.replace(e[c],t[c],0,0,u,a,i);return l},createLayer:function(e,t,r,i,s){void 0===t&&(t=this.game.width),void 0===r&&(r=this.game.height),void 0===i&&(i=this.game.world);var o=e;return"string"==typeof e&&(o=this.getLayerIndex(e)),null===o||o>this.layers.length?void console.warn("Tilemap.createLayer: Invalid layer ID given: "+o):s?i.add(new n.TilemapLayerGL(this.game,this,o,t,r)):i.add(new n.TilemapLayer(this.game,this,o,t,r))},createBlankLayer:function(e,t,r,i,s,o){if(void 0===o&&(o=this.game.world),null!==this.getLayerIndex(e))return void console.warn("Tilemap.createBlankLayer: Layer with matching name already exists");for(var u,a={name:e,x:0,y:0,width:t,height:r,widthInPixels:t*i,heightInPixels:r*s,alpha:1,visible:!0,properties:{},indexes:[],callbacks:[],bodies:[],data:null},f=[],l=0;r>l;l++){u=[];for(var c=0;t>c;c++)u.push(new n.Tile(a,-1,c,l,i,s));f.push(u)}a.data=f,this.layers.push(a),this.currentLayer=this.layers.length-1;var h=a.widthInPixels,p=a.heightInPixels;h>this.game.width&&(h=this.game.width),p>this.game.height&&(p=this.game.height);var f=new n.TilemapLayer(this.game,this,this.layers.length-1,h,p);return f.name=e,o.add(f)},getIndex:function(e,t){for(var n=0;n<e.length;n++)if(e[n].name===t)return n;return null},getLayerIndex:function(e){return this.getIndex(this.layers,e)},getTilesetIndex:function(e){return this.getIndex(this.tilesets,e)},getImageIndex:function(e){return this.getIndex(this.images,e)},setTileIndexCallback:function(e,t,n,r){if(r=this.getLayer(r),"number"==typeof e)this.layers[r].callbacks[e]={callback:t,callbackContext:n};else for(var i=0,s=e.length;s>i;i++)this.layers[r].callbacks[e[i]]={callback:t,callbackContext:n}},setTileLocationCallback:function(e,t,n,r,i,s,o){if(o=this.getLayer(o),this.copy(e,t,n,r,o),!(this._results.length<2))for(var u=1;u<this._results.length;u++)this._results[u].setCollisionCallback(i,s)},setCollision:function(e,t,n,r){if(void 0===t&&(t=!0),void 0===r&&(r=!0),n=this.getLayer(n),"number"==typeof e)return this.setCollisionByIndex(e,t,n,!0);if(Array.isArray(e)){for(var i=0;i<e.length;i++)this.setCollisionByIndex(e[i],t,n,!1);r&&this.calculateFaces(n)}},setCollisionBetween:function(e,t,n,r,i){if(void 0===n&&(n=!0),void 0===i&&(i=!0),r=this.getLayer(r),!(e>t)){for(var s=e;t>=s;s++)this.setCollisionByIndex(s,n,r,!1);i&&this.calculateFaces(r)}},setCollisionByExclusion:function(e,t,n,r){void 0===t&&(t=!0),void 0===r&&(r=!0),n=this.getLayer(n);for(var i=0,s=this.tiles.length;s>i;i++)-1===e.indexOf(i)&&this.setCollisionByIndex(i,t,n,!1);r&&this.calculateFaces(n)},setCollisionByIndex:function(e,t,n,r){if(void 0===t&&(t=!0),void 0===n&&(n=this.currentLayer),void 0===r&&(r=!0),t)this.collideIndexes.push(e);else{var i=this.collideIndexes.indexOf(e);i>-1&&this.collideIndexes.splice(i,1)}for(var s=0;s<this.layers[n].height;s++)for(var o=0;o<this.layers[n].width;o++){var u=this.layers[n].data[s][o];u&&u.index===e&&(t?u.setCollision(!0,!0,!0,!0):u.resetCollision(),u.faceTop=t,u.faceBottom=t,u.faceLeft=t,u.faceRight=t)}return r&&this.calculateFaces(n),n},getLayer:function(e){return void 0===e?e=this.currentLayer:"string"==typeof e?e=this.getLayerIndex(e):e instanceof n.TilemapLayer&&(e=e.index),e},setPreventRecalculate:function(e){if(e===!0&&this.preventingRecalculate!==!0&&(this.preventingRecalculate=!0,this.needToRecalculate={}),e===!1&&this.preventingRecalculate===!0){this.preventingRecalculate=!1;for(var t in this.needToRecalculate)this.calculateFaces(t);this.needToRecalculate=!1}},calculateFaces:function(e){if(this.preventingRecalculate)return void (this.needToRecalculate[e]=!0);for(var t=null,n=null,r=null,i=null,s=0,o=this.layers[e].height;o>s;s++)for(var u=0,a=this.layers[e].width;a>u;u++){var f=this.layers[e].data[s][u];f&&(t=this.getTileAbove(e,u,s),n=this.getTileBelow(e,u,s),r=this.getTileLeft(e,u,s),i=this.getTileRight(e,u,s),f.collides&&(f.faceTop=!0,f.faceBottom=!0,f.faceLeft=!0,f.faceRight=!0),t&&t.collides&&(f.faceTop=!1),n&&n.collides&&(f.faceBottom=!1),r&&r.collides&&(f.faceLeft=!1),i&&i.collides&&(f.faceRight=!1))}},getTileAbove:function(e,t,n){return n>0?this.layers[e].data[n-1][t]:null},getTileBelow:function(e,t,n){return n<this.layers[e].height-1?this.layers[e].data[n+1][t]:null},getTileLeft:function(e,t,n){return t>0?this.layers[e].data[n][t-1]:null},getTileRight:function(e,t,n){return t<this.layers[e].width-1?this.layers[e].data[n][t+1]:null},setLayer:function(e){e=this.getLayer(e),this.layers[e]&&(this.currentLayer=e)},hasTile:function(e,t,n){return n=this.getLayer(n),void 0===this.layers[n].data[t]||void 0===this.layers[n].data[t][e]?!1:this.layers[n].data[t][e].index>-1},removeTile:function(e,t,r){if(r=this.getLayer(r),e>=0&&e<this.layers[r].width&&t>=0&&t<this.layers[r].height&&this.hasTile(e,t,r)){var i=this.layers[r].data[t][e];return this.layers[r].data[t][e]=new n.Tile(this.layers[r],-1,e,t,this.tileWidth,this.tileHeight),this.layers[r].dirty=!0,this.calculateFaces(r),i}},removeTileWorldXY:function(e,t,n,r,i){return i=this.getLayer(i),e=this.game.math.snapToFloor(e,n)/n,t=this.game.math.snapToFloor(t,r)/r,this.removeTile(e,t,i)},putTile:function(e,t,r,i){if(null===e)return this.removeTile(t,r,i);if(i=this.getLayer(i),t>=0&&t<this.layers[i].width&&r>=0&&r<this.layers[i].height){var s;return e instanceof n.Tile?(s=e.index,this.hasTile(t,r,i)?this.layers[i].data[r][t].copy(e):this.layers[i].data[r][t]=new n.Tile(i,s,t,r,e.width,e.height)):(s=e,this.hasTile(t,r,i)?this.layers[i].data[r][t].index=s:this.layers[i].data[r][t]=new n.Tile(this.layers[i],s,t,r,this.tileWidth,this.tileHeight)),this.collideIndexes.indexOf(s)>-1?this.layers[i].data[r][t].setCollision(!0,!0,!0,!0):this.layers[i].data[r][t].resetCollision(),this.layers[i].dirty=!0,this.calculateFaces(i),this.layers[i].data[r][t]}return null},putTileWorldXY:function(e,t,n,r,i,s){return s=this.getLayer(s),t=this.game.math.snapToFloor(t,r)/r,n=this.game.math.snapToFloor(n,i)/i,this.putTile(e,t,n,s)},searchTileIndex:function(e,t,n,r){void 0===t&&(t=0),void 0===n&&(n=!1),r=this.getLayer(r);var i=0;if(n){for(var s=this.layers[r].height-1;s>=0;s--)for(var o=this.layers[r].width-1;o>=0;o--)if(this.layers[r].data[s][o].index===e){if(i===t)return this.layers[r].data[s][o];i++}}else for(var s=0;s<this.layers[r].height;s++)for(var o=0;o<this.layers[r].width;o++)if(this.layers[r].data[s][o].index===e){if(i===t)return this.layers[r].data[s][o];i++}return null},getTile:function(e,t,n,r){return void 0===r&&(r=!1),n=this.getLayer(n),e>=0&&e<this.layers[n].width&&t>=0&&t<this.layers[n].height?-1===this.layers[n].data[t][e].index?r?this.layers[n].data[t][e]:null:this.layers[n].data[t][e]:null},getTileWorldXY:function(e,t,n,r,i,s){return void 0===n&&(n=this.tileWidth),void 0===r&&(r=this.tileHeight),i=this.getLayer(i),e=this.game.math.snapToFloor(e,n)/n,t=this.game.math.snapToFloor(t,r)/r,this.getTile(e,t,i,s)},copy:function(e,t,n,r,i){if(i=this.getLayer(i),!this.layers[i])return void (this._results.length=0);void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=this.layers[i].width),void 0===r&&(r=this.layers[i].height),0>e&&(e=0),0>t&&(t=0),n>this.layers[i].width&&(n=this.layers[i].width),r>this.layers[i].height&&(r=this.layers[i].height),this._results.length=0,this._results.push({x:e,y:t,width:n,height:r,layer:i});for(var s=t;t+r>s;s++)for(var o=e;e+n>o;o++)this._results.push(this.layers[i].data[s][o]);return this._results},paste:function(e,t,n,r){if(void 0===e&&(e=0),void 0===t&&(t=0),r=this.getLayer(r),n&&!(n.length<2)){for(var i=e-n[1].x,s=t-n[1].y,o=1;o<n.length;o++)this.layers[r].data[s+n[o].y][i+n[o].x].copy(n[o]);this.layers[r].dirty=!0,this.calculateFaces(r)}},swap:function(e,t,n,r,i,s,o){o=this.getLayer(o),this.copy(n,r,i,s,o),this._results.length<2||(this._tempA=e,this._tempB=t,this._results.forEach(this.swapHandler,this),this.paste(n,r,this._results,o))},swapHandler:function(e){e.index===this._tempA?e.index=this._tempB:e.index===this._tempB&&(e.index=this._tempA)},forEach:function(e,t,n,r,i,s,o){o=this.getLayer(o),this.copy(n,r,i,s,o),this._results.length<2||(this._results.forEach(e,t),this.paste(n,r,this._results,o))},replace:function(e,t,n,r,i,s,o){if(o=this.getLayer(o),this.copy(n,r,i,s,o),!(this._results.length<2)){for(var u=1;u<this._results.length;u++)this._results[u].index===e&&(this._results[u].index=t);this.paste(n,r,this._results,o)}},random:function(e,t,n,r,i){if(i=this.getLayer(i),this.copy(e,t,n,r,i),!(this._results.length<2)){for(var s=[],o=1;o<this._results.length;o++)if(this._results[o].index){var u=this._results[o].index;-1===s.indexOf(u)&&s.push(u)}for(var a=1;a<this._results.length;a++)this._results[a].index=this.game.rnd.pick(s);this.paste(e,t,this._results,i)}},shuffle:function(e,t,r,i,s){if(s=this.getLayer(s),this.copy(e,t,r,i,s),!(this._results.length<2)){for(var o=[],u=1;u<this._results.length;u++)this._results[u].index&&o.push(this._results[u].index);n.ArrayUtils.shuffle(o);for(var a=1;a<this._results.length;a++)this._results[a].index=o[a-1];this.paste(e,t,this._results,s)}},fill:function(e,t,n,r,i,s){if(s=this.getLayer(s),this.copy(t,n,r,i,s),!(this._results.length<2)){for(var o=1;o<this._results.length;o++)this._results[o].index=e;this.paste(t,n,this._results,s)}},removeAllLayers:function(){this.layers.length=0,this.currentLayer=0},dump:function(){for(var e="",t=[""],n=0;n<this.layers[this.currentLayer].height;n++){for(var r=0;r<this.layers[this.currentLayer].width;r++)e+="%c  ",this.layers[this.currentLayer].data[n][r]>1?this.debugMap[this.layers[this.currentLayer].data[n][r]]?t.push("background: "+this.debugMap[this.layers[this.currentLayer].data[n][r]]):t.push("background: #ffffff"):t.push("background: rgb(0, 0, 0)");e+="\n"}t[0]=e,console.log.apply(console,t)},destroy:function(){this.removeAllLayers(),this.data=[],this.game=null}},n.Tilemap.prototype.constructor=n.Tilemap,Object.defineProperty(n.Tilemap.prototype,"layer",{get:function(){return this.layers[this.currentLayer]},set:function(e){e!==this.currentLayer&&this.setLayer(e)}}),n.TilemapLayer=function(e,t,r,i,s){i|=0,s|=0,n.Sprite.call(this,e,0,0),this.map=t,this.index=r,this.layer=t.layers[r],this.canvas=PIXI.CanvasPool.create(this,i,s),this.context=this.canvas.getContext("2d"),this.setTexture(new PIXI.Texture(new PIXI.BaseTexture(this.canvas))),this.type=n.TILEMAPLAYER,this.physicsType=n.TILEMAPLAYER,this.renderSettings={enableScrollDelta:!1,overdrawRatio:.2,copyCanvas:null},this.debug=!1,this.exists=!0,this.debugSettings={missingImageFill:"rgb(255,255,255)",debuggedTileOverfill:"rgba(0,255,0,0.4)",forceFullRedraw:!0,debugAlpha:.5,facingEdgeStroke:"rgba(0,255,0,1)",collidingTileOverfill:"rgba(0,255,0,0.2)"},this.scrollFactorX=1,this.scrollFactorY=1,this.dirty=!0,this.rayStepRate=4,this._wrap=!1,this._mc={scrollX:0,scrollY:0,renderWidth:0,renderHeight:0,tileWidth:t.tileWidth,tileHeight:t.tileHeight,cw:t.tileWidth,ch:t.tileHeight,tilesets:[]},this._scrollX=0,this._scrollY=0,this._results=[],e.device.canvasBitBltShift||(this.renderSettings.copyCanvas=n.TilemapLayer.ensureSharedCopyCanvas()),this.fixedToCamera=!0},n.TilemapLayer.prototype=Object.create(n.Sprite.prototype),n.TilemapLayer.prototype.constructor=n.TilemapLayer,n.TilemapLayer.prototype.preUpdateCore=n.Component.Core.preUpdate,n.TilemapLayer.sharedCopyCanvas=null,n.TilemapLayer.ensureSharedCopyCanvas=function(){return this.sharedCopyCanvas||(this.sharedCopyCanvas=n.Canvas.create(2,2)),this.sharedCopyCanvas},n.TilemapLayer.prototype.preUpdate=function(){return this.preUpdateCore()},n.TilemapLayer.prototype.postUpdate=function(){n.Component.FixedToCamera.postUpdate.call(this);var e=this.game.camera;this.scrollX=e.x*this.scrollFactorX/this.scale.x,this.scrollY=e.y*this.scrollFactorY/this.scale.y,this.render()},n.TilemapLayer.prototype.destroy=function(){PIXI.CanvasPool.remove(this),n.Component.Destroy.prototype.destroy.call(this)},n.TilemapLayer.prototype.resize=function(e,t){this.canvas.width=e,this.canvas.height=t,this.texture.frame.resize(e,t),this.texture.width=e,this.texture.height=t,this.texture.crop.width=e,this.texture.crop.height=t,this.texture.baseTexture.width=e,this.texture.baseTexture.height=t,this.texture.baseTexture.dirty(),this.texture.requiresUpdate=!0,this.texture._updateUvs(),this.dirty=!0},n.TilemapLayer.prototype.resizeWorld=function(){this.game.world.setBounds(0,0,this.layer.widthInPixels*this.scale.x,this.layer.heightInPixels*this.scale.y)},n.TilemapLayer.prototype._fixX=function(e){return 0>e&&(e=0),1===this.scrollFactorX?e:this._scrollX+(e-this._scrollX/this.scrollFactorX)},n.TilemapLayer.prototype._unfixX=function(e){return 1===this.scrollFactorX?e:this._scrollX/this.scrollFactorX+(e-this._scrollX)},n.TilemapLayer.prototype._fixY=function(e){return 0>e&&(e=0),1===this.scrollFactorY?e:this._scrollY+(e-this._scrollY/this.scrollFactorY)},n.TilemapLayer.prototype._unfixY=function(e){return 1===this.scrollFactorY?e:this._scrollY/this.scrollFactorY+(e-this._scrollY)},n.TilemapLayer.prototype.getTileX=function(e){return Math.floor(this._fixX(e)/this._mc.tileWidth)},n.TilemapLayer.prototype.getTileY=function(e){return Math.floor(this._fixY(e)/this._mc.tileHeight)},n.TilemapLayer.prototype.getTileXY=function(e,t,n){return n.x=this.getTileX(e),n.y=this.getTileY(t),n},n.TilemapLayer.prototype.getRayCastTiles=function(e,t,n,r){t||(t=this.rayStepRate),void 0===n&&(n=!1),void 0===r&&(r=!1);var i=this.getTiles(e.x,e.y,e.width,e.height,n,r);if(0===i.length)return[];for(var s=e.coordinatesOnLine(t),o=[],u=0;u<i.length;u++)for(var a=0;a<s.length;a++){var f=i[u],l=s[a];if(f.containsPoint(l[0],l[1])){o.push(f);break}}return o},n.TilemapLayer.prototype.getTiles=function(e,t,n,r,i,s){void 0===i&&(i=!1),void 0===s&&(s=!1);var o=!i&&!s;e=this._fixX(e),t=this._fixY(t);for(var u=Math.floor(e/(this._mc.cw*this.scale.x)),a=Math.floor(t/(this._mc.ch*this.scale.y)),f=Math.ceil((e+n)/(this._mc.cw*this.scale.x))-u,l=Math.ceil((t+r)/(this._mc.ch*this.scale.y))-a;this._results.length;)this._results.pop();for(var c=a;a+l>c;c++)for(var h=u;u+f>h;h++){var p=this.layer.data[c];p&&p[h]&&(o||p[h].isInteresting(i,s))&&this._results.push(p[h])}return this._results.slice()},n.TilemapLayer.prototype.resolveTileset=function(e){var t=this._mc.tilesets;if(2e3>e)for(;t.length<e;)t.push(void 0);var n=this.map.tiles[e]&&this.map.tiles[e][2];if(null!=n){var r=this.map.tilesets[n];if(r&&r.containsTileIndex(e))return t[e]=r}return t[e]=null},n.TilemapLayer.prototype.resetTilesetCache=function(){for(var e=this._mc.tilesets;e.length;)e.pop()},n.TilemapLayer.prototype.setScale=function(e,t){e=e||1,t=t||e;for(var n=0;n<this.layer.data.length;n++)for(var r=this.layer.data[n],i=0;i<r.length;i++){var s=r[i];s.width=this.map.tileWidth*e,s.height=this.map.tileHeight*t,s.worldX=s.x*s.width,s.worldY=s.y*s.height}this.scale.setTo(e,t)},n.TilemapLayer.prototype.shiftCanvas=function(e,t,n){var r=e.canvas,i=r.width-Math.abs(t),s=r.height-Math.abs(n),o=0,u=0,a=t,f=n;0>t&&(o=-t,a=0),0>n&&(u=-n,f=0);var l=this.renderSettings.copyCanvas;if(l){(l.width<i||l.height<s)&&(l.width=i,l.height=s);var c=l.getContext("2d");c.clearRect(0,0,i,s),c.drawImage(r,o,u,i,s,0,0,i,s),e.clearRect(a,f,i,s),e.drawImage(l,0,0,i,s,a,f,i,s)}else e.save(),e.globalCompositeOperation="copy",e.drawImage(r,o,u,i,s,a,f,i,s),e.restore()},n.TilemapLayer.prototype.renderRegion=function(e,t,n,r,i,s){var o=this.context,u=this.layer.width,a=this.layer.height,f=this._mc.tileWidth,l=this._mc.tileHeight,c=this._mc.tilesets,h=NaN;this._wrap||(i>=n&&(n=Math.max(0,n),i=Math.min(u-1,i)),s>=r&&(r=Math.max(0,r),s=Math.min(a-1,s)));var p,d,v,m,g,y,b=n*f-e,w=r*l-t,E=(n+(1<<20)*u)%u,S=(r+(1<<20)*a)%a;for(o.fillStyle=this.tileColor,m=S,y=s-r,d=w;y>=0;m++,y--,d+=l){m>=a&&(m-=a);var x=this.layer.data[m];for(v=E,g=i-n,p=b;g>=0;v++,g--,p+=f){v>=u&&(v-=u);var T=x[v];if(T&&!(T.index<0)){var N=T.index,C=c[N];void 0===C&&(C=this.resolveTileset(N)),T.alpha===h||this.debug||(o.globalAlpha=T.alpha,h=T.alpha),C?T.rotation||T.flipped?(o.save(),o.translate(p+T.centerX,d+T.centerY),o.rotate(T.rotation),T.flipped&&o.scale(-1,1),C.draw(o,-T.centerX,-T.centerY,N),o.restore()):C.draw(o,p,d,N):this.debugSettings.missingImageFill&&(o.fillStyle=this.debugSettings.missingImageFill,o.fillRect(p,d,f,l)),T.debug&&this.debugSettings.debuggedTileOverfill&&(o.fillStyle=this.debugSettings.debuggedTileOverfill,o.fillRect(p,d,f,l))}}}},n.TilemapLayer.prototype.renderDeltaScroll=function(e,t){var n=this._mc.scrollX,r=this._mc.scrollY,i=this.canvas.width,s=this.canvas.height,o=this._mc.tileWidth,u=this._mc.tileHeight,a=0,f=-o,l=0,c=-u;if(0>e?(a=i+e,f=i-1):e>0&&(f=e),0>t?(l=s+t,c=s-1):t>0&&(c=t),this.shiftCanvas(this.context,e,t),a=Math.floor((a+n)/o),f=Math.floor((f+n)/o),l=Math.floor((l+r)/u),c=Math.floor((c+r)/u),f>=a){this.context.clearRect(a*o-n,0,(f-a+1)*o,s);var h=Math.floor((0+r)/u),p=Math.floor((s-1+r)/u);this.renderRegion(n,r,a,h,f,p)}if(c>=l){this.context.clearRect(0,l*u-r,i,(c-l+1)*u);var d=Math.floor((0+n)/o),v=Math.floor((i-1+n)/o);this.renderRegion(n,r,d,l,v,c)}},n.TilemapLayer.prototype.renderFull=function(){var e=this._mc.scrollX,t=this._mc.scrollY,n=this.canvas.width,r=this.canvas.height,i=this._mc.tileWidth,s=this._mc.tileHeight,o=Math.floor(e/i),u=Math.floor((n-1+e)/i),a=Math.floor(t/s),f=Math.floor((r-1+t)/s);this.context.clearRect(0,0,n,r),this.renderRegion(e,t,o,a,u,f)},n.TilemapLayer.prototype.render=function(){var e=!1;if(this.visible){(this.dirty||this.layer.dirty)&&(this.layer.dirty=!1,e=!0);var t=this.canvas.width,n=this.canvas.height,r=0|this._scrollX,i=0|this._scrollY,s=this._mc,o=s.scrollX-r,u=s.scrollY-i;if(e||0!==o||0!==u||s.renderWidth!==t||s.renderHeight!==n)return this.context.save(),s.scrollX=r,s.scrollY=i,(s.renderWidth!==t||s.renderHeight!==n)&&(s.renderWidth=t,s.renderHeight=n),this.debug&&(this.context.globalAlpha=this.debugSettings.debugAlpha,this.debugSettings.forceFullRedraw&&(e=!0)),!e&&this.renderSettings.enableScrollDelta&&Math.abs(o)+Math.abs(u)<Math.min(t,n)?this.renderDeltaScroll(o,u):this.renderFull(),this.debug&&(this.context.globalAlpha=1,this.renderDebug()),this.texture.baseTexture.dirty(),this.dirty=!1,this.context.restore(),!0}},n.TilemapLayer.prototype.renderDebug=function(){var e,t,n,r,i,s,o=this._mc.scrollX,u=this._mc.scrollY,a=this.context,f=this.canvas.width,l=this.canvas.height,c=this.layer.width,h=this.layer.height,p=this._mc.tileWidth,d=this._mc.tileHeight,v=Math.floor(o/p),m=Math.floor((f-1+o)/p),g=Math.floor(u/d),y=Math.floor((l-1+u)/d),b=v*p-o,w=g*d-u,E=(v+(1<<20)*c)%c,S=(g+(1<<20)*h)%h;for(a.strokeStyle=this.debugSettings.facingEdgeStroke,r=S,s=y-g,t=w;s>=0;r++,s--,t+=d){r>=h&&(r-=h);var x=this.layer.data[r];for(n=E,i=m-v,e=b;i>=0;n++,i--,e+=p){n>=c&&(n-=c);var T=x[n];!T||T.index<0||!T.collides||(this.debugSettings.collidingTileOverfill&&(a.fillStyle=this.debugSettings.collidingTileOverfill,a.fillRect(e,t,this._mc.cw,this._mc.ch)),this.debugSettings.facingEdgeStroke&&(a.beginPath(),T.faceTop&&(a.moveTo(e,t),a.lineTo(e+this._mc.cw,t)),T.faceBottom&&(a.moveTo(e,t+this._mc.ch),a.lineTo(e+this._mc.cw,t+this._mc.ch)),T.faceLeft&&(a.moveTo(e,t),a.lineTo(e,t+this._mc.ch)),T.faceRight&&(a.moveTo(e+this._mc.cw,t),a.lineTo(e+this._mc.cw,t+this._mc.ch)),a.stroke()))}}},Object.defineProperty(n.TilemapLayer.prototype,"wrap",{get:function(){return this._wrap},set:function(e){this._wrap=e,this.dirty=!0}}),Object.defineProperty(n.TilemapLayer.prototype,"scrollX",{get:function(){return this._scrollX},set:function(e){this._scrollX=e}}),Object.defineProperty(n.TilemapLayer.prototype,"scrollY",{get:function(){return this._scrollY},set:function(e){this._scrollY=e}}),Object.defineProperty(n.TilemapLayer.prototype,"collisionWidth",{get:function(){return this._mc.cw},set:function(e){this._mc.cw=0|e,this.dirty=!0}}),Object.defineProperty(n.TilemapLayer.prototype,"collisionHeight",{get:function(){return this._mc.ch},set:function(e){this._mc.ch=0|e,this.dirty=!0}}),n.TilemapParser={INSERT_NULL:!1,parse:function(e,t,r,i,s,o){if(void 0===r&&(r=32),void 0===i&&(i=32),void 0===s&&(s=10),void 0===o&&(o=10),void 0===t)return this.getEmptyData();if(null===t)return this.getEmptyData(r,i,s,o);var u=e.cache.getTilemapData(t);if(u){if(u.format===n.Tilemap.CSV)return this.parseCSV(t,u.data,r,i);if(!u.format||u.format===n.Tilemap.TILED_JSON)return this.parseTiledJSON(u.data)}else console.warn("Phaser.TilemapParser.parse - No map data found for key "+t)},parseCSV:function(e,t,r,i){var s=this.getEmptyData();t=t.trim();for(var o=[],u=t.split("\n"),a=u.length,f=0,l=0;l<u.length;l++){o[l]=[];for(var c=u[l].split(","),h=0;h<c.length;h++)o[l][h]=new n.Tile(s.layers[0],parseInt(c[h],10),h,l,r,i);0===f&&(f=c.length)}return s.format=n.Tilemap.CSV,s.name=e,s.width=f,s.height=a,s.tileWidth=r,s.tileHeight=i,s.widthInPixels=f*r,s.heightInPixels=a*i,s.layers[0].width=f,s.layers[0].height=a,s.layers[0].widthInPixels=s.widthInPixels,s.layers[0].heightInPixels=s.heightInPixels,s.layers[0].data=o,s},getEmptyData:function(e,t,n,r){var i={};i.width=0,i.height=0,i.tileWidth=0,i.tileHeight=0,"undefined"!=typeof e&&null!==e&&(i.tileWidth=e),"undefined"!=typeof t&&null!==t&&(i.tileHeight=t),"undefined"!=typeof n&&null!==n&&(i.width=n),"undefined"!=typeof r&&null!==r&&(i.height=r),i.orientation="orthogonal",i.version="1",i.properties={},i.widthInPixels=0,i.heightInPixels=0;var s=[],o={name:"layer",x:0,y:0,width:0,height:0,widthInPixels:0,heightInPixels:0,alpha:1,visible:!0,properties:{},indexes:[],callbacks:[],bodies:[],data:[]};return s.push(o),i.layers=s,i.images=[],i.objects={},i.collision={},i.tilesets=[],i.tiles=[],i},parseTiledJSON:function(e){function t(e,t){var n={};for(var r in t){var i=t[r];"undefined"!=typeof e[i]&&(n[i]=e[i])}return n}if("orthogonal"!==e.orientation)return console.warn("TilemapParser.parseTiledJSON - Only orthogonal map types are supported in this version of Phaser"),null;var r={};r.width=e.width,r.height=e.height,r.tileWidth=e.tilewidth,r.tileHeight=e.tileheight,r.orientation=e.orientation,r.format=n.Tilemap.TILED_JSON,r.version=e.version,r.properties=e.properties,r.widthInPixels=r.width*r.tileWidth,r.heightInPixels=r.height*r.tileHeight;for(var i=[],s=0;s<e.layers.length;s++)if("tilelayer"===e.layers[s].type){var o=e.layers[s];if(!o.compression&&o.encoding&&"base64"===o.encoding){for(var u=window.atob(o.data),a=u.length,f=new Array(a),l=0;a>l;l+=4)f[l/4]=(u.charCodeAt(l)|u.charCodeAt(l+1)<<8|u.charCodeAt(l+2)<<16|u.charCodeAt(l+3)<<24)>>>0;o.data=f,delete o.encoding}else if(o.compression){console.warn("TilemapParser.parseTiledJSON - Layer compression is unsupported, skipping layer '"+o.name+"'");continue}var c={name:o.name,x:o.x,y:o.y,width:o.width,height:o.height,widthInPixels:o.width*e.tilewidth,heightInPixels:o.height*e.tileheight,alpha:o.opacity,visible:o.visible,properties:{},indexes:[],callbacks:[],bodies:[]};o.properties&&(c.properties=o.properties);for(var h,p,d,v,m=0,g=[],y=[],b=0,a=o.data.length;a>b;b++){if(h=0,p=!1,v=o.data[b],v>536870912)switch(d=0,v>2147483648&&(v-=2147483648,d+=4),v>1073741824&&(v-=1073741824,d+=2),v>536870912&&(v-=536870912,d+=1),d){case 5:h=Math.PI/2;break;case 6:h=Math.PI;break;case 3:h=3*Math.PI/2;break;case 4:h=0,p=!0;break;case 7:h=Math.PI/2,p=!0;break;case 2:h=Math.PI,p=!0;break;case 1:h=3*Math.PI/2,p=!0}v>0?(g.push(new n.Tile(c,v,m,y.length,e.tilewidth,e.tileheight)),g[g.length-1].rotation=h,g[g.length-1].flipped=p):n.TilemapParser.INSERT_NULL?g.push(null):g.push(new n.Tile(c,-1,m,y.length,e.tilewidth,e.tileheight)),m++,m===o.width&&(y.push(g),m=0,g=[])}c.data=y,i.push(c)}r.layers=i;for(var w=[],s=0;s<e.layers.length;s++)if("imagelayer"===e.layers[s].type){var E=e.layers[s],S={name:E.name,image:E.image,x:E.x,y:E.y,alpha:E.opacity,visible:E.visible,properties:{}};E.properties&&(S.properties=E.properties),w.push(S)}r.images=w;for(var x=[],T=[],s=0;s<e.tilesets.length;s++){var N=e.tilesets[s];if(N.image){var C=new n.Tileset(N.name,N.firstgid,N.tilewidth,N.tileheight,N.margin,N.spacing,N.properties);N.tileproperties&&(C.tileProperties=N.tileproperties),C.updateTileData(N.imagewidth,N.imageheight),x.push(C)}else{var k=new n.ImageCollection(N.name,N.firstgid,N.tilewidth,N.tileheight,N.margin,N.spacing,N.properties);for(var L in N.tiles){var S=N.tiles[L].image,v=N.firstgid+parseInt(L,10);k.addImage(v,S)}T.push(k)}}r.tilesets=x,r.imagecollections=T;for(var A={},O={},s=0;s<e.layers.length;s++)if("objectgroup"===e.layers[s].type){var M=e.layers[s];A[M.name]=[],O[M.name]=[];for(var _=0,a=M.objects.length;a>_;_++)if(M.objects[_].gid){var D={gid:M.objects[_].gid,name:M.objects[_].name,type:M.objects[_].hasOwnProperty("type")?M.objects[_].type:"",x:M.objects[_].x,y:M.objects[_].y,visible:M.objects[_].visible,properties:M.objects[_].properties};M.objects[_].rotation&&(D.rotation=M.objects[_].rotation),A[M.name].push(D)}else if(M.objects[_].polyline){var D={name:M.objects[_].name,type:M.objects[_].type,x:M.objects[_].x,y:M.objects[_].y,width:M.objects[_].width,height:M.objects[_].height,visible:M.objects[_].visible,properties:M.objects[_].properties};M.objects[_].rotation&&(D.rotation=M.objects[_].rotation),D.polyline=[];for(var P=0;P<M.objects[_].polyline.length;P++)D.polyline.push([M.objects[_].polyline[P].x,M.objects[_].polyline[P].y]);O[M.name].push(D),A[M.name].push(D)}else if(M.objects[_].polygon){var D=t(M.objects[_],["name","type","x","y","visible","rotation","properties"]);D.polygon=[];for(var P=0;P<M.objects[_].polygon.length;P++)D.polygon.push([M.objects[_].polygon[P].x,M.objects[_].polygon[P].y]);A[M.name].push(D)}else if(M.objects[_].ellipse){var D=t(M.objects[_],["name","type","ellipse","x","y","width","height","visible","rotation","properties"]);A[M.name].push(D)}else{var D=t(M.objects[_],["name","type","x","y","width","height","visible","rotation","properties"]);D.rectangle=!0,A[M.name].push(D)}}r.objects=A,r.collision=O,r.tiles=[];for(var s=0;s<r.tilesets.length;s++)for(var N=r.tilesets[s],m=N.tileMargin,H=N.tileMargin,B=0,j=0,F=0,b=N.firstgid;b<N.firstgid+N.total&&(r.tiles[b]=[m,H,s],m+=N.tileWidth+N.tileSpacing,B++,B!==N.total)&&(j++,j!==N.columns||(m=N.tileMargin,H+=N.tileHeight+N.tileSpacing,j=0,F++,F!==N.rows));b++);for(var c,I,q,N,s=0;s<r.layers.length;s++){c=r.layers[s];for(var l=0;l<c.data.length;l++){g=c.data[l];for(var R=0;R<g.length;R++)I=g[R],null===I||I.index<0||(q=r.tiles[I.index][2],N=r.tilesets[q],N.tileProperties&&N.tileProperties[I.index-N.firstgid]&&(I.properties=n.Utils.mixin(N.tileProperties[I.index-N.firstgid],I.properties)))}}return r}},n.Tileset=function(e,t,n,r,i,s,o){(void 0===n||0>=n)&&(n=32),(void 0===r||0>=r)&&(r=32),void 0===i&&(i=0),void 0===s&&(s=0),this.name=e,this.firstgid=0|t,this.tileWidth=0|n,this.tileHeight=0|r,this.tileMargin=0|i,this.tileSpacing=0|s,this.properties=o||{},this.image=null,this.rows=0,this.columns=0,this.total=0,this.drawCoords=[]},n.Tileset.prototype={draw:function(e,t,n,r){var i=r-this.firstgid<<1;i>=0&&i+1<this.drawCoords.length&&e.drawImage(this.image,this.drawCoords[i],this.drawCoords[i+1],this.tileWidth,this.tileHeight,t,n,this.tileWidth,this.tileHeight)},containsTileIndex:function(e){return e>=this.firstgid&&e<this.firstgid+this.total},setImage:function(e){this.image=e,this.updateTileData(e.width,e.height)},setSpacing:function(e,t){this.tileMargin=0|e,this.tileSpacing=0|t,this.image&&this.updateTileData(this.image.width,this.image.height)},updateTileData:function(e,t){var n=(t-2*this.tileMargin+this.tileSpacing)/(this.tileHeight+this.tileSpacing),r=(e-2*this.tileMargin+this.tileSpacing)/(this.tileWidth+this.tileSpacing);(n%1!==0||r%1!==0)&&console.warn("Phaser.Tileset - "+this.name+" image tile area is not an even multiple of tile size"),n=Math.floor(n),r=Math.floor(r),(this.rows&&this.rows!==n||this.columns&&this.columns!==r)&&console.warn("Phaser.Tileset - actual and expected number of tile rows and columns differ"),this.rows=n,this.columns=r,this.total=n*r,this.drawCoords.length=0;for(var i=this.tileMargin,s=this.tileMargin,o=0;o<this.rows;o++){for(var u=0;u<this.columns;u++)this.drawCoords.push(i),this.drawCoords.push(s),i+=this.tileWidth+this.tileSpacing;i=this.tileMargin,s+=this.tileHeight+this.tileSpacing}}},n.Tileset.prototype.constructor=n.Tileset,n.Particle=function(e,t,r,i,s){n.Sprite.call(this,e,t,r,i,s),this.autoScale=!1,this.scaleData=null,this._s=0,this.autoAlpha=!1,this.alphaData=null,this._a=0},n.Particle.prototype=Object.create(n.Sprite.prototype),n.Particle.prototype.constructor=n.Particle,n.Particle.prototype.update=function(){this.autoScale&&(this._s--,this._s?this.scale.set(this.scaleData[this._s].x,this.scaleData[this._s].y):this.autoScale=!1),this.autoAlpha&&(this._a--,this._a?this.alpha=this.alphaData[this._a].v:this.autoAlpha=!1)},n.Particle.prototype.onEmit=function(){},n.Particle.prototype.setAlphaData=function(e){this.alphaData=e,this._a=e.length-1,this.alpha=this.alphaData[this._a].v,this.autoAlpha=!0},n.Particle.prototype.setScaleData=function(e){this.scaleData=e,this._s=e.length-1,this.scale.set(this.scaleData[this._s].x,this.scaleData[this._s].y),this.autoScale=!0},n.Particle.prototype.reset=function(e,t,r){return n.Component.Reset.prototype.reset.call(this,e,t,r),this.alpha=1,this.scale.set(1),this.autoScale=!1,this.autoAlpha=!1,this},n.Particles=function(e){this.game=e,this.emitters={},this.ID=0},n.Particles.prototype={add:function(e){return this.emitters[e.name]=e,e},remove:function(e){delete this.emitters[e.name]},update:function(){for(var e in this.emitters)this.emitters[e].exists&&this.emitters[e].update()}},n.Particles.prototype.constructor=n.Particles,n.Particles.Arcade={},n.Particles.Arcade.Emitter=function(e,t,r,i){this.maxParticles=i||50,n.Group.call(this,e),this.name="emitter"+this.game.particles.ID++,this.type=n.EMITTER,this.physicsType=n.GROUP,this.area=new n.Rectangle(t,r,1,1),this.minParticleSpeed=new n.Point(-100,-100),this.maxParticleSpeed=new n.Point(100,100),this.minParticleScale=1,this.maxParticleScale=1,this.scaleData=null,this.minRotation=-360,this.maxRotation=360,this.minParticleAlpha=1,this.maxParticleAlpha=1,this.alphaData=null,this.gravity=100,this.particleClass=n.Particle,this.particleDrag=new n.Point,this.angularDrag=0,this.frequency=100,this.lifespan=2e3,this.bounce=new n.Point,this.on=!1,this.particleAnchor=new n.Point(.5,.5),this.blendMode=n.blendModes.NORMAL,this.emitX=t,this.emitY=r,this.autoScale=!1,this.autoAlpha=!1,this.particleBringToTop=!1,this.particleSendToBack=!1,this._minParticleScale=new n.Point(1,1),this._maxParticleScale=new n.Point(1,1),this._quantity=0,this._timer=0,this._counter=0,this._flowQuantity=0,this._flowTotal=0,this._explode=!0,this._frames=null},n.Particles.Arcade.Emitter.prototype=Object.create(n.Group.prototype),n.Particles.Arcade.Emitter.prototype.constructor=n.Particles.Arcade.Emitter,n.Particles.Arcade.Emitter.prototype.update=function(){if(this.on&&this.game.time.time>=this._timer)if(this._timer=this.game.time.time+this.frequency*this.game.time.slowMotion,0!==this._flowTotal)if(this._flowQuantity>0){for(var e=0;e<this._flowQuantity;e++)if(this.emitParticle()&&(this._counter++,-1!==this._flowTotal&&this._counter>=this._flowTotal)){this.on=!1;break}}else this.emitParticle()&&(this._counter++,-1!==this._flowTotal&&this._counter>=this._flowTotal&&(this.on=!1));else this.emitParticle()&&(this._counter++,this._quantity>0&&this._counter>=this._quantity&&(this.on=!1));for(var e=this.children.length;e--;)this.children[e].exists&&this.children[e].update()},n.Particles.Arcade.Emitter.prototype.makeParticles=function(e,t,n,r,i){void 0===t&&(t=0),void 0===n&&(n=this.maxParticles),void 0===r&&(r=!1),void 0===i&&(i=!1);var s,o=0,u=e,a=t;for(this._frames=t,n>this.maxParticles&&(this.maxParticles=n);n>o;)Array.isArray(e)&&(u=this.game.rnd.pick(e)),Array.isArray(t)&&(a=this.game.rnd.pick(t)),s=new this.particleClass(this.game,0,0,u,a),this.game.physics.arcade.enable(s,!1),r?(s.body.checkCollision.any=!0,s.body.checkCollision.none=!1):s.body.checkCollision.none=!0,s.body.collideWorldBounds=i,s.body.skipQuadTree=!0,s.exists=!1,s.visible=!1,s.anchor.copyFrom(this.particleAnchor),this.add(s),o++;return this},n.Particles.Arcade.Emitter.prototype.kill=function(){return this.on=!1,this.alive=!1,this.exists=!1,this},n.Particles.Arcade.Emitter.prototype.revive=function(){return this.alive=!0,this.exists=!0,this},n.Particles.Arcade.Emitter.prototype.explode=function(e,t){return this._flowTotal=0,this.start(!0,e,0,t,!1),this},n.Particles.Arcade.Emitter.prototype.flow=function(e,t,n,r,i){return(void 0===n||0===n)&&(n=1),void 0===r&&(r=-1),void 0===i&&(i=!0),n>this.maxParticles&&(n=this.maxParticles),this._counter=0,this._flowQuantity=n,this._flowTotal=r,i?(this.start(!0,e,t,n),this._counter+=n,this.on=!0,this._timer=this.game.time.time+t*this.game.time.slowMotion):this.start(!1,e,t,n),this},n.Particles.Arcade.Emitter.prototype.start=function(e,t,n,r,i){if(void 0===e&&(e=!0),void 0===t&&(t=0),(void 0===n||null===n)&&(n=250),void 0===r&&(r=0),void 0===i&&(i=!1),r>this.maxParticles&&(r=this.maxParticles),this.revive(),this.visible=!0,this.lifespan=t,this.frequency=n,e||i)for(var s=0;r>s;s++)this.emitParticle();else this.on=!0,this._quantity=r,this._counter=0,this._timer=this.game.time.time+n*this.game.time.slowMotion;return this},n.Particles.Arcade.Emitter.prototype.emitParticle=function(e,t,n,r){void 0===e&&(e=null),void 0===t&&(t=null);var i=this.getFirstExists(!1);if(null===i)return!1;var s=this.game.rnd;void 0!==n&&void 0!==r?i.loadTexture(n,r):void 0!==n&&i.loadTexture(n);var o=this.emitX,u=this.emitY;null!==e?o=e:this.width>1&&(o=s.between(this.left,this.right)),null!==t?u=t:this.height>1&&(u=s.between(this.top,this.bottom)),i.reset(o,u),i.angle=0,i.lifespan=this.lifespan,this.particleBringToTop?this.bringToTop(i):this.particleSendToBack&&this.sendToBack(i),this.autoScale?i.setScaleData(this.scaleData):1!==this.minParticleScale||1!==this.maxParticleScale?i.scale.set(s.realInRange(this.minParticleScale,this.maxParticleScale)):(this._minParticleScale.x!==this._maxParticleScale.x||this._minParticleScale.y!==this._maxParticleScale.y)&&i.scale.set(s.realInRange(this._minParticleScale.x,this._maxParticleScale.x),s.realInRange(this._minParticleScale.y,this._maxParticleScale.y)),void 0===r&&(Array.isArray(this._frames)?i.frame=this.game.rnd.pick(this._frames):i.frame=this._frames),this.autoAlpha?i.setAlphaData(this.alphaData):i.alpha=s.realInRange(this.minParticleAlpha,this.maxParticleAlpha),i.blendMode=this.blendMode;var a=i.body;return a.updateBounds(),a.bounce.copyFrom(this.bounce),a.drag.copyFrom(this.particleDrag),a.velocity.x=s.between(this.minParticleSpeed.x,this.maxParticleSpeed.x),a.velocity.y=s.between(this.minParticleSpeed.y,this.maxParticleSpeed.y),a.angularVelocity=s.between(this.minRotation,this.maxRotation),a.gravity.y=this.gravity,a.angularDrag=this.angularDrag,i.onEmit(),!0},n.Particles.Arcade.Emitter.prototype.destroy=function(){this.game.particles.remove(this),n.Group.prototype.destroy.call(this,!0,!1)},n.Particles.Arcade.Emitter.prototype.setSize=function(e,t){return this.area.width=e,this.area.height=t,this},n.Particles.Arcade.Emitter.prototype.setXSpeed=function(e,t){return e=e||0,t=t||0,this.minParticleSpeed.x=e,this.maxParticleSpeed.x=t,this},n.Particles.Arcade.Emitter.prototype.setYSpeed=function(e,t){return e=e||0,t=t||0,this.minParticleSpeed.y=e,this.maxParticleSpeed.y=t,this},n.Particles.Arcade.Emitter.prototype.setRotation=function(e,t){return e=e||0,t=t||0,this.minRotation=e,this.maxRotation=t,this},n.Particles.Arcade.Emitter.prototype.setAlpha=function(e,t,r,i,s){if(void 0===e&&(e=1),void 0===t&&(t=1),void 0===r&&(r=0),void 0===i&&(i=n.Easing.Linear.None),void 0===s&&(s=!1),this.minParticleAlpha=e,this.maxParticleAlpha=t,this.autoAlpha=!1,r>0&&e!==t){var o={v:e},u=this.game.make.tween(o).to({v:t},r,i);u.yoyo(s),this.alphaData=u.generateData(60),this.alphaData.reverse(),this.autoAlpha=!0}return this},n.Particles.Arcade.Emitter.prototype.setScale=function(e,t,r,i,s,o,u){if(void 0===e&&(e=1),void 0===t&&(t=1),void 0===r&&(r=1),void 0===i&&(i=1),void 0===s&&(s=0),void 0===o&&(o=n.Easing.Linear.None),void 0===u&&(u=!1),this.minParticleScale=1,this.maxParticleScale=1,this._minParticleScale.set(e,r),this._maxParticleScale.set(t,i),this.autoScale=!1,s>0&&(e!==t||r!==i)){var a={x:e,y:r},f=this.game.make.tween(a).to({x:t,y:i},s,o);f.yoyo(u),this.scaleData=f.generateData(60),this.scaleData.reverse(),this.autoScale=!0}return this},n.Particles.Arcade.Emitter.prototype.at=function(e){return e.center?(this.emitX=e.center.x,this.emitY=e.center.y):(this.emitX=e.world.x+e.anchor.x*e.width,this.emitY=e.world.y+e.anchor.y*e.height),this},Object.defineProperty(n.Particles.Arcade.Emitter.prototype,"width",{get:function(){return this.area.width},set:function(e){this.area.width=e}}),Object.defineProperty(n.Particles.Arcade.Emitter.prototype,"height",{get:function(){return this.area.height},set:function(e){this.area.height=e}}),Object.defineProperty(n.Particles.Arcade.Emitter.prototype,"x",{get:function(){return this.emitX},set:function(e){this.emitX=e}}),Object.defineProperty(n.Particles.Arcade.Emitter.prototype,"y",{get:function(){return this.emitY},set:function(e){this.emitY=e}}),Object.defineProperty(n.Particles.Arcade.Emitter.prototype,"left",{get:function(){return Math.floor(this.x-this.area.width/2)}}),Object.defineProperty(n.Particles.Arcade.Emitter.prototype,"right",{get:function(){return Math.floor(this.x+this.area.width/2)}}),Object.defineProperty(n.Particles.Arcade.Emitter.prototype,"top",{get:function(){return Math.floor(this.y-this.area.height/2)}}),Object.defineProperty(n.Particles.Arcade.Emitter.prototype,"bottom",{get:function(){return Math.floor(this.y+this.area.height/2)}}),n.Video=function(e,t,r){if(void 0===t&&(t=null),void 0===r&&(r=null),this.game=e,this.key=t,this.width=0,this.height=0,this.type=n.VIDEO,this.disableTextureUpload=!1,this.touchLocked=!1,this.onPlay=new n.Signal,this.onChangeSource=new n.Signal,this.onComplete=new n.Signal,this.onAccess=new n.Signal,this.onError=new n.Signal,this.onTimeout=new n.Signal,this.timeout=15e3,this._timeOutID=null,this.video=null,this.videoStream=null,this.isStreaming=!1,this.retryLimit=20,this.retry=0,this.retryInterval=500,this._retryID=null,this._codeMuted=!1,this._muted=!1,this._codePaused=!1,this._paused=!1,this._pending=!1,this._autoplay=!1,this._endCallback=null,this._playCallback=null,t&&this.game.cache.checkVideoKey(t)){var i=this.game.cache.getVideo(t);i.isBlob?this.createVideoFromBlob(i.data):this.video=i.data,this.width=this.video.videoWidth,this.height=this.video.videoHeight}else r&&this.createVideoFromURL(r,!1);this.video&&!r?(this.baseTexture=new PIXI.BaseTexture(this.video),this.baseTexture.forceLoaded(this.width,this.height)):(this.baseTexture=new PIXI.BaseTexture(PIXI.TextureCache.__default.baseTexture.source),this.baseTexture.forceLoaded(this.width,this.height)),this.texture=new PIXI.Texture(this.baseTexture),this.textureFrame=new n.Frame(0,0,0,this.width,this.height,"video"),this.texture.setFrame(this.textureFrame),this.texture.valid=!1,null!==t&&this.video&&(this.texture.valid=this.video.canplay),this.snapshot=null,n.BitmapData&&(this.snapshot=new n.BitmapData(this.game,"",this.width,this.height)),!this.game.device.cocoonJS&&(this.game.device.iOS||this.game.device.android)||window.PhaserGlobal&&window.PhaserGlobal.fakeiOSTouchLock?this.setTouchLock():i&&(i.locked=!1)},n.Video.prototype={connectToMediaStream:function(e,t){return e&&t&&(this.video=e,this.videoStream=t,this.isStreaming=!0,this.baseTexture.source=this.video,this.updateTexture(null,this.video.videoWidth,this.video.videoHeight),this.onAccess.dispatch(this)),this},startMediaStream:function(e,t,n){if(void 0===e&&(e=!1),void 0===t&&(t=null),void 0===n&&(n=null),!this.game.device.getUserMedia)return this.onError.dispatch(this,"No getUserMedia"),!1;null!==this.videoStream&&(this.videoStream.active?this.videoStream.active=!1:this.videoStream.stop()),this.removeVideoElement(),this.video=document.createElement("video"),this.video.setAttribute("autoplay","autoplay"),null!==t&&(this.video.width=t),null!==n&&(this.video.height=n),this._timeOutID=window.setTimeout(this.getUserMediaTimeout.bind(this),this.timeout);try{navigator.getUserMedia({audio:e,video:!0},this.getUserMediaSuccess.bind(this),this.getUserMediaError.bind(this))}catch(r){this.getUserMediaError(r)}return this},getUserMediaTimeout:function(){clearTimeout(this._timeOutID),this.onTimeout.dispatch(this)},getUserMediaError:function(e){clearTimeout(this._timeOutID),this.onError.dispatch(this,e)},getUserMediaSuccess:function(e){clearTimeout(this._timeOutID),this.videoStream=e,void 0!==this.video.mozSrcObject?this.video.mozSrcObject=e:this.video.src=window.URL&&window.URL.createObjectURL(e)||e;var t=this;this.video.onloadeddata=function(){function e(){if(n>0)if(t.video.videoWidth>0){var r=t.video.videoWidth,i=t.video.videoHeight;isNaN(t.video.videoHeight)&&(i=r/(4/3)),t.video.play(),t.isStreaming=!0,t.baseTexture.source=t.video,t.updateTexture(null,r,i),t.onAccess.dispatch(t)}else window.setTimeout(e,500);else console.warn("Unable to connect to video stream. Webcam error?");n--}var n=10;e()}},createVideoFromBlob:function(e){var t=this;return this.video=document.createElement("video"),this.video.controls=!1,this.video.setAttribute("autoplay","autoplay"),this.video.addEventListener("loadeddata",function(e){t.updateTexture(e)},!0),this.video.src=window.URL.createObjectURL(e),this.video.canplay=!0,this},createVideoFromURL:function(e,t){return void 0===t&&(t=!1),this.texture&&(this.texture.valid=!1),this.video=document.createElement("video"),this.video.controls=!1,t&&this.video.setAttribute("autoplay","autoplay"),this.video.src=e,this.video.canplay=!0,this.video.load(),this.retry=this.retryLimit,this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval),this.key=e,this},updateTexture:function(e,t,n){var r=!1;(void 0===t||null===t)&&(t=this.video.videoWidth,r=!0),(void 0===n||null===n)&&(n=this.video.videoHeight),this.width=t,this.height=n,this.baseTexture.source!==this.video&&(this.baseTexture.source=this.video),this.baseTexture.forceLoaded(t,n),this.texture.frame.resize(t,n),this.texture.width=t,this.texture.height=n,this.texture.valid=!0,this.snapshot&&this.snapshot.resize(t,n),r&&null!==this.key&&(this.onChangeSource.dispatch(this,t,n),this._autoplay&&(this.video.play(),this.onPlay.dispatch(this,this.loop,this.playbackRate)))},complete:function(){this.onComplete.dispatch(this)},play:function(e,t){return void 0===e&&(e=!1),void 0===t&&(t=1),this.game.sound.onMute&&(this.game.sound.onMute.add(this.setMute,this),this.game.sound.onUnMute.add(this.unsetMute,this),this.game.sound.mute&&this.setMute()),this.game.onPause.add(this.setPause,this),this.game.onResume.add(this.setResume,this),this._endCallback=this.complete.bind(this),this.video.addEventListener("ended",this._endCallback,!0),e?this.video.loop="loop":this.video.loop="",this.video.playbackRate=t,this.touchLocked?this._pending=!0:(this._pending=!1,null!==this.key&&(4!==this.video.readyState?(this.retry=this.retryLimit,this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval)):(this._playCallback=this.playHandler.bind(this),this.video.addEventListener("playing",this._playCallback,!0))),this.video.play(),this.onPlay.dispatch(this,e,t)),this},playHandler:function(){this.video.removeEventListener("playing",this._playCallback,!0),this.updateTexture()},stop:function(){return this.game.sound.onMute&&(this.game.sound.onMute.remove(this.setMute,this),this.game.sound.onUnMute.remove(this.unsetMute,this)),this.game.onPause.remove(this.setPause,this),this.game.onResume.remove(this.setResume,this),this.isStreaming?(this.video.mozSrcObject?(this.video.mozSrcObject.stop(),this.video.src=null):(this.video.src="",this.videoStream.active?this.videoStream.active=!1:this.videoStream.getTracks?this.videoStream.getTracks().forEach(function(e){e.stop()}):this.videoStream.stop()),this.videoStream=null,this.isStreaming=!1):(this.video.removeEventListener("ended",this._endCallback,!0),this.video.removeEventListener("playing",this._playCallback,!0),this.touchLocked?this._pending=!1:this.video.pause()),this},add:function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)e[t].loadTexture&&e[t].loadTexture(this);else e.loadTexture(this);return this},addToWorld:function(e,t,n,r,i,s){i=i||1,s=s||1;var o=this.game.add.image(e,t,this);return o.anchor.set(n,r),o.scale.set(i,s),o},render:function(){!this.disableTextureUpload&&this.playing&&this.baseTexture.dirty()},setMute:function(){this._muted||(this._muted=!0,this.video.muted=!0)},unsetMute:function(){this._muted&&!this._codeMuted&&(this._muted=!1,this.video.muted=!1)},setPause:function(){this._paused||this.touchLocked||(this._paused=!0,this.video.pause())},setResume:function(){!this._paused||this._codePaused||this.touchLocked||(this._paused=!1,this.video.ended||this.video.play())},changeSource:function(e,t){return void 0===t&&(t=!0),this.texture.valid=!1,this.video.pause(),this.retry=this.retryLimit,this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval),this.video.src=e,this.video.load(),this._autoplay=t,t||(this.paused=!0),this},checkVideoProgress:function(){4===this.video.readyState?this.updateTexture():(this.retry--,this.retry>0?this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval):console.warn("Phaser.Video: Unable to start downloading video in time",this.isStreaming))},setTouchLock:function(){this.game.input.touch.addTouchLockCallback(this.unlock,this),this.touchLocked=!0},unlock:function(){if(this.touchLocked=!1,this.video.play(),this.onPlay.dispatch(this,this.loop,this.playbackRate),this.key){var e=this.game.cache.getVideo(this.key);e&&!e.isBlob&&(e.locked=!1)}return!0},grab:function(e,t,n){return void 0===e&&(e=!1),void 0===t&&(t=1),void 0===n&&(n=null),null===this.snapshot?void console.warn("Video.grab cannot run because Phaser.BitmapData is unavailable"):(e&&this.snapshot.cls(),this.snapshot.copy(this.video,0,0,this.width,this.height,0,0,this.width,this.height,0,0,0,1,1,t,n),this.snapshot)},removeVideoElement:function(){if(this.video){for(this.video.parentNode&&this.video.parentNode.removeChild(this.video);this.video.hasChildNodes();)this.video.removeChild(this.video.firstChild);this.video.removeAttribute("autoplay"),this.video.removeAttribute("src"),this.video=null}},destroy:function(){this.stop(),this.removeVideoElement(),this.touchLocked&&this.game.input.touch.removeTouchLockCallback(this.unlock,this),this._retryID&&window.clearTimeout(this._retryID)}},Object.defineProperty(n.Video.prototype,"currentTime",{get:function(){return this.video?this.video.currentTime:0},set:function(e){this.video.currentTime=e}}),Object.defineProperty(n.Video.prototype,"duration",{get:function(){return this.video?this.video.duration:0}}),Object.defineProperty(n.Video.prototype,"progress",{get:function(){return this.video?this.video.currentTime/this.video.duration:0}}),Object.defineProperty(n.Video.prototype,"mute",{get:function(){return this._muted},set:function(e){if(e=e||null){if(this._muted)return;this._codeMuted=!0,this.setMute()}else{if(!this._muted)return;this._codeMuted=!1,this.unsetMute()}}}),Object.defineProperty(n.Video.prototype,"paused",{get:function(){return this._paused},set:function(e){if(e=e||null,!this.touchLocked)if(e){if(this._paused)return;this._codePaused=!0,this.setPause()}else{if(!this._paused)return;this._codePaused=!1,this.setResume()}}}),Object.defineProperty(n.Video.prototype,"volume",{get:function(){return this.video?this.video.volume:1},set:function(e){0>e?e=0:e>1&&(e=1),this.video&&(this.video.volume=e)}}),Object.defineProperty(n.Video.prototype,"playbackRate",{get:function(){return this.video?this.video.playbackRate:1},set:function(e){this.video&&(this.video.playbackRate=e)}}),Object.defineProperty(n.Video.prototype,"loop",{get:function(){return this.video?this.video.loop:!1},set:function(e){e&&this.video?this.video.loop="loop":this.video&&(this.video.loop="")}}),Object.defineProperty(n.Video.prototype,"playing",{get:function(){return!this.video.paused||!this.video.ended}}),n.Video.prototype.constructor=n.Video,void 0===PIXI.blendModes&&(PIXI.blendModes=n.blendModes),void 0===PIXI.scaleModes&&(PIXI.scaleModes=n.scaleModes),void 0===PIXI.Texture.emptyTexture&&(PIXI.Texture.emptyTexture=new PIXI.Texture(new PIXI.BaseTexture)),void 0===PIXI.DisplayObject._tempMatrix&&(PIXI.DisplayObject._tempMatrix=new PIXI.Matrix),void 0===PIXI.RenderTexture.tempMatrix&&(PIXI.RenderTexture.tempMatrix=new PIXI.Matrix),PIXI.Graphics&&void 0===PIXI.Graphics.POLY&&(PIXI.Graphics.POLY=n.POLYGON,PIXI.Graphics.RECT=n.RECTANGLE,PIXI.Graphics.CIRC=n.CIRCLE,PIXI.Graphics.ELIP=n.ELLIPSE,PIXI.Graphics.RREC=n.ROUNDEDRECTANGLE),PIXI.TextureSilentFail=!0,"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=n),exports.Phaser=n):"undefined"!=typeof define&&define.amd?define("Phaser",function(){return t.Phaser=n}()):t.Phaser=n,n}.call(this),function(){function N(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function C(e,t,n,r){var i=arguments.length,s=3>i?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;0<=u;u--)if(o=e[u])s=(3>i?o(s):3<i?o(t,n,s):o(t,n))||s;return 3<i&&s&&Object.defineProperty(t,n,s),s}function k(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function pt(e,t){if(t instanceof Object){switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&(e[n]=pt(e[n],t[n]));return e}return t}function bt(e,t){return e=new wt(e,t),e.subscribe.bind(e)}function xt(e){if("object"!=typeof e||null===e)return!1;for(var t=s(),n=t.next();!n.done;n=t.next())if(n=n.value,n in e&&"function"==typeof e[n])return!0;return!1}function Tt(){}function Lt(){function e(e){e=e||"[DEFAULT]";var n=t[e];return void 0===n&&At("noApp",{name:e}),n}var t={},n={},r=[],i={initializeApp:function(e,n){void 0===n?n="[DEFAULT]":"string"==typeof n&&""!==n||At("bad-app-name",{name:n+""}),void 0!==t[n]&&At("dupApp",{name:n});var s=new Ct(e,n,i);return t[n]=s,r.forEach(function(e){return e("create",s)}),void 0!=s.INTERNAL&&void 0!=s.INTERNAL.getToken||pt(s,{INTERNAL:{getToken:function(){return Nt.resolve(null)},addAuthTokenListener:function(){},removeAuthTokenListener:function(){}}}),s},app:e,apps:null,Promise:Nt,SDK_VERSION:"0.0.0",INTERNAL:{registerService:function(t,r,s){return n[t]&&At("dupService",{name:t}),n[t]=r,r=function(n){return void 0===n&&(n=e()),n[t]()},void 0!==s&&pt(r,s),i[t]=r},createFirebaseNamespace:Lt,extendNamespace:function(e){pt(i,e)},createSubscribe:bt,ErrorFactory:mt,registerAppHook:function(e){r.push(e)},removeApp:function(e){r.forEach(function(n){return n("delete",t[e])}),delete t[e]},factories:n,Promise:Y,deepExtend:pt}};return Object.defineProperty(i,"apps",{get:function(){return Object.keys(t).map(function(e){return t[e]})}}),e.App=Ct,i}function At(e,t){throw Error(Ot(e,t))}function Ot(e,t){return t=t||{},t={noApp:"No Firebase App '"+t.name+"' has been created - call Firebase App.initializeApp().","bad-app-name":"Illegal App name: '"+t.name+"'.",dupApp:"Firebase App named '"+t.name+"' already exists.",deleted:"Firebase App named '"+t.name+"' already deleted.",dupService:"Firebase Service named '"+t.name+"' already registered."}[e],void 0===t?"Application Error: ("+e+")":t}var e="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global?global:this,t=function(){e.Symbol||(e.Symbol=r),t=function(){}},n=0,r=function(e){return"jscomp_symbol_"+e+n++},i=function(){t(),e.Symbol.iterator||(e.Symbol.iterator=e.Symbol("iterator")),i=function(){}},s=function(){var t=["next","error","complete"];i();if(t[e.Symbol.iterator])return t[e.Symbol.iterator]();var n=0;return{next:function(){return n==t.length?{done:!0}:{done:!1,value:t[n++]}}}},o=function(){return{done:!0,value:void 0}},u=function(e,n){e instanceof String&&(e=String(e));var r=0;t(),i();var s={},u=(s.next=function(){if(r<e.length){var t=r++;return{value:n(t,e[t]),done:!1}}return u.next=o,o()},s[Symbol.iterator]=function(){return u},s);return u},a=function(e,t){!Array.prototype[e]&&Object.defineProperties&&Object.defineProperty&&Object.defineProperty(Array.prototype,e,{configurable:!0,enumerable:!1,writable:!0,value:t})},f=function(e,t){if(null==e)throw new TypeError("The 'this' value for String.prototype."+t+" must not be null or undefined")},l=function(e,t){if(e instanceof RegExp)throw new TypeError("First argument to String.prototype."+t+" must not be a regular expression")},c=function(e){f(this,"repeat");var t=String(this);if(0>e||1342177279<e)throw new RangeError("Invalid count value");e|=0;for(var n="";e;)if(e&1&&(n+=t),e>>>=1)t+=t;return n},h=function(e){f(this,"codePointAt");var t=String(this),n=t.length;e=Number(e)||0;if(0<=e&&e<n){e|=0;var r=t.charCodeAt(e);return 55296>r||56319<r||e+1===n?r:(e=t.charCodeAt(e+1),56320>e||57343<e?r:1024*(r-55296)+e+9216)}},p=function(e,t){return t=void 0===t?0:t,l(e,"includes"),f(this,"includes"),-1!==String(this).indexOf(e,t)},d=function(e,t){t=void 0===t?0:t,l(e,"startsWith"),f(this,"startsWith");var n=String(this);e+="";var r=n.length,i=e.length;t=Math.max(0,Math.min(t|0,n.length));for(var s=0;s<i&&t<r;)if(n[t++]!=e[s++])return!1;return s>=i},v=function(e,t){l(e,"endsWith"),f(this,"endsWith");var n=String(this);e+="",void 0===t&&(t=n.length),t=Math.max(0,Math.min(t|0,n.length));for(var r=e.length;0<r&&0<t;)if(n[--t]!=e[--r])return!1;return 0>=r};String.prototype.endsWith||(String.prototype.endsWith=v),String.prototype.startsWith||(String.prototype.startsWith=d),String.prototype.includes||(String.prototype.includes=p),String.prototype.codePointAt||(String.prototype.codePointAt=h),String.prototype.repeat||(String.prototype.repeat=c),a("values",function(){return u(this,function(e,t){return t})}),a("keys",function(){return u(this,function(e){return e})}),a("entries",function(){return u(this,function(e,t){return[e,t]})});var m=this,g=function(){},y=function(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof Object)return t;var n=Object.prototype.toString.call(e);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof e.length&&"undefined"!=typeof e.splice&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||"undefined"!=typeof e.call&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==t&&"undefined"==typeof e.call)return"object";return t},b=function(e){return"function"==y(e)},w=function(e,t,n){return e.call.apply(e.bind,arguments)},E=function(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}},S=function(e,t,n){return S=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?w:E,S.apply(null,arguments)},x=function(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}},T=function(e,t){function n(){}n.prototype=t.prototype,e.ba=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.aa=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}},L=function(e,t){return function(n,r){t(n,r,e)}},A=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(t){s(t)}}function u(e){try{a(r.throw(e))}catch(t){s(t)}}function a(e){e.done?i(e.value):(new n(function(t){t(e.value)})).then(o,u)}a((r=r.apply(e,t)).next())})},O=function(e){if(Error.captureStackTrace)Error.captureStackTrace(this,O);else{var t=Error().stack;t&&(this.stack=t)}e&&(this.message=String(e))};T(O,Error),O.prototype.name="CustomError";var M=function(e,t){for(var n=e.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")},_=function(e,t){t.unshift(e),O.call(this,M.apply(null,t)),t.shift()};T(_,O),_.prototype.name="AssertionError";var D=function(e,t,n,r){var i="Assertion failed";if(n)var i=i+(": "+n),s=r;else e&&(i+=": "+e,s=t);throw new _(""+i,s||[])},P=function(e,t,n){e||D("",null,t,Array.prototype.slice.call(arguments,2))},H=function(e,t,n){b(e)||D("Expected function but got %s: %s.",[y(e),e],t,Array.prototype.slice.call(arguments,2))},B=function(e,t,n){this.S=n,this.L=e,this.U=t,this.s=0,this.o=null};B.prototype.get=function(){var e;return 0<this.s?(this.s--,e=this.o,this.o=e.next,e.next=null):e=this.L(),e},B.prototype.put=function(e){this.U(e),this.s<this.S&&(this.s++,e.next=this.o,this.o=e)};var j;e:{var F=m.navigator;if(F){var I=F.userAgent;if(I){j=I;break e}}j=""}var q=function(e){m.setTimeout(function(){throw e},0)},R,U=function(){var e=m.MessageChannel;"undefined"==typeof e&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&-1==j.indexOf("Presto")&&(e=function(){var e=document.createElement("IFRAME");e.style.display="none",e.src="",document.documentElement.appendChild(e);var t=e.contentWindow,e=t.document;e.open(),e.write(""),e.close();var n="callImmediate"+Math.random(),r="file:"==t.location.protocol?"*":t.location.protocol+"//"+t.location.host,e=S(function(e){("*"==r||e.origin==r)&&e.data==n&&this.port1.onmessage()},this);t.addEventListener("message",e,!1),this.port1={},this.port2={postMessage:function(){t.postMessage(n,r)}}});if("undefined"!=typeof e&&-1==j.indexOf("Trident")&&-1==j.indexOf("MSIE")){var t=new e,n={},r=n;return t.port1.onmessage=function(){if(void 0!==n.next){n=n.next;var e=n.F;n.F=null,e()}},function(e){r.next={F:e},r=r.next,t.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(e){var t=document.createElement("SCRIPT");t.onreadystatechange=function(){t.onreadystatechange=null,t.parentNode.removeChild(t),t=null,e(),e=null},document.documentElement.appendChild(t)}:function(e){m.setTimeout(e,0)}},z=function(){this.v=this.f=null},W=new B(function(){return new X},function(e){e.reset()},100);z.prototype.add=function(e,t){var n=W.get();n.set(e,t),this.v?this.v.next=n:(P(!this.f),this.f=n),this.v=n},z.prototype.remove=function(){var e=null;return this.f&&(e=this.f,this.f=this.f.next,this.f||(this.v=null),e.next=null),e};var X=function(){this.next=this.scope=this.B=null};X.prototype.set=function(e,t){this.B=e,this.scope=t,this.next=null},X.prototype.reset=function(){this.next=this.scope=this.B=null};var V=function(e,t){$||J(),K||($(),K=!0),Q.add(e,t)},$,J=function(){if(m.Promise&&m.Promise.resolve){var e=m.Promise.resolve(void 0);$=function(){e.then(G)}}else $=function(){var e=G,t;!(t=!b(m.setImmediate))&&(t=m.Window&&m.Window.prototype)&&(t=-1==j.indexOf("Edge")&&m.Window.prototype.setImmediate==m.setImmediate),t?(R||(R=U()),R(e)):m.setImmediate(e)}},K=!1,Q=new z,G=function(){for(var e;e=Q.remove();){try{e.B.call(e.scope)}catch(t){q(t)}W.put(e)}K=!1},Y=function(e,t){this.b=0,this.K=void 0,this.j=this.g=this.u=null,this.m=this.A=!1;if(e!=g)try{var n=this;e.call(t,function(e){st(n,2,e)},function(e){try{throw e instanceof Error?e:Error("Promise rejected.")}catch(t){}st(n,3,e)})}catch(r){st(this,3,r)}},Z=function(){this.next=this.context=this.h=this.c=this.child=null,this.w=!1};Z.prototype.reset=function(){this.context=this.h=this.c=this.child=null,this.w=!1};var et=new B(function(){return new Z},function(e){e.reset()},100),tt=function(e,t,n){var r=et.get();return r.c=e,r.h=t,r.context=n,r},nt=function(e,t,n){ot(e,t,n,null)||V(x(t,e))};Y.prototype.then=function(e,t,n){return null!=e&&H(e,"opt_onFulfilled should be a function."),null!=t&&H(t,"opt_onRejected should be a function. Did you pass opt_context as the second argument instead of the third?"),it(this,b(e)?e:null,b(t)?t:null,n)},Y.prototype.then=Y.prototype.then,Y.prototype.$goog_Thenable=!0,Y.prototype.X=function(e,t){return it(this,null,e,t)};var rt=function(e,t){e.g||2!=e.b&&3!=e.b||at(e),P(null!=t.c),e.j?e.j.next=t:e.g=t,e.j=t},it=function(e,t,n,r){var i=tt(null,null,null);return i.child=new Y(function(e,s){i.c=t?function(n){try{var i=t.call(r,n);e(i)}catch(o){s(o)}}:e,i.h=n?function(t){try{var i=n.call(r,t);e(i)}catch(o){s(o)}}:s}),i.child.u=e,rt(e,i),i.child};Y.prototype.Y=function(e){P(1==this.b),this.b=0,st(this,2,e)},Y.prototype.Z=function(e){P(1==this.b),this.b=0,st(this,3,e)};var st=function(e,t,n){0==e.b&&(e==n&&(t=3,n=new TypeError("Promise cannot resolve to itself")),e.b=1,ot(n,e.Y,e.Z,e)||(e.K=n,e.b=t,e.u=null,at(e),3!=t||ct(e,n)))},ot=function(e,t,n,r){if(e instanceof Y)return null!=t&&H(t,"opt_onFulfilled should be a function."),null!=n&&H(n,"opt_onRejected should be a function. Did you pass opt_context as the second argument instead of the third?"),rt(e,tt(t||g,n||null,r)),!0;var i;if(e)try{i=!!e.$goog_Thenable}catch(s){i=!1}else i=!1;if(i)return e.then(t,n,r),!0;i=typeof e;if("object"==i&&null!=e||"function"==i)try{var o=e.then;if(b(o))return ut(e,o,t,n,r),!0}catch(s){return n.call(r,s),!0}return!1},ut=function(e,t,n,r,i){var s=!1,o=function(e){s||(s=!0,n.call(i,e))},u=function(e){s||(s=!0,r.call(i,e))};try{t.call(e,o,u)}catch(a){u(a)}},at=function(e){e.A||(e.A=!0,V(e.N,e))},ft=function(e){var t=null;return e.g&&(t=e.g,e.g=t.next,t.next=null),e.g||(e.j=null),null!=t&&P(null!=t.c),t};Y.prototype.N=function(){for(var e;e=ft(this);){var t=this.b,n=this.K;if(3==t&&e.h&&!e.w){var r;for(r=this;r&&r.m;r=r.u)r.m=!1}if(e.child)e.child.u=null,lt(e,t,n);else try{e.w?e.c.call(e.context):lt(e,t,n)}catch(i){ht.call(null,i)}et.put(e)}this.A=!1};var lt=function(e,t,n){2==t?e.c.call(e.context,n):e.h&&e.h.call(e.context,n)},ct=function(e,t){e.m=!0,V(function(){e.m&&ht.call(null,t)})},ht=q,dt=Error.captureStackTrace,vt=function(e,t){this.code=e,this.message=t;if(dt)dt(this,mt.prototype.create);else{var n=Error.apply(this,arguments);this.name="FirebaseError",Object.defineProperty(this,"stack",{get:function(){return n.stack}})}};vt.prototype=Object.create(Error.prototype),vt.prototype.constructor=vt,vt.prototype.name="FirebaseError";var mt=function(e,t,n){this.V=e,this.W=t,this.M=n,this.pattern=/\{\$([^}]+)}/g};mt.prototype.create=function(e,t){void 0===t&&(t={});var n=this.M[e],n=void 0===n?"Error":n.replace(this.pattern,function(e,n){return void 0!==t[n]?t[n].toString():"<"+n+"?>"}),n=this.W+": "+n+" ("+this.V+"/"+e+").";e=new vt(e,n);for(var r in t)t.hasOwnProperty(r)&&"_"!==r.slice(-1)&&(e[r]=t[r]);return e},Y.all=function(e){return new Y(function(t,n){var r=e.length,i=[];if(r)for(var s=function(e,n){r--,i[e]=n,0==r&&t(i)},o=function(e){n(e)},u=0,a;u<e.length;u++)a=e[u],nt(a,x(s,u),o);else t(i)})},Y.resolve=function(e){if(e instanceof Y)return e;var t=new Y(g);return st(t,2,e),t},Y.reject=function(e){return new Y(function(t,n){n(e)})},Y.prototype["catch"]=Y.prototype.X;var gt=Y;"undefined"!=typeof Promise&&(gt=Promise);var yt=gt,wt=function(e,t){var n=this;this.a=[],this.J=0,this.task=yt.resolve(),this.l=!1,this.D=t,this.task.then(function(){e(n)}).catch(function(e){n.error(e)})};wt.prototype.next=function(e){Et(this,function(t){t.next(e)})},wt.prototype.error=function(e){Et(this,function(t){t.error(e)}),this.close(e)},wt.prototype.complete=function(){Et(this,function(e){e.complete()}),this.close()},wt.prototype.subscribe=function(e,t,n){var r=this,i;if(void 0===e&&void 0===t&&void 0===n)throw Error("Missing Observer.");return i=xt(e)?e:{next:e,error:t,complete:n},void 0===i.next&&(i.next=Tt),void 0===i.error&&(i.error=Tt),void 0===i.complete&&(i.complete=Tt),e=this.$.bind(this,this.a.length),this.l&&this.task.then(function(){try{r.G?i.error(r.G):i.complete()}catch(e){}}),this.a.push(i),e},wt.prototype.$=function(e){void 0!==this.a&&void 0!==this.a[e]&&(this.a[e]=void 0,--this.J,0===this.J&&void 0!==this.D&&this.D(this))};var Et=function(e,t){if(!e.l)for(var n=0;n<e.a.length;n++)St(e,n,t)},St=function(e,t,n){e.task.then(function(){if(void 0!==e.a&&void 0!==e.a[t])try{n(e.a[t])}catch(r){}})};wt.prototype.close=function(e){var t=this;this.l||(this.l=!0,void 0!==e&&(this.G=e),this.task.then(function(){t.a=void 0,t.D=void 0}))};var Nt=gt,Ct=function(e,t,n){var r=this;this.H=n,this.I=!1,this.i={},this.P={},this.C=t,this.T=pt(void 0,e),Object.keys(n.INTERNAL.factories).forEach(function(e){r[e]=r.R.bind(r,e)})};Ct.prototype.delete=function(){var e=this;return(new Nt(function(t){kt(e),t()})).then(function(){return e.H.INTERNAL.removeApp(e.C),Nt.all(Object.keys(e.i).map(function(t){return e.i[t].INTERNAL.delete()}))}).then(function(){e.I=!0,e.i=null,e.P=null})},Ct.prototype.R=function(e){return kt(this),void 0===this.i[e]&&(this.i[e]=this.H.INTERNAL.factories[e](this,this.O.bind(this))),this.i[e]},Ct.prototype.O=function(e){pt(this,e)};var kt=function(e){e.I&&At(Ot("deleted",{name:e.C}))};Object.defineProperties(Ct.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return kt(this),this.C}},options:{configurable:!0,enumerable:!0,get:function(){return kt(this),this.T}}}),Ct.prototype.name&&Ct.prototype.options||Ct.prototype.delete||console.log("dc"),"undefined"!=typeof window&&(window.firebase=Lt())}(),firebase.SDK_VERSION="3.0.3",function(){var k,aa=aa||{},l=this,ba=function(){},ca=function(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof Object)return t;var n=Object.prototype.toString.call(e);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof e.length&&"undefined"!=typeof e.splice&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||"undefined"!=typeof e.call&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==t&&"undefined"==typeof e.call)return"object";return t},da=function(e){return null===e},ea=function(e){return"array"==ca(e)},fa=function(e){var t=ca(e);return"array"==t||"object"==t&&"number"==typeof e.length},n=function(e){return"string"==typeof e},ga=function(e){return"number"==typeof e},p=function(e){return"function"==ca(e)},ha=function(e){var t=typeof e;return"object"==t&&null!=e||"function"==t},ia=function(e,t,n){return e.call.apply(e.bind,arguments)},ja=function(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}},q=function(e,t,n){return q=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ia:ja,q.apply(null,arguments)},ka=function(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}},la=Date.now||function(){return+(new Date)},r=function(e,t){function n(){}n.prototype=t.prototype,e.yc=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Ae=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}},t=function(e){if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var n=Error().stack;n&&(this.stack=n)}e&&(this.message=String(e))};r(t,Error),t.prototype.name="CustomError";var ma=function(e,t){for(var n=e.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")},na=String.prototype.trim?function(e){return e.trim()}:function(e){return e.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},oa=/&/g,pa=/</g,qa=/>/g,ra=/"/g,sa=/'/g,ta=/\x00/g,ua=/[\x00&<>"']/,u=function(e,t){return-1!=e.indexOf(t)},va=function(e,t){return e<t?-1:e>t?1:0},wa=function(e,n){n.unshift(e),t.call(this,ma.apply(null,n)),n.shift()};r(wa,t),wa.prototype.name="AssertionError";var xa=function(e,t,n,r){var i="Assertion failed";if(n)var i=i+(": "+n),s=r;else e&&(i+=": "+e,s=t);throw new wa(""+i,s||[])},v=function(e,t,n){e||xa("",null,t,Array.prototype.slice.call(arguments,2))},ya=function(e,t){throw new wa("Failure"+(e?": "+e:""),Array.prototype.slice.call(arguments,1))},za=function(e,t,n){return ga(e)||xa("Expected number but got %s: %s.",[ca(e),e],t,Array.prototype.slice.call(arguments,2)),e},Aa=function(e,t,r){return n(e)||xa("Expected string but got %s: %s.",[ca(e),e],t,Array.prototype.slice.call(arguments,2)),e},Ba=function(e,t,n){p(e)||xa("Expected function but got %s: %s.",[ca(e),e],t,Array.prototype.slice.call(arguments,2))},Ca=Array.prototype.indexOf?function(e,t,n){return v(null!=e.length),Array.prototype.indexOf.call(e,t,n)}:function(e,t,r){r=null==r?0:0>r?Math.max(0,e.length+r):r;if(n(e))return n(t)&&1==t.length?e.indexOf(t,r):-1;for(;r<e.length;r++)if(r in e&&e[r]===t)return r;return-1},w=Array.prototype.forEach?function(e,t,n){v(null!=e.length),Array.prototype.forEach.call(e,t,n)}:function(e,t,r){for(var i=e.length,s=n(e)?e.split(""):e,o=0;o<i;o++)o in s&&t.call(r,s[o],o,e)},Da=function(e,t){for(var r=n(e)?e.split(""):e,i=e.length-1;0<=i;--i)i in r&&t.call(void 0,r[i],i,e)},Ea=Array.prototype.map?function(e,t,n){return v(null!=e.length),Array.prototype.map.call(e,t,n)}:function(e,t,r){for(var i=e.length,s=Array(i),o=n(e)?e.split(""):e,u=0;u<i;u++)u in o&&(s[u]=t.call(r,o[u],u,e));return s},Fa=Array.prototype.some?function(e,t,n){return v(null!=e.length),Array.prototype.some.call(e,t,n)}:function(e,t,r){for(var i=e.length,s=n(e)?e.split(""):e,o=0;o<i;o++)if(o in s&&t.call(r,s[o],o,e))return!0;return!1},Ha=function(e){var t;e:{t=Ga;for(var r=e.length,i=n(e)?e.split(""):e,s=0;s<r;s++)if(s in i&&t.call(void 0,i[s],s,e)){t=s;break e}t=-1}return 0>t?null:n(e)?e.charAt(t):e[t]},Ia=function(e,t){return 0<=Ca(e,t)},Ka=function(e,t){var n=Ca(e,t),r;return(r=0<=n)&&Ja(e,n),r},Ja=function(e,t){return v(null!=e.length),1==Array.prototype.splice.call(e,t,1).length},La=function(e,t){var n=0;Da(e,function(r,i){t.call(void 0,r,i,e)&&Ja(e,i)&&n++})},Ma=function(e){return Array.prototype.concat.apply(Array.prototype,arguments)},Na=function(e){return Array.prototype.concat.apply(Array.prototype,arguments)},Oa=function(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]},Pa=function(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(fa(r)){var i=e.length||0,s=r.length||0;e.length=i+s;for(var o=0;o<s;o++)e[i+o]=r[o]}else e.push(r)}},Qa=function(e,t){for(var n in e)t.call(void 0,e[n],n,e)},Ra=function(e){var t=[],n=0,r;for(r in e)t[n++]=e[r];return t},Sa=function(e){var t=[],n=0,r;for(r in e)t[n++]=r;return t},Ta=function(e){return null!==e&&"withCredentials"in e},Ua=function(e){for(var t in e)return!1;return!0},Va=function(e,t){for(var n in e)if(!(n in t)||e[n]!==t[n])return!1;for(n in t)if(!(n in e))return!1;return!0},Ya=function(e){var t={},n;for(n in e)t[n]=e[n];return t},Za="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),$a=function(e,t){for(var n,r,i=1;i<arguments.length;i++){r=arguments[i];for(n in r)e[n]=r[n];for(var s=0;s<Za.length;s++)n=Za[s],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}},ab;e:{var bb=l.navigator;if(bb){var cb=bb.userAgent;if(cb){ab=cb;break e}}ab=""}var x=function(e){return u(ab,e)},db=x("Opera"),y=x("Trident")||x("MSIE"),eb=x("Edge"),fb=eb||y,gb=x("Gecko")&&(!u(ab.toLowerCase(),"webkit")||!!x("Edge"))&&!x("Trident")&&!x("MSIE")&&!x("Edge"),hb=u(ab.toLowerCase(),"webkit")&&!x("Edge"),ib=function(){var e=l.document;return e?e.documentMode:void 0},jb;e:{var kb="",lb=function(){var e=ab;if(gb)return/rv\:([^\);]+)(\)|;)/.exec(e);if(eb)return/Edge\/([\d\.]+)/.exec(e);if(y)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e);if(hb)return/WebKit\/(\S+)/.exec(e);if(db)return/(?:Version)[ \/]?(\S+)/.exec(e)}();lb&&(kb=lb?lb[1]:"");if(y){var mb=ib();if(null!=mb&&mb>parseFloat(kb)){jb=String(mb);break e}}jb=kb}var nb=jb,ob={},z=function(e){var t;if(!(t=ob[e])){t=0;for(var n=na(String(nb)).split("."),r=na(String(e)).split("."),i=Math.max(n.length,r.length),s=0;0==t&&s<i;s++){var o=n[s]||"",u=r[s]||"",a=RegExp("(\\d*)(\\D*)","g"),f=RegExp("(\\d*)(\\D*)","g");do{var l=a.exec(o)||["","",""],c=f.exec(u)||["","",""];if(0==l[0].length&&0==c[0].length)break;t=va(0==l[1].length?0:parseInt(l[1],10),0==c[1].length?0:parseInt(c[1],10))||va(0==l[2].length,0==c[2].length)||va(l[2],c[2])}while(0==t)}t=ob[e]=0<=t}return t},pb=l.document,qb=pb&&y?ib()||("CSS1Compat"==pb.compatMode?parseInt(nb,10):5):void 0,rb=null,sb=null,ub=function(e){var t="";return tb(e,function(e){t+=String.fromCharCode(e)}),t},tb=function(e,t){function n(t){for(;r<e.length;){var n=e.charAt(r++),i=sb[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return t}vb();for(var r=0;;){var i=n(-1),s=n(0),o=n(64),u=n(64);if(64===u&&-1===i)break;t(i<<2|s>>4),64!=o&&(t(s<<4&240|o>>2),64!=u&&t(o<<6&192|u))}},vb=function(){if(!rb){rb={},sb={};for(var e=0;65>e;e++)rb[e]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e),sb[rb[e]]=e,62<=e&&(sb["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(e)]=e)}},xb=function(){this.Pb="",this.wd=wb};xb.prototype.ic=!0,xb.prototype.gc=function(){return this.Pb},xb.prototype.toString=function(){return"Const{"+this.Pb+"}"};var yb=function(e){return e instanceof xb&&e.constructor===xb&&e.wd===wb?e.Pb:(ya("expected object of type Const, got '"+e+"'"),"type_error:Const")},wb={},A=function(){this.aa="",this.vd=zb};A.prototype.ic=!0,A.prototype.gc=function(){return this.aa},A.prototype.toString=function(){return"SafeUrl{"+this.aa+"}"};var Ab=function(e){return e instanceof A&&e.constructor===A&&e.vd===zb?e.aa:(ya("expected object of type SafeUrl, got '"+e+"' of type "+ca(e)),"type_error:SafeUrl")},Bb=/^(?:(?:https?|mailto|ftp):|[^&:/?#]*(?:[/?#]|$))/i,Db=function(e){return e instanceof A?e:(e=e.ic?e.gc():String(e),Bb.test(e)||(e="about:invalid#zClosurez"),Cb(e))},zb={},Cb=function(e){var t=new A;return t.aa=e,t};Cb("about:blank");var Fb=function(){this.aa="",this.ud=Eb};Fb.prototype.ic=!0,Fb.prototype.gc=function(){return this.aa},Fb.prototype.toString=function(){return"SafeHtml{"+this.aa+"}"};var Gb=function(e){return e instanceof Fb&&e.constructor===Fb&&e.ud===Eb?e.aa:(ya("expected object of type SafeHtml, got '"+e+"' of type "+ca(e)),"type_error:SafeHtml")},Eb={};Fb.prototype.Zd=function(e){return this.aa=e,this};var Hb=function(e,t){var n;n=t instanceof A?t:Db(t),e.href=Ab(n)},Ib=function(e){return Ib[" "](e),e};Ib[" "]=ba;var Jb=!y||9<=Number(qb),Kb=y&&!z("9");!hb||z("528"),gb&&z("1.9b")||y&&z("8")||db&&z("9.5")||hb&&z("528"),gb&&!z("8")||y&&z("9");var Lb=function(){this.ra=this.ra,this.Gb=this.Gb};Lb.prototype.ra=!1,Lb.prototype.isDisposed=function(){return this.ra},Lb.prototype.Ga=function(){if(this.Gb)for(;this.Gb.length;)this.Gb.shift()()};var Mb=function(e,t){this.type=e,this.currentTarget=this.target=t,this.defaultPrevented=this.Na=!1,this.gd=!0};Mb.prototype.preventDefault=function(){this.defaultPrevented=!0,this.gd=!1};var Nb=function(e,t){Mb.call(this,e?e.type:""),this.relatedTarget=this.currentTarget=this.target=null,this.charCode=this.keyCode=this.button=this.screenY=this.screenX=this.clientY=this.clientX=this.offsetY=this.offsetX=0,this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.ub=this.state=null,e&&this.init(e,t)};r(Nb,Mb),Nb.prototype.init=function(e,t){var n=this.type=e.type,r=e.changedTouches?e.changedTouches[0]:null;this.target=e.target||e.srcElement,this.currentTarget=t;var i=e.relatedTarget;if(i){if(gb){var s;e:{try{Ib(i.nodeName),s=!0;break e}catch(o){}s=!1}s||(i=null)}}else"mouseover"==n?i=e.fromElement:"mouseout"==n&&(i=e.toElement);this.relatedTarget=i,null===r?(this.offsetX=hb||void 0!==e.offsetX?e.offsetX:e.layerX,this.offsetY=hb||void 0!==e.offsetY?e.offsetY:e.layerY,this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0):(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0),this.button=e.button,this.keyCode=e.keyCode||0,this.charCode=e.charCode||("keypress"==n?e.keyCode:0),this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.state=e.state,this.ub=e,e.defaultPrevented&&this.preventDefault()},Nb.prototype.preventDefault=function(){Nb.yc.preventDefault.call(this);var e=this.ub;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,Kb)try{if(e.ctrlKey||112<=e.keyCode&&123>=e.keyCode)e.keyCode=-1}catch(t){}};var Ob="closure_listenable_"+(1e6*Math.random()|0),Pb=0,Qb=function(e,t,n,r,i){this.listener=e,this.Ib=null,this.src=t,this.type=n,this.rb=!!r,this.zb=i,this.key=++Pb,this.Pa=this.qb=!1},Rb=function(e){e.Pa=!0,e.listener=null,e.Ib=null,e.src=null,e.zb=null},Sb=function(e){this.src=e,this.v={},this.pb=0};Sb.prototype.add=function(e,t,n,r,i){var s=e.toString();e=this.v[s],e||(e=this.v[s]=[],this.pb++);var o=Tb(e,t,r,i);return-1<o?(t=e[o],n||(t.qb=!1)):(t=new Qb(t,this.src,s,!!r,i),t.qb=n,e.push(t)),t},Sb.prototype.remove=function(e,t,n,r){e=e.toString();if(e in this.v){var i=this.v[e];return t=Tb(i,t,n,r),-1<t?(Rb(i[t]),Ja(i,t),0==i.length&&(delete this.v[e],this.pb--),!0):!1}return!1};var Ub=function(e,t){var n=t.type;n in e.v&&Ka(e.v[n],t)&&(Rb(t),0==e.v[n].length&&(delete e.v[n],e.pb--))};Sb.prototype.ec=function(e,t,n,r){e=this.v[e.toString()];var i=-1;return e&&(i=Tb(e,t,n,r)),-1<i?e[i]:null};var Tb=function(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.Pa&&s.listener==t&&s.rb==!!n&&s.zb==r)return i}return-1},Vb="closure_lm_"+(1e6*Math.random()|0),Wb={},Xb=0,Yb=function(e,t,n,r,i){if(ea(t))for(var s=0;s<t.length;s++)Yb(e,t[s],n,r,i);else n=Zb(n),e&&e[Ob]?$b(e,t,n,r,i):ac(e,t,n,!1,r,i)},ac=function(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var o=!!i,u=bc(e);u||(e[Vb]=u=new Sb(e)),n=u.add(t,n,r,i,s);if(!n.Ib){r=cc(),n.Ib=r,r.src=e,r.listener=n;if(e.addEventListener)e.addEventListener(t.toString(),r,o);else{if(!e.attachEvent)throw Error("addEventListener and attachEvent are unavailable.");e.attachEvent(dc(t.toString()),r)}Xb++}},cc=function(){var e=ec,t=Jb?function(n){return e.call(t.src,t.listener,n)}:function(n){n=e.call(t.src,t.listener,n);if(!n)return n};return t},fc=function(e,t,n,r,i){if(ea(t))for(var s=0;s<t.length;s++)fc(e,t[s],n,r,i);else n=Zb(n),e&&e[Ob]?gc(e,t,n,r,i):ac(e,t,n,!0,r,i)},hc=function(e,t,n,r,i){if(ea(t))for(var s=0;s<t.length;s++)hc(e,t[s],n,r,i);else n=Zb(n),e&&e[Ob]?e.O.remove(String(t),n,r,i):e&&(e=bc(e))&&(t=e.ec(t,n,!!r,i))&&ic(t)},ic=function(e){if(!ga(e)&&e&&!e.Pa){var t=e.src;if(t&&t[Ob])Ub(t.O,e);else{var n=e.type,r=e.Ib;t.removeEventListener?t.removeEventListener(n,r,e.rb):t.detachEvent&&t.detachEvent(dc(n),r),Xb--,(n=bc(t))?(Ub(n,e),0==n.pb&&(n.src=null,t[Vb]=null)):Rb(e)}}},dc=function(e){return e in Wb?Wb[e]:Wb[e]="on"+e},kc=function(e,t,n,r){var i=!0;if(e=bc(e))if(t=e.v[t.toString()])for(t=t.concat(),e=0;e<t.length;e++){var s=t[e];s&&s.rb==n&&!s.Pa&&(s=jc(s,r),i=i&&!1!==s)}return i},jc=function(e,t){var n=e.listener,r=e.zb||e.src;return e.qb&&ic(e),n.call(r,t)},ec=function(e,t){if(e.Pa)return!0;if(!Jb){var n;if(!(n=t))e:{n=["window","event"];for(var r=l,i;i=n.shift();){if(null==r[i]){n=null;break e}r=r[i]}n=r}i=n,n=new Nb(i,this),r=!0;if(!(0>i.keyCode||void 0!=i.returnValue)){e:{var s=!1;if(0==i.keyCode)try{i.keyCode=-1;break e}catch(o){s=!0}if(s||void 0==i.returnValue)i.returnValue=!0}i=[];for(s=n.currentTarget;s;s=s.parentNode)i.push(s);for(var s=e.type,u=i.length-1;!n.Na&&0<=u;u--){n.currentTarget=i[u];var a=kc(i[u],s,!0,n),r=r&&a}for(u=0;!n.Na&&u<i.length;u++)n.currentTarget=i[u],a=kc(i[u],s,!1,n),r=r&&a}return r}return jc(e,new Nb(t,this))},bc=function(e){return e=e[Vb],e instanceof Sb?e:null},lc="__closure_events_fn_"+(1e9*Math.random()>>>0),Zb=function(e){return v(e,"Listener can not be null."),p(e)?e:(v(e.handleEvent,"An object listener must have handleEvent method."),e[lc]||(e[lc]=function(t){return e.handleEvent(t)}),e[lc])},mc=/^[+a-zA-Z0-9_.!#$%&'*\/=?^`{|}~-]+@([a-zA-Z0-9-]+\.)+[a-zA-Z0-9]{2,63}$/,nc=function(a){a=String(a);if(/^\s*$/.test(a)?0:/^[\],:{}\s\u2028\u2029]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/(?:"[^"\\\n\r\u2028\u2029\x00-\x08\x0a-\x1f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)[\s\u2028\u2029]*(?=:|,|]|}|$)/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,"")))try{return eval("("+a+")")}catch(b){}throw Error("Invalid JSON string: "+a)},qc=function(e){var t=[];return oc(new pc,e,t),t.join("")},pc=function(){this.Lb=void 0},oc=function(e,t,n){if(null==t)n.push("null");else{if("object"==typeof t){if(ea(t)){var r=t;t=r.length,n.push("[");for(var i="",s=0;s<t;s++)n.push(i),i=r[s],oc(e,e.Lb?e.Lb.call(r,String(s),i):i,n),i=",";n.push("]");return}if(!(t instanceof String||t instanceof Number||t instanceof Boolean)){n.push("{"),s="";for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i=t[r],"function"!=typeof i&&(n.push(s),rc(r,n),n.push(":"),oc(e,e.Lb?e.Lb.call(t,r,i):i,n),s=","));n.push("}");return}t=t.valueOf()}switch(typeof t){case"string":rc(t,n);break;case"number":n.push(isFinite(t)&&!isNaN(t)?String(t):"null");break;case"boolean":n.push(String(t));break;case"function":n.push("null");break;default:throw Error("Unknown type: "+typeof t)}}},sc={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","":"\\u000b"},tc=/\uffff/.test("￿")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g,rc=function(e,t){t.push('"',e.replace(tc,function(e){var t=sc[e];return t||(t="\\u"+(e.charCodeAt(0)|65536).toString(16).substr(1),sc[e]=t),t}),'"')},uc=function(){};uc.prototype.Bc=null;var vc=function(e){return e.Bc||(e.Bc=e.Uc())},wc,xc=function(){};r(xc,uc),xc.prototype.$b=function(){var e=yc(this);return e?new ActiveXObject(e):new XMLHttpRequest},xc.prototype.Uc=function(){var e={};return yc(this)&&(e[0]=!0,e[1]=!0),e};var yc=function(e){if(!e.Qc&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var t=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<t.length;n++){var r=t[n];try{return new ActiveXObject(r),e.Qc=r}catch(i){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return e.Qc};wc=new xc;var zc=function(){};r(zc,uc),zc.prototype.$b=function(){var e=new XMLHttpRequest;if("withCredentials"in e)return e;if("undefined"!=typeof XDomainRequest)return new Ac;throw Error("Unsupported browser")},zc.prototype.Uc=function(){return{}};var Ac=function(){this.fa=new XDomainRequest,this.readyState=0,this.responseText=this.onreadystatechange=null,this.status=-1,this.statusText=this.responseXML=null,this.fa.onload=q(this.Nd,this),this.fa.onerror=q(this.Oc,this),this.fa.onprogress=q(this.Od,this),this.fa.ontimeout=q(this.Pd,this)};k=Ac.prototype,k.open=function(e,t,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.fa.open(e,t)},k.send=function(e){if(e){if("string"!=typeof e)throw Error("Only string data is supported");this.fa.send(e)}else this.fa.send()},k.abort=function(){this.fa.abort()},k.setRequestHeader=function(){},k.Nd=function(){this.status=200,this.responseText=this.fa.responseText,Bc(this,4)},k.Oc=function(){this.status=500,this.responseText=null,Bc(this,4)},k.Pd=function(){this.Oc()},k.Od=function(){this.status=200,Bc(this,1)};var Bc=function(e,t){e.readyState=t,e.onreadystatechange&&e.onreadystatechange()},B=function(e,t){this.h=[],this.g=t;for(var n=!0,r=e.length-1;0<=r;r--){var i=e[r]|0;n&&i==t||(this.h[r]=i,n=!1)}},Cc={},Dc=function(e){if(-128<=e&&128>e){var t=Cc[e];if(t)return t}return t=new B([e|0],0>e?-1:0),-128<=e&&128>e&&(Cc[e]=t),t},E=function(e){if(isNaN(e)||!isFinite(e))return C;if(0>e)return D(E(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new B(t,0)},Ec=function(e,t){if(0==e.length)throw Error("number format error: empty string");var n=t||10;if(2>n||36<n)throw Error("radix out of range: "+n);if("-"==e.charAt(0))return D(Ec(e.substring(1),n));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=E(Math.pow(n,8)),i=C,s=0;s<e.length;s+=8){var o=Math.min(8,e.length-s),u=parseInt(e.substring(s,s+o),n);8>o?(o=E(Math.pow(n,o)),i=i.multiply(o).add(E(u))):(i=i.multiply(r),i=i.add(E(u)))}return i},C=Dc(0),Fc=Dc(1),Gc=Dc(16777216),Hc=function(e){if(-1==e.g)return-Hc(D(e));for(var t=0,n=1,r=0;r<e.h.length;r++)t+=Ic(e,r)*n,n*=4294967296;return t};B.prototype.toString=function(e){e=e||10;if(2>e||36<e)throw Error("radix out of range: "+e);if(F(this))return"0";if(-1==this.g)return"-"+D(this).toString(e);for(var t=E(Math.pow(e,6)),n=this,r="";;){var i=Jc(n,t),n=Kc(n,i.multiply(t)),s=((0<n.h.length?n.h[0]:n.g)>>>0).toString(e),n=i;if(F(n))return s+r;for(;6>s.length;)s="0"+s;r=""+s+r}};var G=function(e,t){return 0>t?0:t<e.h.length?e.h[t]:e.g},Ic=function(e,t){var n=G(e,t);return 0<=n?n:4294967296+n},F=function(e){if(0!=e.g)return!1;for(var t=0;t<e.h.length;t++)if(0!=e.h[t])return!1;return!0};B.prototype.tb=function(e){if(this.g!=e.g)return!1;for(var t=Math.max(this.h.length,e.h.length),n=0;n<t;n++)if(G(this,n)!=G(e,n))return!1;return!0},B.prototype.compare=function(e){return e=Kc(this,e),-1==e.g?-1:F(e)?0:1};var D=function(e){for(var t=e.h.length,n=[],r=0;r<t;r++)n[r]=~e.h[r];return(new B(n,~e.g)).add(Fc)};B.prototype.add=function(e){for(var t=Math.max(this.h.length,e.h.length),n=[],r=0,i=0;i<=t;i++){var s=r+(G(this,i)&65535)+(G(e,i)&65535),o=(s>>>16)+(G(this,i)>>>16)+(G(e,i)>>>16),r=o>>>16,s=s&65535,o=o&65535;n[i]=o<<16|s}return new B(n,n[n.length-1]&-2147483648?-1:0)};var Kc=function(e,t){return e.add(D(t))};B.prototype.multiply=function(e){if(F(this)||F(e))return C;if(-1==this.g)return-1==e.g?D(this).multiply(D(e)):D(D(this).multiply(e));if(-1==e.g)return D(this.multiply(D(e)));if(0>this.compare(Gc)&&0>e.compare(Gc))return E(Hc(this)*Hc(e));for(var t=this.h.length+e.h.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.h.length;r++)for(var i=0;i<e.h.length;i++){var s=G(this,r)>>>16,o=G(this,r)&65535,u=G(e,i)>>>16,a=G(e,i)&65535;n[2*r+2*i]+=o*a,Lc(n,2*r+2*i),n[2*r+2*i+1]+=s*a,Lc(n,2*r+2*i+1),n[2*r+2*i+1]+=o*u,Lc(n,2*r+2*i+1),n[2*r+2*i+2]+=s*u,Lc(n,2*r+2*i+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new B(n,0)};var Lc=function(e,t){for(;(e[t]&65535)!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535},Jc=function(e,t){if(F(t))throw Error("division by zero");if(F(e))return C;if(-1==e.g)return-1==t.g?Jc(D(e),D(t)):D(Jc(D(e),t));if(-1==t.g)return D(Jc(e,D(t)));if(30<e.h.length){if(-1==e.g||-1==t.g)throw Error("slowDivide_ only works with positive integers.");for(var n=Fc,r=t;0>=r.compare(e);)n=n.shiftLeft(1),r=r.shiftLeft(1);for(var i=Mc(n,1),s=Mc(r,1),o,r=Mc(r,2),n=Mc(n,2);!F(r);)o=s.add(r),0>=o.compare(e)&&(i=i.add(n),s=o),r=Mc(r,1),n=Mc(n,1);return i}n=C;for(r=e;0<=r.compare(t);){i=Math.max(1,Math.floor(Hc(r)/Hc(t))),s=Math.ceil(Math.log(i)/Math.LN2),s=48>=s?1:Math.pow(2,s-48),o=E(i);for(var u=o.multiply(t);-1==u.g||0<u.compare(r);)i-=s,o=E(i),u=o.multiply(t);F(o)&&(o=Fc),n=n.add(o),r=Kc(r,u)}return n},Nc=function(e,t){for(var n=Math.max(e.h.length,t.h.length),r=[],i=0;i<n;i++)r[i]=G(e,i)|G(t,i);return new B(r,e.g|t.g)};B.prototype.shiftLeft=function(e){var t=e>>5;e%=32;for(var n=this.h.length+t+(0<e?1:0),r=[],i=0;i<n;i++)r[i]=0<e?G(this,i-t)<<e|G(this,i-t-1)>>>32-e:G(this,i-t);return new B(r,this.g)};var Mc=function(e,t){for(var n=t>>5,r=t%32,i=e.h.length-n,s=[],o=0;o<i;o++)s[o]=0<r?G(e,o+n)>>>r|G(e,o+n+1)<<32-r:G(e,o+n);return new B(s,e.g)},Oc=function(e,t){this.cb=e,this.ea=t};Oc.prototype.tb=function(e){return this.ea==e.ea&&this.cb.tb(Ya(e.cb))};var Rc=function(e){try{var t;if(t=0==e.lastIndexOf("[",0)){var n=e.length-1;t=0<=n&&e.indexOf("]",n)==n}return t?new Pc(e.substring(1,e.length-1)):new Qc(e)}catch(r){return null}},Qc=function(e){var t=C;if(e instanceof B){if(0!=e.g||0>e.compare(C)||0<e.compare(Sc))throw Error("The address does not look like an IPv4.");t=Ya(e)}else{if(!Tc.test(e))throw Error(e+" does not look like an IPv4 address.");var n=e.split(".");if(4!=n.length)throw Error(e+" does not look like an IPv4 address.");for(var r=0;r<n.length;r++){var i;i=n[r];var s=Number(i);i=0==s&&/^[\s\xa0]*$/.test(i)?NaN:s;if(isNaN(i)||0>i||255<i||1!=n[r].length&&0==n[r].lastIndexOf("0",0))throw Error("In "+e+", octet "+r+" is not valid");i=E(i),t=Nc(t.shiftLeft(8),i)}}Oc.call(this,t,4)};r(Qc,Oc);var Tc=/^[0-9.]*$/,Sc=Kc(Fc.shiftLeft(32),Fc);Qc.prototype.toString=function(){if(this.va)return this.va;for(var e=Ic(this.cb,0),t=[],n=3;0<=n;n--)t[n]=String(e&255),e>>>=8;return this.va=t.join(".")};var Pc=function(e){var t=C;if(e instanceof B){if(0!=e.g||0>e.compare(C)||0<e.compare(Uc))throw Error("The address does not look like a valid IPv6.");t=Ya(e)}else{if(!Vc.test(e))throw Error(e+" is not a valid IPv6 address.");var n=e.split(":");if(-1!=n[n.length-1].indexOf(".")){e=Ic(Ya((new Qc(n[n.length-1])).cb),0);var r=[];r.push((e>>>16&65535).toString(16)),r.push((e&65535).toString(16)),Ja(n,n.length-1),Pa(n,r),e=n.join(":")}r=e.split("::");if(2<r.length||1==r.length&&8!=n.length)throw Error(e+" is not a valid IPv6 address.");if(1<r.length){n=r[0].split(":"),r=r[1].split(":"),1==n.length&&""==n[0]&&(n=[]),1==r.length&&""==r[0]&&(r=[]);var i=8-(n.length+r.length);if(1>i)n=[];else{for(var s=[],o=0;o<i;o++)s[o]="0";n=Na(n,s,r)}}if(8!=n.length)throw Error(e+" is not a valid IPv6 address");for(r=0;r<n.length;r++){i=Ec(n[r],16);if(0>i.compare(C)||0<i.compare(Wc))throw Error(n[r]+" in "+e+" is not a valid hextet.");t=Nc(t.shiftLeft(16),i)}}Oc.call(this,t,6)};r(Pc,Oc);var Vc=/^([a-fA-F0-9]*:){2}[a-fA-F0-9:.]*$/,Wc=Dc(65535),Uc=Kc(Fc.shiftLeft(128),Fc);Pc.prototype.toString=function(){if(this.va)return this.va;for(var e=[],t=3;0<=t;t--){var n=Ic(this.cb,t),r=n&65535;e.push((n>>>16).toString(16)),e.push(r.toString(16))}for(var n=t=-1,i=r=0,s=0;s<e.length;s++)"0"==e[s]?(i++,-1==n&&(n=s),i>r&&(r=i,t=n)):(n=-1,i=0);return 0<r&&(t+r==e.length&&e.push(""),e.splice(t,r,""),0==t&&(e=[""].concat(e))),this.va=e.join(":")},!gb&&!y||y&&9<=Number(qb)||gb&&z("1.9.1"),y&&z("9");var Yc=function(e,t){Qa(t,function(t,n){"style"==n?e.style.cssText=t:"class"==n?e.className=t:"for"==n?e.htmlFor=t:Xc.hasOwnProperty(n)?e.setAttribute(Xc[n],t):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?e.setAttribute(n,t):e[n]=t})},Xc={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"},Zc=function(e,t,n){this.ae=n,this.Cd=e,this.le=t,this.Fb=0,this.Ab=null};Zc.prototype.get=function(){var e;return 0<this.Fb?(this.Fb--,e=this.Ab,this.Ab=e.next,e.next=null):e=this.Cd(),e},Zc.prototype.put=function(e){this.le(e),this.Fb<this.ae&&(this.Fb++,e.next=this.Ab,this.Ab=e)};var $c=function(e){l.setTimeout(function(){throw e},0)},ad,bd=function(){var e=l.MessageChannel;"undefined"==typeof e&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!x("Presto")&&(e=function(){var e=document.createElement("IFRAME");e.style.display="none",e.src="",document.documentElement.appendChild(e);var t=e.contentWindow,e=t.document;e.open(),e.write(""),e.close();var n="callImmediate"+Math.random(),r="file:"==t.location.protocol?"*":t.location.protocol+"//"+t.location.host,e=q(function(e){("*"==r||e.origin==r)&&e.data==n&&this.port1.onmessage()},this);t.addEventListener("message",e,!1),this.port1={},this.port2={postMessage:function(){t.postMessage(n,r)}}});if("undefined"!=typeof e&&!x("Trident")&&!x("MSIE")){var t=new e,n={},r=n;return t.port1.onmessage=function(){if(void 0!==n.next){n=n.next;var e=n.Fc;n.Fc=null,e()}},function(e){r.next={Fc:e},r=r.next,t.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(e){var t=document.createElement("SCRIPT");t.onreadystatechange=function(){t.onreadystatechange=null,t.parentNode.removeChild(t),t=null,e(),e=null},document.documentElement.appendChild(t)}:function(e){l.setTimeout(e,0)}},cd=function(){this.Tb=this.Da=null},ed=new Zc(function(){return new dd},function(e){e.reset()},100);cd.prototype.add=function(e,t){var n=ed.get();n.set(e,t),this.Tb?this.Tb.next=n:(v(!this.Da),this.Da=n),this.Tb=n},cd.prototype.remove=function(){var e=null;return this.Da&&(e=this.Da,this.Da=this.Da.next,this.Da||(this.Tb=null),e.next=null),e};var dd=function(){this.next=this.scope=this.dc=null};dd.prototype.set=function(e,t){this.dc=e,this.scope=t,this.next=null},dd.prototype.reset=function(){this.next=this.scope=this.dc=null};var jd=function(e,t){fd||gd(),hd||(fd(),hd=!0),id.add(e,t)},fd,gd=function(){if(l.Promise&&l.Promise.resolve){var e=l.Promise.resolve(void 0);fd=function(){e.then(kd)}}else fd=function(){var e=kd;!p(l.setImmediate)||l.Window&&l.Window.prototype&&!x("Edge")&&l.Window.prototype.setImmediate==l.setImmediate?(ad||(ad=bd()),ad(e)):l.setImmediate(e)}},hd=!1,id=new cd,kd=function(){for(var e;e=id.remove();){try{e.dc.call(e.scope)}catch(t){$c(t)}ed.put(e)}hd=!1},ld=function(e){e.prototype.then=e.prototype.then,e.prototype.$goog_Thenable=!0},md=function(e){if(!e)return!1;try{return!!e.$goog_Thenable}catch(t){return!1}},H=function(e,t){this.A=0,this.ca=void 0,this.Fa=this.X=this.l=null,this.yb=this.cc=!1;if(e!=ba)try{var n=this;e.call(t,function(e){nd(n,2,e)},function(e){if(!(e instanceof od))try{throw e instanceof Error?e:Error("Promise rejected.")}catch(t){}nd(n,3,e)})}catch(r){nd(this,3,r)}},pd=function(){this.next=this.context=this.La=this.wa=this.child=null,this.Wa=!1};pd.prototype.reset=function(){this.context=this.La=this.wa=this.child=null,this.Wa=!1};var qd=new Zc(function(){return new pd},function(e){e.reset()},100),rd=function(e,t,n){var r=qd.get();return r.wa=e,r.La=t,r.context=n,r},I=function(e){if(e instanceof H)return e;var t=new H(ba);return nd(t,2,e),t},sd=function(e){return new H(function(t,n){n(e)})},ud=function(e,t,n){td(e,t,n,null)||jd(ka(t,e))},vd=function(e){return new H(function(t){var n=e.length,r=[];if(n)for(var i=function(e,i,s){n--,r[e]=i?{Ld:!0,value:s}:{Ld:!1,reason:s},0==n&&t(r)},s=0,o;s<e.length;s++)o=e[s],ud(o,ka(i,s,!0),ka(i,s,!1));else t(r)})};H.prototype.then=function(e,t,n){return null!=e&&Ba(e,"opt_onFulfilled should be a function."),null!=t&&Ba(t,"opt_onRejected should be a function. Did you pass opt_context as the second argument instead of the third?"),wd(this,p(e)?e:null,p(t)?t:null,n)},ld(H);var yd=function(e,t){var n=rd(t,t,void 0);return n.Wa=!0,xd(e,n),e};H.prototype.I=function(e,t){return wd(this,null,e,t)},H.prototype.cancel=function(e){0==this.A&&jd(function(){var t=new od(e);zd(this,t)},this)};var zd=function(e,t){if(0==e.A)if(e.l){var n=e.l;if(n.X){for(var r=0,i=null,s=null,o=n.X;o&&(o.Wa||(r++,o.child==e&&(i=o),!(i&&1<r)));o=o.next)i||(s=o);i&&(0==n.A&&1==r?zd(n,t):(s?(r=s,v(n.X),v(null!=r),r.next==n.Fa&&(n.Fa=r),r.next=r.next.next):Ad(n),Bd(n,i,3,t)))}e.l=null}else nd(e,3,t)},xd=function(e,t){e.X||2!=e.A&&3!=e.A||Cd(e),v(null!=t.wa),e.Fa?e.Fa.next=t:e.X=t,e.Fa=t},wd=function(e,t,n,r){var i=rd(null,null,null);return i.child=new H(function(e,s){i.wa=t?function(n){try{var i=t.call(r,n);e(i)}catch(o){s(o)}}:e,i.La=n?function(t){try{var i=n.call(r,t);void 0===i&&t instanceof od?s(t):e(i)}catch(o){s(o)}}:s}),i.child.l=e,xd(e,i),i.child};H.prototype.ve=function(e){v(1==this.A),this.A=0,nd(this,2,e)},H.prototype.we=function(e){v(1==this.A),this.A=0,nd(this,3,e)};var nd=function(e,t,n){0==e.A&&(e==n&&(t=3,n=new TypeError("Promise cannot resolve to itself")),e.A=1,td(n,e.ve,e.we,e)||(e.ca=n,e.A=t,e.l=null,Cd(e),3!=t||n instanceof od||Dd(e,n)))},td=function(e,t,n,r){if(e instanceof H)return null!=t&&Ba(t,"opt_onFulfilled should be a function."),null!=n&&Ba(n,"opt_onRejected should be a function. Did you pass opt_context as the second argument instead of the third?"),xd(e,rd(t||ba,n||null,r)),!0;if(md(e))return e.then(t,n,r),!0;if(ha(e))try{var i=e.then;if(p(i))return Ed(e,i,t,n,r),!0}catch(s){return n.call(r,s),!0}return!1},Ed=function(e,t,n,r,i){var s=!1,o=function(e){s||(s=!0,n.call(i,e))},u=function(e){s||(s=!0,r.call(i,e))};try{t.call(e,o,u)}catch(a){u(a)}},Cd=function(e){e.cc||(e.cc=!0,jd(e.Gd,e))},Ad=function(e){var t=null;return e.X&&(t=e.X,e.X=t.next,t.next=null),e.X||(e.Fa=null),null!=t&&v(null!=t.wa),t};H.prototype.Gd=function(){for(var e;e=Ad(this);)Bd(this,e,this.A,this.ca);this.cc=!1};var Bd=function(e,t,n,r){if(3==n&&t.La&&!t.Wa)for(;e&&e.yb;e=e.l)e.yb=!1;if(t.child)t.child.l=null,Fd(t,n,r);else try{t.Wa?t.wa.call(t.context):Fd(t,n,r)}catch(i){Gd.call(null,i)}qd.put(t)},Fd=function(e,t,n){2==t?e.wa.call(e.context,n):e.La&&e.La.call(e.context,n)},Dd=function(e,t){e.yb=!0,jd(function(){e.yb&&Gd.call(null,t)})},Gd=$c,od=function(e){t.call(this,e)};r(od,t),od.prototype.name="cancel";var Hd=function(e,t){this.Mb=[],this.Zc=e,this.Hc=t||null,this.$a=this.Ia=!1,this.ca=void 0,this.wc=this.Ac=this.Xb=!1,this.Rb=0,this.l=null,this.Yb=0};Hd.prototype.cancel=function(e){if(this.Ia)this.ca instanceof Hd&&this.ca.cancel();else{if(this.l){var t=this.l;delete this.l,e?t.cancel(e):(t.Yb--,0>=t.Yb&&t.cancel())}this.Zc?this.Zc.call(this.Hc,this):this.wc=!0,this.Ia||Id(this,new Jd)}},Hd.prototype.Gc=function(e,t){this.Xb=!1,Kd(this,e,t)};var Kd=function(e,t,n){e.Ia=!0,e.ca=n,e.$a=!t,Ld(e)},Nd=function(e){if(e.Ia){if(!e.wc)throw new Md;e.wc=!1}};Hd.prototype.callback=function(e){Nd(this),Od(e),Kd(this,!0,e)};var Id=function(e,t){Nd(e),Od(t),Kd(e,!1,t)},Od=function(e){v(!(e instanceof Hd),"An execution sequence may not be initiated with a blocking Deferred.")},Qd=function(e,t){Pd(e,null,t,void 0)},Pd=function(e,t,n,r){v(!e.Ac,"Blocking Deferreds can not be re-used"),e.Mb.push([t,n,r]),e.Ia&&Ld(e)};Hd.prototype.then=function(e,t,n){var r,i,s=new H(function(e,t){r=e,i=t});return Pd(this,r,function(e){e instanceof Jd?s.cancel():i(e)}),s.then(e,t,n)},ld(Hd);var Rd=function(e){return Fa(e.Mb,function(e){return p(e[1])})},Ld=function(e){if(e.Rb&&e.Ia&&Rd(e)){var t=e.Rb,n=Sd[t];n&&(l.clearTimeout(n.ab),delete Sd[t]),e.Rb=0}e.l&&(e.l.Yb--,delete e.l);for(var t=e.ca,r=n=!1;e.Mb.length&&!e.Xb;){var i=e.Mb.shift(),s=i[0],o=i[1],i=i[2];if(s=e.$a?o:s)try{var u=s.call(i||e.Hc,t);void 0!==u&&(e.$a=e.$a&&(u==t||u instanceof Error),e.ca=t=u);if(md(t)||"function"==typeof l.Promise&&t instanceof l.Promise)r=!0,e.Xb=!0}catch(a){t=a,e.$a=!0,Rd(e)||(n=!0)}}e.ca=t,r&&(u=q(e.Gc,e,!0),r=q(e.Gc,e,!1),t instanceof Hd?(Pd(t,u,r),t.Ac=!0):t.then(u,r)),n&&(t=new Td(t),Sd[t.ab]=t,e.Rb=t.ab)},Md=function(){t.call(this)};r(Md,t),Md.prototype.message="Deferred has already fired",Md.prototype.name="AlreadyCalledError";var Jd=function(){t.call(this)};r(Jd,t),Jd.prototype.message="Deferred was canceled",Jd.prototype.name="CanceledError";var Td=function(e){this.ab=l.setTimeout(q(this.ue,this),0),this.D=e};Td.prototype.ue=function(){throw v(Sd[this.ab],"Cannot throw an error that is not scheduled."),delete Sd[this.ab],this.D};var Sd={},Yd=function(e){var t={},n=t.document||document,r=document.createElement("SCRIPT"),i={hd:r,ob:void 0},s=new Hd(Ud,i),o=null,u=null!=t.timeout?t.timeout:5e3;return 0<u&&(o=window.setTimeout(function(){Vd(r,!0),Id(s,new Wd(1,"Timeout reached for loading script "+e))},u),i.ob=o),r.onload=r.onreadystatechange=function(){r.readyState&&"loaded"!=r.readyState&&"complete"!=r.readyState||(Vd(r,t.Be||!1,o),s.callback(null))},r.onerror=function(){Vd(r,!0,o),Id(s,new Wd(0,"Error while loading script "+e))},i=t.attributes||{},$a(i,{type:"text/javascript",charset:"UTF-8",src:e}),Yc(r,i),Xd(n).appendChild(r),s},Xd=function(e){var t=e.getElementsByTagName("HEAD");return t&&0!=t.length?t[0]:e.documentElement},Ud=function(){if(this&&this.hd){var e=this.hd;e&&"SCRIPT"==e.tagName&&Vd(e,!0,this.ob)}},Vd=function(e,t,n){null!=n&&l.clearTimeout(n),e.onload=ba,e.onerror=ba,e.onreadystatechange=ba,t&&window.setTimeout(function(){e&&e.parentNode&&e.parentNode.removeChild(e)},0)},Wd=function(e,n){var r="Jsloader error (code #"+e+")";n&&(r+=": "+n),t.call(this,r),this.code=e};r(Wd,t);var J=function(){Lb.call(this),this.O=new Sb(this),this.yd=this,this.lc=null};r(J,Lb),J.prototype[Ob]=!0,J.prototype.addEventListener=function(e,t,n,r){Yb(this,e,t,n,r)},J.prototype.removeEventListener=function(e,t,n,r){hc(this,e,t,n,r)},J.prototype.dispatchEvent=function(e){Zd(this);var t,r=this.lc;if(r){t=[];for(var i=1;r;r=r.lc)t.push(r),v(1e3>++i,"infinite loop")}r=this.yd,i=e.type||e;if(n(e))e=new Mb(e,r);else if(e instanceof Mb)e.target=e.target||r;else{var s=e;e=new Mb(i,r),$a(e,s)}var s=!0,o;if(t)for(var u=t.length-1;!e.Na&&0<=u;u--)o=e.currentTarget=t[u],s=$d(o,i,!0,e)&&s;e.Na||(o=e.currentTarget=r,s=$d(o,i,!0,e)&&s,e.Na||(s=$d(o,i,!1,e)&&s));if(t)for(u=0;!e.Na&&u<t.length;u++)o=e.currentTarget=t[u],s=$d(o,i,!1,e)&&s;return s},J.prototype.Ga=function(){J.yc.Ga.call(this);if(this.O){var e=this.O,t=0,n;for(n in e.v){for(var r=e.v[n],i=0;i<r.length;i++)++t,Rb(r[i]);delete e.v[n],e.pb--}}this.lc=null};var $b=function(e,t,n,r,i){Zd(e),e.O.add(String(t),n,!1,r,i)},gc=function(e,t,n,r,i){e.O.add(String(t),n,!0,r,i)},$d=function(e,t,n,r){t=e.O.v[String(t)];if(!t)return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.Pa&&o.rb==n){var u=o.listener,a=o.zb||o.src;o.qb&&Ub(e.O,o),i=!1!==u.call(a,r)&&i}}return i&&0!=r.gd};J.prototype.ec=function(e,t,n,r){return this.O.ec(String(e),t,n,r)};var Zd=function(e){v(e.O,"Event target is not initialized. Did you call the superclass (goog.events.EventTarget) constructor?")},ae="StopIteration"in l?l.StopIteration:{message:"StopIteration",stack:""},be=function(){};be.prototype.next=function(){throw ae},be.prototype.Va=function(){return this};var ce=function(e){if(e instanceof be)return e;if("function"==typeof e.Va)return e.Va(!1);if(fa(e)){var t=0,n=new be;return n.next=function(){for(;;){if(t>=e.length)throw ae;if(t in e)return e[t++];t++}},n}throw Error("Not implemented")},de=function(e,t){if(fa(e))try{w(e,t,void 0)}catch(n){if(n!==ae)throw n}else{e=ce(e);try{for(;;)t.call(void 0,e.next(),void 0,e)}catch(n){if(n!==ae)throw n}}},ee=function(e,t){this.P={},this.m=[],this.ea=this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else e&&this.addAll(e)};k=ee.prototype,k.wb=function(){return this.i},k.J=function(){fe(this);for(var e=[],t=0;t<this.m.length;t++)e.push(this.P[this.m[t]]);return e},k.Y=function(){return fe(this),this.m.concat()},k.Ya=function(e){return ge(this.P,e)},k.tb=function(e,t){if(this===e)return!0;if(this.i!=e.wb())return!1;var n=t||he;fe(this);for(var r,i=0;r=this.m[i];i++)if(!n(this.get(r),e.get(r)))return!1;return!0};var he=function(e,t){return e===t};ee.prototype.remove=function(e){return ge(this.P,e)?(delete this.P[e],this.i--,this.ea++,this.m.length>2*this.i&&fe(this),!0):!1};var fe=function(e){if(e.i!=e.m.length){for(var t=0,n=0;t<e.m.length;){var r=e.m[t];ge(e.P,r)&&(e.m[n++]=r),t++}e.m.length=n}if(e.i!=e.m.length){for(var i={},n=t=0;t<e.m.length;)r=e.m[t],ge(i,r)||(e.m[n++]=r,i[r]=1),t++;e.m.length=n}};k=ee.prototype,k.get=function(e,t){return ge(this.P,e)?this.P[e]:t},k.set=function(e,t){ge(this.P,e)||(this.i++,this.m.push(e),this.ea++),this.P[e]=t},k.addAll=function(e){var t;e instanceof ee?(t=e.Y(),e=e.J()):(t=Sa(e),e=Ra(e));for(var n=0;n<t.length;n++)this.set(t[n],e[n])},k.forEach=function(e,t){for(var n=this.Y(),r=0;r<n.length;r++){var i=n[r],s=this.get(i);e.call(t,s,i,this)}},k.clone=function(){return new ee(this)},k.Va=function(e){fe(this);var t=0,n=this.ea,r=this,i=new be;return i.next=function(){if(n!=r.ea)throw Error("The map has changed since the iterator was created");if(t>=r.m.length)throw ae;var i=r.m[t++];return e?i:r.P[i]},i};var ge=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},ie=function(e){if(e.J&&"function"==typeof e.J)return e.J();if(n(e))return e.split("");if(fa(e)){for(var t=[],r=e.length,i=0;i<r;i++)t.push(e[i]);return t}return Ra(e)},je=function(e){if(e.Y&&"function"==typeof e.Y)return e.Y();if(!e.J||"function"!=typeof e.J){if(fa(e)||n(e)){var t=[];e=e.length;for(var r=0;r<e;r++)t.push(r);return t}return Sa(e)}},ke=function(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(fa(e)||n(e))w(e,t,void 0);else for(var r=je(e),i=ie(e),s=i.length,o=0;o<s;o++)t.call(void 0,i[o],r&&r[o],e)},le=function(e,t,n,r,i){this.reset(e,t,n,r,i)};le.prototype.Jc=null;var me=0;le.prototype.reset=function(e,t,n,r,i){"number"==typeof i||me++,r||la(),this.gb=e,this.de=t,delete this.Jc},le.prototype.kd=function(e){this.gb=e};var ne=function(e){this.ee=e,this.Pc=this.Zb=this.gb=this.l=null},oe=function(e,t){this.name=e,this.value=t};oe.prototype.toString=function(){return this.name};var pe=new oe("SEVERE",1e3),qe=new oe("CONFIG",700),re=new oe("FINE",500);ne.prototype.getParent=function(){return this.l},ne.prototype.kd=function(e){this.gb=e};var se=function(e){return e.gb?e.gb:e.l?se(e.l):(ya("Root logger has no level set."),null)};ne.prototype.log=function(e,t,n){if(e.value>=se(this).value)for(p(t)&&(t=t()),e=new le(e,String(t),this.ee),n&&(e.Jc=n),n="log:"+e.de,l.console&&(l.console.timeStamp?l.console.timeStamp(n):l.console.markTimeline&&l.console.markTimeline(n)),l.msWriteProfilerMark&&l.msWriteProfilerMark(n),n=this;n;){t=n;var r=e;if(t.Pc)for(var i=0,s;s=t.Pc[i];i++)s(r);n=n.getParent()}};var te={},ue=null,ve=function(e){ue||(ue=new ne(""),te[""]=ue,ue.kd(qe));var t;if(!(t=te[e])){t=new ne(e);var n=e.lastIndexOf("."),r=e.substr(n+1),n=ve(e.substr(0,n));n.Zb||(n.Zb={}),n.Zb[r]=t,t.l=n,te[e]=t}return t},K=function(e,t){e&&e.log(re,t,void 0)},we=function(e,t,n){if(p(e))n&&(e=q(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=q(e.handleEvent,e)}return 2147483647<Number(t)?-1:l.setTimeout(e,t||0)},xe=function(e){var t=null;return(new H(function(n,r){t=we(function(){n(void 0)},e),-1==t&&r(Error("Failed to schedule timer."))})).I(function(e){throw l.clearTimeout(t),e})},ye=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/,ze=function(e,t){if(e)for(var n=e.split("&"),r=0;r<n.length;r++){var i=n[r].indexOf("="),s,o=null;0<=i?(s=n[r].substring(0,i),o=n[r].substring(i+1)):s=n[r],t(s,o?decodeURIComponent(o.replace(/\+/g," ")):"")}},L=function(e){J.call(this),this.headers=new ee,this.Vb=e||null,this.ga=!1,this.Ub=this.a=null,this.fb=this.Wc=this.Cb="",this.ua=this.jc=this.Bb=this.bc=!1,this.Sa=0,this.Qb=null,this.fd="",this.Sb=this.ke=this.ye=!1};r(L,J);var Ae=L.prototype,Be=ve("goog.net.XhrIo");Ae.L=Be;var Ce=/^https?$/i,De=["POST","PUT"];L.prototype.send=function(e,t,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.Cb+"; newUri="+e);t=t?t.toUpperCase():"GET",this.Cb=e,this.fb="",this.Wc=t,this.bc=!1,this.ga=!0,this.a=this.Vb?this.Vb.$b():wc.$b(),this.Ub=this.Vb?vc(this.Vb):vc(wc),this.a.onreadystatechange=q(this.ad,this),this.ke&&"onprogress"in this.a&&(this.a.onprogress=q(function(e){this.$c(e,!0)},this),this.a.upload&&(this.a.upload.onprogress=q(this.$c,this)));try{K(this.L,Ee(this,"Opening Xhr")),this.jc=!0,this.a.open(t,String(e),!0),this.jc=!1}catch(i){K(this.L,Ee(this,"Error opening Xhr: "+i.message)),this.D(5,i);return}e=n||"";var s=this.headers.clone();r&&ke(r,function(e,t){s.set(t,e)}),r=Ha(s.Y()),n=l.FormData&&e instanceof l.FormData,!Ia(De,t)||r||n||s.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),s.forEach(function(e,t){this.a.setRequestHeader(t,e)},this),this.fd&&(this.a.responseType=this.fd),Ta(this.a)&&(this.a.withCredentials=this.ye);try{Fe(this),0<this.Sa&&(this.Sb=Ge(this.a),K(this.L,Ee(this,"Will abort after "+this.Sa+"ms if incomplete, xhr2 "+this.Sb)),this.Sb?(this.a.timeout=this.Sa,this.a.ontimeout=q(this.ob,this)):this.Qb=we(this.ob,this.Sa,this)),K(this.L,Ee(this,"Sending request")),this.Bb=!0,this.a.send(e),this.Bb=!1}catch(i){K(this.L,Ee(this,"Send error: "+i.message)),this.D(5,i)}};var Ge=function(e){return y&&z(9)&&ga(e.timeout)&&void 0!==e.ontimeout},Ga=function(e){return"content-type"==e.toLowerCase()};L.prototype.ob=function(){"undefined"!=typeof aa&&this.a&&(this.fb="Timed out after "+this.Sa+"ms, aborting",K(this.L,Ee(this,this.fb)),this.dispatchEvent("timeout"),this.abort(8))},L.prototype.D=function(e,t){this.ga=!1,this.a&&(this.ua=!0,this.a.abort(),this.ua=!1),this.fb=t,He(this),Ie(this)};var He=function(e){e.bc||(e.bc=!0,e.dispatchEvent("complete"),e.dispatchEvent("error"))};L.prototype.abort=function(){this.a&&this.ga&&(K(this.L,Ee(this,"Aborting")),this.ga=!1,this.ua=!0,this.a.abort(),this.ua=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Ie(this))},L.prototype.Ga=function(){this.a&&(this.ga&&(this.ga=!1,this.ua=!0,this.a.abort(),this.ua=!1),Ie(this,!0)),L.yc.Ga.call(this)},L.prototype.ad=function(){this.isDisposed()||(this.jc||this.Bb||this.ua?Je(this):this.ie())},L.prototype.ie=function(){Je(this)};var Je=function(e){if(e.ga&&"undefined"!=typeof aa)if(e.Ub[1]&&4==Ke(e)&&2==Le(e))K(e.L,Ee(e,"Local request error detected and ignored"));else if(e.Bb&&4==Ke(e))we(e.ad,0,e);else if(e.dispatchEvent("readystatechange"),4==Ke(e)){K(e.L,Ee(e,"Request complete")),e.ga=!1;try{var t=Le(e),n;e:switch(t){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:n=!0;break e;default:n=!1}var r;if(!(r=n)){var i;if(i=0===t){var s=String(e.Cb).match(ye)[1]||null;if(!s&&l.self&&l.self.location)var o=l.self.location.protocol,s=o.substr(0,o.length-1);i=!Ce.test(s?s.toLowerCase():"")}r=i}if(r)e.dispatchEvent("complete"),e.dispatchEvent("success");else{var u;try{u=2<Ke(e)?e.a.statusText:""}catch(a){K(e.L,"Can not get status: "+a.message),u=""}e.fb=u+" ["+Le(e)+"]",He(e)}}finally{Ie(e)}}};L.prototype.$c=function(e,t){v("progress"===e.type,"goog.net.EventType.PROGRESS is of the same type as raw XHR progress."),this.dispatchEvent(Me(e,"progress")),this.dispatchEvent(Me(e,t?"downloadprogress":"uploadprogress"))};var Me=function(e,t){return{type:t,lengthComputable:e.lengthComputable,loaded:e.loaded,total:e.total}},Ie=function(e,t){if(e.a){Fe(e);var n=e.a,r=e.Ub[0]?ba:null;e.a=null,e.Ub=null,t||e.dispatchEvent("ready");try{n.onreadystatechange=r}catch(i){(n=e.L)&&n.log(pe,"Problem encountered resetting onreadystatechange: "+i.message,void 0)}}},Fe=function(e){e.a&&e.Sb&&(e.a.ontimeout=null),ga(e.Qb)&&(l.clearTimeout(e.Qb),e.Qb=null)},Ke=function(e){return e.a?e.a.readyState:0},Le=function(e){try{return 2<Ke(e)?e.a.status:-1}catch(t){return-1}},Ee=function(e,t){return t+" ["+e.Wc+" "+e.Cb+" "+Le(e)+"]"},Ne=function(e,t){this.ia=this.Ca=this.na="",this.Ma=null,this.ta=this.ka="",this.F=this.$d=!1;var n;if(e instanceof Ne)this.F=void 0!==t?t:e.F,Oe(this,e.na),n=e.Ca,M(this),this.Ca=n,Pe(this,e.ia),Qe(this,e.Ma),Re(this,e.ka),Se(this,e.S.clone()),n=e.ta,M(this),this.ta=n;else if(e&&(n=String(e).match(ye))){this.F=!!t,Oe(this,n[1]||"",!0);var r=n[2]||"";M(this),this.Ca=Te(r),Pe(this,n[3]||"",!0),Qe(this,n[4]),Re(this,n[5]||"",!0),Se(this,n[6]||"",!0),n=n[7]||"",M(this),this.ta=Te(n)}else this.F=!!t,this.S=new N(null,0,this.F)};Ne.prototype.toString=function(){var e=[],t=this.na;t&&e.push(Ue(t,Ve,!0),":");var n=this.ia;if(n||"file"==t)e.push("//"),(t=this.Ca)&&e.push(Ue(t,Ve,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.Ma,null!=n&&e.push(":",String(n));if(n=this.ka)this.ia&&"/"!=n.charAt(0)&&e.push("/"),e.push(Ue(n,"/"==n.charAt(0)?We:Xe,!0));return(n=this.S.toString())&&e.push("?",n),(n=this.ta)&&e.push("#",Ue(n,Ye)),e.join("")},Ne.prototype.resolve=function(e){var t=this.clone(),n=!!e.na;n?Oe(t,e.na):n=!!e.Ca;if(n){var r=e.Ca;M(t),t.Ca=r}else n=!!e.ia;n?Pe(t,e.ia):n=null!=e.Ma,r=e.ka;if(n)Qe(t,e.Ma);else if(n=!!e.ka){if("/"!=r.charAt(0))if(this.ia&&!this.ka)r="/"+r;else{var i=t.ka.lastIndexOf("/");-1!=i&&(r=t.ka.substr(0,i+1)+r)}i=r;if(".."==i||"."==i)r="";else if(u(i,"./")||u(i,"/.")){for(var r=0==i.lastIndexOf("/",0),i=i.split("/"),s=[],o=0;o<i.length;){var a=i[o++];"."==a?r&&o==i.length&&s.push(""):".."==a?((1<s.length||1==s.length&&""!=s[0])&&s.pop(),r&&o==i.length&&s.push("")):(s.push(a),r=!0)}r=s.join("/")}else r=i}return n?Re(t,r):n=""!==e.S.toString(),n?Se(t,Te(e.S.toString())):n=!!e.ta,n&&(e=e.ta,M(t),t.ta=e),t},Ne.prototype.clone=function(){return new Ne(this)};var Oe=function(e,t,n){M(e),e.na=n?Te(t,!0):t,e.na&&(e.na=e.na.replace(/:$/,""))},Pe=function(e,t,n){M(e),e.ia=n?Te(t,!0):t},Qe=function(e,t){M(e);if(t){t=Number(t);if(isNaN(t)||0>t)throw Error("Bad port number "+t);e.Ma=t}else e.Ma=null},Re=function(e,t,n){M(e),e.ka=n?Te(t,!0):t},Se=function(e,t,n){M(e),t instanceof N?(e.S=t,e.S.vc(e.F)):(n||(t=Ue(t,Ze)),e.S=new N(t,0,e.F))},O=function(e,t,n){M(e),e.S.set(t,n)},M=function(e){if(e.$d)throw Error("Tried to modify a read-only Uri")};Ne.prototype.vc=function(e){return this.F=e,this.S&&this.S.vc(e),this};var $e=function(e,t){var n=new Ne(null,void 0);return Oe(n,"https"),e&&Pe(n,e),t&&Re(n,t),n},Te=function(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""},Ue=function(e,t,r){return n(e)?(e=encodeURI(e).replace(t,af),r&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null},af=function(e){return e=e.charCodeAt(0),"%"+(e>>4&15).toString(16)+(e&15).toString(16)},Ve=/[#\/\?@]/g,Xe=/[\#\?:]/g,We=/[\#\?]/g,Ze=/[\#\?@]/g,Ye=/#/g,N=function(e,t,n){this.i=this.j=null,this.C=e||null,this.F=!!n},bf=function(e){e.j||(e.j=new ee,e.i=0,e.C&&ze(e.C,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))},df=function(e){var t=je(e);if("undefined"==typeof t)throw Error("Keys are undefined");var n=new N(null,0,void 0);e=ie(e);for(var r=0;r<t.length;r++){var i=t[r],s=e[r];ea(s)?cf(n,i,s):n.add(i,s)}return n};k=N.prototype,k.wb=function(){return bf(this),this.i},k.add=function(e,t){bf(this),this.C=null,e=this.s(e);var n=this.j.get(e);return n||this.j.set(e,n=[]),n.push(t),this.i=za(this.i)+1,this},k.remove=function(e){return bf(this),e=this.s(e),this.j.Ya(e)?(this.C=null,this.i=za(this.i)-this.j.get(e).length,this.j.remove(e)):!1},k.Ya=function(e){return bf(this),e=this.s(e),this.j.Ya(e)},k.Y=function(){bf(this);for(var e=this.j.J(),t=this.j.Y(),n=[],r=0;r<t.length;r++)for(var i=e[r],s=0;s<i.length;s++)n.push(t[r]);return n},k.J=function(e){bf(this);var t=[];if(n(e))this.Ya(e)&&(t=Ma(t,this.j.get(this.s(e))));else{e=this.j.J();for(var r=0;r<e.length;r++)t=Ma(t,e[r])}return t},k.set=function(e,t){return bf(this),this.C=null,e=this.s(e),this.Ya(e)&&(this.i=za(this.i)-this.j.get(e).length),this.j.set(e,[t]),this.i=za(this.i)+1,this},k.get=function(e,t){var n=e?this.J(e):[];return 0<n.length?String(n[0]):t};var cf=function(e,t,n){e.remove(t),0<n.length&&(e.C=null,e.j.set(e.s(t),Oa(n)),e.i=za(e.i)+n.length)};N.prototype.toString=function(){if(this.C)return this.C;if(!this.j)return"";for(var e=[],t=this.j.Y(),n=0;n<t.length;n++)for(var r=t[n],i=encodeURIComponent(String(r)),r=this.J(r),s=0;s<r.length;s++){var o=i;""!==r[s]&&(o+="="+encodeURIComponent(String(r[s]))),e.push(o)}return this.C=e.join("&")},N.prototype.clone=function(){var e=new N;return e.C=this.C,this.j&&(e.j=this.j.clone(),e.i=this.i),e},N.prototype.s=function(e){return e=String(e),this.F&&(e=e.toLowerCase()),e},N.prototype.vc=function(e){e&&!this.F&&(bf(this),this.C=null,this.j.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(this.remove(t),cf(this,n,e))},this)),this.F=e};var ef=function(e,t){var n=[],r;for(r in e)r in t?typeof e[r]!=typeof t[r]?n.push(r):ea(e[r])?Va(e[r],t[r])||n.push(r):"object"==typeof e[r]&&null!=e[r]&&null!=t[r]?0<ef(e[r],t[r]).length&&n.push(r):e[r]!==t[r]&&n.push(r):n.push(r);for(r in t)r in e||n.push(r);return n},ff=function(e,t){var n=null,r=Math.floor(1e9*Math.random()).toString(),i=e||500,s=t||600,o=(window.screen.availHeight-s)/2,a=(window.screen.availWidth-i)/2,i={width:i,height:s,top:0<o?o:0,left:0<a?a:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1};r&&(i.target=r),navigator.userAgent&&-1!=navigator.userAgent.indexOf("Firefox/")&&(n=n||"http://localhost");var f,s=n||"about:blank";(r=i)||(r={}),n=window,i=s instanceof A?s:Db("undefined"!=typeof s.href?s.href:String(s)),s=r.target||s.target,o=[];for(f in r)switch(f){case"width":case"height":case"top":case"left":o.push(f+"="+r[f]);break;case"target":case"noreferrer":break;default:o.push(f+"="+(r[f]?1:0))}f=o.join(","),(x("iPhone")&&!x("iPod")&&!x("iPad")||x("iPad")||x("iPod"))&&n.navigator&&n.navigator.standalone&&s&&"_self"!=s?(f=n.document.createElement("A"),i=i instanceof A?i:Db(i),f.href=Ab(i),f.setAttribute("target",s),r.noreferrer&&f.setAttribute("rel","noreferrer"),r=document.createEvent("MouseEvent"),r.initMouseEvent("click",!0,!0,n,1),f.dispatchEvent(r),f={}):r.noreferrer?(f=n.open("",s,f),r=Ab(i),f&&(fb&&u(r,";")&&(r="'"+r.replace(/'/g,"%27")+"'"),f.opener=null,n=new xb,n.Pb="b/12014412, meta tag with sanitized URL",ua.test(r)&&(-1!=r.indexOf("&")&&(r=r.replace(oa,"&amp;")),-1!=r.indexOf("<")&&(r=r.replace(pa,"&lt;")),-1!=r.indexOf(">")&&(r=r.replace(qa,"&gt;")),-1!=r.indexOf('"')&&(r=r.replace(ra,"&quot;")),-1!=r.indexOf("'")&&(r=r.replace(sa,"&#39;")),-1!=r.indexOf("\0")&&(r=r.replace(ta,"&#0;"))),r='<META HTTP-EQUIV="refresh" content="0; url='+r+'">',Aa(yb(n),"must provide justification"),v(!/^[\s\xa0]*$/.test(yb(n)),"must provide non-empty justification"),f.document.write(Gb((new Fb).Zd(r))),f.document.close())):f=n.open(Ab(i),s,f);if(f)try{f.focus()}catch(l){}return f},gf=function(e){return new H(function(t){var n=function(){xe(2e3).then(function(){if(!!e&&!e.closed)return n();t()})};return n()})},hf=function(){var e=null;return(new H(function(t){"complete"==l.document.readyState?t():(e=function(){t()},fc(window,"load",e))})).I(function(t){throw hc(window,"load",e),t})},jf=function(){var e=navigator.userAgent,t=e.toLowerCase();return u(t,"opera/")||u(t,"opr/")||u(t,"opios/")?"Opera":u(t,"msie")||u(t,"trident/")?"IE":u(t,"edge/")?"Edge":u(t,"firefox/")?"Firefox":u(t,"silk/")?"Silk":u(t,"safari/")&&!u(t,"chrome/")?"Safari":!u(t,"chrome/")&&!u(t,"crios/")||u(t,"edge/")?(e=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==e.length?e[1]:"Other":"Chrome"},kf=function(e){return jf()+"/JsCore/"+e},lf=function(e){e=e.split(".");for(var t=l,n=0;n<e.length&&"object"==typeof t&&null!=t;n++)t=t[e[n]];return n!=e.length&&(t=void 0),t},mf;try{var nf={};Object.defineProperty(nf,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(nf,"abcd",{configurable:!0,enumerable:!0,value:2}),mf=2==nf.abcd}catch(a){mf=!1}var P=function(e,t,n){mf?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,value:n}):e[t]=n},of=function(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&P(e,n,t[n])},pf=function(e){var t={},n;for(n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},qf=function(e,t){if(!t||!t.length)return!0;if(!e)return!1;for(var n=0;n<t.length;n++){var r=e[t[n]];if(void 0===r||null===r||""===r)return!1}return!0},rf={rd:{kb:985,jb:735,providerId:"facebook.com"},sd:{kb:1040,jb:620,providerId:"github.com"},td:{kb:485,jb:640,providerId:"google.com"},xd:{kb:485,jb:705,providerId:"twitter.com"}},sf=function(e){for(var t in rf)if(rf[t].providerId==e)return rf[t];return null},Q=function(e,t){this.code="auth/"+e,this.message=t||tf[e]||""};r(Q,Error),Q.prototype.N=function(){return{name:this.code,code:this.code,message:this.message}};var tf={"argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-user-token":"The user's credential is no longer valid. The user must sign in again.","invalid-auth-event":"An internal error has occurred.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","missing-iframe-start":"An internal error has occurred.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","operation-not-allowed":"This operation is not allowed. You must enable this service in the console.","popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported."},uf=function(e,t,n,r,i){this.pa=e,this.sa=t||null,this.Ua=n||null,this.uc=r||null,this.D=i||null;if(!this.Ua&&!this.D)throw new Q("invalid-auth-event");if(this.Ua&&this.D)throw new Q("invalid-auth-event");if(this.Ua&&!this.uc)throw new Q("invalid-auth-event")};uf.prototype.fc=function(){return this.uc},uf.prototype.getError=function(){return this.D},uf.prototype.N=function(){return{type:this.pa,eventId:this.sa,urlResponse:this.Ua,sessionId:this.uc,error:this.D&&this.D.N()}};var vf=function(e){this.be=e.sub,la(),this.sb=e.email||null},wf=function(e,t,r,i){var s={};ha(r)?s=r:t&&n(r)&&n(i)?s={oauthToken:r,oauthTokenSecret:i}:!t&&n(r)&&(s={accessToken:r});if(t||!s.idToken&&!s.accessToken){if(!(t&&s.oauthToken&&s.oauthTokenSecret))throw t?new Q("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret)."):new Q("argument-error","credential failed: expected 1 argument (the OAuth access token).");P(this,"accessToken",s.oauthToken),P(this,"secret",s.oauthTokenSecret)}else s.idToken&&P(this,"idToken",s.idToken),s.accessToken&&P(this,"accessToken",s.accessToken);P(this,"provider",e)};wf.prototype.xb=function(e){return xf(e,yf(this))},wf.prototype.Xc=function(e,t){var n=yf(this);return n.idToken=t,R(e,zf,n)};var yf=function(e){var t={};return e.idToken&&(t.id_token=e.idToken),e.accessToken&&(t.access_token=e.accessToken),e.secret&&(t.oauth_token_secret=e.secret),t.providerId=e.provider,{postBody:df(t).toString(),requestUri:window.location.href}};wf.prototype.N=function(){var e={provider:this.provider};return this.idToken&&(e.oauthIdToken=this.idToken),this.accessToken&&(e.oauthAccessToken=this.accessToken),this.secret&&(e.oauthTokenSecret=this.secret),e};var Af=function(e,t){var n=!!t,r=function(){of(this,{providerId:e,isOAuthProvider:!0}),this.tc=[]};return n||(r.prototype.addScope=function(e){Ia(this.tc,e)||this.tc.push(e)}),r.prototype.Mc=function(){return Oa(this.tc)},r.credential=function(t,r){return new wf(e,n,t,r)},of(r,{PROVIDER_ID:e}),r},Bf=Af("facebook.com");Bf.prototype.addScope=Bf.prototype.addScope||void 0;var Cf=Af("github.com");Cf.prototype.addScope=Cf.prototype.addScope||void 0;var Df=Af("google.com");Df.prototype.addScope=Df.prototype.addScope||void 0,Df.credential=function(e,t){if(!e&&!t)throw new Q("argument-error","credential failed: must provide the ID token and/or the access token.");return new wf("google.com",!1,ha(e)?e:{idToken:e||null,accessToken:t||null})};var Ef=Af("twitter.com",!0),Ff=function(e,t){this.sb=e,this.mc=t,P(this,"provider","password")};Ff.prototype.xb=function(e){return R(e,Gf,{email:this.sb,password:this.mc})},Ff.prototype.Xc=function(e,t){return R(e,Hf,{idToken:t,email:this.sb,password:this.mc})},Ff.prototype.N=function(){return{email:this.sb,password:this.mc}};var If=function(){of(this,{providerId:"password",isOAuthProvider:!1})};of(If,{PROVIDER_ID:"password"});var Jf={ze:If,rd:Bf,td:Df,sd:Cf,xd:Ef},Kf=function(e){var t=e&&e.providerId;if(!t)return null;var n=e&&e.oauthAccessToken,r=e&&e.oauthTokenSecret;e=e&&e.oauthIdToken;for(var i in Jf)if(Jf[i].PROVIDER_ID==t)try{return Jf[i].credential({accessToken:n,idToken:e,oauthToken:n,oauthTokenSecret:r})}catch(s){break}return null},Lf=function(e,t,n){Q.call(this,"account-exists-with-different-credential",n),P(this,"email",e),P(this,"credential",t)};r(Lf,Q),Lf.prototype.N=function(){var e={code:this.code,message:this.message,email:this.email},t=this.credential&&this.credential.N();return t&&($a(e,t),e.providerId=t.provider,delete e.provider),e};var T=function(e,t,n){this.u=e,e=t||{},this.ne=e.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.pe=e.secureTokenTimeout||1e4,this.oe=Ya(e.secureTokenHeaders||Mf),this.Jd=e.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.Kd=e.firebaseTimeout||1e4,this.Lc=Ya(e.firebaseHeaders||Nf),n&&(this.Lc["X-Client-Version"]=n),this.Bd=new zc},Of,Mf={"Content-Type":"application/x-www-form-urlencoded"},Nf={"Content-Type":"application/json"},Qf=function(e,t,n,r,i,s,o){!y||!qb||9<qb?e=q(e.re,e):(Of||(Of=new H(function(e,t){Pf(e,t)})),e=q(e.qe,e)),e(t,n,r,i,s,o)};T.prototype.re=function(e,t,n,r,i,s){var o=new L(this.Bd),u;s&&(o.Sa=Math.max(0,s),u=setTimeout(function(){o.dispatchEvent("timeout")},s)),$b(o,"complete",function(){u&&clearTimeout(u);var e=null;try{var n;n=this.a?nc(this.a.responseText):void 0,e=n||null}catch(r){e=null}t&&t(e)}),gc(o,"ready",function(){u&&clearTimeout(u),this.ra||(this.ra=!0,this.Ga())}),gc(o,"timeout",function(){u&&clearTimeout(u),this.ra||(this.ra=!0,this.Ga()),t&&t(null)}),o.send(e,n,r,i)};var Rf="__fcb"+Math.floor(1e6*Math.random()).toString(),Pf=function(e,t){((window.gapi||{}).client||{}).request?e():(l[Rf]=function(){((window.gapi||{}).client||{}).request?e():t(Error("CORS_UNSUPPORTED"))},Qd(Yd("//apis.google.com/js/client.js?onload="+Rf),function(){t(Error("CORS_UNSUPPORTED"))}))};T.prototype.qe=function(e,t,n,r,i){var s=this;Of.then(function(){window.gapi.client.setApiKey(s.u);var o=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:e,method:n,body:r,headers:i,authType:"none",callback:function(e){window.gapi.auth.setToken(o),t&&t(e)}})}).I(function(e){t&&t({error:{message:e&&e.message||"CORS_UNSUPPORTED"}})})};var Tf=function(e,t){return new H(function(n,r){"refresh_token"==t.grant_type&&t.refresh_token||"authorization_code"==t.grant_type&&t.code?Qf(e,e.ne+"?key="+encodeURIComponent(e.u),function(e){e?e.error?r(Sf(e)):e.access_token&&e.refresh_token?n(e):r(new Q("internal-error")):r(new Q("network-request-failed"))},"POST",df(t).toString(),e.oe,e.pe):r(new Q("internal-error"))})},Uf=function(e){var t={},n;for(n in e)null!==e[n]&&void 0!==e[n]&&(t[n]=e[n]);return qc(t)},Vf=function(e,t,n,r,i){var s=e.Jd+t+"?key="+encodeURIComponent(e.u);return i&&(s+="&cb="+la().toString()),new H(function(t,i){Qf(e,s,function(e){e?e.error?i(Sf(e)):t(e):i(new Q("network-request-failed"))},n,Uf(r),e.Lc,e.Kd)})},Wf=function(e){if(!mc.test(e.email))throw new Q("invalid-email")},Xf=function(e){"email"in e&&Wf(e)},Zf=function(e,t){return R(e,Yf,{identifier:t,continueUri:window.location.href}).then(function(e){return e.allProviders||[]})},ag=function(e){return R(e,$f,{}).then(function(e){return e.authorizedDomains||[]})},bg=function(e){if(!e.idToken)throw new Q("internal-error")};T.prototype.signInAnonymously=function(){return R(this,cg,{})},T.prototype.updateEmail=function(e,t){return R(this,dg,{idToken:e,email:t})},T.prototype.updatePassword=function(e,t){return R(this,Hf,{idToken:e,password:t})};var eg={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};T.prototype.updateProfile=function(e,t){var n={idToken:e},r=[];return Qa(eg,function(e,i){var s=t[i];null===s?r.push(e):i in t&&(n[i]=s)}),r.length&&(n.deleteAttribute=r),R(this,dg,n)},T.prototype.sendPasswordResetEmail=function(e){return R(this,fg,{requestType:"PASSWORD_RESET",email:e})},T.prototype.sendEmailVerification=function(e){return R(this,gg,{requestType:"VERIFY_EMAIL",idToken:e})};var ig=function(e,t,n){return R(e,hg,{idToken:t,deleteProvider:n})},jg=function(e){if(!e.requestUri||!e.sessionId&&!e.postBody)throw new Q("internal-error")},kg=function(e){if(e.needConfirmation)throw(e&&e.email?new Lf(e.email,Kf(e),e.message):null)||new Q("account-exists-with-different-credential");if(!e.idToken)throw new Q("internal-error")},xf=function(e,t){return R(e,lg,t)},mg=function(e){if(!e.oobCode)throw new Q("invalid-action-code")};T.prototype.confirmPasswordReset=function(e,t){return R(this,ng,{oobCode:e,newPassword:t})},T.prototype.checkActionCode=function(e){return R(this,og,{oobCode:e})},T.prototype.applyActionCode=function(e){return R(this,pg,{oobCode:e})};var pg={endpoint:"setAccountInfo",w:mg,Ra:"email"},og={endpoint:"resetPassword",w:mg,la:function(e){if(!mc.test(e.email))throw new Q("internal-error")}},qg={endpoint:"signupNewUser",w:function(e){Wf(e);if(!e.password)throw new Q("weak-password")},la:bg,ma:!0},Yf={endpoint:"createAuthUri"},rg={endpoint:"deleteAccount",Qa:["idToken"]},hg={endpoint:"setAccountInfo",Qa:["idToken","deleteProvider"],w:function(e){if(!ea(e.deleteProvider))throw new Q("internal-error")}},sg={endpoint:"getAccountInfo"},gg={endpoint:"getOobConfirmationCode",Qa:["idToken","requestType"],w:function(e){if("VERIFY_EMAIL"!=e.requestType)throw new Q("internal-error")},Ra:"email"},fg={endpoint:"getOobConfirmationCode",Qa:["requestType"],w:function(e){if("PASSWORD_RESET"!=e.requestType)throw new Q("internal-error");Wf(e)},Ra:"email"},$f={Ad:!0,endpoint:"getProjectConfig",Sd:"GET"},ng={endpoint:"resetPassword",w:mg,Ra:"email"},dg={endpoint:"setAccountInfo",Qa:["idToken"],w:Xf,ma:!0},Hf={endpoint:"setAccountInfo",Qa:["idToken"],w:function(e){Xf(e);if(!e.password)throw new Q("weak-password")},la:bg,ma:!0},cg={endpoint:"signupNewUser",la:bg,ma:!0},lg={endpoint:"verifyAssertion",w:jg,la:kg,ma:!0},zf={endpoint:"verifyAssertion",w:function(e){jg(e);if(!e.idToken)throw new Q("internal-error")},la:kg,ma:!0},tg={endpoint:"verifyCustomToken",w:function(e){if(!e.token)throw new Q("invalid-custom-token")},la:bg,ma:!0},Gf={endpoint:"verifyPassword",w:function(e){Wf(e);if(!e.password)throw new Q("wrong-password")},la:bg,ma:!0},R=function(e,t,n){if(!qf(n,t.Qa))return sd(new Q("internal-error"));var r=t.Sd||"POST",i;return I(n).then(t.w).then(function(){return t.ma&&(n.returnSecureToken=!0),Vf(e,t.endpoint,r,n,t.Ad||!1)}).then(function(e){return i=e}).then(t.la).then(function(){if(!t.Ra)return i;if(t.Ra in i)return i[t.Ra];throw new Q("internal-error")})},Sf=function(e){var t;t=(e.error&&e.error.errors&&e.error.errors[0]||{}).reason||"";var n={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(t=n[t]?new Q(n[t]):null)return t;e=e.error&&e.error.message||"",t={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",EMAIL_NOT_FOUND:"user-not-found",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported"};if(t[e])return new Q(t[e]);t={TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed"};for(var r in t)if(0===e.indexOf(r))return new Q(t[r]);return new Q("internal-error")},ug=function(e){this.G=e};ug.prototype.value=function(){return this.G},ug.prototype.ld=function(e){return this.G.style=e,this};var vg=function(e){this.G=e||{}};vg.prototype.value=function(){return this.G},vg.prototype.ld=function(e){return this.G.style=e,this};var xg=function(e){this.xe=e,this.hc=null,this.he=wg(this)},yg,zg=function(e){var t=new vg;return t.G.where=document.body,t.G.url=e.xe,t.G.messageHandlersFilter=lf("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),t.G.attributes=t.G.attributes||{},(new ug(t.G.attributes)).ld({position:"absolute",top:"-100px",width:"1px",height:"1px"}),t.G.dontclear=!0,t},wg=function(e){return Ag().then(function(){return new H(function(t){lf("gapi.iframes.getContext")().open(zg(e).value(),function(n){e.hc=n,e.hc.restyle({setHideOnLeave:!1}),t()})})})},Bg=function(e,t){e.he.then(function(){e.hc.register("authEvent",t,lf("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})},Cg="__iframefcb"+Math.floor(1e6*Math.random()).toString(),Ag=function(){return yg?yg:yg=new H(function(e,t){var n=function(){lf("gapi.load")("gapi.iframes",function(){e()})};lf("gapi.iframes.Iframe")?e():lf("gapi.load")?n():(l[Cg]=function(){lf("gapi.load")?n():t()},Qd(Yd("//apis.google.com/js/api.js?onload="+Cg),function(){t()}))})},Eg=function(e,t,n,r){this.ha=e,this.u=t,this.W=n,r=this.qa=r||null,e=$e(e,"/__/auth/iframe"),O(e,"apiKey",t),O(e,"appName",n),r&&O(e,"v",r),this.Ud=e.toString(),this.Vd=new xg(this.Ud),this.Wb=[],Dg(this)},Fg=function(e,t,n,r,i,s,o,u,a){return e=$e(e,"/__/auth/handler"),O(e,"apiKey",t),O(e,"appName",n),O(e,"authType",r),O(e,"providerId",i),s&&s.length&&O(e,"scopes",s.join(",")),o&&O(e,"redirectUrl",o),u&&O(e,"eventId",u),a&&O(e,"v",a),e.toString()},Dg=function(e){Bg(e.Vd,function(t){var n={};if(t&&t.authEvent){var r=!1;t=t.authEvent||{};if(t.type){if(n=t.error)var i=(n=t.error)&&(n.name||n.code),n=i?new Q(i.substring(5),n.message):null;t=new uf(t.type,t.eventId,t.urlResponse,t.sessionId,n)}else t=null;for(n=0;n<e.Wb.length;n++)r=e.Wb[n](t)||r;return n={},n.status=r?"ACK":"ERROR",I(n)}return n.status="ERROR",I(n)})};Eg.prototype.zc=function(e){this.Wb.push(e)};var Gg=function(e){this.Eb=e};Gg.prototype.set=function(e,t){void 0!==t?this.Eb.set(e,qc(t)):this.Eb.remove(e)},Gg.prototype.get=function(e){var t;try{t=this.Eb.get(e)}catch(n){return}if(null!==t)try{return nc(t)}catch(n){throw"Storage: Invalid value was encountered"}},Gg.prototype.remove=function(e){this.Eb.remove(e)};var Hg=function(){},Ig=function(){};r(Ig,Hg),Ig.prototype.wb=function(){var e=0;return de(this.Va(!0),function(t){Aa(t),e++}),e};var Jg=function(e){this.H=e};r(Jg,Ig);var Kg=function(e){if(!e.H)return!1;try{return e.H.setItem("__sak","1"),e.H.removeItem("__sak"),!0}catch(t){return!1}};k=Jg.prototype,k.set=function(e,t){try{this.H.setItem(e,t)}catch(n){throw 0==this.H.length?"Storage mechanism: Storage disabled":"Storage mechanism: Quota exceeded"}},k.get=function(e){e=this.H.getItem(e);if(!n(e)&&null!==e)throw"Storage mechanism: Invalid value was encountered";return e},k.remove=function(e){this.H.removeItem(e)},k.wb=function(){return this.H.length},k.Va=function(e){var t=0,r=this.H,i=new be;return i.next=function(){if(t>=r.length)throw ae;var i=Aa(r.key(t++));if(e)return i;i=r.getItem(i);if(!n(i))throw"Storage mechanism: Invalid value was encountered";return i},i},k.key=function(e){return this.H.key(e)};var Lg=function(){var e=null;try{e=window.localStorage||null}catch(t){}this.H=e};r(Lg,Jg);var Mg=function(){var e=null;try{e=window.sessionStorage||null}catch(t){}this.H=e};r(Mg,Jg);var Ng="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" "),U=function(e,t){return{name:e||"",U:"a valid string",optional:!!t,V:n}},Og=function(e){return{name:e||"",U:"a valid object",optional:!1,V:ha}},Pg=function(e,t){return{name:e||"",U:"a function",optional:!!t,V:p}},Qg=function(){return{name:"",U:"null",optional:!1,V:da}},Rg=function(){return{name:"credential",U:"a valid credential",optional:!1,V:function(e){return!!e&&!!e.xb}}},Sg=function(){return{name:"authProvider",U:"a valid Auth provider",optional:!1,V:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}},Tg=function(e,t,n,r){return{name:n||"",U:e.U+" or "+t.U,optional:!!r,V:function(n){return e.V(n)||t.V(n)}}},Vg=function(e,t){for(var n in t){var r=t[n].name;e[r]=Ug(r,e[n],t[n].b)}},V=function(e,t,n,r){e[t]=Ug(t,n,r)},Ug=function(e,t,n){if(!n)return t;var r=Wg(e);e=function(){var e=Array.prototype.slice.call(arguments),i;e:{i=Array.prototype.slice.call(e);var s;s=0;for(var o=!1,u=0;u<n.length;u++)if(n[u].optional)o=!0;else{if(o)throw new Q("internal-error","Argument validator encountered a required argument after an optional argument.");s++}o=n.length;if(i.length<s||o<i.length)i="Expected "+(s==o?1==s?"1 argument":s+" arguments":s+"-"+o+" arguments")+" but got "+i.length+".";else{for(s=0;s<i.length;s++)if(o=n[s].optional&&void 0===i[s],!n[s].V(i[s])&&!o){i=n[s];if(0>s||s>=Ng.length)throw new Q("internal-error","Argument validator received an unsupported number of arguments.");i=Ng[s]+" argument "+(i.name?'"'+i.name+'" ':"")+"must be "+i.U+".";break e}i=null}}if(i)throw new Q("argument-error",r+" failed: "+i);return t.apply(this,e)};for(var i in t)e[i]=t[i];for(i in t.prototype)e.prototype[i]=t.prototype[i];return e},Wg=function(e){return e=e.split("."),e[e.length-1]},$g=function(e,t,n){var r=(this.qa=firebase.SDK_VERSION||null)?kf(this.qa):null;this.c=new T(t,null,r),this.bd=Xg(this.c),this.ha=e,this.u=t,this.W=n,this.nb=[],this.Tc=!1,this.zd=q(this.Md,this),this.lb=new Yg,this.dd=new Zg,this.Ta={},this.Ta.unknown=this.lb,this.Ta.signInViaRedirect=this.lb,this.Ta.linkViaRedirect=this.lb,this.Ta.signInViaPopup=this.dd,this.Ta.linkViaPopup=this.dd},Xg=function(e){var t=window.location.href;return ag(e).then(function(e){e:{for(var n=(t instanceof Ne?t.clone():new Ne(t,void 0)).ia,r=0;r<e.length;r++){var i,s=e[r];i=n;var o=Rc(s);o?i=(i=Rc(i))?o.tb(i):!1:(o=s.split(".").join("\\."),i=(new RegExp("^(.+."+o+"|"+o+")$","i")).test(i));if(i){e=!0;break e}}e=!1}if(!e)throw new Q("unauthorized-domain")})},ah=function(e){e.Tc=!0,hf().then(function(){e.Td=new Eg(e.ha,e.u,e.W,e.qa),e.Td.zc(e.zd)})};$g.prototype.subscribe=function(e){Ia(this.nb,e)||this.nb.push(e),this.Tc||ah(this)},$g.prototype.unsubscribe=function(e){La(this.nb,function(t){return t==e})},$g.prototype.Md=function(e){if(!e)throw new Q("invalid-auth-event");for(var t=!1,n=0;n<this.nb.length;n++){var r=this.nb[n];if(r.Ec(e.pa,e.sa)){(t=this.Ta[e.pa])&&t.ed(e,r),t=!0;break}}return e=this.lb,e.qc||(e.qc=!0,bh(e,!1,null,null)),t},$g.prototype.getRedirectResult=function(){return this.lb.getRedirectResult()};var dh=function(e,t,n,r,i){return t?e.bd.then(function(){ch(r);var s=Fg(e.ha,e.u,e.W,n,r.providerId,r.Mc(),null,i,e.qa);return Hb((t||window).location,s),t}):sd(new Q("popup-blocked"))},eh=function(e,t,n,r){return e.bd.then(function(){ch(n);var i=Fg(e.ha,e.u,e.W,t,n.providerId,n.Mc(),window.location.href,r,e.qa);Hb(window.location,i)})},fh=function(e,t,n,r){var i=new Q("popup-closed-by-user");return gf(n).then(function(){return xe(3e4).then(function(){e.Ba(t,null,i,r)})})},ch=function(e){if(!e.isOAuthProvider)throw new Q("invalid-oauth-provider")},gh={},hh=function(e,t,n){var r=t+":"+n;return gh[r]||(gh[r]=new $g(e,t,n)),gh[r]},Yg=function(){this.rc=this.Kb=this.Oa=this.T=null,this.qc=!1};Yg.prototype.ed=function(e,t){if(!e)return sd(new Q("invalid-auth-event"));this.qc=!0;var n=e.pa,r=e.sa;return"unknown"==n?(this.T||bh(this,!1,null,null),n=I()):n=e.D?this.oc(e,t):t.Za(n,r)?this.pc(e,t):sd(new Q("invalid-auth-event")),n},Yg.prototype.oc=function(e){return this.T||bh(this,!0,null,e.getError()),I()},Yg.prototype.pc=function(e,t){var n=this,r=e.pa,i=t.Za(r,e.sa),s=e.Ua,o=e.fc(),u="signInViaRedirect"==r||"linkViaRedirect"==r;return i(s,o).then(function(e){n.T||bh(n,u,e,null)}).I(function(e){n.T||bh(n,u,null,e)})};var bh=function(e,t,n,r){t?r?(e.T=function(){return sd(r)},e.Kb&&e.Kb(r)):(e.T=function(){return I(n)},e.Oa&&e.Oa(n)):(e.T=function(){return I({user:null})},e.Oa&&e.Oa({user:null})),e.Oa=null,e.Kb=null};Yg.prototype.getRedirectResult=function(){var e=this;return this.Cc||(this.Cc=new H(function(t,n){e.T?e.T().then(t,n):(e.Oa=t,e.Kb=n,ih(e))})),this.Cc};var ih=function(e){var t=new Q("timeout");e.rc&&e.rc.cancel(),e.rc=xe(3e4).then(function(){e.T||bh(e,!0,null,t)})},Zg=function(){};Zg.prototype.ed=function(e,t){if(!e)return sd(new Q("invalid-auth-event"));var n=e.pa,r=e.sa;return e.D?this.oc(e,t):t.Za(n,r)?this.pc(e,t):sd(new Q("invalid-auth-event"))},Zg.prototype.oc=function(e,t){return t.Ba(e.pa,null,e.getError(),e.sa),I()},Zg.prototype.pc=function(e,t){var n=e.sa,r=e.pa,i=t.Za(r,n),s=e.Ua,o=e.fc();return i(s,o).then(function(e){t.Ba(r,e,null,n)}).I(function(e){t.Ba(r,null,e,n)})};var jh=function(e){this.c=e,this.Ea=this.ba=null,this.Ha=0};jh.prototype.N=function(){return{apiKey:this.c.u,refreshToken:this.ba,accessToken:this.Ea,expirationTime:this.Ha}};var lh=function(e,t){var n=t.idToken,r=t.refreshToken,i=kh(t.expiresIn);e.Ea=n,e.Ha=i,e.ba=r},kh=function(e){return la()+1e3*parseInt(e,10)},mh=function(e,t){return Tf(e.c,t).then(function(t){return e.Ea=t.access_token,e.Ha=kh(t.expires_in),e.ba=t.refresh_token,{accessToken:e.Ea,expirationTime:e.Ha,refreshToken:e.ba}})};jh.prototype.getToken=function(e){return e||!this.Ea||la()>this.Ha-3e4?this.ba?mh(this,{grant_type:"refresh_token",refresh_token:this.ba}):I(null):I({accessToken:this.Ea,expirationTime:this.Ha,refreshToken:this.ba})};var nh=function(e,t,n,r,i){of(this,{uid:e,displayName:r||null,photoURL:i||null,email:n||null,providerId:t})},oh=function(e,t){Mb.call(this,e);for(var n in t)this[n]=t[n]};r(oh,Mb);var W=function(e,t,n){this.M=[],this.u=e.apiKey,this.W=e.appName,this.ha=e.authDomain||null,e=firebase.SDK_VERSION?kf(firebase.SDK_VERSION):null,this.c=new T(this.u,null,e),this.oa=new jh(this.c),ph(this,t.idToken),lh(this.oa,t),P(this,"refreshToken",this.oa.ba),qh(this,n||{}),J.call(this),this.Hb=!1,this.ha&&(this.o=hh(this.ha,this.u,this.W)),this.Nb=[]};r(W,J);var ph=function(e,t){e.Vc=t,P(e,"_lat",t)},rh=function(e,t){La(e.Nb,function(e){return e==t})},sh=function(e){for(var t=[],n=0;n<e.Nb.length;n++)t.push(e.Nb[n](e));return vd(t).then(function(){return e})},th=function(e){e.o&&!e.Hb&&(e.Hb=!0,e.o.subscribe(e))},qh=function(e,t){of(e,{uid:t.uid,displayName:t.displayName||null,photoURL:t.photoURL||null,email:t.email||null,emailVerified:t.emailVerified||!1,isAnonymous:t.isAnonymous||!1,providerData:[]})};P(W.prototype,"providerId","firebase");var uh=function(){},vh=function(e){return I().then(function(){if(e.Ed)throw new Q("app-deleted")})},wh=function(e){return Ea(e.providerData,function(e){return e.providerId})},yh=function(e,t){t&&(xh(e,t.providerId),e.providerData.push(t))},xh=function(e,t){La(e.providerData,function(e){return e.providerId==t})},zh=function(e,t,n){("uid"!=t||n)&&e.hasOwnProperty(t)&&P(e,t,n)};W.prototype.copy=function(e){var t=this;t!=e&&(of(this,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,isAnonymous:e.isAnonymous,providerData:[]}),w(e.providerData,function(e){yh(t,e)}),this.oa=e.oa,P(this,"refreshToken",this.oa.ba))},W.prototype.reload=function(){var e=this;return vh(this).then(function(){return Ah(e).then(function(){return sh(e)}).then(uh)})};var Ah=function(e){return e.getToken().then(function(t){var n=e.isAnonymous;return Bh(e,t).then(function(){return n||zh(e,"isAnonymous",!1),t}).I(function(t){throw"auth/user-token-expired"==t.code&&(e.dispatchEvent(new oh("userDeleted")),Ch(e)),t})})};W.prototype.getToken=function(e){var t=this;return vh(this).then(function(){return t.oa.getToken(e)}).then(function(e){if(!e)throw new Q("internal-error");return e.accessToken!=t.Vc&&(ph(t,e.accessToken),t.ja()),zh(t,"refreshToken",e.refreshToken),e.accessToken})};var Dh=function(e,t){t.idToken&&e.Vc!=t.idToken&&(lh(e.oa,t),e.ja(),ph(e,t.idToken))};W.prototype.ja=function(){this.dispatchEvent(new oh("tokenChanged"))};var Bh=function(e,t){return R(e.c,sg,{idToken:t}).then(q(e.je,e))};W.prototype.je=function(e){e=e.users;if(!e||!e.length)throw new Q("internal-error");e=e[0],qh(this,{uid:e.localId,displayName:e.displayName,photoURL:e.photoUrl,email:e.email,emailVerified:!!e.emailVerified});for(var t=Eh(e),n=0;n<t.length;n++)yh(this,t[n]);zh(this,"isAnonymous",(!this.email||!e.passwordHash)&&(!this.providerData||!this.providerData.length))};var Eh=function(e){return(e=e.providerUserInfo)&&e.length?Ea(e,function(e){return new nh(e.rawId,e.providerId,e.email,e.displayName,e.photoUrl)}):[]};W.prototype.reauthenticate=function(e){var t=this;return this.f(e.xb(this.c).then(function(e){var n;e:{var r=e.idToken.split(".");if(3==r.length){for(var r=r[1],i=(4-r.length%4)%4,s=0;s<i;s++)r+=".";try{var o=nc(ub(r));if(o.sub&&o.iss&&o.aud&&o.exp){n=new vf(o);break e}}catch(u){}}n=null}if(!n||t.uid!=n.be)throw new Q("user-mismatch");return Dh(t,e),t.reload()}))};var Fh=function(e,t){return Ah(e).then(function(){if(Ia(wh(e),t))return sh(e).then(function(){throw new Q("provider-already-linked")})})};k=W.prototype,k.link=function(e){var t=this;return this.f(Fh(this,e.provider).then(function(){return t.getToken()}).then(function(n){return e.Xc(t.c,n)}).then(q(this.Kc,this)))},k.Kc=function(e){Dh(this,e);var t=this;return this.reload().then(function(){return t})},k.updateEmail=function(e){var t=this;return this.f(this.getToken().then(function(n){return t.c.updateEmail(n,e)}).then(function(e){return Dh(t,e),t.reload()}))},k.updatePassword=function(e){var t=this;return this.f(this.getToken().then(function(n){return t.c.updatePassword(n,e)}).then(function(e){return Dh(t,e),t.reload()}))},k.updateProfile=function(e){if(void 0===e.displayName&&void 0===e.photoURL)return vh(this);var t=this;return this.f(this.getToken().then(function(n){return t.c.updateProfile(n,{displayName:e.displayName,photoUrl:e.photoURL})}).then(function(e){return Dh(t,e),zh(t,"displayName",e.displayName||null),zh(t,"photoURL",e.photoUrl||null),sh(t)}).then(uh))},k.unlink=function(e){var t=this;return this.f(Ah(this).then(function(n){return Ia(wh(t),e)?ig(t.c,n,[e]).then(function(e){var n={};return w(e.providerUserInfo||[],function(e){n[e.providerId]=!0}),w(wh(t),function(e){n[e]||xh(t,e)}),sh(t)}):sh(t).then(function(){throw new Q("no-such-provider")})}))},k["delete"]=function(){var e=this;return this.f(this.getToken().then(function(t){return R(e.c,rg,{idToken:t})}).then(function(){e.dispatchEvent(new oh("userDeleted"))})).then(function(){Ch(e)})},k.Ec=function(e,t){return"linkViaPopup"==e&&(this.$||null)==t&&this.R||"linkViaRedirect"==e&&(this.Jb||null)==t?!0:!1},k.Ba=function(e,t,n,r){"linkViaPopup"==e&&r==(this.$||null)&&(n&&this.xa?this.xa(n):t&&!n&&this.R&&this.R(t),this.ya&&(this.ya.cancel(),this.ya=null),delete this.R,delete this.xa)},k.Za=function(e,t){return"linkViaPopup"==e&&t==(this.$||null)||"linkViaRedirect"==e&&(this.Jb||null)==t?q(this.Hd,this):null},k.vb=function(){return this.uid+":::"+Math.floor(1e9*Math.random()).toString()},k.linkWithPopup=function(e){var t=this,n=sf(e.providerId),r=ff(n&&n.kb,n&&n.jb),i=this.vb(),n=Fh(this,e.providerId).then(function(){return sh(t)}).then(function(){return t.Ja(),t.getToken()}).then(function(){return dh(t.o,r,"linkViaPopup",e,i)}).then(function(e){return new H(function(n,r){t.Ba("linkViaPopup",null,new Q("cancelled-popup-request"),t.$||null),t.R=n,t.xa=r,t.$=i,t.ya=fh(t,"linkViaPopup",e,i)})}).then(function(e){return r&&(r||window).close(),e}).I(function(e){throw r&&(r||window).close(),e});return this.f(n)},k.linkWithRedirect=function(e){var t=this,n=null,r=this.vb(),i=Fh(this,e.providerId).then(function(){return t.Ja(),t.getToken()}).then(function(){return t.Jb=r,sh(t)}).then(function(e){return t.za&&(e=t.u+":"+t.W,e=Gh(t.za,Hh,t.N(),e)),e}).then(function(){return eh(t.o,"linkViaRedirect",e,r)}).I(function(e){n=e;if(t.za)return Ih(t.za,Hh,t.u+":"+t.W);throw n}).then(function(){if(n)throw n});return this.f(i)},k.Ja=function(){if(this.o&&this.Hb)return this.o;throw this.o&&!this.Hb?new Q("internal-error"):new Q("auth-domain-config-required")},k.Hd=function(e,t){var n=this,r=null,i=this.getToken().then(function(r){return R(n.c,zf,{requestUri:e,sessionId:t,idToken:r})}).then(function(e){return r=Kf(e),n.Kc(e)}).then(function(e){return{user:e,credential:r}});return this.f(i)},k.sendEmailVerification=function(){var e=this;return this.f(this.getToken().then(function(t){return e.c.sendEmailVerification(t)}).then(function(t){if(e.email!=t)return e.reload()}).then(function(){}))};var Ch=function(e){for(var t=0;t<e.M.length;t++)e.M[t].cancel("app-deleted");e.M=[],e.Ed=!0,P(e,"refreshToken",null),e.o&&e.o.unsubscribe(e)};W.prototype.f=function(e){var t=this;return this.M.push(e),yd(e,function(){Ka(t.M,e)}),e},W.prototype.N=function(){var e={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,isAnonymous:this.isAnonymous,providerData:[],apiKey:this.u,appName:this.W,authDomain:this.ha,stsTokenManager:this.oa.N(),redirectEventId:this.Jb||null};return w(this.providerData,function(t){e.providerData.push(pf(t))}),e};var Jh=function(e){if(!e.apiKey)return null;var t={apiKey:e.apiKey,authDomain:e.authDomain,appName:e.appName},n={};if(!(e.stsTokenManager&&e.stsTokenManager.accessToken&&e.stsTokenManager.refreshToken&&e.stsTokenManager.expirationTime))return null;n.idToken=e.stsTokenManager.accessToken,n.refreshToken=e.stsTokenManager.refreshToken,n.expiresIn=(e.stsTokenManager.expirationTime-la())/1e3;var r=new W(t,n,e);return e.providerData&&w(e.providerData,function(e){if(e){var t={};of(t,e),yh(r,t)}}),e.redirectEventId&&(r.Jb=e.redirectEventId),r},Kh=function(e,t,n){var r=new W(e,t);return n&&(r.za=n),r.reload().then(function(){return r})},Lh,Mh=function(e,t,n,r,i,s){this.Dd=e,this.kc=t,this.ac=n,this.qd=r,this.ea=i,this.Db={},this.mb=[],this.ib=0,this.Wd=s||l.indexedDB},Nh=function(e){return new H(function(t,n){var r=e.Wd.open(e.Dd,e.ea);r.onerror=function(e){n(Error(e.target.errorCode))},r.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore(e.kc,{keyPath:e.ac})}catch(r){n(r)}},r.onsuccess=function(e){t(e.target.result)}})},Oh=function(e){return e.Sc||(e.Sc=Nh(e)),e.Sc},Ph=function(e,t){return t.objectStore(e.kc)},Qh=function(e,t,n){return t.transaction([e.kc],n?"readwrite":"readonly")},Rh=function(e){return new H(function(t,n){e.onsuccess=function(e){e&&e.target?t(e.target.result):t()},e.onerror=function(e){n(Error(e.target.errorCode))}})};Mh.prototype.set=function(e,t){var n=!1,r,i=this;return yd(Oh(this).then(function(t){return r=t,t=Ph(i,Qh(i,r,!0)),Rh(t.get(e))}).then(function(s){var o=Ph(i,Qh(i,r,!0));return s?(s.value=t,Rh(o.put(s))):(i.ib++,n=!0,s={},s[i.ac]=e,s[i.qd]=t,Rh(o.add(s)))}).then(function(){i.Db[e]=t}),function(){n&&i.ib--})},Mh.prototype.get=function(e){var t=this;return Oh(this).then(function(n){return Rh(Ph(t,Qh(t,n,!1)).get(e))})},Mh.prototype.remove=function(e){var t=!1,n=this;return yd(Oh(this).then(function(r){return t=!0,n.ib++,Rh(Ph(n,Qh(n,r,!0))["delete"](e))}).then(function(){delete n.Db[e]}),function(){t&&n.ib--})},Mh.prototype.te=function(){var e=this;return Oh(this).then(function(t){var n=Ph(e,Qh(e,t,!1));return n.getAll?Rh(n.getAll()):new H(function(e,t){var r=[],i=n.openCursor();i.onsuccess=function(t){(t=t.target.result)?(r.push(t.value),t["continue"]()):e(r)},i.onerror=function(e){t(Error(e.target.errorCode))}})}).then(function(t){var n={},r=[];if(0==e.ib){for(r=0;r<t.length;r++)n[t[r][e.ac]]=t[r][e.qd];r=ef(e.Db,n),e.Db=n}return r})};var Sh=function(e,t){La(e.mb,function(e){return e==t}),0==e.mb.length&&e.Ob()};Mh.prototype.xc=function(){var e=this;this.Ob();var t=function(){return e.nc=xe(1e3).then(q(e.te,e)).then(function(t){0<t.length&&w(e.mb,function(e){e(t)})}).then(t).I(function(e){"STOP_EVENT"!=e.message&&t()}),e.nc};t()},Mh.prototype.Ob=function(){this.nc&&this.nc.cancel("STOP_EVENT")};var Hh={name:"redirectUser",Z:!1},Th={name:"sessionId",Z:!1},Uh={name:"authEvent",Z:!0},Vh={name:"authUser",Z:!0},Wh=function(e,t,n,r,i){this.fe=e,this.jd=t,this.hb=r,this.me=i;if(!Kg(new Lg)||!Kg(new Mg))throw new Q("web-storage-unsupported");this.K={},this.bb=n,this.Yc=q(this.ce,this),this.Rc=q(this.Xd,this)},Xh,Yh=function(){if(!Xh){Lh||(Lh=new Mh("firebaseLocalStorageDb","firebaseLocalStorage","fbase_key","value",1));var e=navigator.userAgent.toLowerCase();Xh=new Wh("firebase",":",Lh,y&&!!qb&&11==qb||/Edge\/\d+/.test(ab),-1!=e.indexOf("safari")&&-1==e.indexOf("chrome")&&window!=window.top?!0:!1)}return Xh},Zh=function(e,t){var n;return t?(e.cd||(n=new Lg,n=Kg(n)?n:null,e.cd=new Gg(n)),n=e.cd):(e.md||(n=new Mg,n=Kg(n)?n:null,e.md=new Gg(n)),n=e.md),n};Wh.prototype.s=function(e,t){return this.fe+this.jd+e.name+(t?this.jd+t:"")};var $h=function(e,t,n){return e.hb&&t.Z?e.bb.get(e.s(t,n)).then(function(e){return e&&e.value}):I(Zh(e,t.Z).get(e.s(t,n)))},Ih=function(e,t,n){return e.hb&&t.Z?e.bb.remove(e.s(t,n)):(Zh(e,t.Z).remove(e.s(t,n)),I())},Gh=function(e,t,n,r){return e.hb&&t.Z?e.bb.set(e.s(t,r),n):(Zh(e,t.Z).set(e.s(t,r),n),I())};Wh.prototype.fc=function(e){return $h(this,Th,e)},Wh.prototype.zc=function(e,t){ai(this,this.s(Uh,e),t)};var bi=function(e,t,n){return $h(e,Vh,t).then(function(e){return e&&n&&(e.authDomain=n),Jh(e||{})})},ci=function(e,t,n){return $h(e,Hh,t).then(function(e){return e&&n&&(e.authDomain=n),Jh(e||{})})},ai=function(e,t,n){Ua(e.K)&&e.xc(),e.K[t]||(e.K[t]=[]),e.K[t].push(n)},di=function(e,t,n){e.K[t]&&(La(e.K[t],function(e){return e==n}),0==e.K[t].length&&delete e.K[t]),Ua(e.K)&&e.Ob()};k=Wh.prototype,k.xc=function(){if(this.hb){var e=this.bb,t=this.Rc;0==e.mb.length&&e.xc(),e.mb.push(t)}else Yb(window,"storage",this.Yc)},k.Ob=function(){this.hb?Sh(this.bb,this.Rc):hc(window,"storage",this.Yc)},k.ce=function(e){var t=e.ub.key;if(this.me){var n=window.localStorage.getItem(t);e=e.ub.newValue,e!=n&&(e?window.localStorage.setItem(t,e):e||window.localStorage.removeItem(t))}this.Dc(t)},k.Xd=function(e){w(e,q(this.Dc,this))},k.Dc=function(e){this.K[e]&&w(this.K[e],function(e){e()})};var Y=function(e){this.Ic=!1,P(this,"app",e);if(!X(this).options||!X(this).options.apiKey)throw new Q("invalid-api-key");e=firebase.SDK_VERSION?kf(firebase.SDK_VERSION):null,this.c=new T(X(this).options&&X(this).options.apiKey,null,e),this.M=[],this.Xa=[],this.ge=firebase.INTERNAL.createSubscribe(q(this.Yd,this)),ei(this,null),this.Aa=this.da=null;try{this.da=Yh(),this.Aa=Yh(),this.B=fi(this)}catch(t){this.B=sd(t)}this.eb=!1,this.Nc=q(this.se,this),this.od=q(this.Ka,this),this.pd=q(this.Rd,this),this.nd=q(this.Qd,this),gi(this),this.INTERNAL={},this.INTERNAL["delete"]=q(this["delete"],this)};Y.prototype.Ja=function(){return this.Fd||sd(new Q("auth-domain-config-required"))};var gi=function(e){var t=X(e).options.authDomain,n=X(e).options.apiKey;t&&(e.Fd=e.B.then(function(){return e.o=hh(t,n,X(e).name),e.o.subscribe(e),Z(e)&&th(Z(e)),e.sc&&(th(e.sc),e.sc=null),e.o}))};k=Y.prototype,k.Ec=function(e,t){switch(e){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.$==t&&!!this.R;default:return!1}},k.Ba=function(e,t,n,r){"signInViaPopup"==e&&this.$==r&&(n&&this.xa?this.xa(n):t&&!n&&this.R&&this.R(t),this.ya&&(this.ya.cancel(),this.ya=null),delete this.R,delete this.xa)},k.Za=function(e,t){return"signInViaRedirect"==e||"signInViaPopup"==e&&this.$==t&&this.R?q(this.Id,this):null},k.Id=function(e,t){var n=this,r=null,i=xf(n.c,{requestUri:e,sessionId:t}).then(function(e){return r=Kf(e),e}),s=n.B.then(function(){return i}).then(function(e){return hi(n,e)}).then(function(){return{user:Z(n),credential:r}});return this.f(s)},k.vb=function(){return Math.floor(1e9*Math.random()).toString()},k.signInWithPopup=function(e){var t=this,n=sf(e.providerId),r=ff(n&&n.kb,n&&n.jb),i=this.vb(),n=this.Ja().then(function(t){return dh(t,r,"signInViaPopup",e,i)}).then(function(e){return new H(function(n,r){t.Ba("signInViaPopup",null,new Q("cancelled-popup-request"),t.$),t.R=n,t.xa=r,t.$=i,t.ya=fh(t,"signInViaPopup",e,i)})}).then(function(e){return r&&(r||window).close(),e}).I(function(e){throw r&&(r||window).close(),e});return this.f(n)},k.signInWithRedirect=function(e){var t=this,n=this.Ja().then(function(){return eh(t.o,"signInViaRedirect",e)});return this.f(n)},k.getRedirectResult=function(){var e=this,t=this.Ja().then(function(){return e.o.getRedirectResult()});return this.f(t)};var hi=function(e,t){var n={};return n.apiKey=X(e).options.apiKey,n.authDomain=X(e).options.authDomain,n.appName=X(e).name,e.B.then(function(){return Kh(n,t,e.Aa)}).then(function(t){return Z(e)&&t.uid==Z(e).uid?(Z(e).copy(t),e.Ka(t)):(ei(e,t),th(t),e.Ka(t))}).then(function(){e.ja()})},ei=function(e,t){Z(e)&&(rh(Z(e),e.od),hc(Z(e),"tokenChanged",e.pd),hc(Z(e),"userDeleted",e.nd)),t&&(t.Nb.push(e.od),Yb(t,"tokenChanged",e.pd),Yb(t,"userDeleted",e.nd)),P(e,"currentUser",t)};Y.prototype.signOut=function(){var e=this,t=this.B.then(function(){return Z(e)?(ei(e,null),Ih(e.da,Vh,ii(e)).then(function(){e.ja()})):I()});return this.f(t)};var ji=function(e){var t=ii(e),n=ci(e.Aa,t,X(e).options.authDomain).then(function(n){if(e.sc=n)n.za=e.Aa;return Ih(e.Aa,Hh,t)});return e.f(n)},fi=function(e){var t=ii(e),n=X(e).options.authDomain,r=yd(ji(e).then(function(){return bi(e.da,t,n)}).then(function(n){return n?(n.za=e.Aa,n.reload().then(function(){return n}).I(function(r){return"auth/network-request-failed"==r.code?n:Ih(e.da,Vh,t)})):null}).then(function(t){ei(e,t||null),e.eb=!0,e.ja()}),function(){if(!e.Ic){e.eb=!0;var n=e.da;ai(n,n.s(Vh,t),e.Nc)}});return e.f(r)};Y.prototype.se=function(){var e=this;return bi(this.da,ii(this),X(this).options.authDomain).then(function(t){var n;if(n=Z(e)&&t){n=Z(e).uid;var r=t.uid;n=void 0===n||null===n||""===n||void 0===r||null===r||""===r?!1:n==r}if(n)return Z(e).copy(t),Z(e).getToken();ei(e,t),t&&(th(t),t.za=e.Aa),e.o.subscribe(e),e.ja()})},Y.prototype.Ka=function(e){var t=ii(this);return Gh(this.da,Vh,e.N(),t)},Y.prototype.Rd=function(){this.eb=!0,this.ja(),this.Ka(Z(this))},Y.prototype.Qd=function(){this.signOut()};var ki=function(e,t){return e.f(t.then(function(t){return hi(e,t)}).then(function(){return Z(e)}))};k=Y.prototype,k.Yd=function(e){var t=this;this.addAuthTokenListener(function(){e.next(Z(t))})},k.onAuthStateChanged=function(e,t,n){var r=this;return this.eb&&firebase.Promise.resolve().then(function(){p(e)?e(Z(r)):p(e.next)&&e.next(Z(r))}),this.ge(e,t,n)},k.getToken=function(e){var t=this,n=this.B.then(function(){return Z(t)?Z(t).getToken(e).then(function(e){return{accessToken:e}}):null});return this.f(n)},k.signInWithCustomToken=function(e){var t=this;return this.B.then(function(){return ki(t,R(t.c,tg,{token:e}))}).then(function(e){return zh(e,"isAnonymous",!1),t.Ka(e)}).then(function(){return Z(t)})},k.signInWithEmailAndPassword=function(e,t){var n=this;return this.B.then(function(){return ki(n,R(n.c,Gf,{email:e,password:t}))})},k.createUserWithEmailAndPassword=function(e,t){var n=this;return this.B.then(function(){return ki(n,R(n.c,qg,{email:e,password:t}))})},k.signInWithCredential=function(e){var t=this;return this.B.then(function(){return ki(t,e.xb(t.c))})},k.signInAnonymously=function(){var e=Z(this),t=this;return e&&e.isAnonymous?I(e):this.B.then(function(){return ki(t,t.c.signInAnonymously())}).then(function(e){return zh(e,"isAnonymous",!0),t.Ka(e)}).then(function(){return Z(t)})};var ii=function(e){return X(e).options.apiKey+":"+X(e).name},X=function(e){return e.app},Z=function(e){return e.currentUser};k=Y.prototype,k.ja=function(){for(var e=0;e<this.Xa.length;e++)this.Xa[e]&&this.Xa[e](Z(this)&&Z(this)._lat||null)},k.addAuthTokenListener=function(e){this.Xa.push(e);var t=this;this.eb&&this.B.then(function(){e(Z(t)&&Z(t)._lat||null)})},k.removeAuthTokenListener=function(e){La(this.Xa,function(t){return t==e})},k["delete"]=function(){this.Ic=!0;for(var e=0;e<this.M.length;e++)this.M[e].cancel("app-deleted");this.M=[],this.da&&(e=this.da,di(e,e.s(Vh,ii(this)),this.Nc)),this.o&&this.o.unsubscribe(this)},k.f=function(e){var t=this;return this.M.push(e),yd(e,function(){Ka(t.M,e)}),e},k.fetchProvidersForEmail=function(e){return this.f(Zf(this.c,e))},k.verifyPasswordResetCode=function(e){return this.checkActionCode(e).then(function(e){return e.data.email})},k.confirmPasswordReset=function(e,t){return this.f(this.c.confirmPasswordReset(e,t).then(function(){}))},k.checkActionCode=function(e){return this.f(this.c.checkActionCode(e).then(function(e){return{data:{email:e.email}}}))},k.applyActionCode=function(e){return this.f(this.c.applyActionCode(e).then(function(){}))},k.sendPasswordResetEmail=function(e){return this.f(this.c.sendPasswordResetEmail(e).then(function(){}))},Vg(Y.prototype,{applyActionCode:{name:"applyActionCode",b:[U("code")]},checkActionCode:{name:"checkActionCode",b:[U("code")]},confirmPasswordReset:{name:"confirmPasswordReset",b:[U("code"),U("newPassword")]},createUserWithEmailAndPassword:{name:"createUserWithEmailAndPassword",b:[U("email"),U("password")]},fetchProvidersForEmail:{name:"fetchProvidersForEmail",b:[U("email")]},getRedirectResult:{name:"getRedirectResult",b:[]},onAuthStateChanged:{name:"onAuthStateChanged",b:[Tg(Og(),Pg(),"nextOrObserver"),Pg("opt_error",!0),Pg("opt_completed",!0)]},sendPasswordResetEmail:{name:"sendPasswordResetEmail",b:[U("email")]},signInAnonymously:{name:"signInAnonymously",b:[]},signInWithCredential:{name:"signInWithCredential",b:[Rg()]},signInWithCustomToken:{name:"signInWithCustomToken",b:[U("token")]},signInWithEmailAndPassword:{name:"signInWithEmailAndPassword",b:[U("email"),U("password")]},signInWithPopup:{name:"signInWithPopup",b:[Sg()]},signInWithRedirect:{name:"signInWithRedirect",b:[Sg()]},signOut:{name:"signOut",b:[]},verifyPasswordResetCode:{name:"verifyPasswordResetCode",b:[U("code")]}}),Vg(W.prototype,{"delete":{name:"delete",b:[]},getToken:{name:"getToken",b:[{name:"opt_forceRefresh",U:"a boolean",optional:!0,V:function(e){return"boolean"==typeof e}}]},link:{name:"link",b:[Rg()]},linkWithPopup:{name:"linkWithPopup",b:[Sg()]},linkWithRedirect:{name:"linkWithRedirect",b:[Sg()]},reauthenticate:{name:"reauthenticate",b:[Rg()]},reload:{name:"reload",b:[]},sendEmailVerification:{name:"sendEmailVerification",b:[]},unlink:{name:"unlink",b:[U("provider")]},updateEmail:{name:"updateEmail",b:[U("email")]},updatePassword:{name:"updatePassword",b:[U("password")]},updateProfile:{name:"updateProfile",b:[Og("profile")]}}),Vg(H.prototype,{I:{name:"catch"},then:{name:"then"}}),V(If,"credential",function(e,t){return new Ff(e,t)},[U("email"),U("password")]),Vg(Bf.prototype,{addScope:{name:"addScope",b:[U("scope")]}}),V(Bf,"credential",Bf.credential,[Tg(U(),Og(),"token")]),Vg(Cf.prototype,{addScope:{name:"addScope",b:[U("scope")]}}),V(Cf,"credential",Cf.credential,[Tg(U(),Og(),"token")]),Vg(Df.prototype,{addScope:{name:"addScope",b:[U("scope")]}}),V(Df,"credential",Df.credential,[Tg(U(),Tg(Og(),Qg()),"idToken"),Tg(U(),Qg(),"accessToken",!0)]),V(Ef,"credential",Ef.credential,[Tg(U(),Og(),"token"),U("secret",!0)]),function(){if("undefined"==typeof firebase||!firebase.INTERNAL||!firebase.INTERNAL.registerService)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var e={Auth:Y,Error:Q};V(e,"EmailAuthProvider",If,[]),V(e,"FacebookAuthProvider",Bf,[]),V(e,"GithubAuthProvider",Cf,[]),V(e,"GoogleAuthProvider",Df,[]),V(e,"TwitterAuthProvider",Ef,[]),firebase.INTERNAL.registerService("auth",function(e,t){var n=new Y(e);return t({INTERNAL:{getToken:q(n.getToken,n),addAuthTokenListener:q(n.addAuthTokenListener,n),removeAuthTokenListener:q(n.removeAuthTokenListener,n)}}),n},e),firebase.INTERNAL.registerAppHook(function(e,t){"create"===e&&t.auth()}),firebase.INTERNAL.extendNamespace({User:W})}()}(),function(){function p(e){return void 0!==e}function aa(){}function ba(e){e.Wb=function(){return e.$e?e.$e:e.$e=new e}}function ca(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof Object)return t;var n=Object.prototype.toString.call(e);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof e.length&&"undefined"!=typeof e.splice&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||"undefined"!=typeof e.call&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==t&&"undefined"==typeof e.call)return"object";return t}function da(e){return"array"==ca(e)}function ea(e){var t=ca(e);return"array"==t||"object"==t&&"number"==typeof e.length}function q(e){return"string"==typeof e}function fa(e){return"number"==typeof e}function ga(e){return"function"==ca(e)}function ha(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function ia(e,t,n){return e.call.apply(e.bind,arguments)}function ja(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function r(e,t,n){return r=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ia:ja,r.apply(null,arguments)}function ka(e,t){function n(){}n.prototype=t.prototype,e.Eg=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Bg=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function la(){this.Ya=-1}function ma(){this.Ya=-1,this.Ya=64,this.N=[],this.Wd=[],this.Hf=[],this.zd=[],this.zd[0]=128;for(var e=1;e<this.Ya;++e)this.zd[e]=0;this.Pd=this.ac=0,this.reset()}function na(e,t,n){n||(n=0);var r=e.Hf;if(q(t))for(var i=0;16>i;i++)r[i]=t.charCodeAt(n)<<24|t.charCodeAt(n+1)<<16|t.charCodeAt(n+2)<<8|t.charCodeAt(n+3),n+=4;else for(i=0;16>i;i++)r[i]=t[n]<<24|t[n+1]<<16|t[n+2]<<8|t[n+3],n+=4;for(i=16;80>i;i++){var s=r[i-3]^r[i-8]^r[i-14]^r[i-16];r[i]=(s<<1|s>>>31)&4294967295}t=e.N[0],n=e.N[1];for(var o=e.N[2],u=e.N[3],a=e.N[4],f,i=0;80>i;i++)40>i?20>i?(s=u^n&(o^u),f=1518500249):(s=n^o^u,f=1859775393):60>i?(s=n&o|u&(n|o),f=2400959708):(s=n^o^u,f=3395469782),s=(t<<5|t>>>27)+s+a+f+r[i]&4294967295,a=u,u=o,o=(n<<30|n>>>2)&4294967295,n=t,t=s;e.N[0]=e.N[0]+t&4294967295,e.N[1]=e.N[1]+n&4294967295,e.N[2]=e.N[2]+o&4294967295,e.N[3]=e.N[3]+u&4294967295,e.N[4]=e.N[4]+a&4294967295}function t(e,t){for(var n in e)t.call(void 0,e[n],n,e)}function oa(e,t){var n={},r;for(r in e)n[r]=t.call(void 0,e[r],r,e);return n}function pa(e,t){for(var n in e)if(!t.call(void 0,e[n],n,e))return!1;return!0}function qa(e){var t=0,n;for(n in e)t++;return t}function ra(e){for(var t in e)return t}function sa(e){var t=[],n=0,r;for(r in e)t[n++]=e[r];return t}function ta(e){var t=[],n=0,r;for(r in e)t[n++]=r;return t}function ua(e,t){for(var n in e)if(e[n]==t)return!0;return!1}function va(e,t,n){for(var r in e)if(t.call(n,e[r],r,e))return r}function wa(e,t){var n=va(e,t,void 0);return n&&e[n]}function xa(e){for(var t in e)return!1;return!0}function ya(e){var t={},n;for(n in e)t[n]=e[n];return t}function za(a){a=String(a);if(/^\s*$/.test(a)?0:/^[\],:{}\s\u2028\u2029]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r\u2028\u2029\x00-\x08\x0a-\x1f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,"")))try{return eval("("+a+")")}catch(b){}throw Error("Invalid JSON string: "+a)}function Aa(){this.Fd=void 0}function Ba(e,t,n){switch(typeof t){case"string":Ca(t,n);break;case"number":n.push(isFinite(t)&&!isNaN(t)?t:"null");break;case"boolean":n.push(t);break;case"undefined":n.push("null");break;case"object":if(null==t){n.push("null");break}if(da(t)){var r=t.length;n.push("[");for(var i="",s=0;s<r;s++)n.push(i),i=t[s],Ba(e,e.Fd?e.Fd.call(t,String(s),i):i,n),i=",";n.push("]");break}n.push("{"),r="";for(s in t)Object.prototype.hasOwnProperty.call(t,s)&&(i=t[s],"function"!=typeof i&&(n.push(r),Ca(s,n),n.push(":"),Ba(e,e.Fd?e.Fd.call(t,s,i):i,n),r=","));n.push("}");break;case"function":break;default:throw Error("Unknown type: "+typeof t)}}function Ca(e,t){t.push('"',e.replace(Ea,function(e){if(e in Da)return Da[e];var t=e.charCodeAt(0),n="\\u";return 16>t?n+="000":256>t?n+="00":4096>t&&(n+="0"),Da[e]=n+t.toString(16)}),'"')}function Ha(e){if(Error.captureStackTrace)Error.captureStackTrace(this,Ha);else{var t=Error().stack;t&&(this.stack=t)}e&&(this.message=String(e))}function Oa(e,t){var n=Pa(e,t,void 0);return 0>n?null:q(e)?e.charAt(n):e[n]}function Pa(e,t,n){for(var r=e.length,i=q(e)?e.split(""):e,s=0;s<r;s++)if(s in i&&t.call(n,i[s],s,e))return s;return-1}function Qa(e,t){var n=Ia(e,t);0<=n&&w.splice.call(e,n,1)}function Ra(e,t,n){return 2>=arguments.length?w.slice.call(e,t):w.slice.call(e,t,n)}function Sa(e,t){e.sort(t||Ta)}function Ta(e,t){return e>t?1:e<t?-1:0}function ab(e,t){if(!ea(e))throw Error("encodeByteArray takes an array as a parameter");bb();for(var n=t?Za:Ya,r=[],i=0;i<e.length;i+=3){var s=e[i],o=i+1<e.length,u=o?e[i+1]:0,a=i+2<e.length,f=a?e[i+2]:0,l=s>>2,s=(s&3)<<4|u>>4,u=(u&15)<<2|f>>6,f=f&63;a||(f=64,o||(u=64)),r.push(n[l],n[s],n[u],n[f])}return r.join("")}function bb(){if(!Ya){Ya={},Za={},$a={};for(var e=0;65>e;e++)Ya[e]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e),Za[e]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(e),$a[Za[e]]=e,62<=e&&($a["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e)]=e)}}function cb(e){n.setTimeout(function(){throw e},0)}function eb(){var e=n.MessageChannel;"undefined"==typeof e&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&-1==v.indexOf("Presto")&&(e=function(){var e=document.createElement("iframe");e.style.display="none",e.src="",document.documentElement.appendChild(e);var t=e.contentWindow,e=t.document;e.open(),e.write(""),e.close();var n="callImmediate"+Math.random(),i="file:"==t.location.protocol?"*":t.location.protocol+"//"+t.location.host,e=r(function(e){("*"==i||e.origin==i)&&e.data==n&&this.port1.onmessage()},this);t.addEventListener("message",e,!1),this.port1={},this.port2={postMessage:function(){t.postMessage(n,i)}}});if("undefined"!=typeof e&&-1==v.indexOf("Trident")&&-1==v.indexOf("MSIE")){var t=new e,i={},s=i;return t.port1.onmessage=function(){if(p(i.next)){i=i.next;var e=i.Ke;i.Ke=null,e()}},function(e){s.next={Ke:e},s=s.next,t.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("script")?function(e){var t=document.createElement("script");t.onreadystatechange=function(){t.onreadystatechange=null,t.parentNode.removeChild(t),t=null,e(),e=null},document.documentElement.appendChild(t)}:function(e){n.setTimeout(e,0)}}function fb(e,t){gb||hb(),ib||(gb(),ib=!0),jb.push(new kb(e,t))}function hb(){if(n.Promise&&n.Promise.resolve){var e=n.Promise.resolve();gb=function(){e.then(lb)}}else gb=function(){var e=lb;!ga(n.setImmediate)||n.Window&&n.Window.prototype&&n.Window.prototype.setImmediate==n.setImmediate?(db||(db=eb()),db(e)):n.setImmediate(e)}}function lb(){for(;jb.length;){var e=jb;jb=[];for(var t=0;t<e.length;t++){var n=e[t];try{n.Uf.call(n.scope)}catch(r){cb(r)}}}ib=!1}function kb(e,t){this.Uf=e,this.scope=t}function mb(e,t){this.L=nb,this.sf=void 0,this.Ca=this.Ha=null,this.jd=this.be=!1;if(e==ob)pb(this,qb,t);else try{var n=this;e.call(t,function(e){pb(n,qb,e)},function(e){if(!(e instanceof rb))try{throw e instanceof Error?e:Error("Promise rejected.")}catch(t){}pb(n,sb,e)})}catch(r){pb(this,sb,r)}}function ob(){}function ub(e,t){if(e.L==nb)if(e.Ha){var n=e.Ha;if(n.Ca){for(var r=0,i=-1,s=0,o;o=n.Ca[s];s++)if(o=o.m)if(r++,o==e&&(i=s),0<=i&&1<r)break;0<=i&&(n.L==nb&&1==r?ub(n,t):(r=n.Ca.splice(i,1)[0],vb(n,r,sb,t)))}e.Ha=null}else pb(e,sb,t)}function wb(e,t){e.Ca&&e.Ca.length||e.L!=qb&&e.L!=sb||xb(e),e.Ca||(e.Ca=[]),e.Ca.push(t)}function tb(e,t,n,r){var i={m:null,ff:null,hf:null};return i.m=new mb(function(e,s){i.ff=t?function(n){try{var i=t.call(r,n);e(i)}catch(o){s(o)}}:e,i.hf=n?function(t){try{var i=n.call(r,t);!p(i)&&t instanceof rb?s(t):e(i)}catch(o){s(o)}}:s}),i.m.Ha=e,wb(e,i),i.m}function pb(e,t,n){if(e.L==nb){if(e==n)t=sb,n=new TypeError("Promise cannot resolve to itself");else{var r;if(n)try{r=!!n.$goog_Thenable}catch(i){r=!1}else r=!1;if(r){e.L=1,n.then(e.Af,e.Bf,e);return}if(ha(n))try{var s=n.then;if(ga(s)){yb(e,n,s);return}}catch(o){t=sb,n=o}}e.sf=n,e.L=t,e.Ha=null,xb(e),t!=sb||n instanceof rb||zb(e,n)}}function yb(e,t,n){function r(t){s||(s=!0,e.Bf(t))}function i(t){s||(s=!0,e.Af(t))}e.L=1;var s=!1;try{n.call(t,i,r)}catch(o){r(o)}}function xb(e){e.be||(e.be=!0,fb(e.Sf,e))}function vb(e,t,n,r){if(n==qb)t.ff(r);else{if(t.m)for(;e&&e.jd;e=e.Ha)e.jd=!1;t.hf(r)}}function zb(e,t){e.jd=!0,fb(function(){e.jd&&Ab.call(null,t)})}function rb(e){Ha.call(this,e)}function Bb(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function x(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]}function Cb(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function y(e,t,n,r){var i;r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n);if(i)throw Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")}function Db(e,t,n){var r="";switch(t){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}return e=e+" failed: "+(r+" argument ")}function A(e,t,n,r){if((!r||p(n))&&!ga(n))throw Error(Db(e,t,r)+"must be a valid function.")}function Eb(e,t,n){if(p(n)&&(!ha(n)||null===n))throw Error(Db(e,t,!0)+"must be a valid context object.")}function Fb(e){var t=[];return Cb(e,function(e,n){da(n)?Ja(n,function(n){t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))}),t.length?"&"+t.join("&"):""}function Hb(){var e=this;this.reject=this.resolve=null,this.ra=new Gb(function(t,n){e.resolve=t,e.reject=n})}function Ib(e,t){return function(n,r){n?e.reject(n):e.resolve(r),ga(t)&&(Jb(e.ra),1===t.length?t(n):t(n,r))}}function Jb(e){e.then(void 0,aa)}function Kb(e,t){if(!e)throw Lb(t)}function Lb(e){return Error("Firebase Database ("+firebase.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)}function Mb(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);55296<=i&&56319>=i&&(i-=55296,r++,Kb(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(i<<10)+(e.charCodeAt(r)-56320)),128>i?t[n++]=i:(2048>i?t[n++]=i>>6|192:(65536>i?t[n++]=i>>12|224:(t[n++]=i>>18|240,t[n++]=i>>12&63|128),t[n++]=i>>6&63|128),t[n++]=i&63|128)}return t}function Nb(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);128>r?t++:2048>r?t+=2:55296<=r&&56319>=r?(t+=4,n++):t+=3}return t}function Ob(e){return"undefined"!=typeof JSON&&p(JSON.parse)?JSON.parse(e):za(e)}function B(e){if("undefined"!=typeof JSON&&p(JSON.stringify))e=JSON.stringify(e);else{var t=[];Ba(new Aa,e,t),e=t.join("")}return e}function Pb(e,t){this.committed=e,this.snapshot=t}function Qb(e){this.se=e,this.Bd=[],this.Rb=0,this.Yd=-1,this.Gb=null}function Rb(e,t,n){e.Yd=t,e.Gb=n,e.Yd<e.Rb&&(e.Gb(),e.Gb=null)}function Sb(e,t,n){for(e.Bd[t]=n;e.Bd[e.Rb];){var r=e.Bd[e.Rb];delete e.Bd[e.Rb];for(var i=0;i<r.length;++i)if(r[i]){var s=e;Tb(function(){s.se(r[i])})}if(e.Rb===e.Yd){e.Gb&&(clearTimeout(e.Gb),e.Gb(),e.Gb=null);break}e.Rb++}}function Ub(){this.qc={}}function Vb(e){this.vc=e,this.Cd="firebase:"}function Wb(e){try{if("undefined"!=typeof window&&"undefined"!=typeof window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new Vb(t)}}catch(n){}return new Ub}function Zb(e,t,n){this.type=$b,this.source=e,this.path=t,this.Ja=n}function ac(e,t){this.type=bc,this.source=e,this.path=t}function cc(e){this.Ge=e}function dc(e,t){e.Ge.INTERNAL.addAuthTokenListener(t)}function ec(){this.Jd=F}function fc(e,t,n,r,i){this.host=e.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.Sc=t,this.oe=n,this.zg=r,this.lf=i||"",this.bb=Xb.get("host:"+e)||this.host}function gc(e,t){t!==e.bb&&(e.bb=t,"s-"===e.bb.substr(0,2)&&Xb.set("host:"+e.host,e.bb))}function hc(e,n,r){H("string"==typeof n,"typeof type must == string"),H("object"==typeof r,"typeof params must == object");if("websocket"===n)n=(e.Sc?"wss://":"ws://")+e.bb+"/.ws?";else{if("long_polling"!==n)throw Error("Unknown connection type: "+n);n=(e.Sc?"https://":"http://")+e.bb+"/.lp?"}e.host!==e.bb&&(r.ns=e.oe);var i=[];return t(r,function(e,t){i.push(t+"="+e)}),n+i.join("&")}function ic(e,t){this.xf={},this.Vc=new jc(e),this.va=t;var n=1e4+2e4*Math.random();setTimeout(r(this.pf,this),Math.floor(n))}function kc(){this.uc={}}function lc(e,t,n){p(n)||(n=1),Bb(e.uc,t)||(e.uc[t]=0),e.uc[t]+=n}function jc(e){this.Lf=e,this.rd=null}function oc(e){return e=e.toString(),mc[e]||(mc[e]=new kc),mc[e]}function pc(e,t){var n=e.toString();return nc[n]||(nc[n]=t()),nc[n]}function qc(){this.wb=[]}function rc(e,t){for(var n=null,r=0;r<t.length;r++){var i=t[r],s=i.Zb();null===n||s.ca(n.Zb())||(e.wb.push(n),n=null),null===n&&(n=new sc(s)),n.add(i)}n&&e.wb.push(n)}function tc(e,t,n){rc(e,n),uc(e,function(e){return e.ca(t)})}function vc(e,t,n){rc(e,n),uc(e,function(e){return e.contains(t)||t.contains(e)})}function uc(e,t){for(var n=!0,r=0;r<e.wb.length;r++){var i=e.wb[r];if(i)if(i=i.Zb(),t(i)){for(var i=e.wb[r],s=0;s<i.hd.length;s++){var o=i.hd[s];if(null!==o){i.hd[s]=null;var u=o.Ub();wc&&E("event: "+o.toString()),Tb(u)}}e.wb[r]=null}else n=!1}n&&(e.wb=[])}function sc(e){this.qa=e,this.hd=[]}function xc(e,t,n,r){this.ae=t,this.Md=n,this.Dd=r,this.gd=e}function yc(e,t,n){this.ae=e,this.error=t,this.path=n}function zc(){}function Bc(e,t,n){this.Ef=e,this.Na=t,this.yd=n}function I(e,t,n,r){this.type=e,this.Ma=t,this.Za=n,this.pe=r,this.Dd=void 0}function Fc(e){return new I(Gc,e)}function Dc(e,t,n){this.A=e,this.ea=t,this.Tb=n}function Hc(e){return e.ea}function Ic(e){return e.Tb}function Jc(e,t){return t.e()?e.ea&&!e.Tb:Cc(e,J(t))}function Cc(e,t){return e.ea&&!e.Tb||e.A.Fa(t)}function Kc(e,t){return Lc(e.name,t.name)}function Mc(e,t){return Lc(e,t)}function K(e,t){this.name=e,this.S=t}function Nc(e,t){return new K(e,t)}function Oc(e,t){return e&&"object"==typeof e?(H(".sv"in e,"Unexpected leaf node or priority contents"),t[e[".sv"]]):e}function Pc(e,t){var n=new Qc;return Rc(e,new L(""),function(e,r){Sc(n,e,Tc(r,t))}),n}function Tc(e,t){var n=e.C().H(),n=Oc(n,t),r;if(e.J()){var i=Oc(e.Ea(),t);return i!==e.Ea()||n!==e.C().H()?new Uc(i,M(n)):e}return r=e,n!==e.C().H()&&(r=r.ga(new Uc(n))),e.P(N,function(e,n){var i=Tc(n,t);i!==n&&(r=r.U(e,i))}),r}function Xc(e){try{var t;if("undefined"!=typeof atob)t=atob(e);else{bb();for(var n=$a,r=[],i=0;i<e.length;){var s=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0;++i;var u=i<e.length?n[e.charAt(i)]:64;++i;var a=i<e.length?n[e.charAt(i)]:64;++i;if(null==s||null==o||null==u||null==a)throw Error();r.push(s<<2|o>>4),64!=u&&(r.push(o<<4&240|u>>2),64!=a&&r.push(u<<6&192|a))}if(8192>r.length)t=String.fromCharCode.apply(null,r);else{e="";for(n=0;n<r.length;n+=8192)e+=String.fromCharCode.apply(null,Ra(r,n,n+8192));t=e}}return t}catch(f){E("base64Decode failed: ",f)}return null}function Yc(e){var t=Mb(e);e=new ma,e.update(t);var t=[],n=8*e.Pd;56>e.ac?e.update(e.zd,56-e.ac):e.update(e.zd,e.Ya-(e.ac-56));for(var r=e.Ya-1;56<=r;r--)e.Wd[r]=n&255,n/=256;na(e,e.Wd);for(r=n=0;5>r;r++)for(var i=24;0<=i;i-=8)t[n]=e.N[r]>>i&255,++n;return ab(t)}function Zc(e){for(var t="",n=0;n<arguments.length;n++)t=ea(arguments[n])?t+Zc.apply(null,arguments[n]):"object"==typeof arguments[n]?t+B(arguments[n]):t+arguments[n],t+=" ";return t}function ad(e,t){Kb(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?("undefined"!=typeof console&&("function"==typeof console.log?wc=r(console.log,console):"object"==typeof console.log&&(wc=function(e){console.log(e)})),t&&Yb.set("logging_enabled",!0)):ga(e)?wc=e:(wc=null,Yb.remove("logging_enabled"))}function E(e){!0===$c&&($c=!1,null===wc&&!0===Yb.get("logging_enabled")&&ad(!0));if(wc){var t=Zc.apply(null,arguments);wc(t)}}function bd(e){return function(){E(e,arguments)}}function cd(e){if("undefined"!=typeof console){var t="FIREBASE INTERNAL ERROR: "+Zc.apply(null,arguments);"undefined"!=typeof console.error?console.error(t):console.log(t)}}function dd(e){var t=Zc.apply(null,arguments);throw Error("FIREBASE FATAL ERROR: "+t)}function O(e){if("undefined"!=typeof console){var t="FIREBASE WARNING: "+Zc.apply(null,arguments);"undefined"!=typeof console.warn?console.warn(t):console.log(t)}}function ed(e){var t,n,r,i,s,o=e;s=n=e=t="",r=!0,i="https";if(q(o)){var u=o.indexOf("//");0<=u&&(i=o.substring(0,u-1),o=o.substring(u+2)),u=o.indexOf("/"),-1===u&&(u=o.length),t=o.substring(0,u),s="",o=o.substring(u).split("/");for(u=0;u<o.length;u++)if(0<o[u].length){var a=o[u];try{a=decodeURIComponent(a.replace(/\+/g," "))}catch(f){}s+="/"+a}o=t.split("."),3===o.length?(e=o[1],n=o[0].toLowerCase()):2===o.length&&(e=o[0]),u=t.indexOf(":"),0<=u&&(r="https"===i||"wss"===i)}return"firebase"===e&&dd(t+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),n&&"undefined"!=n||dd("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),r||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&O("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{kc:new fc(t,r,n,"ws"===i||"wss"===i),path:new L(s)}}function fd(e){return fa(e)&&(e!=e||e==Number.POSITIVE_INFINITY||e==Number.NEGATIVE_INFINITY)}function gd(e){if("complete"===document.readyState)e();else{var t=!1,n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}}function Lc(e,t){if(e===t)return 0;if("[MIN_NAME]"===e||"[MAX_NAME]"===t)return-1;if("[MIN_NAME]"===t||"[MAX_NAME]"===e)return 1;var n=hd(e),r=hd(t);return null!==n?null!==r?0==n-r?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1}function id(e,t){if(t&&e in t)return t[e];throw Error("Missing required key ("+e+") in object: "+B(t))}function jd(e){if("object"!=typeof e||null===e)return B(e);var t=[],n;for(n in e)t.push(n);t.sort(),n="{";for(var r=0;r<t.length;r++)0!==r&&(n+=","),n+=B(t[r]),n+=":",n+=jd(e[t[r]]);return n+"}"}function kd(e,t){if(e.length<=t)return[e];for(var n=[],r=0;r<e.length;r+=t)r+t>e?n.push(e.substring(r,e.length)):n.push(e.substring(r,r+t));return n}function ld(e,n){if(da(e))for(var r=0;r<e.length;++r)n(r,e[r]);else t(e,n)}function md(e){H(!fd(e),"Invalid JSON number");var t,n,r,i;0===e?(r=n=0,t=-Infinity===1/e?1:0):(t=0>e,e=Math.abs(e),e>=Math.pow(2,-1022)?(r=Math.min(Math.floor(Math.log(e)/Math.LN2),1023),n=r+1023,r=Math.round(e*Math.pow(2,52-r)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074)))),i=[];for(e=52;e;--e)i.push(r%2?1:0),r=Math.floor(r/2);for(e=11;e;--e)i.push(n%2?1:0),n=Math.floor(n/2);i.push(t?1:0),i.reverse(),t=i.join(""),n="";for(e=0;64>e;e+=8)r=parseInt(t.substr(e,8),2).toString(16),1===r.length&&(r="0"+r),n+=r;return n.toLowerCase()}function hd(e){return nd.test(e)&&(e=Number(e),-2147483648<=e&&2147483647>=e)?e:null}function Tb(e){try{e()}catch(t){setTimeout(function(){throw O("Exception was thrown by user callback.",t.stack||""),t},Math.floor(0))}}function od(e,t,n){Object.defineProperty(e,t,{get:n})}function pd(e){var t={};try{var n=e.split(".");Ob(Xc(n[0])||""),t=Ob(Xc(n[1])||""),delete t.d}catch(r){}return e=t,"object"==typeof e&&!0===x(e,"admin")}function rd(e,t,n,r){this.Zd=e,this.f=bd(this.Zd),this.frames=this.Ac=null,this.qb=this.rb=this.Ee=0,this.Xa=oc(t),e={v:"5"},"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf("firebaseio.com")&&(e.r="f"),n&&(e.s=n),r&&(e.ls=r),this.Le=hc(t,"websocket",e)}function vd(e,t){e.frames.push(t);if(e.frames.length==e.Ee){var n=e.frames.join("");e.frames=null,n=Ob(n),e.fg(n)}}function ud(e){clearInterval(e.Ac),e.Ac=setInterval(function(){e.La&&wd(e,"0"),ud(e)},Math.floor(45e3))}function wd(e,t){try{e.La.send(t)}catch(n){e.f("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(r(e.fb,e),0)}}function xd(e,t,n){this.f=bd("p:rest:"),this.M=e,this.Hb=t,this.Vd=n,this.$={}}function yd(e,t){return p(t)?"tag$"+t:(H(zd(e.n),"should have a tag if it's not a default query."),e.path.toString())}function Bd(e,t,n,r){n=n||{},n.format="export",e.Vd.getToken(!1).then(function(i){(i=i&&i.accessToken)&&(n.auth=i);var s=(e.M.Sc?"https://":"http://")+e.M.host+t+"?"+Fb(n);e.f("Sending REST request for "+s);var o=new XMLHttpRequest;o.onreadystatechange=function(){if(r&&4===o.readyState){e.f("REST Response for "+s+" received. status:",o.status,"response:",o.responseText);var t=null;if(200<=o.status&&300>o.status){try{t=Ob(o.responseText)}catch(n){O("Failed to parse JSON response for "+s+": "+o.responseText)}r(null,t)}else 401!==o.status&&404!==o.status&&O("Got unsuccessful REST response for "+s+" Status: "+o.status),r(o.status);r=null}},o.open("GET",s,!0),o.send()})}function Cd(e,t,n){this.type=Dd,this.source=e,this.path=t,this.children=n}function Ed(){this.hb={}}function Fd(e,t){var n=t.type,r=t.Za;H("child_added"==n||"child_changed"==n||"child_removed"==n,"Only child changes supported for tracking"),H(".priority"!==r,"Only non-priority child changes can be tracked.");var i=x(e.hb,r);if(i){var s=i.type;if("child_added"==n&&"child_removed"==s)e.hb[r]=new I("child_changed",t.Ma,r,i.Ma);else if("child_removed"==n&&"child_added"==s)delete e.hb[r];else if("child_removed"==n&&"child_changed"==s)e.hb[r]=new I("child_removed",i.pe,r);else if("child_changed"==n&&"child_added"==s)e.hb[r]=new I("child_added",t.Ma,r);else{if("child_changed"!=n||"child_changed"!=s)throw Wc("Illegal combination of changes: "+t+" occurred after "+i);e.hb[r]=new I("child_changed",t.Ma,r,i.pe)}}else e.hb[r]=t}function Gd(e){this.W=e,this.g=e.n.g}function Hd(e,t,n,r){var i=[],s=[];return Ja(t,function(t){"child_changed"===t.type&&e.g.nd(t.pe,t.Ma)&&s.push(new I("child_moved",t.Ma,t.Za))}),Id(e,i,"child_removed",t,r,n),Id(e,i,"child_added",t,r,n),Id(e,i,"child_moved",s,r,n),Id(e,i,"child_changed",t,r,n),Id(e,i,Gc,t,r,n),i}function Id(e,t,n,i,s,o){i=Ka(i,function(e){return e.type===n}),Sa(i,r(e.Mf,e)),Ja(i,function(n){var r=Jd(e,n,o);Ja(s,function(i){i.rf(n.type)&&t.push(i.createEvent(r,e.W))})})}function Jd(e,t,n){return"value"!==t.type&&"child_removed"!==t.type&&(t.Dd=n.Xe(t.Za,t.Ma,e.g)),t}function Kd(e,t){this.Sd=e,this.Kf=t}function Ld(e){this.V=e}function Td(e,t,n,r,i,s){var o=t.O;if(null!=r.mc(n))return t;var u;if(n.e())H(Hc(t.u()),"If change path is empty, we must have complete server data"),Ic(t.u())?(i=Ec(t),r=r.sc(i instanceof P?i:F)):r=r.Ba(Ec(t)),s=e.V.za(t.O.j(),r,s);else{var a=J(n);if(".priority"==a)H(1==Wd(n),"Can't have a priority with additional path components"),s=o.j(),u=t.u().j(),r=r.$c(n,s,u),s=null!=r?e.V.ga(s,r):o.j();else{var f=D(n);Cc(o,a)?(u=t.u().j(),r=r.$c(n,o.j(),u),r=null!=r?o.j().R(a).F(f,r):o.j().R(a)):r=r.rc(a,t.u()),s=null!=r?e.V.F(o.j(),a,r,f,i,s):o.j()}}return Rd(t,s,o.ea||n.e(),e.V.Qa())}function Nd(e,t,n,r,i,s,o,u){var a=t.u();o=o?e.V:e.V.Vb();if(n.e())r=o.za(a.j(),r,null);else if(o.Qa()&&!a.Tb)r=a.j().F(n,r),r=o.za(a.j(),r,null);else{var f=J(n);if(!Jc(a,n)&&1<Wd(n))return t;var l=D(n);r=a.j().R(f).F(l,r),r=".priority"==f?o.ga(a.j(),r):o.F(a.j(),f,r,l,Ac,null)}return a=a.ea||n.e(),t=new Ud(t.O,new Dc(r,a,o.Qa())),Td(e,t,n,i,new Bc(i,t,s),u)}function Md(e,t,n,r,i,s,o){var u=t.O;i=new Bc(i,t,s);if(n.e())o=e.V.za(t.O.j(),r,o),e=Rd(t,o,!0,e.V.Qa());else if(s=J(n),".priority"===s)o=e.V.ga(t.O.j(),r),e=Rd(t,o,u.ea,u.Tb);else{n=D(n);var a=u.j().R(s);if(!n.e()){var f=i.Ve(s);r=null!=f?".priority"===Xd(n)&&f.Q(n.parent()).e()?f:f.F(n,r):F}a.ca(r)?e=t:(o=e.V.F(u.j(),s,r,n,i,o),e=Rd(t,o,u.ea,e.V.Qa()))}return e}function Od(e,t,n,r,i,s,o){var u=t;return Yd(r,function(r,l){var p=n.m(r);Cc(t.O,J(p))&&(u=Md(e,u,p,l,i,s,o))}),Yd(r,function(r,l){var p=n.m(r);Cc(t.O,J(p))||(u=Md(e,u,p,l,i,s,o))}),u}function Zd(e,t){return Yd(t,function(t,n){e=e.F(t,n)}),e}function Pd(e,t,n,r,i,s,o,u){if(t.u().j().e()&&!Hc(t.u()))return t;var a=t;n=n.e()?r:$d(Q,n,r);var f=t.u().j();return n.children.ia(function(n,r){if(f.Fa(n)){var c=t.u().j().R(n),c=Zd(c,r);a=Nd(e,a,new L(n),c,i,s,o,u)}}),n.children.ia(function(n,r){var c=!Cc(t.u(),n)&&null==r.value;f.Fa(n)||c||(c=t.u().j().R(n),c=Zd(c,r),a=Nd(e,a,new L(n),c,i,s,o,u))}),a}function Sd(e,t,n,r,i,s,o){if(null!=i.mc(n))return t;var u=Ic(t.u()),a=t.u();if(null!=r.value){if(n.e()&&a.ea||Jc(a,n))return Nd(e,t,n,a.j().Q(n),i,s,u,o);if(n.e()){var f=Q;return a.j().P(ae,function(e,t){f=f.set(new L(e),t)}),Pd(e,t,n,f,i,s,u,o)}return t}return f=Q,Yd(r,function(e){var t=n.m(e);Jc(a,t)&&(f=f.set(e,a.j().Q(t)))}),Pd(e,t,n,f,i,s,u,o)}function be(e){this.g=e}function ce(e){this.he=new be(e.g),this.g=e.g;var t;e.ka?(t=de(e),t=e.g.Fc(ee(e),t)):t=e.g.Ic(),this.Uc=t,e.na?(t=fe(e),e=e.g.Fc(ge(e),t)):e=e.g.Gc(),this.wc=e}function he(e){this.sa=new ce(e),this.g=e.g,H(e.xa,"Only valid if limit has been set"),this.oa=e.oa,this.Jb=!ie(e)}function je(e,t,n,r,i,s){var o;if(e.Jb){var u=ke(e.g);o=function(e,t){return u(t,e)}}else o=ke(e.g);H(t.Fb()==e.oa,"");var a=new K(n,r),f=e.Jb?le(t,e.g):me(t,e.g),l=e.sa.matches(a);if(t.Fa(n)){for(var c=t.R(n),f=i.fe(e.g,f,e.Jb);null!=f&&(f.name==n||t.Fa(f.name));)f=i.fe(e.g,f,e.Jb);return i=null==f?1:o(f,a),l&&!r.e()&&0<=i?(null!=s&&Fd(s,new I("child_changed",r,n,c)),t.U(n,r)):(null!=s&&Fd(s,new I("child_removed",c,n)),t=t.U(n,F),null!=f&&e.sa.matches(f)?(null!=s&&Fd(s,new I("child_added",f.S,f.name)),t.U(f.name,f.S)):t)}return r.e()?t:l&&0<=o(f,a)?(null!=s&&(Fd(s,new I("child_removed",f.S,f.name)),Fd(s,new I("child_added",r,n))),t.U(n,r).U(f.name,F)):t}function Uc(e,t){this.B=e,H(p(this.B)&&null!==this.B,"LeafNode shouldn't be created with null/undefined value."),this.aa=t||F,ne(this.aa),this.Eb=null}function qe(){}function ke(e){return r(e.compare,e)}function te(e){H(!e.e()&&".priority"!==J(e),"Can't create PathIndex with empty path or .priority key"),this.cc=e}function ve(){}function we(){}function xe(){}function Ae(){this.Sb=this.na=this.Lb=this.ka=this.xa=!1,this.oa=0,this.oc="",this.ec=null,this.Ab="",this.bc=null,this.yb="",this.g=N}function ie(e){return""===e.oc?e.ka:"l"===e.oc}function ee(e){return H(e.ka,"Only valid if start has been set"),e.ec}function de(e){return H(e.ka,"Only valid if start has been set"),e.Lb?e.Ab:"[MIN_NAME]"}function ge(e){return H(e.na,"Only valid if end has been set"),e.bc}function fe(e){return H(e.na,"Only valid if end has been set"),e.Sb?e.yb:"[MAX_NAME]"}function Ce(e){var t=new Ae;return t.xa=e.xa,t.oa=e.oa,t.ka=e.ka,t.ec=e.ec,t.Lb=e.Lb,t.Ab=e.Ab,t.na=e.na,t.bc=e.bc,t.Sb=e.Sb,t.yb=e.yb,t.g=e.g,t}function De(e,t){var n=Ce(e);return n.g=t,n}function Ee(e){var t={};e.ka&&(t.sp=e.ec,e.Lb&&(t.sn=e.Ab)),e.na&&(t.ep=e.bc,e.Sb&&(t.en=e.yb));if(e.xa){t.l=e.oa;var n=e.oc;""===n&&(n=ie(e)?"l":"r"),t.vf=n}return e.g!==N&&(t.i=e.g.toString()),t}function S(e){return!(e.ka||e.na||e.xa)}function zd(e){return S(e)&&e.g==N}function Ad(e){var t={};if(zd(e))return t;var n;return e.g===N?n="$priority":e.g===ze?n="$value":e.g===ae?n="$key":(H(e.g instanceof te,"Unrecognized index type!"),n=e.g.toString()),t.orderBy=B(n),e.ka&&(t.startAt=B(e.ec),e.Lb&&(t.startAt+=","+B(e.Ab))),e.na&&(t.endAt=B(e.bc),e.Sb&&(t.endAt+=","+B(e.yb))),e.xa&&(ie(e)?t.limitToFirst=e.oa:t.limitToLast=e.oa),t}function Fe(e,t){this.od=e,this.dc=t}function Ge(e,t,n){var r=oa(e.od,function(r,i){var s=x(e.dc,i);H(s,"Missing index implementation for "+i);if(r===re){if(s.yc(t.S)){for(var o=[],u=n.Xb(Nc),f=R(u);f;)f.name!=t.name&&o.push(f),f=R(u);return o.push(t),He(o,ke(s))}return re}return s=n.get(t.name),o=r,s&&(o=o.remove(new K(t.name,s))),o.Ra(t,t.S)});return new Fe(r,e.dc)}function Ie(e,t,n){var r=oa(e.od,function(e){if(e===re)return e;var r=n.get(t.name);return r?e.remove(new K(t.name,r)):e});return new Fe(r,e.dc)}function Ke(){this.set={}}function Le(e,n){t(e.set,function(e,t){n(t,e)})}function Me(e,t,n,r){this.Zd=e,this.f=bd(e),this.kc=t,this.qb=this.rb=0,this.Xa=oc(t),this.zf=n,this.xc=!1,this.Db=r,this.Yc=function(e){return hc(t,"long_polling",e)}}function Qe(e,t){var n=B(t).length;e.qb+=n,lc(e.Xa,"bytes_received",n)}function Pe(e,t,n,r){this.Yc=r,this.kb=n,this.ue=new Ke,this.Qc=[],this.$d=Math.floor(1e8*Math.random()),this.Kd=!0,this.Qd=Vc(),window["pLPCommand"+this.Qd]=e,window["pRTLPCB"+this.Qd]=t,e=document.createElement("iframe"),e.style.display="none";if(!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||E("No IE domain setting required")}catch(i){e.src="javascript:void((function(){document.open();document.domain='"+document.domain+"';document.close();})())"}e.contentDocument?e.ib=e.contentDocument:e.contentWindow?e.ib=e.contentWindow.document:e.document&&(e.ib=e.document),this.Ga=e,e="",this.Ga.src&&"javascript:"===this.Ga.src.substr(0,11)&&(e='<script>document.domain="'+document.domain+'";</script>'),e="<html><body>"+e+"</body></html>";try{this.Ga.ib.open(),this.Ga.ib.write(e),this.Ga.ib.close()}catch(s){E("frame writing exception"),s.stack&&E(s.stack),E(s)}}function Se(e){if(e.Ud&&e.Kd&&e.ue.count()<(0<e.Qc.length?2:1)){e.$d++;var t={};t.id=e.dg,t.pw=e.eg,t.ser=e.$d;for(var t=e.Yc(t),n="",r=0;0<e.Qc.length;){if(!(1870>=e.Qc[0].Qe.length+30+n.length))break;var i=e.Qc.shift(),n=n+"&seg"+r+"="+i.sg+"&ts"+r+"="+i.yg+"&d"+r+"="+i.Qe;r++}return Te(e,t+n,e.$d),!0}return!1}function Te(e,t,n){function r(){e.ue.remove(n),Se(e)}e.ue.add(n,1);var i=setTimeout(r,Math.floor(25e3));Re(e,t,function(){clearTimeout(i),r()})}function Re(e,t,n){setTimeout(function(){try{if(e.Kd){var r=e.Ga.ib.createElement("script");r.type="text/javascript",r.async=!0,r.src=t,r.onload=r.onreadystatechange=function(){var e=r.readyState;e&&"loaded"!==e&&"complete"!==e||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=function(){E("Long-poll script failed to load: "+t),e.Kd=!1,e.close()},e.Ga.ib.body.appendChild(r)}}catch(i){}},Math.floor(1))}function Ue(e){Ve(this,e)}function Ve(e,t){var n=rd&&rd.isAvailable(),r=n&&!Xb.af&&!0!==Xb.get("previous_websocket_failure");t.zg&&(n||O("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0);if(r)e.Wc=[rd];else{var i=e.Wc=[];ld(We,function(e,t){t&&t.isAvailable()&&i.push(t)})}}function Xe(e){if(0<e.Wc.length)return e.Wc[0];throw Error("No transports available")}function Ye(e,t,n,r,i,s,o){this.id=e,this.f=bd("c:"+this.id+":"),this.se=n,this.Mc=r,this.ja=i,this.re=s,this.M=t,this.Ad=[],this.Me=0,this.yf=new Ue(t),this.L=0,this.Db=o,this.f("Connection created"),Ze(this)}function Ze(e){var t=Xe(e.yf);e.I=new t("c:"+e.id+":"+e.Me++,e.M,void 0,e.Db),e.we=t.responsesRequiredToBeHealthy||0;var n=$e(e,e.I),r=af(e,e.I);e.Xc=e.I,e.Rc=e.I,e.D=null,e.Cb=!1,setTimeout(function(){e.I&&e.I.open(n,r)},Math.floor(0)),t=t.healthyTimeout||0,0<t&&(e.md=setTimeout(function(){e.md=null,e.Cb||(e.I&&102400<e.I.qb?(e.f("Connection exceeded healthy timeout but has received "+e.I.qb+" bytes.  Marking connection healthy."),e.Cb=!0,e.I.sd()):e.I&&10240<e.I.rb?e.f("Connection exceeded healthy timeout but has sent "+e.I.rb+" bytes.  Leaving connection alive."):(e.f("Closing unhealthy connection after timeout."),e.close()))},Math.floor(t)))}function af(e,t){return function(n){t===e.I?(e.I=null,n||0!==e.L?1===e.L&&e.f("Realtime connection lost."):(e.f("Realtime connection failed."),"s-"===e.M.bb.substr(0,2)&&(Xb.remove("host:"+e.M.host),e.M.bb=e.M.host)),e.close()):t===e.D?(e.f("Secondary connection lost."),n=e.D,e.D=null,e.Xc!==n&&e.Rc!==n||e.close()):e.f("closing an old connection")}}function $e(e,t){return function(n){if(2!=e.L)if(t===e.Rc){var r=id("t",n);n=id("d",n);if("c"==r){if(r=id("t",n),"d"in n)if(n=n.d,"h"===r){var r=n.ts,i=n.v,s=n.h;e.wf=n.s,gc(e.M,s),0==e.L&&(e.I.start(),bf(e,e.I,r),"5"!==i&&O("Protocol version mismatch detected"),n=e.yf,(n=1<n.Wc.length?n.Wc[1]:null)&&cf(e,n))}else if("n"===r){e.f("recvd end transmission on primary"),e.Rc=e.D;for(n=0;n<e.Ad.length;++n)e.wd(e.Ad[n]);e.Ad=[],df(e)}else"s"===r?(e.f("Connection shutdown command received. Shutting down..."),e.re&&(e.re(n),e.re=null),e.ja=null,e.close()):"r"===r?(e.f("Reset packet received.  New host: "+n),gc(e.M,n),1===e.L?e.close():(ef(e),Ze(e))):"e"===r?cd("Server Error: "+n):"o"===r?(e.f("got pong on primary."),ff(e),gf(e)):cd("Unknown control packet command: "+r)}else"d"==r&&e.wd(n)}else if(t===e.D)if(r=id("t",n),n=id("d",n),"c"==r)"t"in n&&(n=n.t,"a"===n?hf(e):"r"===n?(e.f("Got a reset on secondary, closing it"),e.D.close(),e.Xc!==e.D&&e.Rc!==e.D||e.close()):"o"===n&&(e.f("got pong on secondary."),e.uf--,hf(e)));else{if("d"!=r)throw Error("Unknown protocol layer: "+r);e.Ad.push(n)}else e.f("message on old connection")}}function df(e){e.Xc===e.D&&e.Rc===e.D&&(e.f("cleaning up and promoting a connection: "+e.D.Zd),e.I=e.D,e.D=null)}function hf(e){0>=e.uf?(e.f("Secondary connection is healthy."),e.Cb=!0,e.D.sd(),e.D.start(),e.f("sending client ack on secondary"),e.D.send({t:"c",d:{t:"a",d:{}}}),e.f("Ending transmission on primary"),e.I.send({t:"c",d:{t:"n",d:{}}}),e.Xc=e.D,df(e)):(e.f("sending ping on secondary."),e.D.send({t:"c",d:{t:"p",d:{}}}))}function ff(e){e.Cb||(e.we--,0>=e.we&&(e.f("Primary connection is healthy."),e.Cb=!0,e.I.sd()))}function cf(e,t){e.D=new t("c:"+e.id+":"+e.Me++,e.M,e.wf),e.uf=t.responsesRequiredToBeHealthy||0,e.D.open($e(e,e.D),af(e,e.D)),setTimeout(function(){e.D&&(e.f("Timed out trying to upgrade."),e.D.close())},Math.floor(6e4))}function bf(e,t,n){e.f("Realtime connection established."),e.I=t,e.L=1,e.Mc&&(e.Mc(n,e.wf),e.Mc=null),0===e.we?(e.f("Primary connection is healthy."),e.Cb=!0):setTimeout(function(){gf(e)},Math.floor(5e3))}function gf(e){e.Cb||1!==e.L||(e.f("sending ping on primary."),jf(e,{t:"c",d:{t:"p",d:{}}}))}function jf(e,t){if(1!==e.L)throw"Connection is not connected";e.Xc.send(t)}function ef(e){e.f("Shutting down all connections"),e.I&&(e.I.close(),e.I=null),e.D&&(e.D.close(),e.D=null),e.md&&(clearTimeout(e.md),e.md=null)}function L(e,t){if(1==arguments.length){this.o=e.split("/");for(var n=0,r=0;r<this.o.length;r++)0<this.o[r].length&&(this.o[n]=this.o[r],n++);this.o.length=n,this.Z=0}else this.o=e,this.Z=t}function T(e,t){var n=J(e);if(null===n)return t;if(n===J(t))return T(D(e),D(t));throw Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function kf(e,t){for(var n=e.slice(),r=t.slice(),i=0;i<n.length&&i<r.length;i++){var s=Lc(n[i],r[i]);if(0!==s)return s}return n.length===r.length?0:n.length<r.length?-1:1}function J(e){return e.Z>=e.o.length?null:e.o[e.Z]}function Wd(e){return e.o.length-e.Z}function D(e){var t=e.Z;return t<e.o.length&&t++,new L(e.o,t)}function Xd(e){return e.Z<e.o.length?e.o[e.o.length-1]:null}function lf(e,t){this.Ta=e.slice(),this.Ka=Math.max(1,this.Ta.length),this.Re=t;for(var n=0;n<this.Ta.length;n++)this.Ka+=Nb(this.Ta[n]);mf(this)}function mf(e){if(768<e.Ka)throw Error(e.Re+"has a key path longer than 768 bytes ("+e.Ka+").");if(32<e.Ta.length)throw Error(e.Re+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+nf(e))}function nf(e){return 0==e.Ta.length?"":"in property '"+e.Ta.join(".")+"'"}function of(e){e instanceof pf||dd("Don't call new Database() directly - please use firebase.database()."),this.ta=e,this.ba=new U(e,C),this.INTERNAL=new qf(this)}function sf(e,t){null===e.ta&&dd("Cannot call "+t+" on a deleted database.")}function qf(e){this.$a=e}function Qc(){this.k=this.B=null}function Sc(e,t,n){if(t.e())e.B=n,e.k=null;else if(null!==e.B)e.B=e.B.F(t,n);else{null==e.k&&(e.k=new Ke);var r=J(t);e.k.contains(r)||e.k.add(r,new Qc),e=e.k.get(r),t=D(t),Sc(e,t,n)}}function vf(e,t){if(t.e())return e.B=null,e.k=null,!0;if(null!==e.B){if(e.B.J())return!1;var n=e.B;return e.B=null,n.P(N,function(t,n){Sc(e,new L(t),n)}),vf(e,t)}return null!==e.k?(n=J(t),t=D(t),e.k.contains(n)&&vf(e.k.get(n),t)&&e.k.remove(n),e.k.e()?(e.k=null,!0):!1):!0}function Rc(e,t,n){null!==e.B?n(t,e.B):e.P(function(e,r){var i=new L(t.toString()+"/"+e);Rc(r,i,n)})}function yf(e){return q(e)&&0!==e.length&&!wf.test(e)}function zf(e){return null===e||q(e)||fa(e)&&!fd(e)||ha(e)&&Bb(e,".sv")}function Af(e,t,n,r){r&&!p(t)||Bf(Db(e,1,r),t,n)}function Bf(e,t,n){n instanceof L&&(n=new lf(n,e));if(!p(t))throw Error(e+"contains undefined "+nf(n));if(ga(t))throw Error(e+"contains a function "+nf(n)+" with contents: "+t.toString());if(fd(t))throw Error(e+"contains "+t.toString()+" "+nf(n));if(q(t)&&t.length>10485760/3&&10485760<Nb(t))throw Error(e+"contains a string greater than 10485760 utf8 bytes "+nf(n)+" ('"+t.substring(0,50)+"...')");if(ha(t)){var r=!1,i=!1;Cb(t,function(t,s){if(".value"===t)r=!0;else if(".priority"!==t&&".sv"!==t&&(i=!0,!yf(t)))throw Error(e+" contains an invalid key ("+t+") "+nf(n)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');n.push(t),Bf(e,s,n),n.pop()});if(r&&i)throw Error(e+' contains ".value" child '+nf(n)+" in addition to actual children.")}}function Cf(e,t){var n,r;for(n=0;n<t.length;n++){r=t[n];for(var i=r.slice(),s=0;s<i.length;s++)if((".priority"!==i[s]||s!==i.length-1)&&!yf(i[s]))throw Error(e+"contains an invalid key ("+i[s]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}t.sort(kf),i=null;for(n=0;n<t.length;n++){r=t[n];if(null!==i&&i.contains(r))throw Error(e+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}function Df(e,t,n){var r=Db(e,1,!1);if(!ha(t)||da(t))throw Error(r+" must be an object containing the children to replace.");var i=[];Cb(t,function(e,t){var s=new L(e);Bf(r,t,n.m(s));if(".priority"===Xd(s)&&!zf(t))throw Error(r+"contains an invalid value for '"+s.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");i.push(s)}),Cf(r,i)}function Ef(e,t,n){if(fd(n))throw Error(Db(e,t,!1)+"is "+n.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!zf(n))throw Error(Db(e,t,!1)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}function Ff(e,t,n){if(!n||p(t))switch(t){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw Error(Db(e,1,n)+'must be a valid event type: "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}function Gf(e,t){if(p(t)&&!yf(t))throw Error(Db(e,2,!0)+'was an invalid key: "'+t+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')}function Hf(e,t){if(!q(t)||0===t.length||xf.test(t))throw Error(Db(e,1,!1)+'was an invalid path: "'+t+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')}function If(e,t){if(".info"===J(t))throw Error(e+" failed: Can't modify data under /.info/")}function tf(e,t){var n=t.path.toString(),r;!(r=!q(t.kc.host)||0===t.kc.host.length||!yf(t.kc.oe))&&(r=0!==n.length)&&(n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),r=!q(n)||0===n.length||!!xf.test(n));if(r)throw Error(Db(e,1,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')}function V(e,t){this.ta=e,this.qa=t}function Mf(e){H(da(e)&&0<e.length,"Requires a non-empty array"),this.If=e,this.Ec={}}function Nf(e,t){H(Oa(e.If,function(e){return e===t}),"Unknown event: "+t)}function Of(){Mf.call(this,["online"]),this.ic=!0;if("undefined"!=typeof window&&"undefined"!=typeof window.addEventListener){var e=this;window.addEventListener("online",function(){e.ic||(e.ic=!0,e.Fe("online",!0))},!1),window.addEventListener("offline",function(){e.ic&&(e.ic=!1,e.Fe("online",!1))},!1)}}function Pf(){Mf.call(this,["visible"]);var e,t;"undefined"!=typeof document&&"undefined"!=typeof document.addEventListener&&("undefined"!=typeof document.hidden?(t="visibilitychange",e="hidden"):"undefined"!=typeof document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):"undefined"!=typeof document.msHidden?(t="msvisibilitychange",e="msHidden"):"undefined"!=typeof document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.Nb=!0;if(t){var n=this;document.addEventListener(t,function(){var t=!document[e];t!==n.Nb&&(n.Nb=t,n.Fe("visible",t))},!1)}}function Rf(e,t){this.Oa=e,this.ba=t?t:Sf}function Tf(e,t){for(var n,r=e.ba,i=null;!r.e();){n=e.Oa(t,r.key);if(0===n){if(r.left.e())return i?i.key:null;for(r=r.left;!r.right.e();)r=r.right;return r.key}0>n?r=r.left:0<n&&(i=r,r=r.right)}throw Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}function Uf(e,t,n,r,i){this.Hd=i||null,this.ke=r,this.Sa=[];for(i=1;!e.e();)if(i=t?n(e.key,t):1,r&&(i*=-1),0>i)e=this.ke?e.left:e.right;else{if(0===i){this.Sa.push(e);break}this.Sa.push(e),e=this.ke?e.right:e.left}}function R(e){if(0===e.Sa.length)return null;var t=e.Sa.pop(),n;n=e.Hd?e.Hd(t.key,t.value):{key:t.key,value:t.value};if(e.ke)for(t=t.left;!t.e();)e.Sa.push(t),t=t.right;else for(t=t.right;!t.e();)e.Sa.push(t),t=t.left;return n}function Vf(e){if(0===e.Sa.length)return null;var t;return t=e.Sa,t=t[t.length-1],e.Hd?e.Hd(t.key,t.value):{key:t.key,value:t.value}}function Wf(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:!0,this.left=null!=r?r:Sf,this.right=null!=i?i:Sf}function Xf(e){return e.left.e()?e:Xf(e.left)}function Zf(e){return e.left.e()?Sf:(e.left.fa()||e.left.left.fa()||(e=$f(e)),e=e.Y(null,null,null,Zf(e.left),null),Yf(e))}function Yf(e){return e.right.fa()&&!e.left.fa()&&(e=cg(e)),e.left.fa()&&e.left.left.fa()&&(e=ag(e)),e.left.fa()&&e.right.fa()&&(e=bg(e)),e}function $f(e){return e=bg(e),e.right.left.fa()&&(e=e.Y(null,null,null,null,ag(e.right)),e=cg(e),e=bg(e)),e}function cg(e){return e.right.Y(null,null,e.color,e.Y(null,null,!0,null,e.right.left),null)}function ag(e){return e.left.Y(null,null,e.color,null,e.Y(null,null,!0,e.left.right,null))}function bg(e){return e.Y(null,null,!e.color,e.left.Y(null,null,!e.left.color,null,null),e.right.Y(null,null,!e.right.color,null,null))}function dg(){}function P(e,t,n){this.k=e,(this.aa=t)&&ne(this.aa),e.e()&&H(!this.aa||this.aa.e(),"An empty node cannot have a priority"),this.zb=n,this.Eb=null}function le(e,t){var n;return n=(n=fg(e,t))?(n=n.Hc())&&n.name:e.k.Hc(),n?new K(n,e.k.get(n)):null}function me(e,t){var n;return n=(n=fg(e,t))?(n=n.fc())&&n.name:e.k.fc(),n?new K(n,e.k.get(n)):null}function fg(e,t){return t===ae?null:e.zb.get(t.toString())}function M(e,n){if(null===e)return F;var r=null;"object"==typeof e&&".priority"in e?r=e[".priority"]:"undefined"!=typeof n&&(r=n),H(null===r||"string"==typeof r||"number"==typeof r||"object"==typeof r&&".sv"in r,"Invalid priority type found: "+typeof r),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]);if("object"!=typeof e||".sv"in e)return new Uc(e,M(r));if(e instanceof Array){var i=F,s=e;return t(s,function(e,t){if(Bb(s,t)&&"."!==t.substring(0,1)){var n=M(e);if(n.J()||!n.e())i=i.U(t,n)}}),i.ga(M(r))}var o=[],u=!1,a=e;Cb(a,function(e){if("string"!=typeof e||"."!==e.substring(0,1)){var t=M(a[e]);t.e()||(u=u||!t.C().e(),o.push(new K(e,t)))}});if(0==o.length)return F;var f=He(o,Kc,function(e){return e.name},Mc);if(u){var l=He(o,ke(N));return new P(f,M(r),new Fe({".priority":l},{".priority":N}))}return new P(f,M(r),Je)}function hg(e){this.count=parseInt(Math.log(e+1)/gg,10),this.Pe=this.count-1,this.Jf=e+1&parseInt(Array(this.count+1).join("1"),2)}function ig(e){var t=!(e.Jf&1<<e.Pe);return e.Pe--,t}function He(e,t,n,r){function i(t,r){var s=r-t;if(0==s)return null;if(1==s){var o=e[t],u=n?n(o):o;return new Wf(u,o.S,!1,null,null)}var o=parseInt(s/2,10)+t,s=i(t,o),f=i(o+1,r),o=e[o],u=n?n(o):o;return new Wf(u,o.S,!1,s,f)}e.sort(t);var s=function(t){function r(t,r){var f=u-t,l=u;u-=t;var l=i(f+1,l),f=e[f],h=n?n(f):f,l=new Wf(h,f.S,r,null,l);s?s.left=l:o=l,s=l}for(var s=null,o=null,u=e.length,f=0;f<t.count;++f){var l=ig(t),h=Math.pow(2,t.count-(f+1));l?r(h,!1):(r(h,!1),r(h,!0))}return o}(new hg(e.length));return null!==s?new Rf(r||t,s):new Rf(r||t)}function pe(e){return"number"==typeof e?"number:"+md(e):"string:"+e}function ne(e){if(e.J()){var t=e.H();H("string"==typeof t||"number"==typeof t||"object"==typeof t&&Bb(t,".sv"),"Priority must be a string or number.")}else H(e===ue||e.e(),"priority of unexpected type.");H(e===ue||e.C().e(),"Priority nodes can't have a priority of their own.")}function jg(){P.call(this,new Rf(Mc),F,Je)}function W(e,t,n){this.A=e,this.W=t,this.g=n}function Ud(e,t){this.O=e,this.Ld=t}function Rd(e,t,n,r){return new Ud(new Dc(t,n,r),e.Ld)}function Vd(e){return e.O.ea?e.O.j():null}function Ec(e){return e.Ld.ea?e.Ld.j():null}function kg(e,t){this.W=e;var n=e.n,r=new be(n.g),n=S(n)?new be(n.g):n.xa?new he(n):new ce(n);this.mf=new Ld(n);var i=t.u(),s=t.O,o=r.za(F,i.j(),null),u=n.za(F,s.j(),null);this.Na=new Ud(new Dc(u,s.ea,n.Qa()),new Dc(o,i.ea,r.Qa())),this.ab=[],this.Qf=new Gd(e)}function lg(e){return e.W}function ng(e,t){var n=e.Na.O,r=[];return n.j().J()||n.j().P(N,function(e,t){r.push(new I("child_added",t,e))}),n.ea&&r.push(Fc(n.j())),mg(e,r,n.j(),t)}function mg(e,t,n,r){return Hd(e.Qf,t,n,r?[r]:e.ab)}function og(e,t,n){this.Qb=e,this.sb=t,this.ub=n||null}function pg(e,t,n){this.ha=e,this.sb=t,this.ub=n}function X(e,t,n,r){this.w=e,this.path=t,this.n=n,this.Oc=r}function qg(e){var t=null,n=null;e.ka&&(t=ee(e)),e.na&&(n=ge(e));if(e.g===ae){if(e.ka){if("[MIN_NAME]"!=de(e))throw Error("Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().");if("string"!=typeof t)throw Error("Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.")}if(e.na){if("[MAX_NAME]"!=fe(e))throw Error("Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().");if("string"!=typeof n)throw Error("Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.")}}else if(e.g===N){if(null!=t&&!zf(t)||null!=n&&!zf(n))throw Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(H(e.g instanceof te||e.g===ze,"unknown index type."),null!=t&&"object"==typeof t||null!=n&&"object"==typeof n)throw Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")}function rg(e){if(e.ka&&e.na&&e.xa&&(!e.xa||""===e.oc))throw Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")}function sg(e,t){if(!0===e.Oc)throw Error(t+": You can't combine multiple orderBy calls.")}function tg(e,t,n){var r={cancel:null,Pa:null};if(t&&n)r.cancel=t,A(e,3,r.cancel,!0),r.Pa=n,Eb(e,4,r.Pa);else if(t)if("object"==typeof t&&null!==t)r.Pa=t;else{if("function"!=typeof t)throw Error(Db(e,3,!0)+" must either be a cancel callback or a context object.");r.cancel=t}return r}function vg(e,t){this.value=e,this.children=t||wg}function xg(e){var n=Q;return t(e,function(e,t){n=n.set(new L(t),e)}),n}function yg(e,t,n){if(null!=e.value&&n(e.value))return{path:C,value:e.value};if(t.e())return null;var r=J(t);return e=e.children.get(r),null!==e?(t=yg(e,D(t),n),null!=t?{path:(new L(r)).m(t.path),value:t.value}:null):null}function zg(e,t){return yg(e,t,function(){return!0})}function $d(e,t,n){if(t.e())return n;var r=J(t);return t=$d(e.children.get(r)||Q,D(t),n),r=t.e()?e.children.remove(r):e.children.Ra(r,t),new vg(e.value,r)}function Ag(e,t){return Bg(e,C,t)}function Bg(e,t,n){var r={};return e.children.ia(function(e,i){r[e]=Bg(i,t.m(e),n)}),n(t,e.value,r)}function Cg(e,t,n){return Dg(e,t,C,n)}function Dg(e,t,n,r){var i=e.value?r(n,e.value):!1;return i?i:t.e()?null:(i=J(t),(e=e.children.get(i))?Dg(e,D(t),n.m(i),r):null)}function Eg(e,t,n){Fg(e,t,C,n)}function Fg(e,t,n,r){if(t.e())return e;e.value&&r(n,e.value);var i=J(t);return(e=e.children.get(i))?Fg(e,D(t),n.m(i),r):Q}function Yd(e,t){Gg(e,C,t)}function Gg(e,t,n){e.children.ia(function(e,r){Gg(r,t.m(e),n)}),e.value&&n(t,e.value)}function Hg(e,t){e.children.ia(function(e,n){n.value&&t(e,n.value)})}function Ig(e,t,n){this.type=Qd,this.source=Jg,this.path=e,this.Pb=t,this.Id=n}function Kg(e,t,n,r){this.ee=e,this.Ue=t,this.Ib=n,this.De=r,H(!r||t,"Tagged queries must be from server.")}function Mg(e){this.X=e}function Og(e,t,n){if(t.e())return new Mg(new vg(n));var r=zg(e.X,t);if(null!=r){var i=r.path,r=r.value;return t=T(i,t),r=r.F(t,n),new Mg(e.X.set(i,r))}return e=$d(e.X,t,new vg(n)),new Mg(e)}function Pg(e,t,n){var r=e;return Cb(n,function(e,n){r=Og(r,t.m(e),n)}),r}function Qg(e,t){var n=zg(e.X,t);return null!=n?e.X.get(n.path).Q(T(n.path,t)):null}function Rg(e){var t=[],n=e.X.value;return null!=n?n.J()||n.P(N,function(e,n){t.push(new K(e,n))}):e.X.children.ia(function(e,n){null!=n.value&&t.push(new K(e,n.value))}),t}function Sg(e,t){if(t.e())return e;var n=Qg(e,t);return null!=n?new Mg(new vg(n)):new Mg(e.X.subtree(t))}function Tg(e,t,n){if(null!=t.value)return n.F(e,t.value);var r=null;return t.children.ia(function(t,i){".priority"===t?(H(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=Tg(e.m(t),i,n)}),n.Q(e).e()||null===r||(n=n.F(e.m(".priority"),r)),n}function Ug(){this.Aa={}}function Wg(e){return Ka(sa(e.Aa),function(e){return!S(e.W.n)})}function Xg(e,t){if(S(t.n))return Vg(e);var n=t.ya();return x(e.Aa,n)}function Vg(e){return wa(e.Aa,function(e){return S(e.W.n)})||null}function Yg(){this.T=Ng,this.la=[],this.Cc=-1}function Zg(e,t){for(var n=0;n<e.la.length;n++){var r=e.la[n];if(r.Zc===t)return r}return null}function $g(e,t){return e.Ja?e.path.contains(t):!!va(e.children,function(n,r){return e.path.m(r).contains(t)})}function bh(e){return e.visible}function ah(e,t,n){for(var r=Ng,i=0;i<e.length;++i){var s=e[i];if(t(s)){var o=s.path;if(s.Ja)n.contains(o)?(o=T(n,o),r=Og(r,o,s.Ja)):o.contains(n)&&(o=T(o,n),r=Og(r,C,s.Ja.Q(o)));else{if(!s.children)throw Wc("WriteRecord should have .snap or .children");if(n.contains(o))o=T(n,o),r=Pg(r,o,s.children);else if(o.contains(n))if(o=T(o,n),o.e())r=Pg(r,C,s.children);else if(s=x(s.children,J(o)))s=s.Q(D(o)),r=Og(r,C,s)}}}return r}function ch(e,t){this.Mb=e,this.X=t}function dh(){this.children={},this.ad=0,this.value=null}function eh(e,t,n){this.ud=e?e:"",this.Ha=t?t:null,this.A=n?n:new dh}function fh(e,t){for(var n=t instanceof L?t:new L(t),r=e,i;null!==(i=J(n));)r=new eh(i,r,x(r.A.children,i)||new dh),n=D(n);return r}function gh(e,t){H("undefined"!=typeof t,"Cannot set value to undefined"),e.A.value=t,hh(e)}function ih(e,t,n,r){n&&!r&&t(e),e.P(function(e){ih(e,t,!0,r)}),n&&r&&t(e)}function jh(e,t){for(var n=e.parent();null!==n&&!t(n);)n=n.parent()}function hh(e){if(null!==e.Ha){var t=e.Ha,n=e.ud,r=e.e(),i=Bb(t.A.children,n);r&&i?(delete t.A.children[n],t.A.ad--,hh(t)):r||i||(t.A.children[n]=e.A,t.A.ad++,hh(t))}}function kh(e,t,n,r,i,s){this.id=lh++,this.f=bd("p:"+this.id+":"),this.qd={},this.$={},this.pa=[],this.Pc=0,this.Lc=[],this.ma=!1,this.Va=1e3,this.td=3e5,this.Hb=t,this.Kc=n,this.te=r,this.M=e,this.pb=this.Ia=this.Db=this.ye=null,this.Vd=i,this.de=!1;if(s)throw Error("Auth override specified in options, but not supported on non Node.js platforms");this.Ie=s||null,this.vb=null,this.Nb=!1,this.Gd={},this.rg=0,this.Te=!0,this.Bc=this.le=null,mh(this,0),Pf.Wb().hc("visible",this.hg,this),-1===e.host.indexOf("fblocal")&&Of.Wb().hc("online",this.gg,this)}function oh(e,t){var n=t.ng,r=n.path.toString(),i=n.ya();e.f("Listen on "+r+" for "+i);var s={p:r};t.tag&&(s.q=Ee(n.n),s.t=t.tag),s.h=t.ld(),e.ua("q",s,function(s){var o=s.d,u=s.s;if(o&&"object"==typeof o&&Bb(o,"w")){var f=x(o,"w");da(f)&&0<=Ia(f,"no_index")&&O("Using an unspecified index. Consider adding "+('".indexOn": "'+n.n.g.toString()+'"')+" at "+n.path.toString()+" to your security rules for better performance")}(e.$[r]&&e.$[r][i])===t&&(e.f("listen response",s),"ok"!==u&&ph(e,r,i),t.G&&t.G(u,o))})}function qh(e){if(e.ma&&e.pb){var t=e.pb,n={cred:t};e.Ie&&(n.authvar=e.Ie),e.ua("auth",n,function(n){var r=n.s;n=n.d||"error","ok"!==r&&e.pb===t&&rh(e,r,n)})}}function sh(e,t,n,r,i){n={p:n,d:r},e.f("onDisconnect "+t,n),e.ua(t,n,function(e){i&&setTimeout(function(){i(e.s,e.d)},Math.floor(0))})}function th(e,t,n,r,i,s){r={p:n,d:r},p(s)&&(r.h=s),e.pa.push({action:t,qf:r,G:i}),e.Pc++,t=e.pa.length-1,e.ma?uh(e,t):e.f("Buffering put: "+n)}function uh(e,t){var n=e.pa[t].action,r=e.pa[t].qf,i=e.pa[t].G;e.pa[t].og=e.ma,e.ua(n,r,function(r){e.f(n+" response",r),delete e.pa[t],e.Pc--,0===e.Pc&&(e.pa=[]),i&&i(r.s,r.d)})}function mh(e,t){H(!e.Ia,"Scheduling a connect when we're already connected/ing?"),e.vb&&clearTimeout(e.vb),e.vb=setTimeout(function(){e.vb=null,xh(e)},Math.floor(t))}function xh(e){if(yh(e)){e.f("Making a connection attempt"),e.le=(new Date).getTime(),e.Bc=null;var t=r(e.wd,e),n=r(e.Mc,e),i=r(e.gf,e),s=e.id+":"+nh++,o=e.Db,u=!1,a=null,f=function(){a?a.close():(u=!0,i())};e.Ia={close:f,ua:function(e){H(a,"sendRequest call when we're not connected not allowed."),a.ua(e)}};var l=e.de;e.de=!1,e.Vd.getToken(l).then(function(r){u?E("getToken() completed but was canceled"):(E("getToken() completed. Creating connection."),e.pb=r&&r.accessToken,a=new Ye(s,e.M,t,n,i,function(t){O(t+" ("+e.M.toString()+")"),e.eb("server_kill")},o))}).then(null,function(t){e.f("Failed to get token: "+t),u||f()})}}function vh(e,t,n){n=n?La(n,function(e){return jd(e)}).join("$"):"default",(e=ph(e,t,n))&&e.G&&e.G("permission_denied")}function ph(e,t,n){t=(new L(t)).toString();var r;return p(e.$[t])?(r=e.$[t][n],delete e.$[t][n],0===qa(e.$[t])&&delete e.$[t]):r=void 0,r}function rh(e,t,n){E("Auth token revoked: "+t+"/"+n),e.pb=null,e.de=!0,e.Ia.close(),"invalid_token"===t&&(e.Va=3e4,O("Provided authentication credentials are invalid. This usually indicates your FirebaseApp instance was not initialized correctly. Make sure your apiKey and databaseURL match the values provided for your app at https://console.firebase.google.com/, or if you're using a service account, make sure it's authorized to access the specified databaseURL and is from the correct project."))}function wh(e){qh(e),t(e.$,function(n){t(n,function(t){oh(e,t)})});for(var n=0;n<e.pa.length;n++)e.pa[n]&&uh(e,n);for(;e.Lc.length;)n=e.Lc.shift(),sh(e,n.action,n.ve,n.data,n.G)}function yh(e){var t;return t=Of.Wb().ic,xa(e.qd)&&t}function zh(e){this.wa=Q,this.lb=new Yg,this.Ce={},this.jc={},this.Dc=e}function Ah(e,t,n,r,i){var s=e.lb,o=i;return H(r>s.Cc,"Stacking an older write on top of newer ones"),p(o)||(o=!0),s.la.push({path:t,Ja:n,Zc:r,visible:o}),o&&(s.T=Og(s.T,t,n)),s.Cc=r,i?Bh(e,new Zb(Jg,t,n)):[]}function Ch(e,t,n,r){var i=e.lb;return H(r>i.Cc,"Stacking an older merge on top of newer ones"),i.la.push({path:t,children:n,Zc:r,visible:!0}),i.T=Pg(i.T,t,n),i.Cc=r,n=xg(n),Bh(e,new Cd(Jg,t,n))}function Dh(e,t,n){n=n||!1;var r=Zg(e.lb,t);if(e.lb.Ed(t)){var i=Q;return null!=r.Ja?i=i.set(C,!0):Cb(r.children,function(e,t){i=i.set(new L(e),t)}),Bh(e,new Ig(r.path,i,n))}return[]}function Eh(e,t,n){return n=xg(n),Bh(e,new Cd(Lg,t,n))}function Fh(e,t,n,r){r=Gh(e,r);if(null!=r){var i=Hh(r);return r=i.path,i=i.Ib,t=T(r,t),n=new Zb(new Kg(!1,!0,i,!0),t,n),Ih(e,r,n)}return[]}function Jh(e,t,n,r){if(r=Gh(e,r)){var i=Hh(r);return r=i.path,i=i.Ib,t=T(r,t),n=xg(n),n=new Cd(new Kg(!1,!0,i,!0),t,n),Ih(e,r,n)}return[]}function Nh(e){return Ag(e,function(e,n,r){if(n&&null!=Vg(n))return[Vg(n)];var i=[];return n&&(i=Wg(n)),t(r,function(e){i=i.concat(e)}),i})}function Rh(e,t){for(var n=0;n<t.length;++n){var r=t[n];if(!S(r.n)){var r=Kh(r),i=e.jc[r];delete e.jc[r],delete e.Ce["_"+i]}}}function Ph(e){return S(e.n)&&!zd(e.n)?e.xb():e}function Mh(e,n,r){var i=n.path,s=Qh(e,n);r=Oh(e,r),n=e.Dc.ze(Ph(n),s,r.ld,r.G),i=e.wa.subtree(i);if(s)H(null==Vg(i.value),"If we're adding a query, it shouldn't be shadowed");else for(s=Ag(i,function(e,n,r){if(!e.e()&&n&&null!=Vg(n))return[lg(Vg(n))];var i=[];return n&&(i=i.concat(La(Wg(n),function(e){return e.W}))),t(r,function(e){i=i.concat(e)}),i}),i=0;i<s.length;++i)r=s[i],e.Dc.Od(Ph(r),Qh(e,r));return n}function Oh(e,t){var n=t.W,r=Qh(e,n);return{ld:function(){return(t.u()||F).hash()},G:function(t){if("ok"===t){if(r){var i=n.path;if(t=Gh(e,r)){var s=Hh(t);t=s.path,s=s.Ib,i=T(t,i),i=new ac(new Kg(!1,!0,s,!0),i),t=Ih(e,t,i)}else t=[]}else t=Bh(e,new ac(Lg,n.path));return t}return i="Unknown Error","too_big"===t?i="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"==t?i="Client doesn't have permission to access the desired data.":"unavailable"==t&&(i="The service is unavailable"),i=Error(t+" at "+n.path.toString()+": "+i),i.code=t.toUpperCase(),e.mb(n,null,i)}}}function Kh(e){return e.path.toString()+"$"+e.ya()}function Hh(e){var t=e.indexOf("$");return H(-1!==t&&t<e.length-1,"Bad queryKey."),{Ib:e.substr(t+1),path:new L(e.substr(0,t))}}function Gh(e,t){var n=e.Ce,r="_"+t;return r in n?n[r]:void 0}function Qh(e,t){var n=Kh(t);return x(e.jc,n)}function Ih(e,t,n){var r=e.wa.get(t);return H(r,"Missing sync point for query tag that we're tracking"),r.gb(n,new ch(t,e.lb),null)}function Bh(e,t){return Sh(e,t,e.wa,null,new ch(C,e.lb))}function Sh(e,t,n,r,i){if(t.path.e())return Th(e,t,n,r,i);var s=n.get(C);null==r&&null!=s&&(r=s.jb(C));var o=[],u=J(t.path),a=t.Nc(u);if((n=n.children.get(u))&&a)var f=r?r.R(u):null,u=i.m(u),o=o.concat(Sh(e,a,n,f,u));return s&&(o=o.concat(s.gb(t,i,r))),o}function Th(e,t,n,r,i){var s=n.get(C);null==r&&null!=s&&(r=s.jb(C));var o=[];return n.children.ia(function(n,s){var u=r?r.R(n):null,f=i.m(n),l=t.Nc(n);l&&(o=o.concat(Th(e,l,s,u,f)))}),s&&(o=o.concat(s.gb(t,i,r))),o}function pf(e,t,n){this.app=n;var i=new cc(n);this.M=e,this.Xa=oc(e),this.Vc=null,this.da=new qc,this.vd=1,this.Ua=null;if(t||0<=("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i))this.va=new xd(this.M,r(this.Hb,this),i),setTimeout(r(this.Kc,this,!0),0);else{t=n.options.databaseAuthVariableOverride||null;if(null!==t){if("object"!==ca(t))throw Error("Only objects are supported for option databaseAuthVariableOverride");try{B(t)}catch(s){throw Error("Invalid authOverride provided: "+s)}}this.va=this.Ua=new kh(this.M,r(this.Hb,this),r(this.Kc,this),r(this.te,this),i,t)}var o=this;dc(i,function(e){o.va.of(e)}),this.wg=pc(e,r(function(){return new ic(this.Xa,this.va)},this)),this.nc=new eh,this.ie=new ec,this.pd=new zh({ze:function(e,t,n,r){return t=[],n=o.ie.j(e.path),n.e()||(t=Bh(o.pd,new Zb(Lg,e.path,n)),setTimeout(function(){r("ok")},0)),t},Od:aa}),Uh(this,"connected",!1),this.ja=new Qc,this.$a=new of(this),this.ed=0,this.je=null,this.K=new zh({ze:function(e,t,n,r){return o.va.bf(e,n,t,function(t,n){var i=r(t,n);vc(o.da,e.path,i)}),[]},Od:function(e,t){o.va.Cf(e,t)}})}function Vh(e){return e=e.ie.j(new L(".info/serverTimeOffset")).H()||0,(new Date).getTime()+e}function Wh(e){return e=e={timestamp:Vh(e)},e.timestamp=e.timestamp||(new Date).getTime(),e}function Uh(e,t,n){t=new L("/.info/"+t),n=M(n);var r=e.ie;r.Jd=r.Jd.F(t,n),n=Bh(e.pd,new Zb(Lg,t,n)),vc(e.da,t,n)}function Yh(e){e.f("onDisconnectEvents");var t=Wh(e),n=[];Rc(Pc(e.ja,t),C,function(t,r){n=n.concat(Bh(e.K,new Zb(Lg,t,r)));var i=$h(e,t);Xh(e,i)}),e.ja=new Qc,vc(e.da,C,n)}function Jf(e,t,n,r){var i=M(n);e.va.qe(t.toString(),i.H(!0),function(n,s){"ok"===n&&Sc(e.ja,t,i),Zh(r,n,s)})}function Kf(e,t,n,r,i){var s=M(n,r);e.va.qe(t.toString(),s.H(!0),function(n,r){"ok"===n&&Sc(e.ja,t,s),Zh(i,n,r)})}function Lf(e,t,n,r){var i=!0,s;for(s in n)i=!1;i?(E("onDisconnect().update() called with empty data.  Don't do anything."),Zh(r,"ok")):e.va.ef(t.toString(),n,function(i,s){if("ok"===i)for(var o in n){var u=M(n[o]);Sc(e.ja,t.m(o),u)}Zh(r,i,s)})}function ug(e,t,n){n=".info"===J(t.path)?e.pd.Ob(t,n):e.K.Ob(t,n),tc(e.da,t.path,n)}function Zh(e,t,n){e&&Tb(function(){if("ok"==t)e(null);else{var r=(t||"error").toUpperCase(),i=r;n&&(i+=": "+n),i=Error(i),i.code=r,e(i)}})}function ai(e,t,n,r,i){function s(){}e.f("transaction on "+t);var o=new U(e,t);o.hc("value",s),n={path:t,update:n,G:r,status:null,jf:Vc(),He:i,tf:0,Rd:function(){o.Jc("value",s)},Td:null,Da:null,bd:null,cd:null,dd:null},r=e.K.Ba(t,void 0)||F,n.bd=r,r=n.update(r.H());if(p(r)){Bf("transaction failed: Data returned ",r,n.path),n.status=1,i=fh(e.nc,t);var u=i.Ea()||[];u.push(n),gh(i,u),"object"==typeof r&&null!==r&&Bb(r,".priority")?(u=x(r,".priority"),H(zf(u),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):u=(e.K.Ba(t)||F).C().H(),i=Wh(e),r=M(r,u),i=Tc(r,i),n.cd=r,n.dd=i,n.Da=e.vd++,n=Ah(e.K,t,i,n.Da,n.He),vc(e.da,t,n),bi(e)}else n.Rd(),n.cd=null,n.dd=null,n.G&&(e=new W(n.bd,new U(e,n.path),N),n.G(null,!1,e))}function bi(e,t){var n=t||e.nc;t||ci(e,n);if(null!==n.Ea()){var r=di(e,n);H(0<r.length,"Sending zero length transaction queue"),Na(r,function(e){return 1===e.status})&&ei(e,n.path(),r)}else n.kd()&&n.P(function(t){bi(e,t)})}function ei(e,t,n){for(var i=La(n,function(e){return e.Da}),s=e.K.Ba(t,i)||F,i=s,s=s.hash(),o=0;o<n.length;o++){var u=n[o];H(1===u.status,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=2,u.tf++;var a=T(t,u.path),i=i.F(a,u.cd)}i=i.H(!0),e.va.put(t.toString(),i,function(i){e.f("transaction put response",{path:t.toString(),status:i});var s=[];if("ok"===i){i=[];for(o=0;o<n.length;o++){n[o].status=3,s=s.concat(Dh(e.K,n[o].Da));if(n[o].G){var u=n[o].dd,a=new U(e,n[o].path);i.push(r(n[o].G,null,null,!0,new W(u,a,N)))}n[o].Rd()}ci(e,fh(e.nc,t)),bi(e),vc(e.da,t,s);for(o=0;o<i.length;o++)Tb(i[o])}else{if("datastale"===i)for(o=0;o<n.length;o++)n[o].status=4===n[o].status?5:1;else for(O("transaction at "+t.toString()+" failed: "+i),o=0;o<n.length;o++)n[o].status=5,n[o].Td=i;Xh(e,t)}},s)}function Xh(e,t){var n=fi(e,t),r=n.path(),n=di(e,n);return gi(e,n,r),r}function gi(e,t,n){if(0!==t.length){for(var i=[],s=[],o=La(t,function(e){return e.Da}),u=0;u<t.length;u++){var a=t[u],f=T(n,a.path),l=!1,c;H(null!==f,"rerunTransactionsUnderNode_: relativePath should not be null.");if(5===a.status)l=!0,c=a.Td,s=s.concat(Dh(e.K,a.Da,!0));else if(1===a.status)if(25<=a.tf)l=!0,c="maxretry",s=s.concat(Dh(e.K,a.Da,!0));else{var h=e.K.Ba(a.path,o)||F;a.bd=h;var d=t[u].update(h.H());p(d)?(Bf("transaction failed: Data returned ",d,a.path),f=M(d),"object"==typeof d&&null!=d&&Bb(d,".priority")||(f=f.ga(h.C())),h=a.Da,d=Wh(e),d=Tc(f,d),a.cd=f,a.dd=d,a.Da=e.vd++,Qa(o,h),s=s.concat(Ah(e.K,a.path,d,a.Da,a.He)),s=s.concat(Dh(e.K,h,!0))):(l=!0,c="nodata",s=s.concat(Dh(e.K,a.Da,!0)))}vc(e.da,n,s),s=[],l&&(t[u].status=3,setTimeout(t[u].Rd,Math.floor(0)),t[u].G&&("nodata"===c?(a=new U(e,t[u].path),i.push(r(t[u].G,null,null,!1,new W(t[u].bd,a,N)))):i.push(r(t[u].G,null,Error(c),!1,null))))}ci(e,e.nc);for(u=0;u<i.length;u++)Tb(i[u]);bi(e)}}function fi(e,t){for(var n,r=e.nc;null!==(n=J(t))&&null===r.Ea();)r=fh(r,n),t=D(t);return r}function di(e,t){var n=[];return hi(e,t,n),n.sort(function(e,t){return e.jf-t.jf}),n}function hi(e,t,n){var r=t.Ea();if(null!==r)for(var i=0;i<r.length;i++)n.push(r[i]);t.P(function(t){hi(e,t,n)})}function ci(e,t){var n=t.Ea();if(n){for(var r=0,i=0;i<n.length;i++)3!==n[i].status&&(n[r]=n[i],r++);n.length=r,gh(t,0<n.length?n:null)}t.P(function(t){ci(e,t)})}function $h(e,t){var n=fi(e,t).path(),r=fh(e.nc,t);return jh(r,function(t){ii(e,t)}),ii(e,r),ih(r,function(t){ii(e,t)}),n}function ii(e,t){var n=t.Ea();if(null!==n){for(var i=[],s=[],o=-1,u=0;u<n.length;u++)4!==n[u].status&&(2===n[u].status?(H(o===u-1,"All SENT items should be at beginning of queue."),o=u,n[u].status=4,n[u].Td="set"):(H(1===n[u].status,"Unexpected transaction status in abort"),n[u].Rd(),s=s.concat(Dh(e.K,n[u].Da,!0)),n[u].G&&i.push(r(n[u].G,null,Error("set"),!1,null))));-1===o?gh(t,null):n.length=o+1,vc(e.da,t.path(),s);for(u=0;u<i.length;u++)Tb(i[u])}}function uf(){this.nb={},this.Df=!1}function U(e,t){if(!(e instanceof pf))throw Error("new Firebase() no longer supported - use app.database().");X.call(this,e,t,Be,!1),this.then=void 0,this["catch"]=void 0}var g,n=this;ka(ma,la),ma.prototype.reset=function(){this.N[0]=1732584193,this.N[1]=4023233417,this.N[2]=2562383102,this.N[3]=271733878,this.N[4]=3285377520,this.Pd=this.ac=0},ma.prototype.update=function(e,t){if(null!=e){p(t)||(t=e.length);for(var n=t-this.Ya,r=0,i=this.Wd,s=this.ac;r<t;){if(0==s)for(;r<=n;)na(this,e,r),r+=this.Ya;if(q(e)){for(;r<t;)if(i[s]=e.charCodeAt(r),++s,++r,s==this.Ya){na(this,i),s=0;break}}else for(;r<t;)if(i[s]=e[r],++s,++r,s==this.Ya){na(this,i),s=0;break}}this.ac=s,this.Pd+=t}};var Da={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","":"\\u000b"},Ea=/\uffff/.test("￿")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g,v;e:{var Fa=n.navigator;if(Fa){var Ga=Fa.userAgent;if(Ga){v=Ga;break e}}v=""}ka(Ha,Error),Ha.prototype.name="CustomError";var w=Array.prototype,Ia=w.indexOf?function(e,t,n){return w.indexOf.call(e,t,n)}:function(e,t,n){n=null==n?0:0>n?Math.max(0,e.length+n):n;if(q(e))return q(t)&&1==t.length?e.indexOf(t,n):-1;for(;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},Ja=w.forEach?function(e,t,n){w.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i=q(e)?e.split(""):e,s=0;s<r;s++)s in i&&t.call(n,i[s],s,e)},Ka=w.filter?function(e,t,n){return w.filter.call(e,t,n)}:function(e,t,n){for(var r=e.length,i=[],s=0,o=q(e)?e.split(""):e,u=0;u<r;u++)if(u in o){var a=o[u];t.call(n,a,u,e)&&(i[s++]=a)}return i},La=w.map?function(e,t,n){return w.map.call(e,t,n)}:function(e,t,n){for(var r=e.length,i=Array(r),s=q(e)?e.split(""):e,o=0;o<r;o++)o in s&&(i[o]=t.call(n,s[o],o,e));return i},Ma=w.reduce?function(e,t,n,i){for(var s=[],o=1,u=arguments.length;o<u;o++)s.push(arguments[o]);return i&&(s[0]=r(t,i)),w.reduce.apply(e,s)}:function(e,t,n,r){var i=n;return Ja(e,function(n,s){i=t.call(r,i,n,s,e)}),i},Na=w.every?function(e,t,n){return w.every.call(e,t,n)}:function(e,t,n){for(var r=e.length,i=q(e)?e.split(""):e,s=0;s<r;s++)if(s in i&&!t.call(n,i[s],s,e))return!1;return!0},Ua=-1!=v.indexOf("Opera")||-1!=v.indexOf("OPR"),Va=-1!=v.indexOf("Trident")||-1!=v.indexOf("MSIE"),Wa=-1!=v.indexOf("Gecko")&&-1==v.toLowerCase().indexOf("webkit")&&-1==v.indexOf("Trident")&&-1==v.indexOf("MSIE"),Xa=-1!=v.toLowerCase().indexOf("webkit");(function(){var e="",t;return Ua&&n.opera?(e=n.opera.version,ga(e)?e():e):(Wa?t=/rv\:([^\);]+)(\)|;)/:Va?t=/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/:Xa&&(t=/WebKit\/(\S+)/),t&&(e=(e=t.exec(v))?e[1]:""),Va&&(t=(t=n.document)?t.documentMode:void 0,t>parseFloat(e))?String(t):e)})();var Ya=null,Za=null,$a=null,db,gb,ib=!1,jb=[];[].push(function(){ib=!1,jb=[]});var nb=0,qb=2,sb=3;mb.prototype.then=function(e,t,n){return tb(this,ga(e)?e:null,ga(t)?t:null,n)},mb.prototype.then=mb.prototype.then,mb.prototype.$goog_Thenable=!0,g=mb.prototype,g.xg=function(e,t){return tb(this,null,e,t)},g.cancel=function(e){this.L==nb&&fb(function(){var t=new rb(e);ub(this,t)},this)},g.Af=function(e){this.L=nb,pb(this,qb,e)},g.Bf=function(e){this.L=nb,pb(this,sb,e)},g.Sf=function(){for(;this.Ca&&this.Ca.length;){var e=this.Ca;this.Ca=null;for(var t=0;t<e.length;t++)vb(this,e[t],this.L,this.sf)}this.be=!1};var Ab=cb;ka(rb,Ha),rb.prototype.name="cancel";var Gb=n.Promise||mb;mb.prototype["catch"]=mb.prototype.xg,Ub.prototype.set=function(e,t){null==t?delete this.qc[e]:this.qc[e]=t},Ub.prototype.get=function(e){return Bb(this.qc,e)?this.qc[e]:null},Ub.prototype.remove=function(e){delete this.qc[e]},Ub.prototype.af=!0,g=Vb.prototype,g.set=function(e,t){null==t?this.vc.removeItem(this.Cd+e):this.vc.setItem(this.Cd+e,B(t))},g.get=function(e){return e=this.vc.getItem(this.Cd+e),null==e?null:Ob(e)},g.remove=function(e){this.vc.removeItem(this.Cd+e)},g.af=!1,g.toString=function(){return this.vc.toString()};var Xb=Wb("localStorage"),Yb=Wb("sessionStorage");Zb.prototype.Nc=function(e){return this.path.e()?new Zb(this.source,C,this.Ja.R(e)):new Zb(this.source,D(this.path),this.Ja)},Zb.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" overwrite: "+this.Ja.toString()+")"},ac.prototype.Nc=function(){return this.path.e()?new ac(this.source,C):new ac(this.source,D(this.path))},ac.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" listen_complete)"},cc.prototype.getToken=function(e){return this.Ge.INTERNAL.getToken(e).then(null,function(e){return e&&"auth/token-not-initialized"===e.code?(E("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)})},ec.prototype.j=function(e){return this.Jd.Q(e)},ec.prototype.toString=function(){return this.Jd.toString()},fc.prototype.toString=function(){var e=(this.Sc?"https://":"http://")+this.host;return this.lf&&(e+="<"+this.lf+">"),e},ic.prototype.pf=function(){var e=this.Vc.get(),t={},n=!1,i;for(i in e)0<e[i]&&Bb(this.xf,i)&&(t[i]=e[i],n=!0);n&&this.va.xe(t),setTimeout(r(this.pf,this),Math.floor(6e5*Math.random()))},kc.prototype.get=function(){return ya(this.uc)},jc.prototype.get=function(){var e=this.Lf.get(),t=ya(e);if(this.rd)for(var n in this.rd)t[n]-=this.rd[n];return this.rd=e,t};var mc={},nc={};sc.prototype.add=function(e){this.hd.push(e)},sc.prototype.Zb=function(){return this.qa},xc.prototype.Zb=function(){var e=this.Md.xb();return"value"===this.gd?e.path:e.getParent().path},xc.prototype.ge=function(){return this.gd},xc.prototype.Ub=function(){return this.ae.Ub(this)},xc.prototype.toString=function(){return this.Zb().toString()+":"+this.gd+":"+B(this.Md.Se())},yc.prototype.Zb=function(){return this.path},yc.prototype.ge=function(){return"cancel"},yc.prototype.Ub=function(){return this.ae.Ub(this)},yc.prototype.toString=function(){return this.path.toString()+":cancel"},zc.prototype.Ve=function(){return null},zc.prototype.fe=function(){return null};var Ac=new zc;Bc.prototype.Ve=function(e){var t=this.Na.O;return Cc(t,e)?t.j().R(e):(t=null!=this.yd?new Dc(this.yd,!0,!1):this.Na.u(),this.Ef.rc(e,t))},Bc.prototype.fe=function(e,t,n){var r=null!=this.yd?this.yd:Ec(this.Na);return e=this.Ef.Xd(r,t,1,n,e),0===e.length?null:e[0]};var Gc="value";Dc.prototype.j=function(){return this.A};var Vc=function(){var e=1;return function(){return e++}}(),H=Kb,Wc=Lb,wc=null,$c=!0,nd=/^-?\d{1,10}$/,qd=null;"undefined"!=typeof MozWebSocket?qd=MozWebSocket:"undefined"!=typeof WebSocket&&(qd=WebSocket);var td;rd.prototype.open=function(e,t){this.kb=t,this.fg=e,this.f("Websocket connecting to "+this.Le),this.xc=!1,Xb.set("previous_websocket_failure",!0);try{this.La=new qd(this.Le)}catch(n){this.f("Error instantiating WebSocket.");var r=n.message||n.data;r&&this.f(r),this.fb();return}var i=this;this.La.onopen=function(){i.f("Websocket connected."),i.xc=!0},this.La.onclose=function(){i.f("Websocket connection was disconnected."),i.La=null,i.fb()},this.La.onmessage=function(e){if(null!==i.La)if(e=e.data,i.qb+=e.length,lc(i.Xa,"bytes_received",e.length),ud(i),null!==i.frames)vd(i,e);else{e:{H(null===i.frames,"We already have a frame buffer");if(6>=e.length){var t=Number(e);if(!isNaN(t)){i.Ee=t,i.frames=[],e=null;break e}}i.Ee=1,i.frames=[]}null!==e&&vd(i,e)}},this.La.onerror=function(e){i.f("WebSocket error.  Closing connection."),(e=e.message||e.data)&&i.f(e),i.fb()}},rd.prototype.start=function(){},rd.isAvailable=function(){var e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var t=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);t&&1<t.length&&4.4>parseFloat(t[1])&&(e=!0)}return!e&&null!==qd&&!td},rd.responsesRequiredToBeHealthy=2,rd.healthyTimeout=3e4,g=rd.prototype,g.sd=function(){Xb.remove("previous_websocket_failure")},g.send=function(e){ud(this),e=B(e),this.rb+=e.length,lc(this.Xa,"bytes_sent",e.length),e=kd(e,16384),1<e.length&&wd(this,String(e.length));for(var t=0;t<e.length;t++)wd(this,e[t])},g.Tc=function(){this.Bb=!0,this.Ac&&(clearInterval(this.Ac),this.Ac=null),this.La&&(this.La.close(),this.La=null)},g.fb=function(){this.Bb||(this.f("WebSocket is closing itself"),this.Tc(),this.kb&&(this.kb(this.xc),this.kb=null))},g.close=function(){this.Bb||(this.f("WebSocket is being closed"),this.Tc())},g=xd.prototype,g.bf=function(e,t,n,r){var i=e.path.toString();this.f("Listen called for "+i+" "+e.ya());var s=yd(e,n),o={};this.$[s]=o,e=Ad(e.n);var u=this;Bd(this,i+".json",e,function(e,t){var a=t;404===e&&(e=a=null),null===e&&u.Hb(i,a,!1,n),x(u.$,s)===o&&r(e?401==e?"permission_denied":"rest_error:"+e:"ok",null)})},g.Cf=function(e,t){var n=yd(e,t);delete this.$[n]},g.of=function(){},g.qe=function(){},g.ef=function(){},g.xd=function(){},g.put=function(){},g.cf=function(){},g.xe=function(){},Cd.prototype.Nc=function(e){return this.path.e()?(e=this.children.subtree(new L(e)),e.e()?null:e.value?new Zb(this.source,C,e.value):new Cd(this.source,C,e)):(H(J(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Cd(this.source,D(this.path),this.children))},Cd.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},Gd.prototype.Mf=function(e,t){if(null==e.Za||null==t.Za)throw Wc("Should only compare child_ events.");return this.g.compare(new K(e.Za,e.Ma),new K(t.Za,t.Ma))},Ld.prototype.gb=function(e,t,n,r){var i=new Ed,s;if(t.type===$b)t.source.ee?n=Md(this,e,t.path,t.Ja,n,r,i):(H(t.source.Ue,"Unknown source."),s=t.source.De||Ic(e.u())&&!t.path.e(),n=Nd(this,e,t.path,t.Ja,n,r,s,i));else if(t.type===Dd)t.source.ee?n=Od(this,e,t.path,t.children,n,r,i):(H(t.source.Ue,"Unknown source."),s=t.source.De||Ic(e.u()),n=Pd(this,e,t.path,t.children,n,r,s,i));else if(t.type===Qd)if(t.Id)if(t=t.path,null!=n.mc(t))n=e;else{s=new Bc(n,e,r),r=e.O.j();if(t.e()||".priority"===J(t))Hc(e.u())?t=n.Ba(Ec(e)):(t=e.u().j(),H(t instanceof P,"serverChildren would be complete if leaf node"),t=n.sc(t)),t=this.V.za(r,t,i);else{var o=J(t),u=n.rc(o,e.u());null==u&&Cc(e.u(),o)&&(u=r.R(o)),t=null!=u?this.V.F(r,o,u,D(t),s,i):e.O.j().Fa(o)?this.V.F(r,o,F,D(t),s,i):r,t.e()&&Hc(e.u())&&(r=n.Ba(Ec(e)),r.J()&&(t=this.V.za(t,r,i)))}r=Hc(e.u())||null!=n.mc(C),n=Rd(e,t,r,this.V.Qa())}else n=Sd(this,e,t.path,t.Pb,n,r,i);else{if(t.type!==bc)throw Wc("Unknown operation type: "+t.type);r=t.path,t=e.u(),s=t.j(),o=t.ea||r.e(),n=Td(this,new Ud(e.O,new Dc(s,o,t.Tb)),r,n,Ac,i)}return i=sa(i.hb),r=n,t=r.O,t.ea&&(s=t.j().J()||t.j().e(),o=Vd(e),(0<i.length||!e.O.ea||s&&!t.j().ca(o)||!t.j().C().ca(o.C()))&&i.push(Fc(Vd(r)))),new Kd(n,i)},g=be.prototype,g.F=function(e,t,n,r,i,s){return H(e.zc(this.g),"A node must be indexed if only a child is updated"),i=e.R(t),i.Q(r).ca(n.Q(r))&&i.e()==n.e()?e:(null!=s&&(n.e()?e.Fa(t)?Fd(s,new I("child_removed",i,t)):H(e.J(),"A child remove without an old child only makes sense on a leaf node"):i.e()?Fd(s,new I("child_added",n,t)):Fd(s,new I("child_changed",n,t,i))),e.J()&&n.e()?e:e.U(t,n).ob(this.g))},g.za=function(e,t,n){return null!=n&&(e.J()||e.P(N,function(e,r){t.Fa(e)||Fd(n,new I("child_removed",r,e))}),t.J()||t.P(N,function(t,r){if(e.Fa(t)){var i=e.R(t);i.ca(r)||Fd(n,new I("child_changed",r,t,i))}else Fd(n,new I("child_added",r,t))})),t.ob(this.g)},g.ga=function(e,t){return e.e()?F:e.ga(t)},g.Qa=function(){return!1},g.Vb=function(){return this},g=ce.prototype,g.matches=function(e){return 0>=this.g.compare(this.Uc,e)&&0>=this.g.compare(e,this.wc)},g.F=function(e,t,n,r,i,s){return this.matches(new K(t,n))||(n=F),this.he.F(e,t,n,r,i,s)},g.za=function(e,t,n){t.J()&&(t=F);var r=t.ob(this.g),r=r.ga(F),i=this;return t.P(N,function(e,t){i.matches(new K(e,t))||(r=r.U(e,F))}),this.he.za(e,r,n)},g.ga=function(e){return e},g.Qa=function(){return!0},g.Vb=function(){return this.he},g=he.prototype,g.F=function(e,t,n,r,i,s){return this.sa.matches(new K(t,n))||(n=F),e.R(t).ca(n)?e:e.Fb()<this.oa?this.sa.Vb().F(e,t,n,r,i,s):je(this,e,t,n,i,s)},g.za=function(e,t,n){var r;if(t.J()||t.e())r=F.ob(this.g);else if(2*this.oa<t.Fb()&&t.zc(this.g)){r=F.ob(this.g),t=this.Jb?t.$b(this.sa.wc,this.g):t.Yb(this.sa.Uc,this.g);for(var i=0;0<t.Sa.length&&i<this.oa;){var s=R(t),o;if(!(o=this.Jb?0>=this.g.compare(this.sa.Uc,s):0>=this.g.compare(s,this.sa.wc)))break;r=r.U(s.name,s.S),i++}}else{r=t.ob(this.g),r=r.ga(F);var u,a,f;if(this.Jb){t=r.Ye(this.g),u=this.sa.wc,a=this.sa.Uc;var l=ke(this.g);f=function(e,t){return l(t,e)}}else t=r.Xb(this.g),u=this.sa.Uc,a=this.sa.wc,f=ke(this.g);for(var i=0,c=!1;0<t.Sa.length;)s=R(t),!c&&0>=f(u,s)&&(c=!0),(o=c&&i<this.oa&&0>=f(s,a))?i++:r=r.U(s.name,F)}return this.sa.Vb().za(e,r,n)},g.ga=function(e){return e},g.Qa=function(){return!0},g.Vb=function(){return this.sa.Vb()};var oe=["object","boolean","number","string"];g=Uc.prototype,g.J=function(){return!0},g.C=function(){return this.aa},g.ga=function(e){return new Uc(this.B,e)},g.R=function(e){return".priority"===e?this.aa:F},g.Q=function(e){return e.e()?this:".priority"===J(e)?this.aa:F},g.Fa=function(){return!1},g.Xe=function(){return null},g.U=function(e,t){return".priority"===e?this.ga(t):t.e()&&".priority"!==e?this:F.U(e,t).ga(this.aa)},g.F=function(e,t){var n=J(e);return null===n?t:t.e()&&".priority"!==n?this:(H(".priority"!==n||1===Wd(e),".priority must be the last token in a path"),this.U(n,F.F(D(e),t)))},g.e=function(){return!1},g.Fb=function(){return 0},g.P=function(){return!1},g.H=function(e){return e&&!this.C().e()?{".value":this.Ea(),".priority":this.C().H()}:this.Ea()},g.hash=function(){if(null===this.Eb){var e="";this.aa.e()||(e+="priority:"+pe(this.aa.H())+":");var t=typeof this.B,e=e+(t+":"),e="number"===t?e+md(this.B):e+this.B;this.Eb=Yc(e)}return this.Eb},g.Ea=function(){return this.B},g.tc=function(e){if(e===F)return 1;if(e instanceof P)return-1;H(e.J(),"Unknown node type");var t=typeof e.B,n=typeof this.B,r=Ia(oe,t),i=Ia(oe,n);return H(0<=r,"Unknown leaf type: "+t),H(0<=i,"Unknown leaf type: "+n),r===i?"object"===n?0:this.B<e.B?-1:this.B===e.B?0:1:i-r},g.ob=function(){return this},g.zc=function(){return!0},g.ca=function(e){return e===this?!0:e.J()?this.B===e.B&&this.aa.ca(e.aa):!1},g.toString=function(){return B(this.H(!0))};var re={};qe.prototype.nd=function(e,t){return 0!==this.compare(new K("[MIN_NAME]",e),new K("[MIN_NAME]",t))},qe.prototype.Ic=function(){return se},ka(te,qe),g=te.prototype,g.yc=function(e){return!e.Q(this.cc).e()},g.compare=function(e,t){var n=e.S.Q(this.cc),r=t.S.Q(this.cc),n=n.tc(r);return 0===n?Lc(e.name,t.name):n},g.Fc=function(e,t){var n=M(e),n=F.F(this.cc,n);return new K(t,n)},g.Gc=function(){var e=F.F(this.cc,ue);return new K("[MAX_NAME]",e)},g.toString=function(){return this.cc.slice().join("/")},ka(ve,qe),g=ve.prototype,g.compare=function(e,t){var n=e.S.C(),r=t.S.C(),n=n.tc(r);return 0===n?Lc(e.name,t.name):n},g.yc=function(e){return!e.C().e()},g.nd=function(e,t){return!e.C().ca(t.C())},g.Ic=function(){return se},g.Gc=function(){return new K("[MAX_NAME]",new Uc("[PRIORITY-POST]",ue))},g.Fc=function(e,t){var n=M(e);return new K(t,new Uc("[PRIORITY-POST]",n))},g.toString=function(){return".priority"};var N=new ve;ka(we,qe),g=we.prototype,g.compare=function(e,t){return Lc(e.name,t.name)},g.yc=function(){throw Wc("KeyIndex.isDefinedOn not expected to be called.")},g.nd=function(){return!1},g.Ic=function(){return se},g.Gc=function(){return new K("[MAX_NAME]",F)},g.Fc=function(e){return H(q(e),"KeyIndex indexValue must always be a string."),new K(e,F)},g.toString=function(){return".key"};var ae=new we;ka(xe,qe),g=xe.prototype,g.compare=function(e,t){var n=e.S.tc(t.S);return 0===n?Lc(e.name,t.name):n},g.yc=function(){return!0},g.nd=function(e,t){return!e.ca(t)},g.Ic=function(){return se},g.Gc=function(){return ye},g.Fc=function(e,t){var n=M(e);return new K(t,n)},g.toString=function(){return".value"};var ze=new xe,Be=new Ae;g=Ae.prototype,g.me=function(e){var t=Ce(this);return t.xa=!0,t.oa=e,t.oc="l",t},g.ne=function(e){var t=Ce(this);return t.xa=!0,t.oa=e,t.oc="r",t},g.Nd=function(e,t){var n=Ce(this);return n.ka=!0,p(e)||(e=null),n.ec=e,null!=t?(n.Lb=!0,n.Ab=t):(n.Lb=!1,n.Ab=""),n},g.fd=function(e,t){var n=Ce(this);return n.na=!0,p(e)||(e=null),n.bc=e,p(t)?(n.Sb=!0,n.yb=t):(n.Dg=!1,n.yb=""),n},g.toString=function(){return B(Ee(this))},Fe.prototype.get=function(e){var t=x(this.od,e);if(!t)throw Error("No index defined for "+e);return t===re?null:t};var Je=new Fe({".priority":re},{".priority":N});g=Ke.prototype,g.add=function(e,t){this.set[e]=null!==t?t:!0},g.contains=function(e){return Bb(this.set,e)},g.get=function(e){return this.contains(e)?this.set[e]:void 0},g.remove=function(e){delete this.set[e]},g.clear=function(){this.set={}},g.e=function(){return xa(this.set)},g.count=function(){return qa(this.set)},g.keys=function(){var e=[];return t(this.set,function(t,n){e.push(n)}),e};var Ne,Oe;Me.prototype.open=function(e,t){this.Oe=0,this.ja=t,this.df=new Qb(e),this.Bb=!1;var n=this;this.tb=setTimeout(function(){n.f("Timed out trying to connect."),n.fb(),n.tb=null},Math.floor(3e4)),gd(function(){if(!n.Bb){n.Wa=new Pe(function(e,t,r,i,s){Qe(n,arguments);if(n.Wa)if(n.tb&&(clearTimeout(n.tb),n.tb=null),n.xc=!0,"start"==e)n.id=t,n.kf=r;else{if("close"!==e)throw Error("Unrecognized command received: "+e);t?(n.Wa.Kd=!1,Rb(n.df,t,function(){n.fb()})):n.fb()}},function(e,t){Qe(n,arguments),Sb(n.df,e,t)},function(){n.fb()},n.Yc);var e={start:"t"};e.ser=Math.floor(1e8*Math.random()),n.Wa.Qd&&(e.cb=n.Wa.Qd),e.v="5",n.zf&&(e.s=n.zf),n.Db&&(e.ls=n.Db),"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf("firebaseio.com")&&(e.r="f"),e=n.Yc(e),n.f("Connecting via long-poll to "+e),Re(n.Wa,e,function(){})}})},Me.prototype.start=function(){var e=this.Wa,t=this.kf;e.dg=this.id,e.eg=t;for(e.Ud=!0;Se(e););e=this.id,t=this.kf,this.gc=document.createElement("iframe");var n={dframe:"t"};n.id=e,n.pw=t,this.gc.src=this.Yc(n),this.gc.style.display="none",document.body.appendChild(this.gc)},Me.isAvailable=function(){return Ne||!Oe&&"undefined"!=typeof document&&null!=document.createElement&&!("object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&("object"!=typeof Windows||"object"!=typeof Windows.Ag)&&!0},g=Me.prototype,g.sd=function(){},g.Tc=function(){this.Bb=!0,this.Wa&&(this.Wa.close(),this.Wa=null),this.gc&&(document.body.removeChild(this.gc),this.gc=null),this.tb&&(clearTimeout(this.tb),this.tb=null)},g.fb=function(){this.Bb||(this.f("Longpoll is closing itself"),this.Tc(),this.ja&&(this.ja(this.xc),this.ja=null))},g.close=function(){this.Bb||(this.f("Longpoll is being closed."),this.Tc())},g.send=function(e){e=B(e),this.rb+=e.length,lc(this.Xa,"bytes_sent",e.length),e=Mb(e),e=ab(e,!0),e=kd(e,1840);for(var t=0;t<e.length;t++){var n=this.Wa;n.Qc.push({sg:this.Oe,yg:e.length,Qe:e[t]}),n.Ud&&Se(n),this.Oe++}},Pe.prototype.close=function(){this.Ud=!1;if(this.Ga){this.Ga.ib.body.innerHTML="";var e=this;setTimeout(function(){null!==e.Ga&&(document.body.removeChild(e.Ga),e.Ga=null)},Math.floor(0))}var t=this.kb;t&&(this.kb=null,t())};var We=[Me,rd];Ye.prototype.ua=function(e){jf(this,{t:"d",d:e})},Ye.prototype.wd=function(e){ff(this),this.se(e)},Ye.prototype.close=function(){2!==this.L&&(this.f("Closing realtime connection."),this.L=2,ef(this),this.ja&&(this.ja(),this.ja=null))},g=L.prototype,g.toString=function(){for(var e="",t=this.Z;t<this.o.length;t++)""!==this.o[t]&&(e+="/"+this.o[t]);return e||"/"},g.slice=function(e){return this.o.slice(this.Z+(e||0))},g.parent=function(){if(this.Z>=this.o.length)return null;for(var e=[],t=this.Z;t<this.o.length-1;t++)e.push(this.o[t]);return new L(e,0)},g.m=function(e){for(var t=[],n=this.Z;n<this.o.length;n++)t.push(this.o[n]);if(e instanceof L)for(n=e.Z;n<e.o.length;n++)t.push(e.o[n]);else for(e=e.split("/"),n=0;n<e.length;n++)0<e[n].length&&t.push(e[n]);return new L(t,0)},g.e=function(){return this.Z>=this.o.length},g.ca=function(e){if(Wd(this)!==Wd(e))return!1;for(var t=this.Z,n=e.Z;t<=this.o.length;t++,n++)if(this.o[t]!==e.o[n])return!1;return!0},g.contains=function(e){var t=this.Z,n=e.Z;if(Wd(this)>Wd(e))return!1;for(;t<this.o.length;){if(this.o[t]!==e.o[n])return!1;++t,++n}return!0};var C=new L("");lf.prototype.push=function(e){0<this.Ta.length&&(this.Ka+=1),this.Ta.push(e),this.Ka+=Nb(e),mf(this)},lf.prototype.pop=function(){var e=this.Ta.pop();this.Ka-=Nb(e),0<this.Ta.length&&--this.Ka};var rf={TIMESTAMP:{".sv":"timestamp"}};g=of.prototype,g.app=null,g.nf=function(e){return sf(this,"ref"),y("database.ref",0,1,arguments.length),p(e)?this.ba.m(e):this.ba},g.pg=function(e){sf(this,"database.refFromURL"),y("database.refFromURL",1,1,arguments.length);var t=ed(e);tf("database.refFromURL",t);var n=t.kc;return n.host!==this.ta.M.host&&dd("database.refFromURL: Host name does not match the current database: (found "+n.host+" but expected "+this.ta.M.host+")"),this.nf(t.path.toString())},g.Yf=function(){y("database.goOffline",0,0,arguments.length),sf(this,"goOffline"),this.ta.eb()},g.Zf=function(){y("database.goOnline",0,0,arguments.length),sf(this,"goOnline"),this.ta.lc()},Object.defineProperty(of.prototype,"app",{get:function(){return this.ta.app}}),qf.prototype.delete=function(){sf(this.$a,"delete");var e=uf.Wb(),t=this.$a.ta;return x(e.nb,t.app.name)!==t&&dd("Database "+t.app.name+" has already been deleted."),t.eb(),delete e.nb[t.app.name],this.$a.ta=null,this.$a.ba=null,this.$a=this.$a.INTERNAL=null,Promise.resolve()},of.prototype.ref=of.prototype.nf,of.prototype.refFromURL=of.prototype.pg,of.prototype.goOnline=of.prototype.Zf,of.prototype.goOffline=of.prototype.Yf,qf.prototype["delete"]=qf.prototype.delete,Qc.prototype.find=function(e){if(null!=this.B)return this.B.Q(e);if(e.e()||null==this.k)return null;var t=J(e);return e=D(e),this.k.contains(t)?this.k.get(t).find(e):null},Qc.prototype.P=function(e){null!==this.k&&Le(this.k,function(t,n){e(t,n)})};var wf=/[\[\].#$\/\u0000-\u001F\u007F]/,xf=/[\[\].#$\u0000-\u001F\u007F]/;V.prototype.cancel=function(e){y("Firebase.onDisconnect().cancel",0,1,arguments.length),A("Firebase.onDisconnect().cancel",1,e,!0);var t=new Hb;return this.ta.xd(this.qa,Ib(t,e)),t.ra},V.prototype.cancel=V.prototype.cancel,V.prototype.remove=function(e){y("Firebase.onDisconnect().remove",0,1,arguments.length),If("Firebase.onDisconnect().remove",this.qa),A("Firebase.onDisconnect().remove",1,e,!0);var t=new Hb;return Jf(this.ta,this.qa,null,Ib(t,e)),t.ra},V.prototype.remove=V.prototype.remove,V.prototype.set=function(e,t){y("Firebase.onDisconnect().set",1,2,arguments.length),If("Firebase.onDisconnect().set",this.qa),Af("Firebase.onDisconnect().set",e,this.qa,!1),A("Firebase.onDisconnect().set",2,t,!0);var n=new Hb;return Jf(this.ta,this.qa,e,Ib(n,t)),n.ra},V.prototype.set=V.prototype.set,V.prototype.Kb=function(e,t,n){y("Firebase.onDisconnect().setWithPriority",2,3,arguments.length),If("Firebase.onDisconnect().setWithPriority",this.qa),Af("Firebase.onDisconnect().setWithPriority",e,this.qa,!1),Ef("Firebase.onDisconnect().setWithPriority",2,t),A("Firebase.onDisconnect().setWithPriority",3,n,!0);var r=new Hb;return Kf(this.ta,this.qa,e,t,Ib(r,n)),r.ra},V.prototype.setWithPriority=V.prototype.Kb,V.prototype.update=function(e,t){y("Firebase.onDisconnect().update",1,2,arguments.length),If("Firebase.onDisconnect().update",this.qa);if(da(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,O("Passing an Array to Firebase.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}return Df("Firebase.onDisconnect().update",e,this.qa),A("Firebase.onDisconnect().update",2,t,!0),n=new Hb,Lf(this.ta,this.qa,e,Ib(n,t)),n.ra},V.prototype.update=V.prototype.update,Mf.prototype.Fe=function(e,t){var n;n=this.Ec[e]||[];var r=n.length;if(0<r){for(var i=Array(r),s=0;s<r;s++)i[s]=n[s];n=i}else n=[];for(r=0;r<n.length;r++)n[r].Je.apply(n[r].Pa,Array.prototype.slice.call(arguments,1))},Mf.prototype.hc=function(e,t,n){Nf(this,e),this.Ec[e]=this.Ec[e]||[],this.Ec[e].push({Je:t,Pa:n}),(e=this.We(e))&&t.apply(n,e)},Mf.prototype.Jc=function(e,t,n){Nf(this,e),e=this.Ec[e]||[];for(var r=0;r<e.length;r++)if(e[r].Je===t&&(!n||n===e[r].Pa)){e.splice(r,1);break}},ka(Of,Mf),Of.prototype.We=function(e){return H("online"===e,"Unknown event type: "+e),[this.ic]},ba(Of),ka(Pf,Mf),Pf.prototype.We=function(e){return H("visible"===e,"Unknown event type: "+e),[this.Nb]},ba(Pf);var Qf=function(){var e=0,t=[];return function(n){var r=n===e;e=n;for(var i=Array(8),s=7;0<=s;s--)i[s]="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz".charAt(n%64),n=Math.floor(n/64);H(0===n,"Cannot push at time == 0"),n=i.join("");if(r){for(s=11;0<=s&&63===t[s];s--)t[s]=0;t[s]++}else for(s=0;12>s;s++)t[s]=Math.floor(64*Math.random());for(s=0;12>s;s++)n+="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz".charAt(t[s]);return H(20===n.length,"nextPushId: Length should be 20."),n}}();g=Rf.prototype,g.Ra=function(e,t){return new Rf(this.Oa,this.ba.Ra(e,t,this.Oa).Y(null,null,!1,null,null))},g.remove=function(e){return new Rf(this.Oa,this.ba.remove(e,this.Oa).Y(null,null,!1,null,null))},g.get=function(e){for(var t,n=this.ba;!n.e();){t=this.Oa(e,n.key);if(0===t)return n.value;0>t?n=n.left:0<t&&(n=n.right)}return null},g.e=function(){return this.ba.e()},g.count=function(){return this.ba.count()},g.Hc=function(){return this.ba.Hc()},g.fc=function(){return this.ba.fc()},g.ia=function(e){return this.ba.ia(e)},g.Xb=function(e){return new Uf(this.ba,null,this.Oa,!1,e)},g.Yb=function(e,t){return new Uf(this.ba,e,this.Oa,!1,t)},g.$b=function(e,t){return new Uf(this.ba,e,this.Oa,!0,t)},g.Ye=function(e){return new Uf(this.ba,null,this.Oa,!0,e)},g=Wf.prototype,g.Y=function(e,t,n,r,i){return new Wf(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},g.count=function(){return this.left.count()+1+this.right.count()},g.e=function(){return!1},g.ia=function(e){return this.left.ia(e)||e(this.key,this.value)||this.right.ia(e)},g.Hc=function(){return Xf(this).key},g.fc=function(){return this.right.e()?this.key:this.right.fc()},g.Ra=function(e,t,n){var r,i;return i=this,r=n(e,i.key),i=0>r?i.Y(null,null,null,i.left.Ra(e,t,n),null):0===r?i.Y(null,t,null,null,null):i.Y(null,null,null,null,i.right.Ra(e,t,n)),Yf(i)},g.remove=function(e,t){var n,r;n=this;if(0>t(e,n.key))n.left.e()||n.left.fa()||n.left.left.fa()||(n=$f(n)),n=n.Y(null,null,null,n.left.remove(e,t),null);else{n.left.fa()&&(n=ag(n)),n.right.e()||n.right.fa()||n.right.left.fa()||(n=bg(n),n.left.left.fa()&&(n=ag(n),n=bg(n)));if(0===t(e,n.key)){if(n.right.e())return Sf;r=Xf(n.right),n=n.Y(r.key,r.value,null,null,Zf(n.right))}n=n.Y(null,null,null,null,n.right.remove(e,t))}return Yf(n)},g.fa=function(){return this.color},g=dg.prototype,g.Y=function(){return this},g.Ra=function(e,t){return new Wf(e,t,null)},g.remove=function(){return this},g.count=function(){return 0},g.e=function(){return!0},g.ia=function(){return!1},g.Hc=function(){return null},g.fc=function(){return null},g.fa=function(){return!1};var Sf=new dg;g=P.prototype,g.J=function(){return!1},g.C=function(){return this.aa||F},g.ga=function(e){return this.k.e()?this:new P(this.k,e,this.zb)},g.R=function(e){return".priority"===e?this.C():(e=this.k.get(e),null===e?F:e)},g.Q=function(e){var t=J(e);return null===t?this:this.R(t).Q(D(e))},g.Fa=function(e){return null!==this.k.get(e)},g.U=function(e,t){H(t,"We should always be passing snapshot nodes");if(".priority"===e)return this.ga(t);var n=new K(e,t),r,i;return t.e()?(r=this.k.remove(e),n=Ie(this.zb,n,this.k)):(r=this.k.Ra(e,t),n=Ge(this.zb,n,this.k)),i=r.e()?F:this.aa,new P(r,i,n)},g.F=function(e,t){var n=J(e);if(null===n)return t;H(".priority"!==J(e)||1===Wd(e),".priority must be the last token in a path");var r=this.R(n).F(D(e),t);return this.U(n,r)},g.e=function(){return this.k.e()},g.Fb=function(){return this.k.count()};var eg=/^(0|[1-9]\d*)$/;g=P.prototype,g.H=function(e){if(this.e())return null;var t={},n=0,r=0,i=!0;this.P(N,function(s,o){t[s]=o.H(e),n++,i&&eg.test(s)?r=Math.max(r,Number(s)):i=!1});if(!e&&i&&r<2*n){var s=[],o;for(o in t)s[o]=t[o];return s}return e&&!this.C().e()&&(t[".priority"]=this.C().H()),t},g.hash=function(){if(null===this.Eb){var e="";this.C().e()||(e+="priority:"+pe(this.C().H())+":"),this.P(N,function(t,n){var r=n.hash();""!==r&&(e+=":"+t+":"+r)}),this.Eb=""===e?"":Yc(e)}return this.Eb},g.Xe=function(e,t,n){return(n=fg(this,n))?(e=Tf(n,new K(e,t)))?e.name:null:Tf(this.k,e)},g.P=function(e,t){var n=fg(this,e);return n?n.ia(function(e){return t(e.name,e.S)}):this.k.ia(t)},g.Xb=function(e){return this.Yb(e.Ic(),e)},g.Yb=function(e,t){var n=fg(this,t);if(n)return n.Yb(e,function(e){return e});for(var n=this.k.Yb(e.name,Nc),r=Vf(n);null!=r&&0>t.compare(r,e);)R(n),r=Vf(n);return n},g.Ye=function(e){return this.$b(e.Gc(),e)},g.$b=function(e,t){var n=fg(this,t);if(n)return n.$b(e,function(e){return e});for(var n=this.k.$b(e.name,Nc),r=Vf(n);null!=r&&0<t.compare(r,e);)R(n),r=Vf(n);return n},g.tc=function(e){return this.e()?e.e()?0:-1:e.J()||e.e()?1:e===ue?-1:0},g.ob=function(e){if(e===ae||ua(this.zb.dc,e.toString()))return this;var t=this.zb,n=this.k;H(e!==ae,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r=[],i=!1,n=n.Xb(Nc),s=R(n);s;)i=i||e.yc(s.S),r.push(s),s=R(n);return r=i?He(r,ke(e)):re,i=e.toString(),n=ya(t.dc),n[i]=e,e=ya(t.od),e[i]=r,new P(this.k,this.aa,new Fe(e,n))},g.zc=function(e){return e===ae||ua(this.zb.dc,e.toString())},g.ca=function(e){if(e===this)return!0;if(e.J())return!1;if(this.C().ca(e.C())&&this.k.count()===e.k.count()){var t=this.Xb(N);e=e.Xb(N);for(var n=R(t),r=R(e);n&&r;){if(n.name!==r.name||!n.S.ca(r.S))return!1;n=R(t),r=R(e)}return null===n&&null===r}return!1},g.toString=function(){return B(this.H(!0))};var gg=Math.log(2),F=new P(new Rf(Mc),null,Je);ka(jg,P),g=jg.prototype,g.tc=function(e){return e===this?0:1},g.ca=function(e){return e===this},g.C=function(){return this},g.R=function(){return F},g.e=function(){return!1};var ue=new jg,se=new K("[MIN_NAME]",F),ye=new K("[MAX_NAME]",ue);W.prototype.H=function(){return y("Firebase.DataSnapshot.val",0,0,arguments.length),this.A.H()},W.prototype.val=W.prototype.H,W.prototype.Se=function(){return y("Firebase.DataSnapshot.exportVal",0,0,arguments.length),this.A.H(!0)},W.prototype.exportVal=W.prototype.Se,W.prototype.Tf=function(){return y("Firebase.DataSnapshot.exists",0,0,arguments.length),!this.A.e()},W.prototype.exists=W.prototype.Tf,W.prototype.m=function(e){y("Firebase.DataSnapshot.child",0,1,arguments.length),fa(e)&&(e=String(e)),Hf("Firebase.DataSnapshot.child",e);var t=new L(e),n=this.W.m(t);return new W(this.A.Q(t),n,N)},W.prototype.child=W.prototype.m,W.prototype.Fa=function(e){y("Firebase.DataSnapshot.hasChild",1,1,arguments.length),Hf("Firebase.DataSnapshot.hasChild",e);var t=new L(e);return!this.A.Q(t).e()},W.prototype.hasChild=W.prototype.Fa,W.prototype.C=function(){return y("Firebase.DataSnapshot.getPriority",0,0,arguments.length),this.A.C().H()},W.prototype.getPriority=W.prototype.C,W.prototype.forEach=function(e){y("Firebase.DataSnapshot.forEach",1,1,arguments.length),A("Firebase.DataSnapshot.forEach",1,e,!1);if(this.A.J())return!1;var t=this;return!!this.A.P(this.g,function(n,r){return e(new W(r,t.W.m(n),N))})},W.prototype.forEach=W.prototype.forEach,W.prototype.kd=function(){return y("Firebase.DataSnapshot.hasChildren",0,0,arguments.length),this.A.J()?!1:!this.A.e()},W.prototype.hasChildren=W.prototype.kd,W.prototype.getKey=function(){return y("Firebase.DataSnapshot.key",0,0,arguments.length),this.W.getKey()},od(W.prototype,"key",W.prototype.getKey),W.prototype.Fb=function(){return y("Firebase.DataSnapshot.numChildren",0,0,arguments.length),this.A.Fb()},W.prototype.numChildren=W.prototype.Fb,W.prototype.xb=function(){return y("Firebase.DataSnapshot.ref",0,0,arguments.length),this.W},od(W.prototype,"ref",W.prototype.xb),Ud.prototype.u=function(){return this.Ld},g=kg.prototype,g.u=function(){return this.Na.u().j()},g.jb=function(e){var t=Ec(this.Na);return t&&(S(this.W.n)||!e.e()&&!t.R(J(e)).e())?t.Q(e):null},g.e=function(){return 0===this.ab.length},g.Ob=function(e){this.ab.push(e)},g.mb=function(e,t){var n=[];if(t){H(null==e,"A cancel should cancel all event registrations.");var r=this.W.path;Ja(this.ab,function(e){(e=e.Ne(t,r))&&n.push(e)})}if(e){for(var i=[],s=0;s<this.ab.length;++s){var o=this.ab[s];if(!o.matches(e))i.push(o);else if(e.Ze()){i=i.concat(this.ab.slice(s+1));break}}this.ab=i}else this.ab=[];return n},g.gb=function(e,t,n){e.type===Dd&&null!==e.source.Ib&&(H(Ec(this.Na),"We should always have a full cache before handling merges"),H(Vd(this.Na),"Missing event cache, even though we have a server cache"));var r=this.Na;return e=this.mf.gb(r,e,t,n),t=this.mf,n=e.Sd,H(n.O.j().zc(t.V.g),"Event snap not indexed"),H(n.u().j().zc(t.V.g),"Server snap not indexed"),H(Hc(e.Sd.u())||!Hc(r.u()),"Once a server snap is complete, it should never go back"),this.Na=e.Sd,mg(this,e.Kf,e.Sd.O.j(),null)},g=og.prototype,g.rf=function(e){return"value"===e},g.createEvent=function(e,t){var n=t.n.g;return new xc("value",this,new W(e.Ma,t.xb(),n))},g.Ub=function(e){var t=this.ub;if("cancel"===e.ge()){H(this.sb,"Raising a cancel event on a listener with no cancel callback");var n=this.sb;return function(){n.call(t,e.error)}}var r=this.Qb;return function(){r.call(t,e.Md)}},g.Ne=function(e,t){return this.sb?new yc(this,e,t):null},g.matches=function(e){return e instanceof og?e.Qb&&this.Qb?e.Qb===this.Qb&&e.ub===this.ub:!0:!1},g.Ze=function(){return null!==this.Qb},g=pg.prototype,g.rf=function(e){return e="children_added"===e?"child_added":e,("children_removed"===e?"child_removed":e)in this.ha},g.Ne=function(e,t){return this.sb?new yc(this,e,t):null},g.createEvent=function(e,t){H(null!=e.Za,"Child events should have a childName.");var n=t.xb().m(e.Za);return new xc(e.type,this,new W(e.Ma,n,t.n.g),e.Dd)},g.Ub=function(e){var t=this.ub;if("cancel"===e.ge()){H(this.sb,"Raising a cancel event on a listener with no cancel callback");var n=this.sb;return function(){n.call(t,e.error)}}var r=this.ha[e.gd];return function(){r.call(t,e.Md,e.Dd)}},g.matches=function(e){if(e instanceof pg){if(!this.ha||!e.ha)return!0;if(this.ub===e.ub){var t=qa(e.ha);if(t===qa(this.ha)){if(1===t){var t=ra(e.ha),n=ra(this.ha);return n===t&&(!e.ha[t]||!this.ha[n]||e.ha[t]===this.ha[n])}return pa(this.ha,function(t,n){return e.ha[n]===t})}}}return!1},g.Ze=function(){return null!==this.ha},g=X.prototype,g.xb=function(){return y("Query.ref",0,0,arguments.length),new U(this.w,this.path)},g.hc=function(e,t,n,r){y("Query.on",2,4,arguments.length),Ff("Query.on",e,!1),A("Query.on",2,t,!1);var i=tg("Query.on",n,r);if("value"===e)ug(this.w,this,new og(t,i.cancel||null,i.Pa||null));else{var s={};s[e]=t,ug(this.w,this,new pg(s,i.cancel,i.Pa))}return t},g.Jc=function(e,t,n){y("Query.off",0,3,arguments.length),Ff("Query.off",e,!0),A("Query.off",2,t,!0),Eb("Query.off",3,n);var r=null,i=null;"value"===e?r=new og(t||null,null,n||null):e&&(t&&(i={},i[e]=t),r=new pg(i,null,n||null)),i=this.w,r=".info"===J(this.path)?i.pd.mb(this,r):i.K.mb(this,r),tc(i.da,this.path,r)},g.ig=function(e,t){function n(u){s&&(s=!1,i.Jc(e,n),t&&t.call(r.Pa,u),o.resolve(u))}y("Query.once",1,4,arguments.length),Ff("Query.once",e,!1),A("Query.once",2,t,!0);var r=tg("Query.once",arguments[2],arguments[3]),i=this,s=!0,o=new Hb;return Jb(o.ra),this.hc(e,n,function(t){i.Jc(e,n),r.cancel&&r.cancel.call(r.Pa,t),o.reject(t)}),o.ra},g.me=function(e){y("Query.limitToFirst",1,1,arguments.length);if(!fa(e)||Math.floor(e)!==e||0>=e)throw Error("Query.limitToFirst: First argument must be a positive integer.");if(this.n.xa)throw Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new X(this.w,this.path,this.n.me(e),this.Oc)},g.ne=function(e){y("Query.limitToLast",1,1,arguments.length);if(!fa(e)||Math.floor(e)!==e||0>=e)throw Error("Query.limitToLast: First argument must be a positive integer.");if(this.n.xa)throw Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new X(this.w,this.path,this.n.ne(e),this.Oc)},g.jg=function(e){y("Query.orderByChild",1,1,arguments.length);if("$key"===e)throw Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===e)throw Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===e)throw Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');Hf("Query.orderByChild",e),sg(this,"Query.orderByChild");var t=new L(e);if(t.e())throw Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");return t=new te(t),t=De(this.n,t),qg(t),new X(this.w,this.path,t,!0)},g.kg=function(){y("Query.orderByKey",0,0,arguments.length),sg(this,"Query.orderByKey");var e=De(this.n,ae);return qg(e),new X(this.w,this.path,e,!0)},g.lg=function(){y("Query.orderByPriority",0,0,arguments.length),sg(this,"Query.orderByPriority");var e=De(this.n,N);return qg(e),new X(this.w,this.path,e,!0)},g.mg=function(){y("Query.orderByValue",0,0,arguments.length),sg(this,"Query.orderByValue");var e=De(this.n,ze);return qg(e),new X(this.w,this.path,e,!0)},g.Nd=function(e,t){y("Query.startAt",0,2,arguments.length),Af("Query.startAt",e,this.path,!0),Gf("Query.startAt",t);var n=this.n.Nd(e,t);rg(n),qg(n);if(this.n.ka)throw Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return p(e)||(t=e=null),new X(this.w,this.path,n,this.Oc)},g.fd=function(e,t){y("Query.endAt",0,2,arguments.length),Af("Query.endAt",e,this.path,!0),Gf("Query.endAt",t);var n=this.n.fd(e,t);rg(n),qg(n);if(this.n.na)throw Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new X(this.w,this.path,n,this.Oc)},g.Pf=function(e,t){y("Query.equalTo",1,2,arguments.length),Af("Query.equalTo",e,this.path,!1),Gf("Query.equalTo",t);if(this.n.ka)throw Error("Query.equalTo: Starting point was already set (by another call to endAt or equalTo).");if(this.n.na)throw Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.Nd(e,t).fd(e,t)},g.toString=function(){y("Query.toString",0,0,arguments.length);for(var e=this.path,t="",n=e.Z;n<e.o.length;n++)""!==e.o[n]&&(t+="/"+encodeURIComponent(String(e.o[n])));return this.w.toString()+(t||"/")},g.ya=function(){var e=jd(Ee(this.n));return"{}"===e?"default":e},X.prototype.on=X.prototype.hc,X.prototype.off=X.prototype.Jc,X.prototype.once=X.prototype.ig,X.prototype.limitToFirst=X.prototype.me,X.prototype.limitToLast=X.prototype.ne,X.prototype.orderByChild=X.prototype.jg,X.prototype.orderByKey=X.prototype.kg,X.prototype.orderByPriority=X.prototype.lg,X.prototype.orderByValue=X.prototype.mg,X.prototype.startAt=X.prototype.Nd,X.prototype.endAt=X.prototype.fd,X.prototype.equalTo=X.prototype.Pf,X.prototype.toString=X.prototype.toString,od(X.prototype,"ref",X.prototype.xb);var wg=new Rf(function(e,t){return e===t?0:e<t?-1:1});g=vg.prototype,g.e=function(){return null===this.value&&this.children.e()},g.subtree=function(e){if(e.e())return this;var t=this.children.get(J(e));return null!==t?t.subtree(D(e)):Q},g.set=function(e,t){if(e.e())return new vg(t,this.children);var n=J(e),r=(this.children.get(n)||Q).set(D(e),t),n=this.children.Ra(n,r);return new vg(this.value,n)},g.remove=function(e){if(e.e())return this.children.e()?Q:new vg(null,this.children);var t=J(e),n=this.children.get(t);return n?(e=n.remove(D(e)),t=e.e()?this.children.remove(t):this.children.Ra(t,e),null===this.value&&t.e()?Q:new vg(this.value,t)):this},g.get=function(e){if(e.e())return this.value;var t=this.children.get(J(e));return t?t.get(D(e)):null};var Q=new vg(null);vg.prototype.toString=function(){var e={};return Yd(this,function(t,n){e[t.toString()]=n.toString()}),B(e)},Ig.prototype.Nc=function(e){return this.path.e()?null!=this.Pb.value?(H(this.Pb.children.e(),"affectedTree should not have overlapping affected paths."),this):(e=this.Pb.subtree(new L(e)),new Ig(C,e,this.Id)):(H(J(this.path)===e,"operationForChild called for unrelated child."),new Ig(D(this.path),this.Pb,this.Id))},Ig.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" ack write revert="+this.Id+" affectedTree="+this.Pb+")"};var $b=0,Dd=1,Qd=2,bc=3,Jg=new Kg(!0,!1,null,!1),Lg=new Kg(!1,!0,null,!1);Kg.prototype.toString=function(){return this.ee?"user":this.De?"server(queryID="+this.Ib+")":"server"};var Ng=new Mg(new vg(null));Mg.prototype.Ed=function(e){return e.e()?Ng:(e=$d(this.X,e,Q),new Mg(e))},Mg.prototype.e=function(){return this.X.e()},Mg.prototype.apply=function(e){return Tg(C,this.X,e)},g=Ug.prototype,g.e=function(){return xa(this.Aa)},g.gb=function(e,n,r){var i=e.source.Ib;if(null!==i)return i=x(this.Aa,i),H(null!=i,"SyncTree gave us an op for an invalid query."),i.gb(e,n,r);var s=[];return t(this.Aa,function(t){s=s.concat(t.gb(e,n,r))}),s},g.Ob=function(e,t,n,r,i){var s=e.ya(),o=x(this.Aa,s);if(!o){var o=n.Ba(i?r:null),u=!1;o?u=!0:(o=r instanceof P?n.sc(r):F,u=!1),o=new kg(e,new Ud(new Dc(o,u,!1),new Dc(r,i,!1))),this.Aa[s]=o}return o.Ob(t),ng(o,t)},g.mb=function(e,n,r){var i=e.ya(),s=[],o=[],u=null!=Vg(this);if("default"===i){var a=this;t(this.Aa,function(e,t){o=o.concat(e.mb(n,r)),e.e()&&(delete a.Aa[t],S(e.W.n)||s.push(e.W))})}else{var f=x(this.Aa,i);f&&(o=o.concat(f.mb(n,r)),f.e()&&(delete this.Aa[i],S(f.W.n)||s.push(f.W)))}return u&&null==Vg(this)&&s.push(new U(e.w,e.path)),{qg:s,Rf:o}},g.jb=function(e){var n=null;return t(this.Aa,function(t){n=n||t.jb(e)}),n},g=Yg.prototype,g.Ed=function(e){var n=Pa(this.la,function(t){return t.Zc===e});H(0<=n,"removeWrite called with nonexistent writeId.");var r=this.la[n];this.la.splice(n,1);for(var i=r.visible,s=!1,o=this.la.length-1;i&&0<=o;){var u=this.la[o];u.visible&&(o>=n&&$g(u,r.path)?i=!1:r.path.contains(u.path)&&(s=!0)),o--}if(i){if(s)this.T=ah(this.la,bh,C),this.Cc=0<this.la.length?this.la[this.la.length-1].Zc:-1;else if(r.Ja)this.T=this.T.Ed(r.path);else{var a=this;t(r.children,function(e,t){a.T=a.T.Ed(r.path.m(t))})}return!0}return!1},g.Ba=function(e,t,n,r){if(n||r){var i=Sg(this.T,e);return!r&&i.e()?t:r||null!=t||null!=Qg(i,C)?(i=ah(this.la,function(t){return(t.visible||r)&&(!n||!(0<=Ia(n,t.Zc)))&&(t.path.contains(e)||e.contains(t.path))},e),t=t||F,i.apply(t)):null}return i=Qg(this.T,e),null!=i?i:(i=Sg(this.T,e),i.e()?t:null!=t||null!=Qg(i,C)?(t=t||F,i.apply(t)):null)},g.sc=function(e,t){var n=F,r=Qg(this.T,e);if(r)r.J()||r.P(N,function(e,t){n=n.U(e,t)});else if(t){var i=Sg(this.T,e);t.P(N,function(e,t){var r=Sg(i,new L(e)).apply(t);n=n.U(e,r)}),Ja(Rg(i),function(e){n=n.U(e.name,e.S)})}else i=Sg(this.T,e),Ja(Rg(i),function(e){n=n.U(e.name,e.S)});return n},g.$c=function(e,t,n,r){return H(n||r,"Either existingEventSnap or existingServerSnap must exist"),e=e.m(t),null!=Qg(this.T,e)?null:(e=Sg(this.T,e),e.e()?r.Q(t):e.apply(r.Q(t)))},g.rc=function(e,t,n){e=e.m(t);var r=Qg(this.T,e);return null!=r?r:Cc(n,t)?Sg(this.T,e).apply(n.j().R(t)):null},g.mc=function(e){return Qg(this.T,e)},g.Xd=function(e,t,n,r,i,s){var o;e=Sg(this.T,e),o=Qg(e,C);if(null==o){if(null==t)return[];o=e.apply(t)}o=o.ob(s);if(o.e()||o.J())return[];t=[],e=ke(s),i=i?o.$b(n,s):o.Yb(n,s);for(s=R(i);s&&t.length<r;)0!==e(s,n)&&t.push(s),s=R(i);return t},g=ch.prototype,g.Ba=function(e,t,n){return this.X.Ba(this.Mb,e,t,n)},g.sc=function(e){return this.X.sc(this.Mb,e)},g.$c=function(e,t,n){return this.X.$c(this.Mb,e,t,n)},g.mc=function(e){return this.X.mc(this.Mb.m(e))},g.Xd=function(e,t,n,r,i){return this.X.Xd(this.Mb,e,t,n,r,i)},g.rc=function(e,t){return this.X.rc(this.Mb,e,t)},g.m=function(e){return new ch(this.Mb.m(e),this.X)},g=eh.prototype,g.Ea=function(){return this.A.value},g.clear=function(){this.A.value=null,this.A.children={},this.A.ad=0,hh(this)},g.kd=function(){return 0<this.A.ad},g.e=function(){return null===this.Ea()&&!this.kd()},g.P=function(e){var n=this;t(this.A.children,function(t,r){e(new eh(r,n,t))})},g.path=function(){return new L(null===this.Ha?this.ud:this.Ha.path()+"/"+this.ud)},g.name=function(){return this.ud},g.parent=function(){return this.Ha};var lh=0,nh=0;g=kh.prototype,g.ua=function(e,t,n){var r=++this.rg;e={r:r,a:e,b:t},this.f(B(e)),H(this.ma,"sendRequest call when we're not connected not allowed."),this.Ia.ua(e),n&&(this.Gd[r]=n)},g.bf=function(e,t,n,r){var i=e.ya(),s=e.path.toString();this.f("Listen called for "+s+" "+i),this.$[s]=this.$[s]||{},H(zd(e.n)||!S(e.n),"listen() called for non-default but complete query"),H(!this.$[s][i],"listen() called twice for same path/queryId."),e={G:r,ld:t,ng:e,tag:n},this.$[s][i]=e,this.ma&&oh(this,e)},g.of=function(e){this.pb=e,this.f("Auth token refreshed"),this.pb?qh(this):this.ma&&this.ua("unauth",{},function(){});if(e&&40===e.length||pd(e))this.f("Admin auth credential detected.  Reducing max reconnect time."),this.td=3e4},g.Cf=function(e,t){var n=e.path.toString(),r=e.ya();this.f("Unlisten called for "+n+" "+r),H(zd(e.n)||!S(e.n),"unlisten() called for non-default but complete query");if(ph(this,n,r)&&this.ma){var i=Ee(e.n);this.f("Unlisten on "+n+" for "+r),n={p:n},t&&(n.q=i,n.t=t),this.ua("n",n)}},g.qe=function(e,t,n){this.ma?sh(this,"o",e,t,n):this.Lc.push({ve:e,action:"o",data:t,G:n})},g.ef=function(e,t,n){this.ma?sh(this,"om",e,t,n):this.Lc.push({ve:e,action:"om",data:t,G:n})},g.xd=function(e,t){this.ma?sh(this,"oc",e,null,t):this.Lc.push({ve:e,action:"oc",data:null,G:t})},g.put=function(e,t,n,r){th(this,"p",e,t,n,r)},g.cf=function(e,t,n,r){th(this,"m",e,t,n,r)},g.xe=function(e){this.ma&&(e={c:e},this.f("reportStats",e),this.ua("s",e,function(e){"ok"!==e.s&&this.f("reportStats","Error sending stats: "+e.d)}))},g.wd=function(e){if("r"in e){this.f("from server: "+B(e));var t=e.r,n=this.Gd[t];n&&(delete this.Gd[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&(t=e.a,e=e.b,this.f("handleServerMessage",t,e),"d"===t?this.Hb(e.p,e.d,!1,e.t):"m"===t?this.Hb(e.p,e.d,!0,e.t):"c"===t?vh(this,e.p,e.q):"ac"===t?rh(this,e.s,e.d):"sd"===t?this.ye?this.ye(e):"msg"in e&&"undefined"!=typeof console&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: ")):cd("Unrecognized action received from server: "+B(t)+"\nAre you using the latest client?"))}},g.Mc=function(e,t){this.f("connection ready"),this.ma=!0,this.Bc=(new Date).getTime(),this.te({serverTimeOffset:e-(new Date).getTime()}),this.Db=t;if(this.Te){var n={};n["sdk.js."+firebase.SDK_VERSION.replace(/\./g,"-")]=1,"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test("undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:"")?n["framework.cordova"]=1:"object"==typeof navigator&&"ReactNative"===navigator.product&&(n["framework.reactnative"]=1),this.xe(n)}wh(this),this.Te=!1,this.Kc(!0)},g.hg=function(e){e&&!this.Nb&&this.Va===this.td&&(this.f("Window became visible.  Reducing delay."),this.Va=1e3,this.Ia||mh(this,0)),this.Nb=e},g.gg=function(e){e?(this.f("Browser went online."),this.Va=1e3,this.Ia||mh(this,0)):(this.f("Browser went offline.  Killing connection."),this.Ia&&this.Ia.close())},g.gf=function(){this.f("data client disconnected"),this.ma=!1,this.Ia=null;for(var e=0;e<this.pa.length;e++){var t=this.pa[e];t&&"h"in t.qf&&t.og&&(t.G&&t.G("disconnect"),delete this.pa[e],this.Pc--)}0===this.Pc&&(this.pa=[]),this.Gd={},yh(this)&&(this.Nb?this.Bc&&(3e4<(new Date).getTime()-this.Bc&&(this.Va=1e3),this.Bc=null):(this.f("Window isn't visible.  Delaying reconnect."),this.Va=this.td,this.le=(new Date).getTime()),e=Math.max(0,this.Va-((new Date).getTime()-this.le)),e*=Math.random(),this.f("Trying to reconnect in "+e+"ms"),mh(this,e),this.Va=Math.min(this.td,1.3*this.Va)),this.Kc(!1)},g.eb=function(e){E("Interrupting connection for reason: "+e),this.qd[e]=!0,this.Ia?this.Ia.close():(this.vb&&(clearTimeout(this.vb),this.vb=null),this.ma&&this.gf())},g.lc=function(e){E("Resuming connection for reason: "+e),delete this.qd[e],xa(this.qd)&&(this.Va=1e3,this.Ia||mh(this,0))};var Y={Vf:function(){Ne=td=!0}};Y.forceLongPolling=Y.Vf,Y.Wf=function(){Oe=!0},Y.forceWebSockets=Y.Wf,Y.bg=function(){return rd.isAvailable()},Y.isWebSocketsAvailable=Y.bg,Y.ug=function(e,t){e.w.Ua.ye=t},Y.setSecurityDebugCallback=Y.ug,Y.Ae=function(e,t){e.w.Ae(t)},Y.stats=Y.Ae,Y.Be=function(e,t){e.w.Be(t)},Y.statsIncrementCounter=Y.Be,Y.ed=function(e){return e.w.ed},Y.dataUpdateCount=Y.ed,Y.ag=function(e,t){e.w.je=t},Y.interceptServerData=Y.ag,zh.prototype.Ob=function(e,t){var n=e.path,r=null,i=!1;Eg(this.wa,n,function(e,t){var s=T(e,n);r=r||t.jb(s),i=i||null!=Vg(t)});var s=this.wa.get(n);s?(i=i||null!=Vg(s),r=r||s.jb(C)):(s=new Ug,this.wa=this.wa.set(n,s));var o;null!=r?o=!0:(o=!1,r=F,Hg(this.wa.subtree(n),function(e,t){var n=t.jb(C);n&&(r=r.U(e,n))}));var u=null!=Xg(s,e);if(!u&&!S(e.n)){var a=Kh(e);H(!(a in this.jc),"View does not exist, but we have a tag");var f=Lh++;this.jc[a]=f,this.Ce["_"+f]=a}return o=s.Ob(e,t,new ch(n,this.lb),r,o),u||i||(s=Xg(s,e),o=o.concat(Mh(this,e,s))),o},zh.prototype.mb=function(e,t,n){var r=e.path,i=this.wa.get(r),s=[];if(i&&("default"===e.ya()||null!=Xg(i,e))){s=i.mb(e,t,n),i.e()&&(this.wa=this.wa.remove(r)),i=s.qg,s=s.Rf,t=-1!==Pa(i,function(e){return S(e.n)});var o=Cg(this.wa,r,function(e,t){return null!=Vg(t)});if(t&&!o&&(r=this.wa.subtree(r),!r.e()))for(var r=Nh(r),u=0;u<r.length;++u){var a=r[u],f=a.W,a=Oh(this,a);this.Dc.ze(Ph(f),Qh(this,f),a.ld,a.G)}if(!o&&0<i.length&&!n)if(t)this.Dc.Od(Ph(e),null);else{var l=this;Ja(i,function(e){e.ya();var t=l.jc[Kh(e)];l.Dc.Od(Ph(e),t)})}Rh(this,i)}return s},zh.prototype.Ba=function(e,t){var n=this.lb,r=Cg(this.wa,e,function(t,n){var r=T(t,e);if(r=n.jb(r))return r});return n.Ba(e,r,t,!0)};var Lh=1;g=pf.prototype,g.toString=function(){return(this.M.Sc?"https://":"http://")+this.M.host},g.name=function(){return this.M.oe},g.Hb=function(e,t,n,r){this.ed++;var i=new L(e);t=this.je?this.je(e,t):t,e=[],r?n?(t=oa(t,function(e){return M(e)}),e=Jh(this.K,i,t,r)):(t=M(t),e=Fh(this.K,i,t,r)):n?(r=oa(t,function(e){return M(e)}),e=Eh(this.K,i,r)):(r=M(t),e=Bh(this.K,new Zb(Lg,i,r))),r=i,0<e.length&&(r=Xh(this,i)),vc(this.da,r,e)},g.Kc=function(e){Uh(this,"connected",e),!1===e&&Yh(this)},g.te=function(e){var t=this;ld(e,function(e,n){Uh(t,n,e)})},g.Kb=function(e,t,n,r){this.f("set",{path:e.toString(),value:t,Cg:n});var i=Wh(this);t=M(t,n);var i=Tc(t,i),s=this.vd++,i=Ah(this.K,e,i,s,!0);rc(this.da,i);var o=this;this.va.put(e.toString(),t.H(!0),function(t,n){var i="ok"===t;i||O("set at "+e+" failed: "+t),i=Dh(o.K,s,!i),vc(o.da,e,i),Zh(r,t,n)}),i=$h(this,e),Xh(this,i),vc(this.da,i,[])},g.update=function(e,n,r){this.f("update",{path:e.toString(),value:n});var i=!0,s=Wh(this),o={};t(n,function(e,t){i=!1;var n=M(e);o[t]=Tc(n,s)});if(i)E("update() called with empty data.  Don't do anything."),Zh(r,"ok");else{var u=this.vd++,a=Ch(this.K,e,o,u);rc(this.da,a);var f=this;this.va.cf(e.toString(),n,function(t,n){var i="ok"===t;i||O("update at "+e+" failed: "+t);var i=Dh(f.K,u,!i),s=e;0<i.length&&(s=Xh(f,e)),vc(f.da,s,i),Zh(r,t,n)}),n=$h(this,e),Xh(this,n),vc(this.da,e,[])}},g.xd=function(e,t){var n=this;this.va.xd(e.toString(),function(r,i){"ok"===r&&vf(n.ja,e),Zh(t,r,i)})},g.eb=function(){this.Ua&&this.Ua.eb("repo_interrupt")},g.lc=function(){this.Ua&&this.Ua.lc("repo_interrupt")},g.Ae=function(e){if("undefined"!=typeof console){e?(this.Vc||(this.Vc=new jc(this.Xa)),e=this.Vc.get()):e=this.Xa.get();var t=Ma(ta(e),function(e,t){return Math.max(t.length,e)},0),n;for(n in e){for(var r=e[n],i=n.length;i<t+2;i++)n+=" ";console.log(n+r)}}},g.Be=function(e){lc(this.Xa,e),this.wg.xf[e]=!0},g.f=function(e){var t="";this.Ua&&(t=this.Ua.id+":"),E(t,arguments)},uf.prototype.eb=function(){for(var e in this.nb)this.nb[e].eb()},uf.prototype.lc=function(){for(var e in this.nb)this.nb[e].lc()},uf.prototype.ce=function(e){this.Df=e},ba(uf),uf.prototype.interrupt=uf.prototype.eb,uf.prototype.resume=uf.prototype.lc;var Z={};Z.pc=kh,Z.DataConnection=Z.pc,kh.prototype.vg=function(e,t){this.ua("q",{p:e},t)},Z.pc.prototype.simpleListen=Z.pc.prototype.vg,kh.prototype.Of=function(e,t){this.ua("echo",{d:e},t)},Z.pc.prototype.echo=Z.pc.prototype.Of,kh.prototype.interrupt=kh.prototype.eb,Z.Gf=Ye,Z.RealTimeConnection=Z.Gf,Ye.prototype.sendRequest=Ye.prototype.ua,Ye.prototype.close=Ye.prototype.close,Z.$f=function(e){var t=kh.prototype.put;return kh.prototype.put=function(n,r,i,s){p(s)&&(s=e()),t.call(this,n,r,i,s)},function(){kh.prototype.put=t}},Z.hijackHash=Z.$f,Z.Ff=fc,Z.ConnectionTarget=Z.Ff,Z.ya=function(e){return e.ya()},Z.queryIdentifier=Z.ya,Z.cg=function(e){return e.w.Ua.$},Z.listens=Z.cg,Z.ce=function(e){uf.Wb().ce(e)},Z.forceRestClient=Z.ce,Z.Context=uf,ka(U,X),g=U.prototype,g.getKey=function(){return y("Firebase.key",0,0,arguments.length),this.path.e()?null:Xd(this.path)},g.m=function(e){y("Firebase.child",1,1,arguments.length);if(fa(e))e=String(e);else if(!(e instanceof L))if(null===J(this.path)){var t=e;t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Hf("Firebase.child",t)}else Hf("Firebase.child",e);return new U(this.w,this.path.m(e))},g.getParent=function(){y("Firebase.parent",0,0,arguments.length);var e=this.path.parent();return null===e?null:new U(this.w,e)},g.Xf=function(){y("Firebase.ref",0,0,arguments.length);for(var e=this;null!==e.getParent();)e=e.getParent();return e},g.Nf=function(){return this.w.$a},g.set=function(e,t){y("Firebase.set",1,2,arguments.length),If("Firebase.set",this.path),Af("Firebase.set",e,this.path,!1),A("Firebase.set",2,t,!0);var n=new Hb;return this.w.Kb(this.path,e,null,Ib(n,t)),n.ra},g.update=function(e,t){y("Firebase.update",1,2,arguments.length),If("Firebase.update",this.path);if(da(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,O("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}return Df("Firebase.update",e,this.path),A("Firebase.update",2,t,!0),n=new Hb,this.w.update(this.path,e,Ib(n,t)),n.ra},g.Kb=function(e,t,n){y("Firebase.setWithPriority",2,3,arguments.length),If("Firebase.setWithPriority",this.path),Af("Firebase.setWithPriority",e,this.path,!1),Ef("Firebase.setWithPriority",2,t),A("Firebase.setWithPriority",3,n,!0);if(".length"===this.getKey()||".keys"===this.getKey())throw"Firebase.setWithPriority failed: "+this.getKey()+" is a read-only object.";var r=new Hb;return this.w.Kb(this.path,e,t,Ib(r,n)),r.ra},g.remove=function(e){return y("Firebase.remove",0,1,arguments.length),If("Firebase.remove",this.path),A("Firebase.remove",1,e,!0),this.set(null,e)},g.transaction=function(e,t,n){y("Firebase.transaction",1,3,arguments.length),If("Firebase.transaction",this.path),A("Firebase.transaction",1,e,!1),A("Firebase.transaction",2,t,!0);if(p(n)&&"boolean"!=typeof n)throw Error(Db("Firebase.transaction",3,!0)+"must be a boolean.");if(".length"===this.getKey()||".keys"===this.getKey())throw"Firebase.transaction failed: "+this.getKey()+" is a read-only object.";"undefined"==typeof n&&(n=!0);var r=new Hb;return ga(t)&&Jb(r.ra),ai(this.w,this.path,e,function(e,n,i){e?r.reject(e):r.resolve(new Pb(n,i)),ga(t)&&t(e,n,i)},n),r.ra},g.tg=function(e,t){y("Firebase.setPriority",1,2,arguments.length),If("Firebase.setPriority",this.path),Ef("Firebase.setPriority",1,e),A("Firebase.setPriority",2,t,!0);var n=new Hb;return this.w.Kb(this.path.m(".priority"),e,null,Ib(n,t)),n.ra},g.push=function(e,t){y("Firebase.push",0,2,arguments.length),If("Firebase.push",this.path),Af("Firebase.push",e,this.path,!0),A("Firebase.push",2,t,!0);var n=Vh(this.w),i=Qf(n),n=this.m(i);if(null!=e){var s=this,o=n.set(e,t).then(function(){return s.m(i)});n.then=r(o.then,o),n["catch"]=r(o.then,o,void 0),ga(t)&&Jb(o)}return n},g.kb=function(){return If("Firebase.onDisconnect",this.path),new V(this.w,this.path)},U.prototype.child=U.prototype.m,U.prototype.set=U.prototype.set,U.prototype.update=U.prototype.update,U.prototype.setWithPriority=U.prototype.Kb,U.prototype.remove=U.prototype.remove,U.prototype.transaction=U.prototype.transaction,U.prototype.setPriority=U.prototype.tg,U.prototype.push=U.prototype.push,U.prototype.onDisconnect=U.prototype.kb,od(U.prototype,"database",U.prototype.Nf),od(U.prototype,"key",U.prototype.getKey),od(U.prototype,"parent",U.prototype.getParent),od(U.prototype,"root",U.prototype.Xf);if("undefined"==typeof firebase)throw Error("Cannot install Firebase Database - be sure to load firebase-app.js first.");try{firebase.INTERNAL.registerService("database",function(e){var t=uf.Wb(),n=e.options.databaseURL;p(n)||dd("Can't determine Firebase Database URL.  Be sure to include databaseURL option when calling firebase.intializeApp().");var r=ed(n),n=r.kc;return tf("Invalid Firebase Database URL",r),r.path.e()||dd("Database URL must point to the root of a Firebase Database (not including a child path)."),(r=x(t.nb,e.name))&&dd("FIREBASE INTERNAL ERROR: Database initialized multiple times."),r=new pf(n,t.Df,e),t.nb[e.name]=r,r.$a},{Reference:U,Query:X,Database:of,enableLogging:ad,INTERNAL:Y,TEST_ACCESS:Z,ServerValue:rf})}catch(ji){dd("Failed to register the Firebase Database Service ("+ji+")")}}(),function(){var e,t=t||{},n=this,r=function(e){return void 0!==e},i=function(){},s=function(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof Object)return t;var n=Object.prototype.toString.call(e);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof e.length&&"undefined"!=typeof e.splice&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||"undefined"!=typeof e.call&&"undefined"!=typeof e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==t&&"undefined"==typeof e.call)return"object";return t},o=function(e){var t=s(e);return"array"==t||"object"==t&&"number"==typeof e.length},u=function(e){return"string"==typeof e},a=function(e){return"function"==s(e)},f=function(e){var t=typeof e;return"object"==t&&null!=e||"function"==t},l="closure_uid_"+(1e9*Math.random()>>>0),c=0,h=function(e,t,n){return e.call.apply(e.bind,arguments)},p=function(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}},d=function(e,t,n){return d=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?h:p,d.apply(null,arguments)},v=Date.now||function(){return+(new Date)},m=function(e,t){function n(){}n.prototype=t.prototype,e.G=t.prototype,e.prototype=new n,e.Ma=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}},g=function(e,t,n){function r(){c||(c=!0,t.apply(null,arguments))}function i(t){a=setTimeout(function(){a=null,e(s,2===l)},t)}function s(e,t){if(!c)if(e)r.apply(null,arguments);else if(2===l||f)r.apply(null,arguments);else{64>u&&(u*=2);var n;1===l?(l=2,n=0):n=1e3*(u+Math.random()),i(n)}}function o(e){h||(h=!0,c||(null!==a?(e||(l=2),clearTimeout(a),i(0)):e||(l=1)))}var u=1,a=null,f=!1,l=0,c=!1,h=!1;return i(0),setTimeout(function(){f=!0,o(!0)},n),o},y="https://firebasestorage.googleapis.com",b=function(e,t){this.code="storage/"+e,this.message="Firebase Storage: "+t,this.serverResponse=null,this.name="FirebaseError"};m(b,Error);var w=function(){return new b("unknown","An unknown error occurred, please check the error payload for server response.")},E=function(){return new b("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again.")},S=function(e){return new b("unauthorized","User does not have permission to access '"+e+"'.")},x=function(){return new b("canceled","User canceled the upload/download.")},T=function(e,t,n){return new b("invalid-argument","Invalid argument in `"+t+"` at index "+e+": "+n)},N=function(){return new b("app-deleted","The Firebase app was deleted.")},C=function(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])},k=function(e){var t={};return C(e,function(e,n){t[e]=n}),t},L=function(e,t,n,r){this.l=e,this.f={},this.i=t,this.b={},this.c="",this.N=n,this.g=this.a=null,this.h=[200],this.j=r},A={STATE_CHANGED:"state_changed"},O={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"},M=function(e){switch(e){case"running":case"pausing":case"canceling":return"running";case"paused":return"paused";case"success":return"success";case"canceled":return"canceled";case"error":return"error";default:return"error"}},_=function(e){return r(e)&&null!==e},D=function(e){return"string"==typeof e||e instanceof String},P=function(e,t,n){this.f=n,this.c=e,this.g=t,this.b=0,this.a=null};P.prototype.get=function(){var e;return 0<this.b?(this.b--,e=this.a,this.a=e.next,e.next=null):e=this.c(),e};var H=function(e,t){e.g(t),e.b<e.f&&(e.b++,t.next=e.a,e.a=t)},B=function(e){if(Error.captureStackTrace)Error.captureStackTrace(this,B);else{var t=Error().stack;t&&(this.stack=t)}e&&(this.message=String(e))};m(B,Error),B.prototype.name="CustomError";var j=function(e,t,n,r,i){this.reset(e,t,n,r,i)};j.prototype.a=null;var F=0;j.prototype.reset=function(e,t,n,r,i){"number"==typeof i||F++,r||v(),this.b=t,delete this.a};var I=function(e){var t=[],n=0,r;for(r in e)t[n++]=e[r];return t},q=function(e){var t=[],n=0,r;for(r in e)t[n++]=r;return t},R=function(e){return null!==e&&"withCredentials"in e},U="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),z=function(e,t){for(var n,r,i=1;i<arguments.length;i++){r=arguments[i];for(n in r)e[n]=r[n];for(var s=0;s<U.length;s++)n=U[s],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}},W=function(e){e.prototype.then=e.prototype.then,e.prototype.$goog_Thenable=!0},X=function(e){if(!e)return!1;try{return!!e.$goog_Thenable}catch(t){return!1}},V=function(e){return V[" "](e),e};V[" "]=i;var $=function(e,t){for(var n=e.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")},J=String.prototype.trim?function(e){return e.trim()}:function(e){return e.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},K=function(e,t){return e<t?-1:e>t?1:0},Q=function(e,t){this.a=e,this.b=t};Q.prototype.clone=function(){return new Q(this.a,this.b)};var G=function(e,t){this.bucket=e,this.path=t},Y=function(e){var t=encodeURIComponent;return"/b/"+t(e.bucket)+"/o/"+t(e.path)},Z=function(e){for(var t=null,n=[{ja:/^gs:\/\/([A-Za-z0-9.\-]+)(\/(.*))?$/i,aa:{bucket:1,path:3},ia:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path=e.path.slice(0,-1))}},{ja:/^https?:\/\/firebasestorage\.googleapis\.com\/v[A-Za-z0-9_]+\/b\/([A-Za-z0-9.\-]+)\/o(\/([^?#]*).*)?$/i,aa:{bucket:1,path:3},ia:function(e){e.path=decodeURIComponent(e.path)}}],r=0;r<n.length;r++){var i=n[r],s=i.ja.exec(e);if(s){t=s[i.aa.bucket],(s=s[i.aa.path])||(s=""),t=new G(t,s),i.ia(t);break}}if(null==t)throw new b("invalid-url","Invalid URL '"+e+"'.");return t},et=function(e,t,n){a(e)||_(t)||_(n)?(this.next=e,this.error=t||null,this.a=n||null):(this.next=e.next||null,this.error=e.error||null,this.a=e.complete||null)},tt=function(e){var t=encodeURIComponent,n="?";return C(e,function(e,r){e=t(e)+"="+t(r),n=n+e+"&"}),n=n.slice(0,-1)},nt=function(e,t,n,r,i,s){this.b=e,this.h=t,this.f=n,this.a=r,this.g=i,this.c=s};e=nt.prototype,e.qa=function(){return this.b},e.La=function(){return this.h},e.Ia=function(){return this.f},e.Da=function(){return this.a},e.sa=function(){if(_(this.a)){var e=this.a.downloadURLs;return _(e)&&_(e[0])?e[0]:null}return null},e.Ka=function(){return this.g},e.Ga=function(){return this.c};var rt=function(e,t){t.unshift(e),B.call(this,$.apply(null,t)),t.shift()};m(rt,B),rt.prototype.name="AssertionError";var it=function(e,t,n,r){var i="Assertion failed";if(n)var i=i+(": "+n),s=r;else e&&(i+=": "+e,s=t);throw new rt(""+i,s||[])},st=function(e,t,n){e||it("",null,t,Array.prototype.slice.call(arguments,2))},ot=function(e,t){throw new rt("Failure"+(e?": "+e:""),Array.prototype.slice.call(arguments,1))},ut=function(e,t,n){a(e)||it("Expected function but got %s: %s.",[s(e),e],t,Array.prototype.slice.call(arguments,2))},at=function(){this.g=this.g,this.s=this.s};at.prototype.g=!1,at.prototype.fa=function(){this.g||(this.g=!0,this.A())},at.prototype.A=function(){if(this.s)for(;this.s.length;)this.s.shift()()};var ft="closure_listenable_"+(1e6*Math.random()|0),lt=0,ct;e:{var ht=n.navigator;if(ht){var pt=ht.userAgent;if(pt){ct=pt;break e}}ct=""}var dt=function(e){return-1!=ct.indexOf(e)},vt=function(){};vt.prototype.a=null;var mt=function(e){var t;return(t=e.a)||(t={},Ut(e)&&(t[0]=!0,t[1]=!0),t=e.a=t),t},gt=Array.prototype.indexOf?function(e,t,n){return st(null!=e.length),Array.prototype.indexOf.call(e,t,n)}:function(e,t,n){n=null==n?0:0>n?Math.max(0,e.length+n):n;if(u(e))return u(t)&&1==t.length?e.indexOf(t,n):-1;for(;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},yt=Array.prototype.forEach?function(e,t,n){st(null!=e.length),Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i=u(e)?e.split(""):e,s=0;s<r;s++)s in i&&t.call(n,i[s],s,e)},bt=Array.prototype.filter?function(e,t,n){return st(null!=e.length),Array.prototype.filter.call(e,t,n)}:function(e,t,n){for(var r=e.length,i=[],s=0,o=u(e)?e.split(""):e,a=0;a<r;a++)if(a in o){var f=o[a];t.call(n,f,a,e)&&(i[s++]=f)}return i},wt=Array.prototype.map?function(e,t,n){return st(null!=e.length),Array.prototype.map.call(e,t,n)}:function(e,t,n){for(var r=e.length,i=Array(r),s=u(e)?e.split(""):e,o=0;o<r;o++)o in s&&(i[o]=t.call(n,s[o],o,e));return i},Et=Array.prototype.some?function(e,t,n){return st(null!=e.length),Array.prototype.some.call(e,t,n)}:function(e,t,n){for(var r=e.length,i=u(e)?e.split(""):e,s=0;s<r;s++)if(s in i&&t.call(n,i[s],s,e))return!0;return!1},St=function(e){var t;e:{t=Rr;for(var n=e.length,r=u(e)?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:u(e)?e.charAt(t):e[t]},xt=function(e){if("array"!=s(e))for(var t=e.length-1;0<=t;t--)delete e[t];e.length=0},Tt=function(e,t){t=gt(e,t);var n;if(n=0<=t)st(null!=e.length),Array.prototype.splice.call(e,t,1);return n},Nt=function(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]},Ct=new P(function(){return new Lt},function(e){e.reset()},100),kt=function(){var e=En,t=null;return e.a&&(t=e.a,e.a=e.a.next,e.a||(e.b=null),t.next=null),t},Lt=function(){this.next=this.b=this.a=null};Lt.prototype.set=function(e,t){this.a=e,this.b=t,this.next=null},Lt.prototype.reset=function(){this.next=this.b=this.a=null};var At=function(e,t){this.type=e,this.a=this.target=t,this.ka=!0};At.prototype.b=function(){this.ka=!1};var Ot=function(e,t,n,r,i){this.listener=e,this.a=null,this.src=t,this.type=n,this.U=!!r,this.N=i,++lt,this.O=this.T=!1},Mt=function(e){e.O=!0,e.listener=null,e.a=null,e.src=null,e.N=null},_t=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/,Dt=function(e,t){return t=bt(t.split("/"),function(e){return 0<e.length}).join("/"),0===e.length?t:e+"/"+t},Pt=function(e){var t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)},Ht=function(e){this.src=e,this.a={},this.b=0},Bt=function(e,t,n,r,i,s){var o=t.toString();t=e.a[o],t||(t=e.a[o]=[],e.b++);var u=Ft(t,n,i,s);return-1<u?(e=t[u],r||(e.T=!1)):(e=new Ot(n,e.src,o,!!i,s),e.T=r,t.push(e)),e},jt=function(e,t){var n=t.type;n in e.a&&Tt(e.a[n],t)&&(Mt(t),0==e.a[n].length&&(delete e.a[n],e.b--))},Ft=function(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.O&&s.listener==t&&s.U==!!n&&s.N==r)return i}return-1},It,qt=function(){};m(qt,vt);var Rt=function(e){return(e=Ut(e))?new ActiveXObject(e):new XMLHttpRequest},Ut=function(e){if(!e.b&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var t=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<t.length;n++){var r=t[n];try{return new ActiveXObject(r),e.b=r}catch(i){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return e.b};It=new qt;var zt=function(e){this.a=[];if(e)e:{var t;if(e instanceof zt){if(t=e.D(),e=e.w(),0>=this.o()){for(var n=this.a,r=0;r<t.length;r++)n.push(new Q(t[r],e[r]));break e}}else t=q(e),e=I(e);for(r=0;r<t.length;r++)Wt(this,t[r],e[r])}},Wt=function(e,t,n){var r=e.a;r.push(new Q(t,n)),t=r.length-1,e=e.a;for(n=e[t];0<t;){if(r=t-1>>1,!(e[r].a>n.a))break;e[t]=e[r],t=r}e[t]=n};e=zt.prototype,e.w=function(){for(var e=this.a,t=[],n=e.length,r=0;r<n;r++)t.push(e[r].b);return t},e.D=function(){for(var e=this.a,t=[],n=e.length,r=0;r<n;r++)t.push(e[r].a);return t},e.clone=function(){return new zt(this)},e.o=function(){return this.a.length},e.F=function(){return 0==this.a.length},e.clear=function(){xt(this.a)};var Xt=function(){this.b=[],this.a=[]},Vt=function(e){return 0==e.b.length&&(e.b=e.a,e.b.reverse(),e.a=[]),e.b.pop()};Xt.prototype.o=function(){return this.b.length+this.a.length},Xt.prototype.F=function(){return 0==this.b.length&&0==this.a.length},Xt.prototype.clear=function(){this.b=[],this.a=[]},Xt.prototype.w=function(){for(var e=[],t=this.b.length-1;0<=t;--t)e.push(this.b[t]);for(var n=this.a.length,t=0;t<n;++t)e.push(this.a[t]);return e};var $t=function(e){if(e.w&&"function"==typeof e.w)return e.w();if(u(e))return e.split("");if(o(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}return I(e)},Jt=function(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(o(e)||u(e))yt(e,t,void 0);else{var n;if(e.D&&"function"==typeof e.D)n=e.D();else if(e.w&&"function"==typeof e.w)n=void 0;else if(o(e)||u(e)){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else n=q(e);for(var r=$t(e),i=r.length,s=0;s<i;s++)t.call(void 0,r[s],n&&n[s],e)}},Kt=function(e){n.setTimeout(function(){throw e},0)},Qt,Gt=function(){var e=n.MessageChannel;"undefined"==typeof e&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!dt("Presto")&&(e=function(){var e=document.createElement("IFRAME");e.style.display="none",e.src="",document.documentElement.appendChild(e);var t=e.contentWindow,e=t.document;e.open(),e.write(""),e.close();var n="callImmediate"+Math.random(),r="file:"==t.location.protocol?"*":t.location.protocol+"//"+t.location.host,e=d(function(e){("*"==r||e.origin==r)&&e.data==n&&this.port1.onmessage()},this);t.addEventListener("message",e,!1),this.port1={},this.port2={postMessage:function(){t.postMessage(n,r)}}});if("undefined"!=typeof e&&!dt("Trident")&&!dt("MSIE")){var t=new e,i={},s=i;return t.port1.onmessage=function(){if(r(i.next)){i=i.next;var e=i.ea;i.ea=null,e()}},function(e){s.next={ea:e},s=s.next,t.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(e){var t=document.createElement("SCRIPT");t.onreadystatechange=function(){t.onreadystatechange=null,t.parentNode.removeChild(t),t=null,e(),e=null},document.documentElement.appendChild(t)}:function(e){n.setTimeout(e,0)}},Yt="StopIteration"in n?n.StopIteration:{message:"StopIteration",stack:""},Zt=function(){};Zt.prototype.next=function(){throw Yt},Zt.prototype.X=function(){return this};var en=function(){zt.call(this)};m(en,zt);var tn=dt("Opera"),nn=dt("Trident")||dt("MSIE"),rn=dt("Edge"),sn=dt("Gecko")&&(-1==ct.toLowerCase().indexOf("webkit")||!!dt("Edge"))&&!dt("Trident")&&!dt("MSIE")&&!dt("Edge"),on=-1!=ct.toLowerCase().indexOf("webkit")&&!dt("Edge"),un=function(){var e=n.document;return e?e.documentMode:void 0},an;e:{var fn="",ln=function(){var e=ct;if(sn)return/rv\:([^\);]+)(\)|;)/.exec(e);if(rn)return/Edge\/([\d\.]+)/.exec(e);if(nn)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e);if(on)return/WebKit\/(\S+)/.exec(e);if(tn)return/(?:Version)[ \/]?(\S+)/.exec(e)}();ln&&(fn=ln?ln[1]:"");if(nn){var cn=un();if(null!=cn&&cn>parseFloat(fn)){an=String(cn);break e}}an=fn}var hn=an,pn={},dn=function(e){var t;if(!(t=pn[e])){t=0;for(var n=J(String(hn)).split("."),r=J(String(e)).split("."),i=Math.max(n.length,r.length),s=0;0==t&&s<i;s++){var o=n[s]||"",u=r[s]||"",a=/(\d*)(\D*)/g,f=/(\d*)(\D*)/g;do{var l=a.exec(o)||["","",""],c=f.exec(u)||["","",""];if(0==l[0].length&&0==c[0].length)break;t=K(0==l[1].length?0:parseInt(l[1],10),0==c[1].length?0:parseInt(c[1],10))||K(0==l[2].length,0==c[2].length)||K(l[2],c[2])}while(0==t)}t=pn[e]=0<=t}return t},vn=n.document,mn=vn&&nn?un()||("CSS1Compat"==vn.compatMode?parseInt(hn,10):5):void 0,gn=function(e,t){yn||bn(),wn||(yn(),wn=!0);var n=En,r=Ct.get();r.set(e,t),n.b?n.b.next=r:(st(!n.a),n.a=r),n.b=r},yn,bn=function(){if(n.Promise&&n.Promise.resolve){var e=n.Promise.resolve(void 0);yn=function(){e.then(Sn)}}else yn=function(){var e=Sn;!a(n.setImmediate)||n.Window&&n.Window.prototype&&!dt("Edge")&&n.Window.prototype.setImmediate==n.setImmediate?(Qt||(Qt=Gt()),Qt(e)):n.setImmediate(e)}},wn=!1,En=new function(){this.b=this.a=null},Sn=function(){for(var e;e=kt();){try{e.a.call(e.b)}catch(t){Kt(t)}H(Ct,e)}wn=!1},xn;(xn=!nn)||(xn=9<=Number(mn));var Tn=xn,Nn=nn&&!dn("9");!on||dn("528"),sn&&dn("1.9b")||nn&&dn("8")||tn&&dn("9.5")||on&&dn("528"),sn&&!dn("8")||nn&&dn("9");var Cn=function(e,t){this.b={},this.a=[],this.f=this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e){e instanceof Cn?(n=e.D(),r=e.w()):(n=q(e),r=I(e));for(var i=0;i<n.length;i++)this.set(n[i],r[i])}};e=Cn.prototype,e.o=function(){return this.c},e.w=function(){Ln(this);for(var e=[],t=0;t<this.a.length;t++)e.push(this.b[this.a[t]]);return e},e.D=function(){return Ln(this),this.a.concat()},e.F=function(){return 0==this.c},e.clear=function(){this.b={},this.f=this.c=this.a.length=0};var kn=function(e,t){return Object.prototype.hasOwnProperty.call(e.b,t)?(delete e.b[t],e.c--,e.f++,e.a.length>2*e.c&&Ln(e),!0):!1},Ln=function(e){if(e.c!=e.a.length){for(var t=0,n=0;t<e.a.length;){var r=e.a[t];Object.prototype.hasOwnProperty.call(e.b,r)&&(e.a[n++]=r),t++}e.a.length=n}if(e.c!=e.a.length){for(var i={},n=t=0;t<e.a.length;)r=e.a[t],Object.prototype.hasOwnProperty.call(i,r)||(e.a[n++]=r,i[r]=1),t++;e.a.length=n}};e=Cn.prototype,e.get=function(e,t){return Object.prototype.hasOwnProperty.call(this.b,e)?this.b[e]:t},e.set=function(e,t){Object.prototype.hasOwnProperty.call(this.b,e)||(this.c++,this.a.push(e),this.f++),this.b[e]=t},e.forEach=function(e,t){for(var n=this.D(),r=0;r<n.length;r++){var i=n[r],s=this.get(i);e.call(t,s,i,this)}},e.clone=function(){return new Cn(this)},e.X=function(e){Ln(this);var t=0,n=this.f,r=this,i=new Zt;return i.next=function(){if(n!=r.f)throw Error("The map has changed since the iterator was created");if(t>=r.a.length)throw Yt;var i=r.a[t++];return e?i:r.b[i]},i};var An=function(e,t){At.call(this,e?e.type:""),this.c=this.a=this.target=null;if(e){this.type=e.type,this.target=e.target||e.srcElement,this.a=t;if((t=e.relatedTarget)&&sn)try{V(t.nodeName)}catch(n){}this.c=e,e.defaultPrevented&&this.b()}};m(An,At),An.prototype.b=function(){An.G.b.call(this);var e=this.c;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,Nn)try{if(e.ctrlKey||112<=e.keyCode&&123>=e.keyCode)e.keyCode=-1}catch(t){}};var On=function(e,t){this.a=0,this.i=void 0,this.c=this.b=this.f=null,this.g=this.h=!1;if(e!=i)try{var n=this;e.call(t,function(e){Fn(n,2,e)},function(e){try{throw e instanceof Error?e:Error("Promise rejected.")}catch(t){}Fn(n,3,e)})}catch(r){Fn(this,3,r)}},Mn=function(){this.next=this.f=this.c=this.a=this.b=null,this.g=!1};Mn.prototype.reset=function(){this.f=this.c=this.a=this.b=null,this.g=!1};var _n=new P(function(){return new Mn},function(e){e.reset()},100),Dn=function(e,t,n){var r=_n.get();return r.a=e,r.c=t,r.f=n,r},Pn=function(e){if(e instanceof On)return e;var t=new On(i);return Fn(t,2,e),t},Hn=function(e){return new On(function(t,n){n(e)})};On.prototype.then=function(e,t,n){return null!=e&&ut(e,"opt_onFulfilled should be a function."),null!=t&&ut(t,"opt_onRejected should be a function. Did you pass opt_context as the second argument instead of the third?"),jn(this,a(e)?e:null,a(t)?t:null,n)},W(On),On.prototype.l=function(e,t){return jn(this,null,e,t)};var Bn=function(e,t){e.b||2!=e.a&&3!=e.a||qn(e),st(null!=t.a),e.c?e.c.next=t:e.b=t,e.c=t},jn=function(e,t,n,r){var i=Dn(null,null,null);return i.b=new On(function(e,s){i.a=t?function(n){try{var i=t.call(r,n);e(i)}catch(o){s(o)}}:e,i.c=n?function(t){try{var i=n.call(r,t);e(i)}catch(o){s(o)}}:s}),i.b.f=e,Bn(e,i),i.b};On.prototype.s=function(e){st(1==this.a),this.a=0,Fn(this,2,e)},On.prototype.m=function(e){st(1==this.a),this.a=0,Fn(this,3,e)};var Fn=function(e,t,n){if(0==e.a){e==n&&(t=3,n=new TypeError("Promise cannot resolve to itself")),e.a=1;var r;e:{var s=n,o=e.s,u=e.m;if(s instanceof On)null!=o&&ut(o,"opt_onFulfilled should be a function."),null!=u&&ut(u,"opt_onRejected should be a function. Did you pass opt_context as the second argument instead of the third?"),Bn(s,Dn(o||i,u||null,e)),r=!0;else if(X(s))s.then(o,u,e),r=!0;else{if(f(s))try{var l=s.then;if(a(l)){In(s,l,o,u,e),r=!0;break e}}catch(c){u.call(e,c),r=!0;break e}r=!1}}r||(e.i=n,e.a=t,e.f=null,qn(e),3!=t||zn(e,n))}},In=function(e,t,n,r,i){var s=!1,o=function(e){s||(s=!0,n.call(i,e))},u=function(e){s||(s=!0,r.call(i,e))};try{t.call(e,o,u)}catch(a){u(a)}},qn=function(e){e.h||(e.h=!0,gn(e.j,e))},Rn=function(e){var t=null;return e.b&&(t=e.b,e.b=t.next,t.next=null),e.b||(e.c=null),null!=t&&st(null!=t.a),t};On.prototype.j=function(){for(var e;e=Rn(this);){var t=this.a,n=this.i;if(3==t&&e.c&&!e.g){var r;for(r=this;r&&r.g;r=r.f)r.g=!1}if(e.b)e.b.f=null,Un(e,t,n);else try{e.g?e.a.call(e.f):Un(e,t,n)}catch(i){Wn.call(null,i)}H(_n,e)}this.h=!1};var Un=function(e,t,n){2==t?e.a.call(e.f,n):e.c&&e.c.call(e.f,n)},zn=function(e,t){e.g=!0,gn(function(){e.g&&Wn.call(null,t)})},Wn=Kt,Xn=function(e){this.a=new Cn;if(e){e=$t(e);for(var t=e.length,n=0;n<t;n++){var r=e[n];this.a.set(Vn(r),r)}}},Vn=function(e){var t=typeof e;return"object"==t&&e||"function"==t?"o"+(e[l]||(e[l]=++c)):t.substr(0,1)+e};e=Xn.prototype,e.o=function(){return this.a.o()},e.clear=function(){this.a.clear()},e.F=function(){return this.a.F()},e.w=function(){return this.a.w()},e.clone=function(){return new Xn(this)},e.X=function(){return this.a.X(!1)};var $n=function(e){return function(){var t=[];Array.prototype.push.apply(t,arguments),Pn(!0).then(function(){e.apply(null,t)})}},Jn="closure_lm_"+(1e6*Math.random()|0),Kn={},Qn=0,Gn=function(e,t,n,r,i){if("array"==s(t)){for(var o=0;o<t.length;o++)Gn(e,t[o],n,r,i);return null}return n=fr(n),e&&e[ft]?(Mr(e),e=Bt(e.b,String(t),n,!1,r,i)):e=Yn(e,t,n,!1,r,i),e},Yn=function(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var o=!!i,u=ur(e);u||(e[Jn]=u=new Ht(e)),n=Bt(u,t,n,r,i,s);if(n.a)return n;r=Zn(),n.a=r,r.src=e,r.listener=n;if(e.addEventListener)e.addEventListener(t.toString(),r,o);else{if(!e.attachEvent)throw Error("addEventListener and attachEvent are unavailable.");e.attachEvent(rr(t.toString()),r)}return Qn++,n},Zn=function(){var e=or,t=Tn?function(n){return e.call(t.src,t.listener,n)}:function(n){n=e.call(t.src,t.listener,n);if(!n)return n};return t},er=function(e,t,n,r,i){if("array"==s(t))for(var o=0;o<t.length;o++)er(e,t[o],n,r,i);else n=fr(n),e&&e[ft]?Bt(e.b,String(t),n,!0,r,i):Yn(e,t,n,!0,r,i)},tr=function(e,t,n,r,i){if("array"==s(t))for(var o=0;o<t.length;o++)tr(e,t[o],n,r,i);else(n=fr(n),e&&e[ft])?(e=e.b,t=String(t).toString(),t in e.a&&(o=e.a[t],n=Ft(o,n,r,i),-1<n&&(Mt(o[n]),st(null!=o.length),Array.prototype.splice.call(o,n,1),0==o.length&&(delete e.a[t],e.b--)))):e&&(e=ur(e))&&(t=e.a[t.toString()],e=-1,t&&(e=Ft(t,n,!!r,i)),(n=-1<e?t[e]:null)&&nr(n))},nr=function(e){if("number"!=typeof e&&e&&!e.O){var t=e.src;if(t&&t[ft])jt(t.b,e);else{var n=e.type,r=e.a;t.removeEventListener?t.removeEventListener(n,r,e.U):t.detachEvent&&t.detachEvent(rr(n),r),Qn--,(n=ur(t))?(jt(n,e),0==n.b&&(n.src=null,t[Jn]=null)):Mt(e)}}},rr=function(e){return e in Kn?Kn[e]:Kn[e]="on"+e},ir=function(e,t,n,r){var i=!0;if(e=ur(e))if(t=e.a[t.toString()])for(t=t.concat(),e=0;e<t.length;e++){var s=t[e];s&&s.U==n&&!s.O&&(s=sr(s,r),i=i&&!1!==s)}return i},sr=function(e,t){var n=e.listener,r=e.N||e.src;return e.T&&nr(e),n.call(r,t)},or=function(e,t){if(e.O)return!0;if(!Tn){if(!t)e:{t=["window","event"];for(var r=n,i;i=t.shift();){if(null==r[i]){t=null;break e}r=r[i]}t=r}i=t,t=new An(i,this),r=!0;if(!(0>i.keyCode||void 0!=i.returnValue)){e:{var s=!1;if(0==i.keyCode)try{i.keyCode=-1;break e}catch(o){s=!0}if(s||void 0==i.returnValue)i.returnValue=!0}i=[];for(s=t.a;s;s=s.parentNode)i.push(s);e=e.type;for(s=i.length-1;0<=s;s--){t.a=i[s];var u=ir(i[s],e,!0,t),r=r&&u}for(s=0;s<i.length;s++)t.a=i[s],u=ir(i[s],e,!1,t),r=r&&u}return r}return sr(e,new An(t,this))},ur=function(e){return e=e[Jn],e instanceof Ht?e:null},ar="__closure_events_fn_"+(1e9*Math.random()>>>0),fr=function(e){return st(e,"Listener can not be null."),a(e)?e:(st(e.handleEvent,"An object listener must have handleEvent method."),e[ar]||(e[ar]=function(t){return e.handleEvent(t)}),e[ar])},lr=function(e,t){at.call(this),this.l=e||0,this.c=t||10;if(this.l>this.c)throw Error("[goog.structs.Pool] Min can not be greater than max");this.a=new Xt,this.b=new Xn,this.i=null,this.S()};m(lr,at),lr.prototype.W=function(){var e=v();if(!(null!=this.i&&0>e-this.i)){for(var t;0<this.a.o()&&(t=Vt(this.a),!this.j(t));)this.S();return!t&&this.o()<this.c&&(t=this.h()),t&&(this.i=e,this.b.a.set(Vn(t),t)),t}};var cr=function(e){var t=ni;kn(t.b.a,Vn(e))&&t.Y(e)};lr.prototype.Y=function(e){kn(this.b.a,Vn(e)),this.j(e)&&this.o()<this.c?this.a.a.push(e):hr(e)},lr.prototype.S=function(){for(var e=this.a;this.o()<this.l;){var t=this.h();e.a.push(t)}for(;this.o()>this.c&&0<this.a.o();)hr(Vt(e))},lr.prototype.h=function(){return{}};var hr=function(e){if("function"==typeof e.fa)e.fa();else for(var t in e)e[t]=null};lr.prototype.j=function(e){return"function"==typeof e.ra?e.ra():!0},lr.prototype.o=function(){return this.a.o()+this.b.o()},lr.prototype.F=function(){return this.a.F()&&this.b.F()},lr.prototype.A=function(){lr.G.A.call(this);if(0<this.b.o())throw Error("[goog.structs.Pool] Objects not released");delete this.b;for(var e=this.a;!e.F();)hr(Vt(e));delete this.a};var pr=function(e,t){this.c=[],this.m=t||null,this.a=this.h=!1,this.b=void 0,this.j=this.g=!1,this.f=0,this.i=null,this.s=0};pr.prototype.l=function(e,t){this.g=!1,this.h=!0,this.b=t,this.a=!e,mr(this)};var dr=function(e,t,n){st(!e.j,"Blocking Deferreds can not be re-used"),e.c.push([t,n,void 0]),e.h&&mr(e)};pr.prototype.then=function(e,t,n){var r,i,s=new On(function(e,t){r=e,i=t});return dr(this,r,function(e){i(e)}),s.then(e,t,n)},W(pr);var vr=function(e){return Et(e.c,function(e){return a(e[1])})},mr=function(e){if(e.f&&e.h&&vr(e)){var t=e.f,i=yr[t];i&&(n.clearTimeout(i.a),delete yr[t]),e.f=0}e.i&&(e.i.s--,delete e.i);for(var t=e.b,s=i=!1;e.c.length&&!e.g;){var o=e.c.shift(),u=o[0],a=o[1],o=o[2];if(u=e.a?a:u)try{var f=u.call(o||e.m,t);r(f)&&(e.a=e.a&&(f==t||f instanceof Error),e.b=t=f);if(X(t)||"function"==typeof n.Promise&&t instanceof n.Promise)s=!0,e.g=!0}catch(l){t=l,e.a=!0,vr(e)||(i=!0)}}e.b=t,s&&(f=d(e.l,e,!0),s=d(e.l,e,!1),t instanceof pr?(dr(t,f,s),t.j=!0):t.then(f,s)),i&&(t=new gr(t),yr[t.a]=t,e.f=t.a)},gr=function(e){this.a=n.setTimeout(d(this.c,this),0),this.b=e};gr.prototype.c=function(){throw st(yr[this.a],"Cannot throw an error that is not scheduled."),delete yr[this.a],this.b};var yr={},br=function(e){this.f=e,this.b=this.c=this.a=null},wr=function(e,t){this.name=e,this.value=t};wr.prototype.toString=function(){return this.name};var Er=new wr("SEVERE",1e3),Sr=new wr("CONFIG",700),xr=new wr("FINE",500),Tr=function(e){return e.c?e.c:e.a?Tr(e.a):(ot("Root logger has no level set."),null)};br.prototype.log=function(e,t,r){if(e.value>=Tr(this).value)for(a(t)&&(t=t()),e=new j(e,String(t),this.f),r&&(e.a=r),r="log:"+e.b,n.console&&(n.console.timeStamp?n.console.timeStamp(r):n.console.markTimeline&&n.console.markTimeline(r)),n.msWriteProfilerMark&&n.msWriteProfilerMark(r),r=this;r;)r=r.a};var Nr={},Cr=null,kr=function(e){Cr||(Cr=new br(""),Nr[""]=Cr,Cr.c=Sr);var t;if(!(t=Nr[e])){t=new br(e);var n=e.lastIndexOf("."),r=e.substr(n+1),n=kr(e.substr(0,n));n.b||(n.b={}),n.b[r]=t,t.a=n,Nr[e]=t}return t},Lr=function(){at.call(this),this.b=new Ht(this),this.ma=this,this.I=null};m(Lr,at),Lr.prototype[ft]=!0,Lr.prototype.removeEventListener=function(e,t,n,r){tr(this,e,t,n,r)};var Ar=function(e,t){Mr(e);var n,r=e.I;if(r){n=[];for(var i=1;r;r=r.I)n.push(r),st(1e3>++i,"infinite loop")}e=e.ma,r=t.type||t,u(t)?t=new At(t,e):t instanceof At?t.target=t.target||e:(i=t,t=new At(r,e),z(t,i));var i=!0,s;if(n)for(var o=n.length-1;0<=o;o--)s=t.a=n[o],i=Or(s,r,!0,t)&&i;s=t.a=e,i=Or(s,r,!0,t)&&i,i=Or(s,r,!1,t)&&i;if(n)for(o=0;o<n.length;o++)s=t.a=n[o],i=Or(s,r,!1,t)&&i};Lr.prototype.A=function(){Lr.G.A.call(this);if(this.b){var e=this.b,t=0,n;for(n in e.a){for(var r=e.a[n],i=0;i<r.length;i++)++t,Mt(r[i]);delete e.a[n],e.b--}}this.I=null};var Or=function(e,t,n,r){t=e.b.a[String(t)];if(!t)return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.O&&o.U==n){var u=o.listener,a=o.N||o.src;o.T&&jt(e.b,o),i=!1!==u.call(a,r)&&i}}return i&&0!=r.ka},Mr=function(e){st(e.b,"Event target is not initialized. Did you call the superclass (goog.events.EventTarget) constructor?")},_r=function(e,t){this.f=new en,lr.call(this,e,t)};m(_r,lr),e=_r.prototype,e.W=function(e,t){if(!e)return _r.G.W.call(this);Wt(this.f,r(t)?t:100,e),this.$()},e.$=function(){for(var e=this.f;0<e.o();){var t=this.W();if(!t)break;var n,r=e,i=r.a,s=i.length;n=i[0];if(0>=s)n=void 0;else{if(1==s)xt(i);else{i[0]=i.pop();for(var i=0,r=r.a,s=r.length,o=r[i];i<s>>1;){var u=2*i+1,a=2*i+2,u=a<s&&r[a].a<r[u].a?a:u;if(r[u].a>o.a)break;r[i]=r[u],i=u}r[i]=o}n=n.b}n.apply(this,[t])}},e.Y=function(e){_r.G.Y.call(this,e),this.$()},e.S=function(){_r.G.S.call(this),this.$()},e.A=function(){_r.G.A.call(this),n.clearTimeout(void 0),this.f.clear(),this.f=null};var Dr=function(e,t){e&&e.log(xr,t,void 0)},Pr=function(e,t,r){if(a(e))r&&(e=d(e,r));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=d(e.handleEvent,e)}return 2147483647<Number(t)?-1:n.setTimeout(e,t||0)},Hr=function(e){Lr.call(this),this.L=new Cn,this.C=e||null,this.c=!1,this.B=this.a=null,this.P=this.l="",this.J=0,this.h="",this.f=this.H=this.j=this.K=!1,this.i=0,this.m=null,this.da="",this.v=this.ba=this.Z=!1};m(Hr,Lr);var Br=Hr.prototype,jr=kr("goog.net.XhrIo");Br.u=jr;var Fr=/^https?$/i,Ir=["POST","PUT"];Hr.prototype.send=function(e,t,r,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.l+"; newUri="+e);t=t?t.toUpperCase():"GET",this.l=e,this.h="",this.J=0,this.P=t,this.K=!1,this.c=!0,this.a=this.C?Rt(this.C):Rt(It),this.B=this.C?mt(this.C):mt(It),this.a.onreadystatechange=d(this.ca,this),this.ba&&"onprogress"in this.a&&(this.a.onprogress=d(function(e){this.R(e,!0)},this),this.a.upload&&(this.a.upload.onprogress=d(this.R,this)));try{Dr(this.u,ei(this,"Opening Xhr")),this.H=!0,this.a.open(t,String(e),!0),this.H=!1}catch(s){Dr(this.u,ei(this,"Error opening Xhr: "+s.message)),Ur(this,s);return}e=r||"";var o=this.L.clone();i&&Jt(i,function(e,t){o.set(t,e)}),i=St(o.D()),r=n.FormData&&e instanceof n.FormData,!(0<=gt(Ir,t))||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(e,t){this.a.setRequestHeader(t,e)},this),this.da&&(this.a.responseType=this.da),R(this.a)&&(this.a.withCredentials=this.Z);try{Jr(this),0<this.i&&(this.v=qr(this.a),Dr(this.u,ei(this,"Will abort after "+this.i+"ms if incomplete, xhr2 "+this.v)),this.v?(this.a.timeout=this.i,this.a.ontimeout=d(this.M,this)):this.m=Pr(this.M,this.i,this)),Dr(this.u,ei(this,"Sending request")),this.j=!0,this.a.send(e),this.j=!1}catch(s){Dr(this.u,ei(this,"Send error: "+s.message)),Ur(this,s)}};var qr=function(e){return nn&&dn(9)&&"number"==typeof e.timeout&&r(e.ontimeout)},Rr=function(e){return"content-type"==e.toLowerCase()};Hr.prototype.M=function(){"undefined"!=typeof t&&this.a&&(this.h="Timed out after "+this.i+"ms, aborting",this.J=8,Dr(this.u,ei(this,this.h)),Ar(this,"timeout"),Wr(this,8))};var Ur=function(e,t){e.c=!1,e.a&&(e.f=!0,e.a.abort(),e.f=!1),e.h=t,e.J=5,zr(e),$r(e)},zr=function(e){e.K||(e.K=!0,Ar(e,"complete"),Ar(e,"error"))},Wr=function(e,t){e.a&&e.c&&(Dr(e.u,ei(e,"Aborting")),e.c=!1,e.f=!0,e.a.abort(),e.f=!1,e.J=t||7,Ar(e,"complete"),Ar(e,"abort"),$r(e))};Hr.prototype.A=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),$r(this,!0)),Hr.G.A.call(this)},Hr.prototype.ca=function(){this.g||(this.H||this.j||this.f?Xr(this):this.na())},Hr.prototype.na=function(){Xr(this)};var Xr=function(e){if(e.c&&"undefined"!=typeof t)if(e.B[1]&&4==Qr(e)&&2==Gr(e))Dr(e.u,ei(e,"Local request error detected and ignored"));else if(e.j&&4==Qr(e))Pr(e.ca,0,e);else if(Ar(e,"readystatechange"),4==Qr(e)){Dr(e.u,ei(e,"Request complete")),e.c=!1;try{if(Kr(e))Ar(e,"complete"),Ar(e,"success");else{e.J=6;var n;try{n=2<Qr(e)?e.a.statusText:""}catch(r){Dr(e.u,"Can not get status: "+r.message),n=""}e.h=n+" ["+Gr(e)+"]",zr(e)}}finally{$r(e)}}};Hr.prototype.R=function(e,t){st("progress"===e.type,"goog.net.EventType.PROGRESS is of the same type as raw XHR progress."),Ar(this,Vr(e,"progress")),Ar(this,Vr(e,t?"downloadprogress":"uploadprogress"))};var Vr=function(e,t){return{type:t,lengthComputable:e.lengthComputable,loaded:e.loaded,total:e.total}},$r=function(e,t){if(e.a){Jr(e);var n=e.a,r=e.B[0]?i:null;e.a=null,e.B=null,t||Ar(e,"ready");try{n.onreadystatechange=r}catch(s){(e=e.u)&&e.log(Er,"Problem encountered resetting onreadystatechange: "+s.message,void 0)}}},Jr=function(e){e.a&&e.v&&(e.a.ontimeout=null),"number"==typeof e.m&&(n.clearTimeout(e.m),e.m=null)},Kr=function(e){var t=Gr(e),r;e:switch(t){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:r=!0;break e;default:r=!1}if(!r){if(t=0===t)e=String(e.l).match(_t)[1]||null,!e&&n.self&&n.self.location&&(e=n.self.location.protocol,e=e.substr(0,e.length-1)),t=!Fr.test(e?e.toLowerCase():"");r=t}return r},Qr=function(e){return e.a?e.a.readyState:0},Gr=function(e){try{return 2<Qr(e)?e.a.status:-1}catch(t){return-1}},Yr=function(e){try{return e.a?e.a.responseText:""}catch(t){return Dr(e.u,"Can not get responseText: "+t.message),""}},Zr=function(e,t){return e.a&&4==Qr(e)?e.a.getResponseHeader(t):void 0},ei=function(e,t){return t+" ["+e.P+" "+e.l+" "+Gr(e)+"]"},ti=function(e,t,n,r){this.m=e,this.v=!!r,_r.call(this,t,n)};m(ti,_r),ti.prototype.h=function(){var e=new Hr,t=this.m;return t&&t.forEach(function(t,n){e.L.set(n,t)}),this.v&&(e.Z=!0),e},ti.prototype.j=function(e){return!e.g&&!e.a};var ni=new ti,ri=function(e,t,n,r,i,s,o,u,a,f){this.L=e,this.H=t,this.B=n,this.m=r,this.I=i.slice(),this.s=this.l=this.f=this.c=null,this.h=this.i=!1,this.v=s,this.j=o,this.g=a,this.M=f,this.K=u;var l=this;this.C=new On(function(e,t){l.l=e,l.s=t,si(l)})},ii=function(e,t,n){this.b=e,this.c=t,this.a=!!n},si=function(e){function t(e,t){t?e(!1,new ii(!1,null,!0)):ni.W(function(t){t.Z=i.M,i.c=t;var n=null;null!==i.g&&(t.ba=!0,n=Gn(t,"uploadprogress",function(e){i.g(e.loaded,e.lengthComputable?e.total:-1)}),t.ba=null!==i.g),t.send(i.L,i.H,i.m,i.B),er(t,"complete",function(t){null!==n&&nr(n),i.c=null,t=t.target;var r=6===t.J&&100<=Gr(t),r=Kr(t)||r,s=Gr(t);!r||500<=s&&600>s||429===s?(r=7===t.J,cr(t),e(!1,new ii(!1,null,r))):(r=0<=gt(i.I,s),e(!0,new ii(r,t)))})})}function n(e,t){var n=i.l;e=i.s;var s=t.c;if(t.b)try{var o=i.v(s,Yr(s));r(o)?n(o):n()}catch(u){e(u)}else null!==s?(t=w(),o=Yr(s),t.serverResponse=o,i.j?e(i.j(s,t)):e(t)):(t=t.a?i.h?N():x():new b("retry-limit-exceeded","Max retry time for operation exceeded, please try again."),e(t));cr(s)}var i=e;e.i?n(0,new ii(!1,null,!0)):e.f=g(t,n,e.K)};ri.prototype.a=function(){return this.C},ri.prototype.b=function(e){this.i=!0,this.h=e||!1,null!==this.f&&(0,this.f)(!1),null!==this.c&&Wr(this.c)};var oi=function(e,t,n){var r=tt(e.f),r=e.l+r,i=e.b?k(e.b):{};return null!==t&&0<t.length&&(i.Authorization="Firebase "+t),i["X-Firebase-Storage-Version"]="webjs/1.0.0",new ri(r,e.i,i,e.c,e.h,e.N,e.a,e.j,e.g,n)},ui=function(e){var t=n.BlobBuilder||n.WebKitBlobBuilder;if(r(t)){for(var t=new t,i=0;i<arguments.length;i++)t.append(arguments[i]);return t.getBlob()}t=Nt(arguments),i=n.BlobBuilder||n.WebKitBlobBuilder;if(r(i)){for(var i=new i,s=0;s<t.length;s++)i.append(t[s],void 0);t=i.getBlob(void 0)}else{if(!r(n.Blob))throw Error("This browser doesn't seem to support creating Blobs");t=new Blob(t,{})}return t},ai=function(e,t,n){return r(n)||(n=e.size),e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?sn&&!dn("13.0")||on&&!dn("537.1")?(0>t&&(t+=e.size),0>t&&(t=0),0>n&&(n+=e.size),n<t&&(n=t),e.slice(t,n-t)):e.slice(t,n):null},fi=function(e){this.c=Hn(e)};fi.prototype.a=function(){return this.c},fi.prototype.b=function(){};var li=function(){this.a={},this.b=Number.MIN_SAFE_INTEGER},ci=function(e,t){function n(){delete i.a[r]}var r=e.b;e.b++,e.a[r]=t;var i=e;t.a().then(n,n)};li.prototype.clear=function(){C(this.a,function(e,t){t&&t.b(!0)}),this.a={}};var hi=function(e,t,n,r){this.a=e,this.f=null,null!==this.a&&(e=this.a.options,_(e)?this.f=e.storageBucket||null:this.f=null),this.l=t,this.j=n,this.i=r,this.c=12e4,this.b=6e4,this.h=new li,this.g=!1},pi=function(e){return null!==e.a&&_(e.a.INTERNAL)&&_(e.a.INTERNAL.getToken)?e.a.INTERNAL.getToken().then(function(e){return _(e)?e.accessToken:null},function(){return null}):Pn(null)};hi.prototype.bucket=function(){if(this.g)throw N();return this.f};var di=function(e,t,n){return e.g?new fi(N()):(t=e.j(t,n,null===e.a),ci(e.h,t),t)},vi=function(e,t){return t},mi=function(e,t,n,r){this.c=e,this.b=t||e,this.f=!!n,this.a=r||vi},gi=null,yi=function(){if(gi)return gi;var e=[];e.push(new mi("bucket")),e.push(new mi("generation")),e.push(new mi("metageneration")),e.push(new mi("name","fullPath",!0));var t=new mi("name");return t.a=function(e,t){return!D(t)||2>t.length?t:Pt(t)},e.push(t),t=new mi("size"),t.a=function(e,t){return _(t)?+t:t},e.push(t),e.push(new mi("timeCreated")),e.push(new mi("updated")),e.push(new mi("md5Hash",null,!0)),e.push(new mi("cacheControl",null,!0)),e.push(new mi("contentDisposition",null,!0)),e.push(new mi("contentEncoding",null,!0)),e.push(new mi("contentLanguage",null,!0)),e.push(new mi("contentType",null,!0)),e.push(new mi("metadata","customMetadata",!0)),e.push(new mi("downloadTokens","downloadURLs",!1,function(e,t){if(!(D(t)&&0<t.length))return[];var n=encodeURIComponent;return wt(t.split(","),function(t){var r=e.fullPath,r="https://firebasestorage.googleapis.com/v0"+("/b/"+n(e.bucket)+"/o/"+n(r));return t=tt({alt:"media",token:t}),r+t})})),gi=e},bi=function(e,t){Object.defineProperty(e,"ref",{get:function(){return t.l(t,new G(e.bucket,e.fullPath))}})},wi=function(e,t){for(var n={},r=t.length,i=0;i<r;i++){var s=t[i];s.f&&(n[s.c]=e[s.b])}return JSON.stringify(n)},Ei=function(e){if(!e||"object"!=typeof e)throw"Expected Metadata object.";for(var t in e){var n=e[t];if("customMetadata"===t&&"object"!=typeof n)throw"Expected object for 'customMetadata' mapping."}},Si=function(e,t,n){for(var r=t.length,i=t.length,s=0;s<t.length;s++)if(t[s].b){r=s;break}if(!(r<=n.length&&n.length<=i))throw r===i?(t=r,r=1===r?"argument":"arguments"):(t="between "+r+" and "+i,r="arguments"),new b("invalid-argument-count","Invalid argument count in `"+e+"`: Expected "+t+" "+r+", received "+n.length+".");for(s=0;s<n.length;s++)try{t[s].a(n[s])}catch(o){throw o instanceof Error?T(s,e,o.message):T(s,e,o)}},xi=function(e,t){var n=this;this.a=function(t){n.b&&!r(t)||e(t)},this.b=!!t},Ti=function(e,t){return function(n){e(n),t(n)}},Ni=function(e,t){function n(e){if(!("string"==typeof e||e instanceof String))throw"Expected string."}var r;return e?r=Ti(n,e):r=n,new xi(r,t)},Ci=function(){return new xi(function(e){if(!(e instanceof Blob))throw"Expected Blob or File."})},ki=function(){return new xi(function(e){if(!(("number"==typeof e||e instanceof Number)&&0<=e))throw"Expected a number 0 or greater."})},Li=function(e,t){return new xi(function(t){if(!(null===t||_(t)&&t instanceof Object))throw"Expected an Object.";_(e)&&e(t)},t)},Ai=function(){return new xi(function(e){if(null!==e&&!a(e))throw"Expected a Function."},!0)},Oi=function(e){if(!e)throw w()},Mi=function(e,t){return function(n,r){e:{var i;try{i=JSON.parse(r)}catch(s){n=null;break e}n=f(i)?i:null}if(null===n)n=null;else{r={type:"file"},i=t.length;for(var o=0;o<i;o++){var u=t[o];r[u.b]=u.a(r,n[u.c])}bi(r,e),n=r}return Oi(null!==n),n}},_i=function(e){return function(t,n){return t=404===Gr(t)?new b("object-not-found","Object '"+e.path+"' does not exist."):401===Gr(t)?E():403===Gr(t)?S(e.path):n,t.serverResponse=n.serverResponse,t}},Di=function(e){return function(t,n){return t=401===Gr(t)?E():403===Gr(t)?S(e.path):n,t.serverResponse=n.serverResponse,t}},Pi=function(e,t,n){var r=Y(t);return e=new L(y+"/v0"+r,"GET",Mi(e,n),e.c),e.a=_i(t),e},Hi=function(e,t){var n=Y(t);return e=new L(y+"/v0"+n,"DELETE",function(){},e.c),e.h=[200,204],e.a=_i(t),e},Bi=function(e,t,n){return n=n?k(n):{},n.fullPath=e.path,n.size=t.size,n.contentType||(n.contentType=t&&t.type||"application/octet-stream"),n},ji=function(e,t,n,r,i){var s="/b/"+encodeURIComponent(t.bucket)+"/o",o={"X-Goog-Upload-Protocol":"multipart"},u;u="";for(var a=0;2>a;a++)u+=Math.random().toString().slice(2);return o["Content-Type"]="multipart/related; boundary="+u,i=Bi(t,r,i),a=wi(i,n),r=ui("--"+u+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+a+"\r\n--"+u+"\r\nContent-Type: "+i.contentType+"\r\n\r\n",r,"\r\n--"+u+"--"),e=new L(y+"/v0"+s,"POST",Mi(e,n),e.b),e.f={name:i.fullPath},e.b=o,e.c=r,e.a=Di(t),e},Fi=function(e,t,n,r){this.a=e,this.total=t,this.b=!!n,this.c=r||null},Ii=function(e,t){var n;try{n=Zr(e,"X-Goog-Upload-Status")}catch(r){Oi(!1)}return e=0<=gt(t||["active"],n),Oi(e),n},qi=function(e,t,n,r,i){var s="/b/"+encodeURIComponent(t.bucket)+"/o",o=Bi(t,r,i);return i={name:o.fullPath},s=y+"/v0"+s,r={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":r.size,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},n=wi(o,n),e=new L(s,"POST",function(e){Ii(e);var t;try{t=Zr(e,"X-Goog-Upload-URL")}catch(n){Oi(!1)}return Oi(D(t)),t},e.b),e.f=i,e.b=r,e.c=n,e.a=Di(t),e},Ri=function(e,t,n,r){return e=new L(n,"POST",function(e){var t=Ii(e,["active","final"]),n;try{n=Zr(e,"X-Goog-Upload-Size-Received")}catch(i){Oi(!1)}return e=n,isFinite(e)&&(e=String(e)),e=u(e)?/^\s*-?0x/i.test(e)?parseInt(e,16):parseInt(e,10):NaN,Oi(!isNaN(e)),new Fi(e,r.size,"final"===t)},e.b),e.b={"X-Goog-Upload-Command":"query"},e.a=Di(t),e},Ui=function(e,t,n,r,i,s){var o=new Fi(0,0);s?(o.a=s.a,o.total=s.total):(o.a=0,o.total=r.size);if(r.size!==o.total)throw new b("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.");var u=s=o.total-o.a,u=Math.min(u,262144),a=o.a;s={"X-Goog-Upload-Command":u===s?"upload, finalize":"upload","X-Goog-Upload-Offset":o.a},a=ai(r,a,a+u);if(null===a)throw new b("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.");return n=new L(n,"POST",function(e,n){var s=Ii(e,["active","final"]),a=o.a+u,f=r.size,l;return"final"===s?l=Mi(t,i)(e,n):l=null,new Fi(a,f,"final"===s,l)},t.b),n.b=s,n.c=a,n.g=null,n.a=Di(e),n},zi=function(e,t,n,r,i,s){this.K=e,this.c=t,this.i=n,this.f=i,this.h=s||null,this.l=r,this.j=0,this.B=this.s=!1,this.v=[],this.R=262144<this.f.size,this.b="running",this.a=this.m=this.g=null;var o=this;this.V=function(e){o.a=null,"storage/canceled"===e.code?(o.s=!0,Zi(o)):(o.g=e,Yi(o,"error"))},this.P=function(e){o.a=null,"storage/canceled"===e.code?Zi(o):(o.g=e,Yi(o,"error"))},Wi(this)},Wi=function(e){"running"===e.b&&null===e.a&&(e.R?null===e.m?Vi(e):e.s?$i(e):e.B?Ki(e):Ji(e):Qi(e))},Xi=function(e,t){pi(e.c).then(function(n){switch(e.b){case"running":t(n);break;case"canceling":Yi(e,"canceled");break;case"pausing":Yi(e,"paused")}})},Vi=function(e){Xi(e,function(t){var n=qi(e.c,e.i,e.l,e.f,e.h);e.a=di(e.c,n,t),e.a.a().then(function(t){e.a=null,e.m=t,e.s=!1,Zi(e)},this.V)})},$i=function(e){var t=e.m;Xi(e,function(n){var r=Ri(e.c,e.i,t,e.f);e.a=di(e.c,r,n),e.a.a().then(function(t){e.a=null,Gi(e,t.a),e.s=!1,t.b&&(e.B=!0),Zi(e)},e.V)})},Ji=function(e){var t=new Fi(e.j,e.f.size),n=e.m;Xi(e,function(r){var i;try{i=Ui(e.i,e.c,n,e.f,e.l,t)}catch(s){e.g=s,Yi(e,"error");return}e.a=di(e.c,i,r),e.a.a().then(function(t){e.a=null,Gi(e,t.a),t.b?(e.h=t.c,Yi(e,"success")):Zi(e)},e.V)})},Ki=function(e){Xi(e,function(t){var n=Pi(e.c,e.i,e.l);e.a=di(e.c,n,t),e.a.a().then(function(t){e.a=null,e.h=t,Yi(e,"success")},e.P)})},Qi=function(e){Xi(e,function(t){var n=ji(e.c,e.i,e.l,e.f,e.h);e.a=di(e.c,n,t),e.a.a().then(function(t){e.a=null,e.h=t,Gi(e,e.f.size),Yi(e,"success")},e.V)})},Gi=function(e,t){var n=e.j;e.j=t,e.j>n&&ts(e)},Yi=function(e,t){if(e.b!==t)switch(t){case"canceling":e.b=t,null!==e.a&&e.a.b();break;case"pausing":e.b=t,null!==e.a&&e.a.b();break;case"running":var n="paused"===e.b;e.b=t,n&&(ts(e),Wi(e));break;case"paused":e.b=t,ts(e);break;case"canceled":e.g=x(),e.b=t,ts(e);break;case"error":e.b=t,ts(e);break;case"success":e.b=t,ts(e)}},Zi=function(e){switch(e.b){case"pausing":Yi(e,"paused");break;case"canceling":Yi(e,"canceled");break;case"running":Wi(e)}};zi.prototype.C=function(){return new nt(this.j,this.f.size,M(this.b),this.h,this,this.K)},zi.prototype.I=function(e,t,n,i){function s(e){try{u(e);return}catch(t){}try{if(a(e),!(r(e.next)||r(e.error)||r(e.complete)))throw""}catch(t){throw"Expected a function or an Object with one of `next`, `error`, `complete` properties."}}function o(e){return function(t,n,r){null!==e&&Si("on",e,arguments);var i=new et(t,n,r);return es(f,i),function(){Tt(f.v,i)}}}var u=Ai().a,a=Li(null,!0).a;Si("on",[Ni(function(){if("state_changed"!==e)throw"Expected one of the event types: [state_changed]."}),Li(s,!0),Ai(),Ai()],arguments);var f=this,l=[Li(function(e){if(null===e)throw"Expected a function or an Object with one of `next`, `error`, `complete` properties.";s(e)}),Ai(),Ai()];return r(t)||r(n)||r(i)?o(null)(t,n,i):o(l)};var es=function(e,t){e.v.push(t),ns(e,t)},ts=function(e){var t=Nt(e.v);yt(t,function(t){ns(e,t)})},ns=function(e,t){switch(M(e.b)){case"running":case"paused":null!==t.next&&$n(t.next.bind(t,e.C()))();break;case"success":null!==t.a&&$n(t.a.bind(t))();break;case"canceled":case"error":null!==t.error&&$n(t.error.bind(t,e.g))();break;default:null!==t.error&&$n(t.error.bind(t,e.g))()}};zi.prototype.M=function(){Si("resume",[],arguments);var e="paused"===this.b||"pausing"===this.b;return e&&Yi(this,"running"),e},zi.prototype.L=function(){Si("pause",[],arguments);var e="running"===this.b;return e&&Yi(this,"pausing"),e},zi.prototype.H=function(){Si("cancel",[],arguments);var e="running"===this.b||"pausing"===this.b;return e&&Yi(this,"canceling"),e};var rs=function(e,t){this.b=e;if(t)this.a=t instanceof G?t:Z(t);else{if(e=e.bucket(),null===e)throw new b("no-default-bucket","No default bucket found. Did you set the 'storageBucket' property when initializing the app?");this.a=new G(e,"")}};rs.prototype.toString=function(){return Si("toString",[],arguments),"gs://"+this.a.bucket+"/"+this.a.path};var is=function(e,t){return new rs(e,t)};e=rs.prototype,e.ga=function(e){Si("child",[Ni()],arguments);var t=Dt(this.a.path,e);return is(this.b,new G(this.a.bucket,t))},e.Fa=function(){var e;e=this.a.path;if(0==e.length)e=null;else{var t=e.lastIndexOf("/");e=-1===t?"":e.slice(0,t)}return null===e?null:is(this.b,new G(this.a.bucket,e))},e.Ha=function(){return is(this.b,new G(this.a.bucket,""))},e.pa=function(){return this.a.bucket},e.Aa=function(){return this.a.path},e.Ea=function(){return Pt(this.a.path)},e.Ja=function(){return this.b.i},e.ua=function(e,t){return Si("put",[Ci(),new xi(Ei,!0)],arguments),ss(this,"put"),new zi(this,this.b,this.a,yi(),e,t)},e.delete=function(){Si("delete",[],arguments),ss(this,"delete");var e=this;return pi(this.b).then(function(t){var n=Hi(e.b,e.a);return di(e.b,n,t).a()})},e.ha=function(){Si("getMetadata",[],arguments),ss(this,"getMetadata");var e=this;return pi(this.b).then(function(t){var n=Pi(e.b,e.a,yi());return di(e.b,n,t).a()})},e.va=function(e){Si("updateMetadata",[new xi(Ei,void 0)],arguments),ss(this,"updateMetadata");var t=this;return pi(this.b).then(function(n){var r=t.b,i=t.a,s=e,o=yi(),u=Y(i),u=y+"/v0"+u,s=wi(s,o),r=new L(u,"PATCH",Mi(r,o),r.c);return r.b={"Content-Type":"application/json; charset=utf-8"},r.c=s,r.a=_i(i),di(t.b,r,n).a()})},e.ta=function(){return Si("getDownloadURL",[],arguments),ss(this,"getDownloadURL"),this.ha().then(function(e){e=e.downloadURLs[0];if(_(e))return e;throw new b("no-download-url","The given file does not have any download URLs.")})};var ss=function(e,t){if(""===e.a.path)throw new b("invalid-root-operation","The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")},os=function(e){this.a=new hi(e,function(e,t){return new rs(e,t)},oi,this),this.b=e,this.c=new us(this)};e=os.prototype,e.wa=function(e){Si("ref",[Ni(function(e){if(/^[A-Za-z]+:\/\//.test(e))throw"Expected child path but got a URL, use refFromURL instead."},!0)],arguments);var t=new rs(this.a);return r(e)?t.ga(e):t},e.xa=function(e){return Si("refFromURL",[Ni(function(e){if(!/^[A-Za-z]+:\/\//.test(e))throw"Expected full URL but got a child path, use ref instead.";try{Z(e)}catch(t){throw"Expected valid full URL but got an invalid one."}},!1)],arguments),new rs(this.a,e)},e.Ca=function(){return this.a.b},e.za=function(e){Si("setMaxUploadRetryTime",[ki()],arguments),this.a.b=e},e.Ba=function(){return this.a.c},e.ya=function(e){Si("setMaxOperationRetryTime",[ki()],arguments),this.a.c=e},e.oa=function(){return this.b},e.la=function(){return this.c};var us=function(e){this.a=e};us.prototype.delete=function(){var e=this.a.a;e.g=!0,e.a=null,e.h.clear()};var as=function(e,t,n){Object.defineProperty(e,t,{get:n})};rs.prototype.toString=rs.prototype.toString,rs.prototype.child=rs.prototype.ga,rs.prototype.put=rs.prototype.ua,rs.prototype["delete"]=rs.prototype.delete,rs.prototype.getMetadata=rs.prototype.ha,rs.prototype.updateMetadata=rs.prototype.va,rs.prototype.getDownloadURL=rs.prototype.ta,as(rs.prototype,"parent",rs.prototype.Fa),as(rs.prototype,"root",rs.prototype.Ha),as(rs.prototype,"bucket",rs.prototype.pa),as(rs.prototype,"fullPath",rs.prototype.Aa),as(rs.prototype,"name",rs.prototype.Ea),as(rs.prototype,"storage",rs.prototype.Ja),os.prototype.ref=os.prototype.wa,os.prototype.refFromURL=os.prototype.xa,as(os.prototype,"maxOperationRetryTime",os.prototype.Ba),os.prototype.setMaxOperationRetryTime=os.prototype.ya,as(os.prototype,"maxUploadRetryTime",os.prototype.Ca),os.prototype.setMaxUploadRetryTime=os.prototype.za,as(os.prototype,"app",os.prototype.oa),as(os.prototype,"INTERNAL",os.prototype.la),us.prototype["delete"]=us.prototype.delete,os.prototype.capi_=function(e){y=e},zi.prototype.on=zi.prototype.I,zi.prototype.resume=zi.prototype.M,zi.prototype.pause=zi.prototype.L,zi.prototype.cancel=zi.prototype.H,as(zi.prototype,"snapshot",zi.prototype.C),as(nt.prototype,"bytesTransferred",nt.prototype.qa),as(nt.prototype,"totalBytes",nt.prototype.La),as(nt.prototype,"state",nt.prototype.Ia),as(nt.prototype,"metadata",nt.prototype.Da),as(nt.prototype,"downloadURL",nt.prototype.sa),as(nt.prototype,"task",nt.prototype.Ka),as(nt.prototype,"ref",nt.prototype.Ga),A.STATE_CHANGED="state_changed",O.RUNNING="running",O.PAUSED="paused",O.SUCCESS="success",O.CANCELED="canceled",O.ERROR="error",On.prototype["catch"]=On.prototype.l,On.prototype.then=On.prototype.then,function(){function e(e){return new os(e)}var t={TaskState:O,TaskEvent:A,Storage:os,Reference:rs};if(!(window.firebase&&firebase.INTERNAL&&firebase.INTERNAL.registerService))throw Error("Cannot install Firebase Storage - be sure to load firebase-app.js first.");firebase.INTERNAL.registerService("storage",e,t)}()}(),define("firebase",function(e){return function(){var t,n;return t||e.firebase}}(this)),!function(e){"use strict";angular.module("firebase",[]).value("Firebase",e.Firebase)}(window),function(){"use strict";angular.module("firebase").factory("$firebaseArray",["$log","$firebaseUtils","$q",function(e,t,n){function r(e){if(this instanceof r){var n=this;return this._observers=[],this.$list=[],this._ref=e,this._sync=new i(this),t.assertValidRef(e,"Must pass a valid Firebase reference to $firebaseArray (not a string or URL)"),this._indexCache={},t.getPublicMethods(n,function(e,t){n.$list[t]=e.bind(n)}),this._sync.init(this.$list),this.$list}return new r(e)}function i(r){function i(e){if(!w.isDestroyed){w.isDestroyed=!0;var t=r.$ref();t.off("child_added",l),t.off("child_moved",p),t.off("child_changed",h),t.off("child_removed",d),r=null,y(e||"destroyed")}}function s(t){var n=r.$ref();n.on("child_added",l,g),n.on("child_moved",p,g),n.on("child_changed",h,g),n.on("child_removed",d,g),n.once("value",function(n){angular.isArray(n.val())&&e.warn("Storing data using array indices in Firebase can result in unexpected behavior. See https://firebase.google.com/docs/database/web/structure-data for more information."),y(null,t)},y)}function o(e,t){m||(m=!0,e?f.reject(e):f.resolve(t))}function u(e,t){var r=n.when(e);r.then(function(e){e&&t(e)}),m||v.push(r)}var f=t.defer(),l=function(e,t){r&&u(r.$$added(e,t),function(e){r.$$process("child_added",e,t)})},h=function(e){if(r){var t=r.$getRecord(e.key);t&&u(r.$$updated(e),function(){r.$$process("child_changed",t)})}},p=function(e,t){if(r){var n=r.$getRecord(e.key);n&&u(r.$$moved(e,t),function(){r.$$process("child_moved",n,t)})}},d=function(e){if(r){var t=r.$getRecord(e.key);t&&u(r.$$removed(e),function(){r.$$process("child_removed",t)})}},v=[],m=!1,g=t.batch(function(e){o(e),r&&r.$$error(e)}),y=t.batch(o),w={destroy:i,isDestroyed:!1,init:s,ready:function(){return f.promise.then(function(e){return n.all(v).then(function(){return e})})}};return w}return r.prototype={$add:function(e){this._assertNotDestroyed("$add");var n,r=this,i=t.defer(),s=this.$ref().ref.push();try{n=t.toJSON(e)}catch(o){i.reject(o)}return"undefined"!=typeof n&&t.doSet(s,n).then(function(){r.$$notify("child_added",s.key),i.resolve(s)})["catch"](i.reject),i.promise},$save:function(e){this._assertNotDestroyed("$save");var n=this,r=n._resolveItem(e),i=n.$keyAt(r),s=t.defer();if(null!==i){var o,u=n.$ref().ref.child(i);try{o=t.toJSON(r)}catch(a){s.reject(a)}"undefined"!=typeof o&&t.doSet(u,o).then(function(){n.$$notify("child_changed",i),s.resolve(u)})["catch"](s.reject)}else s.reject("Invalid record; could not determine key for "+e);return s.promise},$remove:function(e){this._assertNotDestroyed("$remove");var n=this.$keyAt(e);if(null!==n){var r=this.$ref().ref.child(n);return t.doRemove(r).then(function(){return r})}return t.reject("Invalid record; could not determine key for "+e)},$keyAt:function(e){var t=this._resolveItem(e);return this.$$getKey(t)},$indexFor:function(e){var t=this,n=t._indexCache;if(!n.hasOwnProperty(e)||t.$keyAt(n[e])!==e){var r=t.$list.findIndex(function(n){return t.$$getKey(n)===e});-1!==r&&(n[e]=r)}return n.hasOwnProperty(e)?n[e]:-1},$loaded:function(e,t){var n=this._sync.ready();return arguments.length&&(n=n.then.call(n,e,t)),n},$ref:function(){return this._ref},$watch:function(e,t){var n=this._observers;return n.push([e,t]),function(){var r=n.findIndex(function(n){return n[0]===e&&n[1]===t});r>-1&&n.splice(r,1)}},$destroy:function(e){this._isDestroyed||(this._isDestroyed=!0,this._sync.destroy(e),this.$list.length=0)},$getRecord:function(e){var t=this.$indexFor(e);return t>-1?this.$list[t]:null},$$added:function(e){var n=this.$indexFor(e.key);if(-1===n){var r=e.val();return angular.isObject(r)||(r={$value:r}),r.$id=e.key,r.$priority=e.getPriority(),t.applyDefaults(r,this.$$defaults),r}return!1},$$removed:function(e){return this.$indexFor(e.key)>-1},$$updated:function(e){var n=!1,r=this.$getRecord(e.key);return angular.isObject(r)&&(n=t.updateRec(r,e),t.applyDefaults(r,this.$$defaults)),n},$$moved:function(e){var t=this.$getRecord(e.key);return angular.isObject(t)?(t.$priority=e.getPriority(),!0):!1},$$error:function(t){e.error(t),this.$destroy(t)},$$getKey:function(e){return angular.isObject(e)?e.$id:null},$$process:function(e,t,n){var r,i=this.$$getKey(t),s=!1;switch(e){case"child_added":r=this.$indexFor(i);break;case"child_moved":r=this.$indexFor(i),this._spliceOut(i);break;case"child_removed":s=null!==this._spliceOut(i);break;case"child_changed":s=!0;break;default:throw new Error("Invalid event type: "+e)}return angular.isDefined(r)&&(s=this._addAfter(t,n)!==r),s&&this.$$notify(e,i,n),s},$$notify:function(e,t,n){var r={event:e,key:t};angular.isDefined(n)&&(r.prevChild=n),angular.forEach(this._observers,function(e){e[0].call(e[1],r)})},_addAfter:function(e,t){var n;return null===t?n=0:(n=this.$indexFor(t)+1,0===n&&(n=this.$list.length)),this.$list.splice(n,0,e),this._indexCache[this.$$getKey(e)]=n,n},_spliceOut:function(e){var t=this.$indexFor(e);return t>-1?(delete this._indexCache[e],this.$list.splice(t,1)[0]):null},_resolveItem:function(e){var t=this.$list;if(angular.isNumber(e)&&e>=0&&t.length>=e)return t[e];if(angular.isObject(e)){var n=this.$$getKey(e),r=this.$getRecord(n);return r===e?r:null}return null},_assertNotDestroyed:function(e){if(this._isDestroyed)throw new Error("Cannot call "+e+" method on a destroyed $firebaseArray object")}},r.$extend=function(e,n){return 1===arguments.length&&angular.isObject(e)&&(n=e,e=function(t){return this instanceof e?(r.apply(this,arguments),this.$list):new e(t)}),t.inherit(e,r,n)},r}]),angular.module("firebase").factory("$FirebaseArray",["$log","$firebaseArray",function(e,t){return function(){return e.warn("$FirebaseArray has been renamed. Use $firebaseArray instead."),t.apply(null,arguments)}}])}(),function(){"use strict";var e;angular.module("firebase").factory("$firebaseAuth",["$firebaseUtils",function(t){return function(n){n=n||firebase.auth();var r=new e(t,n);return r.construct()}}]),e=function(e,t){if(this._utils=e,"string"==typeof ref)throw new Error("Please provide a Firebase reference instead of a URL when creating a `$firebaseAuth` object.");this._auth=t,this._initialAuthResolver=this._initAuthResolver()},e.prototype={construct:function(){return this._object={$signInWithCustomToken:this.signInWithCustomToken.bind(this),$signInAnonymously:this.signInAnonymously.bind(this),$signInWithEmailAndPassword:this.signInWithEmailAndPassword.bind(this),$signInWithPopup:this.signInWithPopup.bind(this),$signInWithRedirect:this.signInWithRedirect.bind(this),$signInWithCredential:this.signInWithCredential.bind(this),$signOut:this.signOut.bind(this),$onAuthStateChanged:this.onAuthStateChanged.bind(this),$getAuth:this.getAuth.bind(this),$requireSignIn:this.requireSignIn.bind(this),$waitForSignIn:this.waitForSignIn.bind(this),$createUserWithEmailAndPassword:this.createUserWithEmailAndPassword.bind(this),$updatePassword:this.updatePassword.bind(this),$updateEmail:this.updateEmail.bind(this),$deleteUser:this.deleteUser.bind(this),$sendPasswordResetEmail:this.sendPasswordResetEmail.bind(this),_:this},this._object},signInWithCustomToken:function(e){return this._utils.Q(this._auth.signInWithCustomToken(e).then)},signInAnonymously:function(){return this._utils.Q(this._auth.signInAnonymously().then)},signInWithEmailAndPassword:function(e,t){return this._utils.Q(this._auth.signInWithEmailAndPassword(e,t).then)},signInWithPopup:function(e){return this._utils.Q(this._auth.signInWithPopup(this._getProvider(e)).then)},signInWithRedirect:function(e){return this._utils.Q(this._auth.signInWithRedirect(this._getProvider(e)).then)},signInWithCredential:function(e){return this._utils.Q(this._auth.signInWithCredential(e).then)},signOut:function(){null!==this.getAuth()&&this._auth.signOut()},onAuthStateChanged:function(e,t){var n=this._utils.debounce(e,t,0),r=this._auth.onAuthStateChanged(n);return r},getAuth:function(){return this._auth.currentUser},_routerMethodOnAuthPromise:function(e){var t=this._utils,n=this;return this._initialAuthResolver.then(function(){var r=n.getAuth(),i=null;return i=e&&null===r?t.reject("AUTH_REQUIRED"):t.resolve(r)})},_getProvider:function(e){var t;if("string"==typeof e){var n=e.slice(0,1).toUpperCase()+e.slice(1);t=new firebase.auth[n+"AuthProvider"]}else t=e;return t},_initAuthResolver:function(){var e=this._auth;return this._utils.promise(function(t){function n(){r(),t()}var r;r=e.onAuthStateChanged(n)})},requireSignIn:function(){return this._routerMethodOnAuthPromise(!0)},waitForSignIn:function(){return this._routerMethodOnAuthPromise(!1)},createUserWithEmailAndPassword:function(e,t){return this._utils.Q(this._auth.createUserWithEmailAndPassword(e,t).then)},updatePassword:function(e){var t=this.getAuth();return t?this._utils.Q(t.updatePassword(e).then):this._utils.reject("Cannot update password since there is no logged in user.")},updateEmail:function(e){var t=this.getAuth();return t?this._utils.Q(t.updateEmail(e).then):this._utils.reject("Cannot update email since there is no logged in user.")},deleteUser:function(){var e=this.getAuth();return e?this._utils.Q(e["delete"]().then):this._utils.reject("Cannot delete user since there is no logged in user.")},sendPasswordResetEmail:function(e){return this._utils.Q(this._auth.sendPasswordResetEmail(e).then)}}}(),function(){"use strict";angular.module("firebase").factory("$firebaseObject",["$parse","$firebaseUtils","$log",function(e,t,n){function r(e){return this instanceof r?(this.$$conf={sync:new s(this,e),ref:e,binding:new i(this),listeners:[]},Object.defineProperty(this,"$$conf",{value:this.$$conf}),this.$id=e.ref.key,this.$priority=null,t.applyDefaults(this,this.$$defaults),void this.$$conf.sync.init()):new r(e)}function i(e){this.subs=[],this.scope=null,this.key=null,this.rec=e}function s(e,r){function i(t){p.isDestroyed||(p.isDestroyed=!0,r.off("value",f),e=null,h(t||"destroyed"))}function s(){r.on("value",f,l),r.once("value",function(e){angular.isArray(e.val())&&n.warn("Storing data using array indices in Firebase can result in unexpected behavior. See https://firebase.google.com/docs/database/web/structure-data for more information. Also note that you probably wanted $firebaseArray and not $firebaseObject."),h(null)},h)}function o(t){u||(u=!0,t?a.reject(t):a.resolve(e))}var u=!1,a=t.defer(),f=t.batch(function(t){var n=e.$$updated(t);n&&e.$$notify()}),l=t.batch(function(t){o(t),e&&e.$$error(t)}),h=t.batch(o),p={isDestroyed:!1,destroy:i,init:s,ready:function(){return a.promise}};return p}return r.prototype={$save:function(){var e,n=this,r=n.$ref(),i=t.defer();try{e=t.toJSON(n)}catch(s){i.reject(s)}return"undefined"!=typeof e&&t.doSet(r,e).then(function(){n.$$notify(),i.resolve(n.$ref())})["catch"](i.reject),i.promise},$remove:function(){var e=this;return t.trimKeys(e,{}),e.$value=null,t.doRemove(e.$ref()).then(function(){return e.$$notify(),e.$ref()})},$loaded:function(e,t){var n=this.$$conf.sync.ready();return arguments.length&&(n=n.then.call(n,e,t)),n},$ref:function(){return this.$$conf.ref},$bindTo:function(e,t){var n=this;return n.$loaded().then(function(){return n.$$conf.binding.bindTo(e,t)})},$watch:function(e,t){var n=this.$$conf.listeners;return n.push([e,t]),function(){var r=n.findIndex(function(n){return n[0]===e&&n[1]===t});r>-1&&n.splice(r,1)}},$destroy:function(e){var n=this;n.$isDestroyed||(n.$isDestroyed=!0,n.$$conf.sync.destroy(e),n.$$conf.binding.destroy(),t.each(n,function(e,t){delete n[t]}))},$$updated:function(e){var n=t.updateRec(this,e);return t.applyDefaults(this,this.$$defaults),n},$$error:function(e){n.error(e),this.$destroy(e)},$$scopeUpdated:function(e){var n=t.defer();return this.$ref().set(t.toJSON(e),t.makeNodeResolver(n)),n.promise},$$notify:function(){var e=this,t=this.$$conf.listeners.slice();angular.forEach(t,function(t){t[0].call(t[1],{event:"value",key:e.$id})})},forEach:function(e,n){return t.each(this,e,n)}},r.$extend=function(e,n){return 1===arguments.length&&angular.isObject(e)&&(n=e,e=function(t){return this instanceof e?void r.apply(this,arguments):new e(t)}),t.inherit(e,r,n)},i.prototype={assertNotBound:function(e){if(this.scope){var r="Cannot bind to "+e+" because this instance is already bound to "+this.key+"; one binding per instance (call unbind method or create another FirebaseObject instance)";return n.error(r),t.reject(r)}},bindTo:function(n,r){function i(i){function s(e){return angular.equals(e,h)&&e.$priority===h.$priority&&e.$value===h.$value}function o(e){l.assign(n,t.scopeData(e))}function u(){var e=l(n);return[e,e.$priority,e.$value]}var f=!1,l=e(r),h=i.rec;i.scope=n,i.varName=r;var p=t.debounce(function(e){var r=t.scopeData(e);h.$$scopeUpdated(r)["finally"](function(){f=!1,r.hasOwnProperty("$value")||(delete h.$value,delete l(n).$value),o(h)})},50,500),v=function(e){e=e[0],s(e)||(f=!0,p(e))},m=function(){f||s(l(n))||o(h)};return o(h),i.subs.push(n.$on("$destroy",i.unbind.bind(i))),i.subs.push(n.$watch(u,v,!0)),i.subs.push(h.$watch(m)),i.unbind.bind(i)}return this.assertNotBound(r)||i(this)},unbind:function(){this.scope&&(angular.forEach(this.subs,function(e){e()}),this.subs=[],this.scope=null,this.key=null)},destroy:function(){this.unbind(),this.rec=null}},r}]),angular.module("firebase").factory("$FirebaseObject",["$log","$firebaseObject",function(e,t){return function(){return e.warn("$FirebaseObject has been renamed. Use $firebaseObject instead."),t.apply(null,arguments)}}])}(),function(){"use strict";angular.module("firebase").factory("$firebase",function(){return function(){throw new Error("$firebase has been removed. You may instantiate $firebaseArray and $firebaseObject directly now. For simple write operations, just use the Firebase ref directly. See the AngularFire 1.0.0 changelog for details: https://github.com/firebase/angularfire/releases/tag/v1.0.0")}})}(),function(){"use strict";function e(e){return e()}e.$inject=["$firebaseAuth","$firebaseRef"],angular.module("firebase").factory("$firebaseAuthService",e)}(),function(){"use strict";function e(){this.urls=null,this.registerUrl=function(e){"string"==typeof e&&(this.urls={},this.urls["default"]=e),angular.isObject(e)&&(this.urls=e)},this.$$checkUrls=function(e){return e?e["default"]?void 0:new Error('No default Firebase URL registered. Use firebaseRefProvider.registerUrl({ default: "https://<my-firebase-app>.firebaseio.com/"}).'):new Error("No Firebase URL registered. Use firebaseRefProvider.registerUrl() in the config phase. This is required if you are using $firebaseAuthService.")},this.$$createRefsFromUrlConfig=function(e){var t={},n=this.$$checkUrls(e);if(n)throw n;return angular.forEach(e,function(e,n){t[n]=firebase.database().refFromURL(e)}),t},this.$get=function(){return this.$$createRefsFromUrlConfig(this.urls)}}angular.module("firebase").provider("$firebaseRef",e)}(),Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){if(void 0===this||null===this)throw new TypeError("'this' is null or not defined");var n=this.length>>>0;for(t=+t||0,Math.abs(t)===1/0&&(t=0),0>t&&(t+=n,0>t&&(t=0));n>t;t++)if(this[t]===e)return t;return-1}),Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,r=function(){},i=function(){return n.apply(this instanceof r&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return r.prototype=this.prototype,i.prototype=new r,i}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,n=Object(this),r=n.length>>>0,i=arguments[1],s=0;r>s;s++)if(s in n&&(t=n[s],e.call(i,t,s,n)))return s;return-1}}),"function"!=typeof Object.create&&!function(){var e=function(){};Object.create=function(t){if(arguments.length>1)throw new Error("Second argument not supported");if(null===t)throw new Error("Cannot set a null [[Prototype]]");if("object"!=typeof t)throw new TypeError("Argument must be an object");return e.prototype=t,new e}}(),Object.keys||(Object.keys=function(){"use strict";var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],r=n.length;return function(i){if("object"==typeof i||"function"==typeof i&&null!==i){var s,o,u=[];for(s in i)e.call(i,s)&&u.push(s);if(t)for(o=0;r>o;o++)e.call(i,n[o])&&u.push(n[o]);return u}throw new TypeError("Object.keys called on non-object")}}()),"function"!=typeof Object.getPrototypeOf&&("object"==typeof "test".__proto__?Object.getPrototypeOf=function(e){return e.__proto__}:Object.getPrototypeOf=function(e){return e.constructor.prototype}),function(){"use strict";function e(t){if(!angular.isObject(t))return t;var n=angular.isArray(t)?[]:{};return angular.forEach(t,function(t,r){"string"==typeof r&&"$"===r.charAt(0)||(n[r]=e(t))}),n}angular.module("firebase").factory("$firebaseConfig",["$firebaseArray","$firebaseObject","$injector",function(e,t,n){return function(r){var i=angular.extend({},r);return"string"==typeof i.objectFactory&&(i.objectFactory=n.get(i.objectFactory)),"string"==typeof i.arrayFactory&&(i.arrayFactory=n.get(i.arrayFactory)),angular.extend({arrayFactory:e,objectFactory:t},i)}}]).factory("$firebaseUtils",["$q","$timeout","$rootScope",function(t,n,r){function i(e){function n(e){i.resolve(e)}function r(e){i.reject(e)}if(!angular.isFunction(e))throw new Error("missing resolver function");var i=t.defer();return e(n,r),i.promise}var s={Q:i,batch:function(e,t){return function(){var n=Array.prototype.slice.call(arguments,0);s.compile(function(){e.apply(t,n)})}},debounce:function(e,t,n,r){function i(){l&&(l(),l=null),a&&Date.now()-a>r?h||(h=!0,s.compile(o)):(a||(a=Date.now()),l=s.wait(o,n))}function o(){l=null,a=null,h=!1,e.apply(t,c)}function u(){c=Array.prototype.slice.call(arguments,0),i()}var a,l,c,h;if("number"==typeof t&&(r=n,n=t,t=null),"number"!=typeof n)throw new Error("Must provide a valid integer for wait. Try 0 for a default");if("function"!=typeof e)throw new Error("Must provide a valid function to debounce");return r||(r=10*n||100),u.running=function(){return a>0},u},assertValidRef:function(e,t){if(!angular.isObject(e)||"object"!=typeof e.ref||"function"!=typeof e.ref.transaction)throw new Error(t||"Invalid Firebase reference")},inherit:function(e,t,n){var r=e.prototype;return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,angular.forEach(Object.keys(r),function(t){e.prototype[t]=r[t]}),angular.isObject(n)&&angular.extend(e.prototype,n),e},getPrototypeMethods:function(e,t,n){for(var r={},i=Object.getPrototypeOf({}),s=angular.isFunction(e)&&angular.isObject(e.prototype)?e.prototype:Object.getPrototypeOf(e);s&&s!==i;){for(var o in s)s.hasOwnProperty(o)&&!r.hasOwnProperty(o)&&(r[o]=!0,t.call(n,s[o],o,s));s=Object.getPrototypeOf(s)}},getPublicMethods:function(e,t,n){s.getPrototypeMethods(e,function(e,r){"function"==typeof e&&"_"!==r.charAt(0)&&t.call(n,e,r)})},defer:t.defer,reject:t.reject,resolve:t.when,promise:angular.isFunction(t)?t:i,makeNodeResolver:function(e){return function(t,n){null===t?(arguments.length>2&&(n=Array.prototype.slice.call(arguments,1)),e.resolve(n)):e.reject(t)}},wait:function(e,t){var r=n(e,t||0);return function(){r&&(n.cancel(r),r=null)}},compile:function(e){return r.$evalAsync(e||function(){})},deepCopy:function(e){if(!angular.isObject(e))return e;var t=angular.isArray(e)?e.slice():angular.extend({},e);for(var n in t)t.hasOwnProperty(n)&&angular.isObject(t[n])&&(t[n]=s.deepCopy(t[n]));return t},trimKeys:function(e,t){s.each(e,function(n,r){t.hasOwnProperty(r)||delete e[r]})},scopeData:function(e){var t={$id:e.$id,$priority:e.$priority},n=!1;return s.each(e,function(e,r){n=!0,t[r]=s.deepCopy(e)}),!n&&e.hasOwnProperty("$value")&&(t.$value=e.$value),t},updateRec:function(e,t){var n=t.val(),r=angular.extend({},e);return angular.isObject(n)?delete e.$value:(e.$value=n,n={}),s.trimKeys(e,n),angular.extend(e,n),e.$priority=t.getPriority(),!angular.equals(r,e)||r.$value!==e.$value||r.$priority!==e.$priority},applyDefaults:function(e,t){return angular.isObject(t)&&angular.forEach(t,function(t,n){e.hasOwnProperty(n)||(e[n]=t)}),e},dataKeys:function(e){var t=[];return s.each(e,function(e,n){t.push(n)}),t},each:function(e,t,n){if(angular.isObject(e)){for(var r in e)if(e.hasOwnProperty(r)){var i=r.charAt(0);"_"!==i&&"$"!==i&&"."!==i&&t.call(n,e[r],r,e)}}else if(angular.isArray(e))for(var s=0,o=e.length;o>s;s++)t.call(n,e[s],s,e);return e},toJSON:function(t){var n;return angular.isObject(t)||(t={$value:t}),angular.isFunction(t.toJSON)?n=t.toJSON():(n={},s.each(t,function(t,r){n[r]=e(t)})),angular.isDefined(t.$value)&&0===Object.keys(n).length&&null!==t.$value&&(n[".value"]=t.$value),angular.isDefined(t.$priority)&&Object.keys(n).length>0&&null!==t.$priority&&(n[".priority"]=t.$priority),angular.forEach(n,function(e,t){if(t.match(/[.$\[\]#\/]/)&&".value"!==t&&".priority"!==t)throw new Error("Invalid key "+t+" (cannot contain .$[]#/)");if(angular.isUndefined(e))throw new Error("Key "+t+" was undefined. Cannot pass undefined in JSON. Use null instead.")}),n},doSet:function(e,t){var n=s.defer();if(angular.isFunction(e.set)||!angular.isObject(t))try{e.set(t,s.makeNodeResolver(n))}catch(r){n.reject(r)}else{var i=angular.extend({},t);e.once("value",function(t){t.forEach(function(e){i.hasOwnProperty(e.key)||(i[e.key]=null)}),e.ref.update(i,s.makeNodeResolver(n))},function(e){n.reject(e)})}return n.promise},doRemove:function(e){var t=s.defer();return angular.isFunction(e.remove)?e.remove(s.makeNodeResolver(t)):e.once("value",function(n){var r=[];n.forEach(function(e){r.push(e.ref.remove())}),s.allPromises(r).then(function(){t.resolve(e)},function(e){t.reject(e)})},function(e){t.reject(e)}),t.promise},VERSION:"2.0.0",allPromises:t.all.bind(t)};return s}])}(),define("angularfire",["angular","firebase"],function(){}),function(e,t){"use strict";function i(){function e(e,n){return t.extend(Object.create(e),n)}function i(e,t){var n=t.caseInsensitiveMatch,r={originalPath:e,regexp:e},i=r.keys=[];return e=e.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)(\*\?|[\?\*])?/g,function(e,t,n,r){var s=r==="?"||r==="*?"?"?":null,o=r==="*"||r==="*?"?"*":null;return i.push({name:n,optional:!!s}),t=t||"",""+(s?"":t)+"(?:"+(s?t:"")+(o&&"(.+?)"||"([^/]+)")+(s||"")+")"+(s||"")}).replace(/([\/$\*])/g,"\\$1"),r.regexp=new RegExp("^"+e+"$",n?"i":""),r}var n={};this.when=function(e,r){var s=t.copy(r);t.isUndefined(s.reloadOnSearch)&&(s.reloadOnSearch=!0),t.isUndefined(s.caseInsensitiveMatch)&&(s.caseInsensitiveMatch=this.caseInsensitiveMatch),n[e]=t.extend(s,e&&i(e,s));if(e){var o=e[e.length-1]=="/"?e.substr(0,e.length-1):e+"/";n[o]=t.extend({redirectTo:e},i(o,s))}return this},this.caseInsensitiveMatch=!1,this.otherwise=function(e){return typeof e=="string"&&(e={redirectTo:e}),this.when(null,e),this},this.$get=["$rootScope","$location","$routeParams","$q","$injector","$templateRequest","$sce",function(i,s,o,u,a,f,l){function v(e,t){var n=t.keys,r={};if(!t.regexp)return null;var i=t.regexp.exec(e);if(!i)return null;for(var s=1,o=i.length;s<o;++s){var u=n[s-1],a=i[s];u&&a&&(r[u.name]=a)}return r}function m(e){var n=d.current;h=w(),p=h&&n&&h.$$route===n.$$route&&t.equals(h.pathParams,n.pathParams)&&!h.reloadOnSearch&&!c,!p&&(n||h)&&i.$broadcast("$routeChangeStart",h,n).defaultPrevented&&e&&e.preventDefault()}function g(){var e=d.current,n=h;if(p)e.params=n.params,t.copy(e.params,o),i.$broadcast("$routeUpdate",e);else if(n||e)c=!1,d.current=n,n&&n.redirectTo&&(t.isString(n.redirectTo)?s.path(E(n.redirectTo,n.params)).search(n.params).replace():s.url(n.redirectTo(n.pathParams,s.path(),s.search())).replace()),u.when(n).then(y).then(function(r){n==d.current&&(n&&(n.locals=r,t.copy(n.params,o)),i.$broadcast("$routeChangeSuccess",n,e))},function(t){n==d.current&&i.$broadcast("$routeChangeError",n,e,t)})}function y(e){if(e){var n=t.extend({},e.resolve);t.forEach(n,function(e,r){n[r]=t.isString(e)?a.get(e):a.invoke(e,null,null,r)});var r=b(e);return t.isDefined(r)&&(n.$template=r),u.all(n)}}function b(e){var n,r;return t.isDefined(n=e.template)?t.isFunction(n)&&(n=n(e.params)):t.isDefined(r=e.templateUrl)&&(t.isFunction(r)&&(r=r(e.params)),t.isDefined(r)&&(e.loadedTemplateUrl=l.valueOf(r),n=f(r))),n}function w(){var r,i;return t.forEach(n,function(n,o){!i&&(r=v(s.path(),n))&&(i=e(n,{params:t.extend({},s.search(),r),pathParams:r}),i.$$route=n)}),i||n[null]&&e(n[null],{params:{},pathParams:{}})}function E(e,n){var r=[];return t.forEach((e||"").split(":"),function(e,t){if(t===0)r.push(e);else{var i=e.match(/(\w+)(?:[?*])?(.*)/),s=i[1];r.push(n[s]),r.push(i[2]||""),delete n[s]}}),r.join("")}var c=!1,h,p,d={routes:n,reload:function(){c=!0;var e={defaultPrevented:!1,preventDefault:function(){this.defaultPrevented=!0,c=!1}};i.$evalAsync(function(){m(e),e.defaultPrevented||g()})},updateParams:function(e){if(!this.current||!this.current.$$route)throw r("norout","Tried updating route when with no current route");e=t.extend({},this.current.params,e),s.path(E(this.current.$$route.originalPath,e)),s.search(e)}};return i.$on("$locationChangeStart",m),i.$on("$locationChangeSuccess",g),d}]}function s(){this.$get=function(){return{}}}function o(e,n,r){return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",link:function(i,s,o,u,a){function d(){c&&(r.cancel(c),c=null),f&&(f.$destroy(),f=null),l&&(c=r.leave(l),c.then(function(){c=null}),l=null)}function v(){var o=e.current&&e.current.locals,u=o&&o.$template;if(t.isDefined(u)){var c=i.$new(),v=e.current,m=a(c,function(e){r.enter(e,null,l||s).then(function(){t.isDefined(h)&&(!h||i.$eval(h))&&n()}),d()});l=m,f=v.scope=c,f.$emit("$viewContentLoaded"),f.$eval(p)}else d()}var f,l,c,h=o.autoscroll,p=o.onload||"";i.$on("$routeChangeSuccess",v),v()}}}function u(e,t,n){return{restrict:"ECA",priority:-400,link:function(r,i){var s=n.current,o=s.locals;i.html(o.$template);var u=e(i.contents());if(s.controller){o.$scope=r;var a=t(s.controller,o);s.controllerAs&&(r[s.controllerAs]=a),i.data("$ngControllerController",a),i.children().data("$ngControllerController",a)}r[s.resolveAs||"$resolve"]=o,u(r)}}}var n=t.module("ngRoute",["ng"]).provider("$route",i),r=t.$$minErr("ngRoute");n.provider("$routeParams",s),n.directive("ngView",o),n.directive("ngView",u),o.$inject=["$route","$anchorScroll","$animate"],u.$inject=["$compile","$controller","$route"]}(window,window.angular),define("angularRoute",["angular"],function(){}),!function(e,t,n){"use strict";function r(e){return A(e)?e:Object.keys(e).map(function(t){return e[t]})}function i(e){return null===e}function s(e,t){var r=Object.keys(e);return-1==r.map(function(r){return t[r]!==n&&t[r]==e[r]}).indexOf(!1)}function o(e,t){if(""===t)return e;var n=e.indexOf(t.charAt(0));return-1===n?!1:o(e.substr(n+1),t.substr(1))}function u(e,t,n){var r=0;return e.filter(function(e){var i=x(n)?t>r&&n(e):t>r;return r=i?r+1:r,i})}function a(e,t,n){return n.round(e*n.pow(10,t))/n.pow(10,t)}function f(e,t,n){t=t||[];var r=Object.keys(e);return r.forEach(function(r){if(L(e[r])&&!A(e[r])){var i=n?n+"."+r:n;f(e[r],t,i||r)}else{var s=n?n+"."+r:r;t.push(s)}}),t}function l(e){return e&&e.$evalAsync&&e.$watch}function c(){return function(e,t){return e>t}}function h(){return function(e,t){return e>=t}}function p(){return function(e,t){return t>e}}function d(){return function(e,t){return t>=e}}function v(){return function(e,t){return e==t}}function m(){return function(e,t){return e!=t}}function g(){return function(e,t){return e===t}}function y(){return function(e,t){return e!==t}}function b(e){return function(t,n){return t=L(t)?r(t):t,!A(t)||T(n)?!1:t.some(function(t){return L(t)||N(n)?e(n)(t):t===n})}}function w(e,t){return t=t||0,t>=e.length?e:A(e[t])?w(e.slice(0,t).concat(e[t],e.slice(t+1)),t):w(e,t+1)}function E(e){return function(t,n){function i(e,t){return T(t)?!1:e.some(function(e){return D(e,t)})}if(t=L(t)?r(t):t,!A(t))return t;var s=[],o=e(n);return T(n)?t.filter(function(e,t,n){return n.indexOf(e)===t}):t.filter(function(e){var t=o(e);return i(s,t)?!1:(s.push(t),!0)})}}function S(e,t,n){return t?e+n+S(e,--t,n):e}var x=t.isDefined,T=t.isUndefined,N=t.isFunction,C=t.isString,k=t.isNumber,L=t.isObject,A=t.isArray,O=t.forEach,M=t.extend,_=t.copy,D=t.equals;String.prototype.contains||(String.prototype.contains=function(){return-1!==String.prototype.indexOf.apply(this,arguments)}),t.module("a8m.angular",[]).filter("isUndefined",function(){return function(e){return t.isUndefined(e)}}).filter("isDefined",function(){return function(e){return t.isDefined(e)}}).filter("isFunction",function(){return function(e){return t.isFunction(e)}}).filter("isString",function(){return function(e){return t.isString(e)}}).filter("isNumber",function(){return function(e){return t.isNumber(e)}}).filter("isArray",function(){return function(e){return t.isArray(e)}}).filter("isObject",function(){return function(e){return t.isObject(e)}}).filter("isEqual",function(){return function(e,n){return t.equals(e,n)}}),t.module("a8m.conditions",[]).filter({isGreaterThan:c,">":c,isGreaterThanOrEqualTo:h,">=":h,isLessThan:p,"<":p,isLessThanOrEqualTo:d,"<=":d,isEqualTo:v,"==":v,isNotEqualTo:m,"!=":m,isIdenticalTo:g,"===":g,isNotIdenticalTo:y,"!==":y}),t.module("a8m.is-null",[]).filter("isNull",function(){return function(e){return i(e)}}),t.module("a8m.after-where",[]).filter("afterWhere",function(){return function(e,t){if(e=L(e)?r(e):e,!A(e)||T(t))return e;var n=e.map(function(e){return s(t,e)}).indexOf(!0);return e.slice(-1===n?0:n)}}),t.module("a8m.after",[]).filter("after",function(){return function(e,t){return e=L(e)?r(e):e,A(e)?e.slice(t):e}}),t.module("a8m.before-where",[]).filter("beforeWhere",function(){return function(e,t){if(e=L(e)?r(e):e,!A(e)||T(t))return e;var n=e.map(function(e){return s(t,e)}).indexOf(!0);return e.slice(0,-1===n?e.length:++n)}}),t.module("a8m.before",[]).filter("before",function(){return function(e,t){return e=L(e)?r(e):e,A(e)?e.slice(0,t?--t:t):e}}),t.module("a8m.chunk-by",["a8m.filter-watcher"]).filter("chunkBy",["filterWatcher",function(e){return function(t,n,r){function i(e,t){for(var n=[];e--;)n[e]=t;return n}function s(e,t,n){return A(e)?e.map(function(e,r,s){return r*=t,e=s.slice(r,r+t),!T(n)&&e.length<t?e.concat(i(t-e.length,n)):e}).slice(0,Math.ceil(e.length/t)):e}return e.isMemoized("chunkBy",arguments)||e.memoize("chunkBy",arguments,this,s(t,n,r))}}]),t.module("a8m.concat",[]).filter("concat",[function(){return function(e,t){if(T(t))return e;if(A(e))return L(t)?e.concat(r(t)):e.concat(t);if(L(e)){var n=r(e);return L(t)?n.concat(r(t)):n.concat(t)}return e}}]),t.module("a8m.contains",[]).filter({contains:["$parse",b],some:["$parse",b]}),t.module("a8m.count-by",[]).filter("countBy",["$parse",function(e){return function(t,n){var i,s={},o=e(n);return t=L(t)?r(t):t,!A(t)||T(n)?t:(t.forEach(function(e){i=o(e),s[i]||(s[i]=0),s[i]++}),s)}}]),t.module("a8m.defaults",[]).filter("defaults",["$parse",function(e){return function(t,n){if(t=L(t)?r(t):t,!A(t)||!L(n))return t;var i=f(n);return t.forEach(function(t){i.forEach(function(r){var i=e(r),s=i.assign;T(i(t))&&s(t,i(n))})}),t}}]),t.module("a8m.every",[]).filter("every",["$parse",function(e){return function(t,n){return t=L(t)?r(t):t,!A(t)||T(n)?!0:t.every(function(t){return L(t)||N(n)?e(n)(t):t===n})}}]),t.module("a8m.filter-by",[]).filter("filterBy",["$parse",function(e){return function(t,i,s){var o;return s=C(s)||k(s)?String(s).toLowerCase():n,t=L(t)?r(t):t,!A(t)||T(s)?t:t.filter(function(t){return i.some(function(n){if(~n.indexOf("+")){var r=n.replace(new RegExp("\\s","g"),"").split("+");o=r.reduce(function(n,r,i){return 1===i?e(n)(t)+" "+e(r)(t):n+" "+e(r)(t)})}else o=e(n)(t);return C(o)||k(o)?String(o).toLowerCase().contains(s):!1})})}}]),t.module("a8m.first",[]).filter("first",["$parse",function(e){return function(t){var i,s,o;return t=L(t)?r(t):t,A(t)?(o=Array.prototype.slice.call(arguments,1),i=k(o[0])?o[0]:1,s=k(o[0])?k(o[1])?n:o[1]:o[0],o.length?u(t,i,s?e(s):s):t[0]):t}}]),t.module("a8m.flatten",[]).filter("flatten",function(){return function(e,t){return t=t||!1,e=L(e)?r(e):e,A(e)?t?[].concat.apply([],e):w(e,0):e}}),t.module("a8m.fuzzy-by",[]).filter("fuzzyBy",["$parse",function(e){return function(t,n,i,s){var u,a,f=s||!1;return t=L(t)?r(t):t,!A(t)||T(n)||T(i)?t:(a=e(n),t.filter(function(e){return u=a(e),C(u)?(u=f?u:u.toLowerCase(),i=f?i:i.toLowerCase(),o(u,i)!==!1):!1}))}}]),t.module("a8m.fuzzy",[]).filter("fuzzy",function(){return function(e,t,n){function i(e,t){var n,r,i=Object.keys(e);return 0<i.filter(function(i){return n=e[i],r?!0:C(n)?(n=s?n:n.toLowerCase(),r=o(n,t)!==!1):!1}).length}var s=n||!1;return e=L(e)?r(e):e,!A(e)||T(t)?e:(t=s?t:t.toLowerCase(),e.filter(function(e){return C(e)?(e=s?e:e.toLowerCase(),o(e,t)!==!1):L(e)?i(e,t):!1}))}}),t.module("a8m.group-by",["a8m.filter-watcher"]).filter("groupBy",["$parse","filterWatcher",function(e,t){return function(n,r){function i(e,t){var n,r={};return O(e,function(e){n=t(e),r[n]||(r[n]=[]),r[n].push(e)}),r}return!L(n)||T(r)?n:t.isMemoized("groupBy",arguments)||t.memoize("groupBy",arguments,this,i(n,e(r)))}}]),t.module("a8m.is-empty",[]).filter("isEmpty",function(){return function(e){return L(e)?!r(e).length:!e.length}}),t.module("a8m.join",[]).filter("join",function(){return function(e,t){return T(e)||!A(e)?e:(T(t)&&(t=" "),e.join(t))}}),t.module("a8m.last",[]).filter("last",["$parse",function(e){return function(t){var i,s,o,a=_(t);return a=L(a)?r(a):a,A(a)?(o=Array.prototype.slice.call(arguments,1),i=k(o[0])?o[0]:1,s=k(o[0])?k(o[1])?n:o[1]:o[0],o.length?u(a.reverse(),i,s?e(s):s).reverse():a[a.length-1]):a}}]),t.module("a8m.map",[]).filter("map",["$parse",function(e){return function(t,n){return t=L(t)?r(t):t,!A(t)||T(n)?t:t.map(function(t){return e(n)(t)})}}]),t.module("a8m.omit",[]).filter("omit",["$parse",function(e){return function(t,n){return t=L(t)?r(t):t,!A(t)||T(n)?t:t.filter(function(t){return!e(n)(t)})}}]),t.module("a8m.pick",[]).filter("pick",["$parse",function(e){return function(t,n){return t=L(t)?r(t):t,!A(t)||T(n)?t:t.filter(function(t){return e(n)(t)})}}]),t.module("a8m.range",[]).filter("range",function(){return function(e,t){for(var n=0;n<parseInt(t);n++)e.push(n);return e}}),t.module("a8m.remove-with",[]).filter("removeWith",function(){return function(e,t){return T(t)?e:(e=L(e)?r(e):e,e.filter(function(e){return!s(t,e)}))}}),t.module("a8m.remove",[]).filter("remove",function(){return function(e){e=L(e)?r(e):e;var t=Array.prototype.slice.call(arguments,1);return A(e)?e.filter(function(e){return!t.some(function(t){return D(t,e)})}):e}}),t.module("a8m.reverse",[]).filter("reverse",[function(){return function(e){return e=L(e)?r(e):e,C(e)?e.split("").reverse().join(""):A(e)?e.slice().reverse():e}}]),t.module("a8m.search-field",[]).filter("searchField",["$parse",function(e){return function(t){var n,i;t=L(t)?r(t):t;var s=Array.prototype.slice.call(arguments,1);return A(t)&&s.length?t.map(function(t){return i=s.map(function(r){return(n=e(r))(t)}).join(" "),M(t,{searchField:i})}):t}}]),t.module("a8m.to-array",[]).filter("toArray",function(){return function(e,t){return L(e)?t?Object.keys(e).map(function(t){return M(e[t],{$key:t})}):r(e):e}}),t.module("a8m.unique",[]).filter({unique:["$parse",E],uniq:["$parse",E]}),t.module("a8m.where",[]).filter("where",function(){return function(e,t){return T(t)?e:(e=L(e)?r(e):e,e.filter(function(e){return s(t,e)}))}}),t.module("a8m.xor",[]).filter("xor",["$parse",function(e){return function(t,n,i){function s(t,n){var r=e(i);return n.some(function(e){return i?D(r(e),r(t)):D(e,t)})}return i=i||!1,t=L(t)?r(t):t,n=L(n)?r(n):n,A(t)&&A(n)?t.concat(n).filter(function(e){return!s(e,t)||!s(e,n)}):t}}]),t.module("a8m.math.byteFmt",["a8m.math"]).filter("byteFmt",["$math",function(e){return function(t,n){return k(n)&&isFinite(n)&&n%1===0&&n>=0&&k(t)&&isFinite(t)?1024>t?a(t,n,e)+" B":1048576>t?a(t/1024,n,e)+" KB":1073741824>t?a(t/1048576,n,e)+" MB":a(t/1073741824,n,e)+" GB":"NaN"}}]),t.module("a8m.math.degrees",["a8m.math"]).filter("degrees",["$math",function(e){return function(t,n){if(k(n)&&isFinite(n)&&n%1===0&&n>=0&&k(t)&&isFinite(t)){var r=180*t/e.PI;return e.round(r*e.pow(10,n))/e.pow(10,n)}return"NaN"}}]),t.module("a8m.math.kbFmt",["a8m.math"]).filter("kbFmt",["$math",function(e){return function(t,n){return k(n)&&isFinite(n)&&n%1===0&&n>=0&&k(t)&&isFinite(t)?1024>t?a(t,n,e)+" KB":1048576>t?a(t/1024,n,e)+" MB":a(t/1048576,n,e)+" GB":"NaN"}}]),t.module("a8m.math",[]).factory("$math",["$window",function(e){return e.Math}]),t.module("a8m.math.max",["a8m.math"]).filter("max",["$math","$parse",function(e,t){function n(n,r){var i=n.map(function(e){return t(r)(e)});return i.indexOf(e.max.apply(e,i))}return function(t,r){return A(t)?T(r)?e.max.apply(e,t):t[n(t,r)]:t}}]),t.module("a8m.math.min",["a8m.math"]).filter("min",["$math","$parse",function(e,t){function n(n,r){var i=n.map(function(e){return t(r)(e)});return i.indexOf(e.min.apply(e,i))}return function(t,r){return A(t)?T(r)?e.min.apply(e,t):t[n(t,r)]:t}}]),t.module("a8m.math.percent",["a8m.math"]).filter("percent",["$math","$window",function(e,t){return function(n,r,i){var s=C(n)?t.Number(n):n;return r=r||100,i=i||!1,!k(s)||t.isNaN(s)?n:i?e.round(s/r*100):s/r*100}}]),t.module("a8m.math.radians",["a8m.math"]).filter("radians",["$math",function(e){return function(t,n){if(k(n)&&isFinite(n)&&n%1===0&&n>=0&&k(t)&&isFinite(t)){var r=3.14159265359*t/180;return e.round(r*e.pow(10,n))/e.pow(10,n)}return"NaN"}}]),t.module("a8m.math.radix",[]).filter("radix",function(){return function(e,t){var n=/^[2-9]$|^[1-2]\d$|^3[0-6]$/;return k(e)&&n.test(t)?e.toString(t).toUpperCase():e}}),t.module("a8m.math.shortFmt",["a8m.math"]).filter("shortFmt",["$math",function(e){return function(t,n){return k(n)&&isFinite(n)&&n%1===0&&n>=0&&k(t)&&isFinite(t)?1e3>t?t:1e6>t?a(t/1e3,n,e)+" K":1e9>t?a(t/1e6,n,e)+" M":a(t/1e9,n,e)+" B":"NaN"}}]),t.module("a8m.math.sum",[]).filter("sum",function(){return function(e,t){return A(e)?e.reduce(function(e,t){return e+t},t||0):e}}),t.module("a8m.ends-with",[]).filter("endsWith",function(){return function(e,t,n){var r,i=n||!1;return!C(e)||T(t)?e:(e=i?e:e.toLowerCase(),r=e.length-t.length,-1!==e.indexOf(i?t:t.toLowerCase(),r))}}),t.module("a8m.latinize",[]).filter("latinize",[function(){function e(e){return e.replace(/[^\u0000-\u007E]/g,function(e){return n[e]||e})}for(var t=[{base:"A",letters:"AⒶＡÀÁÂẦẤẪẨÃĀĂẰẮẴẲȦǠÄǞẢÅǺǍȀȂẠẬẶḀĄȺⱯ"},{base:"AA",letters:"Ꜳ"},{base:"AE",letters:"ÆǼǢ"},{base:"AO",letters:"Ꜵ"},{base:"AU",letters:"Ꜷ"},{base:"AV",letters:"ꜸꜺ"},{base:"AY",letters:"Ꜽ"},{base:"B",letters:"BⒷＢḂḄḆɃƂƁ"},{base:"C",letters:"CⒸＣĆĈĊČÇḈƇȻꜾ"},{base:"D",letters:"DⒹＤḊĎḌḐḒḎĐƋƊƉꝹ"},{base:"DZ",letters:"ǱǄ"},{base:"Dz",letters:"ǲǅ"},{base:"E",letters:"EⒺＥÈÉÊỀẾỄỂẼĒḔḖĔĖËẺĚȄȆẸỆȨḜĘḘḚƐƎ"},{base:"F",letters:"FⒻＦḞƑꝻ"},{base:"G",letters:"GⒼＧǴĜḠĞĠǦĢǤƓꞠꝽꝾ"},{base:"H",letters:"HⒽＨĤḢḦȞḤḨḪĦⱧⱵꞍ"},{base:"I",letters:"IⒾＩÌÍÎĨĪĬİÏḮỈǏȈȊỊĮḬƗ"},{base:"J",letters:"JⒿＪĴɈ"},{base:"K",letters:"KⓀＫḰǨḲĶḴƘⱩꝀꝂꝄꞢ"},{base:"L",letters:"LⓁＬĿĹĽḶḸĻḼḺŁȽⱢⱠꝈꝆꞀ"},{base:"LJ",letters:"Ǉ"},{base:"Lj",letters:"ǈ"},{base:"M",letters:"MⓂＭḾṀṂⱮƜ"},{base:"N",letters:"NⓃＮǸŃÑṄŇṆŅṊṈȠƝꞐꞤ"},{base:"NJ",letters:"Ǌ"},{base:"Nj",letters:"ǋ"},{base:"O",letters:"OⓄＯÒÓÔỒỐỖỔÕṌȬṎŌṐṒŎȮȰÖȪỎŐǑȌȎƠỜỚỠỞỢỌỘǪǬØǾƆƟꝊꝌ"},{base:"OI",letters:"Ƣ"},{base:"OO",letters:"Ꝏ"},{base:"OU",letters:"Ȣ"},{base:"OE",letters:"Œ"},{base:"oe",letters:"œ"},{base:"P",letters:"PⓅＰṔṖƤⱣꝐꝒꝔ"},{base:"Q",letters:"QⓆＱꝖꝘɊ"},{base:"R",letters:"RⓇＲŔṘŘȐȒṚṜŖṞɌⱤꝚꞦꞂ"},{base:"S",letters:"SⓈＳẞŚṤŜṠŠṦṢṨȘŞⱾꞨꞄ"},{base:"T",letters:"TⓉＴṪŤṬȚŢṰṮŦƬƮȾꞆ"},{base:"TZ",letters:"Ꜩ"},{base:"U",letters:"UⓊＵÙÚÛŨṸŪṺŬÜǛǗǕǙỦŮŰǓȔȖƯỪỨỮỬỰỤṲŲṶṴɄ"},{base:"V",letters:"VⓋＶṼṾƲꝞɅ"},{base:"VY",letters:"Ꝡ"},{base:"W",letters:"WⓌＷẀẂŴẆẄẈⱲ"},{base:"X",letters:"XⓍＸẊẌ"},{base:"Y",letters:"YⓎＹỲÝŶỸȲẎŸỶỴƳɎỾ"},{base:"Z",letters:"ZⓏＺŹẐŻŽẒẔƵȤⱿⱫꝢ"},{base:"a",letters:"aⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐ"},{base:"aa",letters:"ꜳ"},{base:"ae",letters:"æǽǣ"},{base:"ao",letters:"ꜵ"},{base:"au",letters:"ꜷ"},{base:"av",letters:"ꜹꜻ"},{base:"ay",letters:"ꜽ"},{base:"b",letters:"bⓑｂḃḅḇƀƃɓ"},{base:"c",letters:"cⓒｃćĉċčçḉƈȼꜿↄ"},{base:"d",letters:"dⓓｄḋďḍḑḓḏđƌɖɗꝺ"},{base:"dz",letters:"ǳǆ"},{base:"e",letters:"eⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇɛǝ"},{base:"f",letters:"fⓕｆḟƒꝼ"},{base:"g",letters:"gⓖｇǵĝḡğġǧģǥɠꞡᵹꝿ"},{base:"h",letters:"hⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ"},{base:"hv",letters:"ƕ"},{base:"i",letters:"iⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı"},{base:"j",letters:"jⓙｊĵǰɉ"},{base:"k",letters:"kⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ"},{base:"l",letters:"lⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇ"},{base:"lj",letters:"ǉ"},{base:"m",letters:"mⓜｍḿṁṃɱɯ"},{base:"n",letters:"nⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥ"},{base:"nj",letters:"ǌ"},{base:"o",letters:"oⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿɔꝋꝍɵ"},{base:"oi",letters:"ƣ"},{base:"ou",letters:"ȣ"},{base:"oo",letters:"ꝏ"},{base:"p",letters:"pⓟｐṕṗƥᵽꝑꝓꝕ"},{base:"q",letters:"qⓠｑɋꝗꝙ"},{base:"r",letters:"rⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ"},{base:"s",letters:"sⓢｓßśṥŝṡšṧṣṩșşȿꞩꞅẛ"},{base:"t",letters:"tⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ"},{base:"tz",letters:"ꜩ"},{base:"u",letters:"uⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ"},{base:"v",letters:"vⓥｖṽṿʋꝟʌ"},{base:"vy",letters:"ꝡ"},{base:"w",letters:"wⓦｗẁẃŵẇẅẘẉⱳ"},{base:"x",letters:"xⓧｘẋẍ"},{base:"y",letters:"yⓨｙỳýŷỹȳẏÿỷẙỵƴɏỿ"},{base:"z",letters:"zⓩｚźẑżžẓẕƶȥɀⱬꝣ"}],n={},r=0;r<t.length;r++)for(var i=t[r].letters.split(""),s=0;s<i.length;s++)n[i[s]]=t[r].base;return function(t){return C(t)?e(t):t}}]),t.module("a8m.ltrim",[]).filter("ltrim",function(){return function(e,t){var n=t||"\\s";return C(e)?e.replace(new RegExp("^"+n+"+"),""):e}}),t.module("a8m.match",[]).filter("match",function(){return function(e,t,n){var r=new RegExp(t,n);return C(e)?e.match(r):null}}),t.module("a8m.repeat",[]).filter("repeat",[function(){return function(e,t,n){var r=~~t;return C(e)&&r?S(e,--t,n||""):e}}]),t.module("a8m.rtrim",[]).filter("rtrim",function(){return function(e,t){var n=t||"\\s";return C(e)?e.replace(new RegExp(n+"+$"),""):e}}),t.module("a8m.slugify",[]).filter("slugify",[function(){return function(e,t){var n=T(t)?"-":t;return C(e)?e.toLowerCase().replace(/\s+/g,n):e}}]),t.module("a8m.starts-with",[]).filter("startsWith",function(){return function(e,t,n){var r=n||!1;return!C(e)||T(t)?e:(e=r?e:e.toLowerCase(),!e.indexOf(r?t:t.toLowerCase()))}}),t.module("a8m.stringular",[]).filter("stringular",function(){return function(e){var t=Array.prototype.slice.call(arguments,1);return e.replace(/{(\d+)}/g,function(e,n){return T(t[n])?e:t[n]})}}),t.module("a8m.strip-tags",[]).filter("stripTags",function(){return function(e){return C(e)?e.replace(/<\S[^><]*>/g,""):e}}),t.module("a8m.test",[]).filter("test",function(){return function(e,t,n){var r=new RegExp(t,n);return C(e)?r.test(e):e}}),t.module("a8m.trim",[]).filter("trim",function(){return function(e,t){var n=t||"\\s";return C(e)?e.replace(new RegExp("^"+n+"+|"+n+"+$","g"),""):e}}),t.module("a8m.truncate",[]).filter("truncate",function(){return function(e,t,n,r){return t=T(t)?e.length:t,r=r||!1,n=n||"",!C(e)||e.length<=t?e:e.substring(0,r?-1===e.indexOf(" ",t)?e.length:e.indexOf(" ",t):t)+n}}),t.module("a8m.ucfirst",[]).filter("ucfirst",[function(){return function(e){return C(e)?e.split(" ").map(function(e){return e.charAt(0).toUpperCase()+e.substring(1)}).join(" "):e}}]),t.module("a8m.uri-component-encode",[]).filter("uriComponentEncode",["$window",function(e){return function(t){return C(t)?e.encodeURIComponent(t):t}}]),t.module("a8m.uri-encode",[]).filter("uriEncode",["$window",function(e){return function(t){return C(t)?e.encodeURI(t):t}}]),t.module("a8m.wrap",[]).filter("wrap",function(){return function(e,t,n){return C(e)&&x(t)?[t,e,n||t].join(""):e}}),t.module("a8m.filter-watcher",[]).provider("filterWatcher",function(){this.$get=["$window","$rootScope",function(e,t){function n(t,n){function r(){var t=[];return function(n,r){if(L(r)&&!i(r)){if(~t.indexOf(r))return"[Circular]";t.push(r)}return e==r?"$WINDOW":e.document==r?"$DOCUMENT":l(r)?"$SCOPE":r}}return[t,JSON.stringify(n,r())].join("#").replace(/"/g,"")}function r(e){var t=e.targetScope.$id;O(c[t],function(e){delete f[e]}),delete c[t]}function s(){h(function(){t.$$phase||(f={})},2e3)}function o(e,t){var n=e.$id;return T(c[n])&&(e.$on("$destroy",r),c[n]=[]),c[n].push(t)}function u(e,t){var r=n(e,t);return f[r]}function a(e,t,r,i){var u=n(e,t);return f[u]=i,l(r)?o(r,u):s(),i}var f={},c={},h=e.setTimeout;return{isMemoized:u,memoize:a}}]}),t.module("angular.filter",["a8m.ucfirst","a8m.uri-encode","a8m.uri-component-encode","a8m.slugify","a8m.latinize","a8m.strip-tags","a8m.stringular","a8m.truncate","a8m.starts-with","a8m.ends-with","a8m.wrap","a8m.trim","a8m.ltrim","a8m.rtrim","a8m.repeat","a8m.test","a8m.match","a8m.to-array","a8m.concat","a8m.contains","a8m.unique","a8m.is-empty","a8m.after","a8m.after-where","a8m.before","a8m.before-where","a8m.defaults","a8m.where","a8m.reverse","a8m.remove","a8m.remove-with","a8m.group-by","a8m.count-by","a8m.chunk-by","a8m.search-field","a8m.fuzzy-by","a8m.fuzzy","a8m.omit","a8m.pick","a8m.every","a8m.filter-by","a8m.xor","a8m.map","a8m.first","a8m.last","a8m.flatten","a8m.join","a8m.range","a8m.math","a8m.math.max","a8m.math.min","a8m.math.percent","a8m.math.radix","a8m.math.sum","a8m.math.degrees","a8m.math.radians","a8m.math.byteFmt","a8m.math.kbFmt","a8m.math.shortFmt","a8m.angular","a8m.conditions","a8m.is-null","a8m.filter-watcher"])}(window,window.angular),define("angularFilter",["angular"],function(){}),define("factories/uid",["angular"],function(e){e.module("AminoApp.uid",[]).factory("uid",function(){var e=null;return{getUid:function(){return e},setUid:function(t){e=t}}})}),define("factories/creator",["angular"],function(e){e.module("AminoApp.userCreator",[]).factory("userCreator",function(){return function(e){return builtUser={uid:e,achievements:{epicCollections:0,totalEpicCollections:0,hiddenAminoAcids:0,totalHiddenAminoAcids:0,longWayHomes:0,totalLongWayHomes:0,cleanCollections:0,totalCleanCollections:0,quickCollections:0,totalQuickCollections:0},ribosomeMuted:!1,color:"#000000",checkpoint:10,mouse:!1,intro:!0,effects:1,music:1},builtUser}})}),define("factories/preload",["angular"],function(e){e.module("AminoApp.preload",[]).factory("preload",["proteinPanic",function(e){var t=e;return function(){t.stage.backgroundColor=7979700,t.load.spritesheet("view-statistics","images/view-statistics.png",534,53),t.load.spritesheet("facebook-btn","images/facebook-btn.png",246,42),t.load.spritesheet("continue-btn","images/continue-btn.png",192,42),t.load.spritesheet("edit-options","images/edit-options.png",534,53),t.load.spritesheet("twitter-btn","images/twitter-btn.png",246,42),t.load.spritesheet("options-btn","images/options-btn.png",192,42),t.load.spritesheet("protein-btn","images/protein-btn.png",192,42),t.load.spritesheet("github-btn","images/github-btn.png",246,42),t.load.spritesheet("google-btn","images/google-btn.png",246,42),t.load.spritesheet("start-game","images/start-game.png",534,53),t.load.spritesheet("riboeyes","images/Ribosome-eyes.png",83,50),t.load.spritesheet("start-btn","images/start-btn.png",192,42),t.load.spritesheet("ribosome","images/Ribosome.png",148,155),t.load.spritesheet("menu-btn","images/menu-btn.png",192,42),t.load.spritesheet("next-btn","images/next-btn.png",34,61),t.load.spritesheet("prev-btn","images/prev-btn.png",34,61),t.load.spritesheet("U","images/Selenocysteine.png",59,60),t.load.spritesheet("eyes","images/tRNA-eyes.png",71,106),t.load.spritesheet("D","images/Aspartic_acid.png",60,58),t.load.spritesheet("E","images/Glutamic_acid.png",30,60),t.load.spritesheet("F","images/Phenylalanine.png",60,60),t.load.spritesheet("player","images/tRNA.png",71,106),t.load.spritesheet("N","images/Asparagine.png",26,60),t.load.spritesheet("I","images/Isoleucine.png",60,59),t.load.spritesheet("M","images/Methionine.png",43,60),t.load.spritesheet("W","images/Tryptophan.png",60,31),t.load.spritesheet("Q","images/Glutamine.png",60,44),t.load.spritesheet("H","images/Histidine.png",59,60),t.load.spritesheet("T","images/Threonine.png",56,60),t.load.spritesheet("R","images/Arginine.png",60,52),t.load.spritesheet("C","images/Cysteine.png",60,59),t.load.spritesheet("Y","images/Tyrosine.png",60,38),t.load.spritesheet("A","images/Alanine.png",60,59),t.load.spritesheet("G","images/Glycine.png",60,57),t.load.spritesheet("L","images/Leucine.png",59,60),t.load.spritesheet("P","images/Proline.png",60,48),t.load.spritesheet("X","images/Unknown.png",60,60),t.load.spritesheet("K","images/Lysine.png",60,44),t.load.spritesheet("S","images/Serine.png",39,60),t.load.spritesheet("V","images/Valine.png",60,60),t.load.image("splash-trna-eyes","images/SplashtRNA-eyes.png"),t.load.image("progress-holder","images/progress-holder.png"),t.load.image("splash-arginine","images/SplashArginine.png"),t.load.image("victory-bubble","images/victory-bubble.png"),t.load.image("speech-bubble","images/speech-bubble.png"),t.load.image("splash-valine","images/SplashValine.png"),t.load.image("progress-bar","images/progress-bar.png"),t.load.image("large-bubble","images/large-bubble.png"),t.load.image("ribo-under","images/Ribosome-under.png"),t.load.image("splash-ribo","images/SplashRibo.png"),t.load.image("splash-trna","images/SplashtRNA.png"),t.load.image("checkpoint","images/checkpoint.png"),t.load.image("victory-v","images/victory-v.png"),t.load.image("victory-i","images/victory-i.png"),t.load.image("victory-c","images/victory-c.png"),t.load.image("victory-t","images/victory-t.png"),t.load.image("victory-o","images/victory-o.png"),t.load.image("victory-r","images/victory-r.png"),t.load.image("victory-y","images/victory-y.png"),t.load.image("victory-x","images/victory-x.png"),t.load.image("checkmark","images/checkmark.png"),t.load.image("longhome","images/longhome.png"),t.load.image("cell-bg","images/cell-bg.png"),t.load.image("orline","images/or-line.png"),t.load.image("hitbox","images/hitbox.png"),t.load.image("hidden","images/hidden.png"),t.load.image("x","images/UnknownNuc.png"),t.load.image("title","images/title.png"),t.load.image("clean","images/clean.png"),t.load.image("quick","images/quick.png"),t.load.image("c","images/Cytosine.png"),t.load.image("panic-p","images/p.png"),t.load.image("panic-a","images/a.png"),t.load.image("panic-n","images/n.png"),t.load.image("panic-i","images/i.png"),t.load.image("panic-c","images/c.png"),t.load.image("epic","images/epic.png"),t.load.image("STOP","images/STOP.png"),t.load.image("a","images/Adenine.png"),t.load.image("g","images/Guanine.png"),t.load.image("u","images/Uracil.png"),t.load.audio("achievement-a","audio/Achievement.ogg"),t.load.audio("checkpoint-a","audio/Checkpoint.ogg"),t.load.audio("collection-a","audio/Collection.ogg"),t.load.audio("capture-a","audio/Capture.ogg"),t.load.audio("victory-a","audio/Victory.ogg"),t.load.audio("fanfare-a","audio/Fanfare.ogg"),t.load.audio("speech-a","audio/Speech.ogg"),t.load.audio("impact-a","audio/Impact.ogg"),t.load.audio("drop-a","audio/Drop.ogg"),t.load.audio("menu-a","audio/Menu.ogg"),t.load.audio("game-a","audio/Game.ogg")}}])}),define("factories/fireconf",["angular","firebase"],function(e,t){e.module("AminoApp.fireconf",[]).factory("fireconf",function(){return t.initializeApp({apiKey:"AIzaSyAs7q2YBQCw0TDW0P-DF5DgAXyyV4YqmOI",authDomain:"proteinpanic.firebaseapp.com",databaseURL:"https://proteinpanic.firebaseio.com",storageBucket:"project-1082984889749344373.appspot.com"}),t})}),define("controllers/addCtrl",["angular","angularRoute"],function(e,t){e.module("AminoApp.add",["ngRoute"]).config(["$routeProvider",function(e){e.when("/add",{templateUrl:"partials/add.html",controller:"addCtrl",controllerAs:"add"})}]).controller("addCtrl",["$firebaseArray","uid","fireconf",function(e,t,n){function h(e){if(e.length>60)return!1;var t=e.toUpperCase();for(var n=0;n<c.length;n++)if(t.indexOf(c[n])>=0)return!1;return t==e}var r=n.database().ref(),i=r.child("proteins"),s=r.child("aminos"),o=r.child("users"),u=e(i),a=e(s),f=e(o),l=t.getUid();this.addProtein=function(){var e=this.proteinName,t=this.aminoString,n={name:e,sequence:t};u.$add(n),this.proteinName="",this.aminoString=""},this.addAmino=function(){var e=this.aminoName,t=this.aminoCode,n=this.codonString.split(", "),r={name:e,codons:n,code:t};a.$add(r),this.aminoName="",this.aminoCode="",this.codonString=""},this.addEverything=function(){var e=[],t={name:"",sequence:""};console.log("clicky"),$.ajax({url:"../assets/parsed.txt"}).done(function(n){e=n.split("\n");for(var r=0;r<e.length;r++){var i=0;r%5e3===0&&(i=5e4),i>0&&(alert("Click this!"),i=0);var s=!1;t.name===""&&!h(e[r])?t.name=e[r]:h(e[r])?h(e[r])&&(t.sequence=t.sequence+e[r],r+1<e.length?h(e[r+1])||(s=!0):s=!0):e[r].length<t.name.length&&(t.name=e[r]),t.name!==""&&s&&(console.log("full protein:",t),t.name="",t.sequence="")}})};var c=["J","O","-","'",".","/","[","]","(",")"," ",",","0","1","2","3","4","5","6","7","8","9"]}])}),define("factories/menuSplash",["angular"],function(e){e.module("AminoApp.menuSplash",[]).factory("menuSplash",["$q","proteinPanic","preload",function(e,t,n){function H(){function u(){r.physics.startSystem(Phaser.Physics.ARCADE),r.world.setBounds(0,0,1200,1200),r.add.tileSprite(0,0,1200,1200,"cell-bg"),r.camera.x=(r.world.width-r.camera.width)/2,r.camera.y=(r.world.height-r.camera.height)/2,C=r.add.audio("menu-a",M,!0),C.play(),k=r.add.group(),k.name="aminoGroup",k.enableBody=!0;for(var e=0;e<15;e++){var n=r.world.randomX,u=r.world.randomY,f=r.rnd.pick(i),l=k.create(n,u,f);l.body.velocity.set(r.rnd.integerInRange(-200,200),r.rnd.integerInRange(-200,200)),l.rotation=r.rnd.realInRange(-0.2,.2),l.body.bounce.y=.6+Math.random()*.35,l.body.bounce.x=.6+Math.random()*.35,l.body.collideWorldBounds=!0,l.anchor.setTo(.5,.5)}N=r.add.group(),N.name="menuGroup",N.fixedToCamera=!0,N.create(0,18,"splash-ribo"),s=N.create(57,70,"splash-valine"),s.anchor.setTo(.5,.5);for(var p=0;p<=1;p+=.005){var v=r.math.catmullRomInterpolation(o.x,p),m=r.math.catmullRomInterpolation(o.y,p);a.push({x:v,y:m})}c=N.create(725,485,"splash-arginine"),c.anchor.setTo(.5,.5);for(var b=0;b<=1;b+=.002){var E=r.math.catmullRomInterpolation(h.x,b),S=r.math.catmullRomInterpolation(h.y,b);d.push({x:E,y:S})}g=N.create(270,121,"splash-trna"),g.anchor.setTo(.5,.5),g.tint=D,T=N.create(-35,-58,"splash-trna-eyes"),g.addChild(T);for(var L=0;L<=1;L+=.001){var O=r.math.catmullRomInterpolation(y.x,L),_=r.math.catmullRomInterpolation(y.y,L);w.push({x:O,y:_})}x=N.create(433,38,"title"),A=r.add.group(),N.addChild(A),A.create(728,38,"panic-p"),A.create(773,38,"panic-a"),A.create(835,38,"panic-n"),A.create(893,38,"panic-i"),A.create(917,38,"panic-c"),t.resolve()}var t=e.defer();return r.state.add("allMenus",{preload:n,create:u,update:B},!0),t.promise}function B(){_!==M&&(C.volume=M,_=M),r.physics.arcade.collide(k,k,j,null,this),k.forEachAlive(function(e){(Math.abs(e.body.velocity.x)<40||Math.abs(e.body.velocity.y)<40)&&e.body.velocity.set(r.rnd.integerInRange(-200,200),r.rnd.integerInRange(-200,200)),e.body.velocity.x>0?e.frame=1:e.body.velocity.x<0&&(e.frame=0)}),s.x=a[f].x,s.y=a[f].y,f++,f>=a.length&&(f=0),u||(u=!0,l=r.rnd.integerInRange(0,500)/1e3),s.rotation<l?s.rotation=Math.round((s.rotation+.001)*1e3)/1e3:s.rotation>l?s.rotation=Math.floor((s.rotation-.001)*1e3)/1e3:u=!1,c.x=d[v].x,c.y=d[v].y,v++,v>=d.length&&(v=0),p||(p=!0,m=r.rnd.integerInRange(-700,0)/1e3),c.rotation<m?c.rotation=Math.round((c.rotation+.001)*1e3)/1e3:c.rotation>m?c.rotation=Math.floor((c.rotation-.001)*1e3)/1e3:p=!1,D&&g.tint!=D&&(g.tint=D),g.x=w[E].x,g.y=w[E].y,E++,E>=w.length&&(E=0),b||(b=!0,S=r.rnd.integerInRange(-500,0)/1e3),g.rotation<S?g.rotation=Math.round((g.rotation+.001)*1e3)/1e3:g.rotation>S?g.rotation=Math.floor((g.rotation-.001)*1e3)/1e3:b=!1;if(O){if(!x.visible||!A.visible)x.visible=!0,A.visible=!0;A.forEachExists(function(e){var t={p:728,a:773,n:835,i:893,c:917,y:38};for(var n in t)e.key==="panic-"+n&&(e.x=r.rnd.realInRange(t[n]-2,t[n]+2)),e.y=r.rnd.realInRange(t.y-2,t.y+2),e.rotation=r.rnd.realInRange(-0.05,.05)})}else if(x.visible||A.visible)x.visible=!1,A.visible=!1}function j(e,t){e.rotation=r.rnd.realInRange(-0.2,.2),t.rotation=r.rnd.realInRange(-0.2,.2)}var r=t,i=["D","E","F","N","I","M","W","Q","H","T","R","C","Y","A","G","L","P","K","S","U","V"],s,o={x:[57,57,67,67,57],y:[70,80,80,70,70]},u=!1,a=[],f=0,l=0,c,h={x:[725,745,725,705,725],y:[485,505,525,505,485]},p=!1,d=[],v=0,m=0,g,y={x:[260,280,260,240,260],y:[121,101,131,101,121]},b=!1,w=[],E=0,S=0,x,T,N,C,k,L,A,O=!0,M=1,_=1,D=65280,P=!1;return{hasTitleSetter:function(e){O=e},trnaTintSetter:function(e){D=e},volumeSetter:function(e){M=e},musicStopper:function(){C.stop()},menusLoadedSetter:function(e){P=e},menusLoadedGetter:function(){return P},menuStarter:function(){return H()}}}])}),define("controllers/menuCtrl",["angular","angularRoute"],function(e,t){e.module("AminoApp.menu",["ngRoute"]).config(["$routeProvider",function(e){e.when("/menu",{templateUrl:"../partials/menu.html",controller:"menuCtrl",controllerAs:"menu"})}]).controller("menuCtrl",["$firebaseArray","uid","userCreator","proteinPanic","menuSplash","preload","fireconf",function(t,n,r,i,s,o,u){function b(){m=a.add.button(520,422,"start-game",E,this,0,1,2,0),y=a.add.button(520,489,"edit-options",S,this,0,1,2,0),g=a.add.button(520,557,"view-statistics",x,this,0,1,2,0)}function w(){m.destroy(),y.destroy(),g.destroy()}function E(){w(),s.musicStopper(),a.state.remove("allMenus"),window.location="#/game"}function S(){w(),window.location="#/user"}function x(){w(),window.location="#/stats"}var a=i,f=u.database().ref(),l=f.child("users"),c=t(l),h=null,p=65280,d,v=1;this.username="",u.auth().onAuthStateChanged(function(t){t===null?window.location="/":(n.setUid(t.uid),h=t.uid,c.$loaded().then(e.bind(this,function(e){var t=!0;for(var n in e)e[n].uid===h&&(t=!1,v=e[n].music,this.username=e[n].username,p="0x"+e[n].color.slice(1),s.volumeSetter(v));t&&c.$add(r(h)),this.username===""?window.location="#/user":s.menusLoadedGetter()===!1?(s.menusLoadedSetter(!0),s.hasTitleSetter(!0),s.trnaTintSetter(p),d=s.menuStarter(),d.then(function(){s.volumeSetter(v),b()})):(s.hasTitleSetter(!0),s.trnaTintSetter(p),s.volumeSetter(v),b())})))}.bind(this));var m,g,y}])}),define("controllers/userCtrl",["angular","angularRoute"],function(e,t){e.module("AminoApp.user",["ngRoute"]).config(["$routeProvider",function(e){e.when("/user",{templateUrl:"../partials/user.html",controller:"userCtrl",controllerAs:"user"})}]).controller("userCtrl",["$firebaseArray","$firebaseObject","uid","userCreator","proteinPanic","menuSplash","preload","fireconf",function(t,n,r,i,s,o,u,a){var f=s,l=a.database().ref(),c=l.child("users"),h=t(c),p=n(c),d=null,v=null,m;this.ribosomeMuted=!1,this.deleteToggle=!1,this.emailToggle=!1,this.passToggle=!1,this.emailAuth=!1,this.color="#00ff00",this.newPassword="",this.checkpoint=10,this.effects=1,this.username="",this.password="",this.newEmail="",this.radioVal="",this.intro=!0,this.mouse=!0,this.music=1,this.email="",a.auth().onAuthStateChanged(function(t){t===null?window.location="#/":(r.setUid(t.uid),d=t.uid,h.$loaded().then(e.bind(this,function(t){var n=!0;for(var r in t)t[r].uid===d&&(n=!1,this.username=t[r].username);if(n)h.$add(i(d)),window.location.reload();else for(var s in t)t[s].uid===d&&(this.ribosomeMuted=t[s].ribosomeMuted,this.checkpoint=t[s].checkpoint,this.username=t[s].username,this.effects=t[s].effects,this.mouse=t[s].mouse,this.music=t[s].music,this.color=t[s].color,this.intro=t[s].intro,v=t[s].$id,o.volumeSetter(this.music),o.trnaTintSetter("0x"+this.color.slice(1)),d.indexOf("github")===-1&&d.indexOf("facebook")===-1&&d.indexOf("twitter")===-1&&d.indexOf("google")===-1&&(this.emailAuth=!0));o.menusLoadedGetter()===!1?(o.menusLoadedSetter(!0),o.hasTitleSetter(!1),m=o.menuStarter(),m.then(e.bind(this,function(){o.volumeSetter(this.music),o.trnaTintSetter("0x"+this.color.slice(1))}))):(o.hasTitleSetter(!1),o.volumeSetter(this.music),o.trnaTintSetter("0x"+this.color.slice(1)))})))}.bind(this)),this.logOut=function(){a.auth().signOut(),f.state.remove("theGame")},this.checkAvail=function(e,t){var n=!1;for(var r=0;r<h.length;r++){if(this.username===""){alert("Usernames cannot be blank.");break}if(h[r].username===this.username&&h[r].uid===d){if(!e){alert(this.username+" is already your username...");break}n=!0;break}if(h[r].username===this.username){n=!1,alert("I'm sorry, the username "+this.username+" is taken.");break}n=!0}n&&e?this.saveUserData(t):n&&alert(this.username+" is available!")},this.colorChange=function(){o.trnaTintSetter("0x"+this.color.slice(1))},this.volumeChange=function(){o.volumeSetter(this.music)},this.saveUserData=function(e){p[v].checkpoint=parseInt(this.checkpoint),p[v].ribosomeMuted=this.ribosomeMuted,p[v].effects=parseFloat(this.effects),p[v].music=parseFloat(this.music),p[v].username=this.username,p[v].mouse=this.mouse,p[v].color=this.color,p[v].intro=this.intro,p.$save().then(function(t){e==="game"&&(o.musicStopper(),f.state.remove("allMenus")),window.location="#/"+e})},this.changeEmail=function(){l.changeEmail({oldEmail:this.email,newEmail:this.newEmail,password:this.password},function(e){e===null?alert("Email changed successfully!"):alert("Error changing email:",e)})},this.changePassword=function(){l.changePassword({email:this.email,oldPassword:this.password,newPassword:this.newPassword},function(e){e===null?alert("Password changed successfully!"):alert("Error changing password:",e)})},this.removeUser=function(){l.removeUser({email:this.email,password:this.password},function(e){e===null?alert("Account deleted successfully! Sorry to see you go."):alert("Error deleting account:",e)})},this.radioChange=function(){this.radioVal==="email"?(this.emailToggle=!0,this.passToggle=!1,this.deleteToggle=!1):this.radioVal==="pass"?(this.emailToggle=!1,this.passToggle=!0,this.deleteToggle=!1):this.radioVal==="delete"&&(this.emailToggle=!1,this.passToggle=!1,this.deleteToggle=!0)}}])}),define("controllers/gameCtrl",["angular","angularRoute"],function(e,t){e.module("AminoApp.game",["ngRoute"]).config(["$routeProvider",function(e){e.when("/game",{templateUrl:"../partials/game.html",controller:"gameCtrl",controllerAs:"game"})}]).controller("gameCtrl",["$q","$scope","$firebaseArray","$firebaseObject","uid","userCreator","proteinPanic","preload","menuSplash","fireconf",function(e,t,n,r,i,s,o,u,a,f){function Zn(){function e(){for(var e=0;e<b.length;e++)if(b[e].name===Zt){An=b[e].sequence.split(""),En=An.length;for(var t=0;t<An.length;t++){if(An[t]==="B"){var n=h.rnd.integerInRange(0,1);n>0?An[t]="N":An[t]="D"}if(An[t]==="Z"){var r=h.rnd.integerInRange(0,1);r>0?An[t]="Q":An[t]="E"}}An.push("STOP")}for(var i=0;i<An.length;i++)for(var s=0;s<aminosArr.length;s++)if(aminosArr[s].code===An[i]){var o=h.rnd.pick(aminosArr[s].codons);for(var u=0;u<o.length;u++)vn.push(o[u].toLowerCase())}if(E)E=!1,er();else{wt.forEachAlive(function(e){e.kill()}),Et.removeAll(!0,!1);var a=On.getFirstAlive();a.kill();for(var f=0;f<15;f++)Ar(!0);g[x].remainingProteinLength=En,Tn=45,gt=!0,Sr(),Er(0),wr(),cr()}}vn=[],aminosArr.length!==0&&b.length!==0?e():aminosArr.$loaded().then(function(t){b.$loaded().then(function(t){e()})})}function er(){Yn[0]="Welcome to\n\n\nThe collection game where you can build all the proteins in the human body!\n\nHi "+T+"! My name's Riley, and I'm a ribosome. I'll be your guide throughout the game, but first, let's learn how to play.",h.state.add("theGame",{preload:u,create:tr,update:nr},!0),h.state.remove("allMenus")}function tr(){h.physics.startSystem(Phaser.Physics.ARCADE),h.add.tileSprite(0,0,1200,1200,"cell-bg"),h.world.setBounds(0,0,1200,1200),M=h.add.graphics(0,0),M.beginFill(0),M.drawPolygon(Gn),M.fixedToCamera=!0,Wt=h.add.audio("victory-a",xn,!0),ot=h.add.audio("game-a",xn,!0),ot.play(),Xt=h.add.audio("achievement-a",_n),Bt=h.add.audio("checkpoint-a",_n),jt=h.add.audio("collection-a",_n),it=h.add.audio("fanfare-a",_n),rt=h.add.audio("capture-a",_n),z=h.add.audio("impact-a",_n),_=h.add.audio("drop-a",_n),yt=h.add.audio("speech-a"),yt.allowMultple=!0,yt.addMarker("1",.1,.15,_n),yt.addMarker("2",.3,.18,_n),yt.addMarker("3",.5,.32,_n),yt.addMarker("4",.9,.29,_n),yt.addMarker("5",1.2,.25,_n),yt.addMarker("6",1.5,.3,_n),yt.addMarker("7",1.8,.29,_n),yt.addMarker("8",2.1,.25,_n),yt.addMarker("9",2.4,.17,_n),yt.addMarker("10",2.6,.15,_n),yt.addMarker("11",2.8,.18,_n),yt.addMarker("12",3,.18,_n),yt.addMarker("13",3.2,.18,_n),yt.addMarker("14",3.4,.2,_n),yt.addMarker("15",3.6,.27,_n),yt.addMarker("16",3.9,.13,_n),yt.addMarker("17",4.1,.15,_n),yt.addMarker("18",4.3,.22,_n),yt.addMarker("19",4.6,.18,_n),yt.addMarker("20",4.8,.19,_n),yt.addMarker("21",5,.2,_n),yt.addMarker("22",5.2,.23,_n),yt.addMarker("23",5.5,.37,_n),yt.addMarker("24",5.9,.25,_n),yt.addMarker("25",6.2,.3,_n),Jt=h.add.group(),Jt.name="proteinGroup",D=h.add.sprite(100,1100,"player"),h.physics.arcade.enable(D),D.body.collideWorldBounds=!0,A=h.add.sprite(0,0,"eyes"),D.anchor.setTo(.5,.5),A.anchor.setTo(.5,.5),h.camera.follow(D),D.tint=qt,D.addChild(A),D.mask=M,wt=h.add.group(),wt.name="aminoGroup",wt.enableBody=!0;for(var e=0;e<15;e++){var t="";if(e<5&&An[e]!=="STOP")t=An[e];else while(t===""||t==="STOP")t=h.rnd.pick(An);var n=0,r=1200;while(n<200&&r>1e3)n=h.world.randomX,r=h.world.randomY;var i=wt.create(n,r,t);i.body.velocity.set(h.rnd.integerInRange(-200,200),h.rnd.integerInRange(-200,200)),i.rotation=h.rnd.realInRange(-0.2,.2),i.body.bounce.y=.6+Math.random()*.35,i.body.bounce.x=.6+Math.random()*.35,i.body.collideWorldBounds=!0,i.anchor.setTo(.5,.5)}ut=h.add.sprite(20,1034,"ribo-under"),Et=h.add.group(),Et.name="codonGroup",wr(),$=h.add.sprite(20,1034,"ribosome"),h.physics.arcade.enable($),$.body.immovable=!0,$.inputEnabled=!0,riboeyes=h.add.sprite(65,22,"riboeyes"),$.addChild(riboeyes),P=h.add.sprite(20,1124,"hitbox"),h.physics.arcade.enable(P),P.body.immovable=!0,It=h.add.sprite(175,440,"speech-bubble"),It.fixedToCamera=!0,On=h.add.group(),On.name="aminoToCollectGroup",It.addChild(On);var s=On.create(340,4,An[0]);s.y+=(60-s.height)/2,s.x+=(60-s.width)/2,Sn=h.add.group(),Sn.name="collectCodonGroup",It.addChild(Sn);var o=Sn.create(50,24,vn[0]),u=Sn.create(65,24,vn[1]),a=Sn.create(80,24,vn[2]);Cn=h.add.text(0,0,"is a codon for",{font:"bold 16pt Arial",boundsAlignH:"center"}),Cn.setTextBounds(110,2,225,40),It.addChild(Cn),dn=h.add.text(0,0,br(An[0]),{fill:"navy",boundsAlignH:"center"}),dn.setTextBounds(110,25,225,40),It.addChild(dn),It.visible=!1,Ft=h.add.sprite(170,80,"large-bubble"),Ft.fixedToCamera=!0,yn=h.add.text(0,0,Yn[0],{align:"center",wordWrap:!0,wordWrapWidth:575}),yn.setTextBounds(65,25,575,400),Ft.addChild(yn),Ln=h.add.text(0,0,Zt,{font:"bold 26pt Arial",boundsAlignH:"center",boundsAlignV:"middle",wordWrapWidth:575,align:"center",wordWrap:!0,fill:"navy"}),Ln.setTextBounds(65,130,575,125),Ft.addChild(Ln),Tt=h.add.group(),Ft.addChild(Tt),Tt.create(80,20,"title"),Nt=h.add.group(),Tt.addChild(Nt),Nt.create(375,20,"panic-p"),Nt.create(420,20,"panic-a"),Nt.create(482,20,"panic-n"),Nt.create(540,20,"panic-i"),Nt.create(564,20,"panic-c"),an=h.add.sprite(73,280,"progress-holder"),Ft.addChild(an),zt=h.add.sprite(78,285,"progress-bar"),Ft.addChild(zt),J=h.add.button(135,365,"start-btn",fr,this,0,1,2,0),Ft.addChild(J),bt=h.add.button(365,365,"options-btn",hr,this,0,1,2,0),Ft.addChild(bt),Ut=h.add.button(135,365,"continue-btn",pr,this,0,1,2,0),Ft.addChild(Ut),en=h.add.sprite(h.camera.width/2,10,"victory-bubble"),en.anchor.setTo(.5,0),en.fixedToCamera=!0,Vt=h.add.group(),K=Vt.create(-409,94,"victory-v"),Q=Vt.create(-286,75,"victory-i"),G=Vt.create(-227,45,"victory-c"),Y=Vt.create(-115,30,"victory-t"),Z=Vt.create(0,30,"victory-o"),et=Vt.create(131,48,"victory-r"),tt=Vt.create(257,78,"victory-y"),nt=Vt.create(328,133,"victory-x"),bn=[[K,Ct,zn],[Q,kt,Wn],[G,Lt,Xn],[Y,At,Vn],[Z,Ot,$n],[et,Mt,Jn],[tt,_t,Kn],[nt,Dt,Qn]];for(var f=0;f<bn.length;f++)for(var l=0;l<=1;l+=.02){var c=h.math.catmullRomInterpolation(bn[f][2],l);bn[f][1].push(c)}en.addChild(Vt),Rt=h.add.text(0,20,"",{align:"center",boundsAlignH:"center",wordWrap:!0,wordWrapWidth:575}),Rt.anchor.setTo(.5,0),en.addChild(Rt),un=h.add.text(0,250,"",{font:"bold 20pt Arial",fill:"green",align:"center",boundsAlignH:"center",wordWrap:!0,wordWrapWidth:575}),un.anchor.setTo(.5,.5),en.addChild(un),mn=h.add.text(-100,65,""),mn.lineSpacing=20,en.addChild(mn),mn.visible=!1,xt=h.add.button(-110,355,"protein-btn",mr,this,0,1,2,0),xt.anchor.setTo(.5,0),en.addChild(xt),U=h.add.button(110,355,"menu-btn",gr,this,0,1,2,0),U.anchor.setTo(.5,0),en.addChild(U),ct=h.add.sprite(-135,58,"epic"),ct.anchor.setTo(.5,0,5),ct.scale.set(.5),en.addChild(ct),ct.visible=!1,Pt=h.add.sprite(-135,115,"hidden"),Pt.anchor.setTo(.5,0,5),Pt.scale.set(.5),en.addChild(Pt),Pt.visible=!1,ht=h.add.sprite(-135,172,"longhome"),ht.anchor.setTo(.5,0,5),ht.scale.set(.5),en.addChild(ht),ht.visible=!1,dt=h.add.sprite(-135,229,"quick"),dt.anchor.setTo(.5,0,5),dt.scale.set(.5),en.addChild(dt),dt.visible=!1,pt=h.add.sprite(-135,286,"clean"),pt.anchor.setTo(.5,0,5),pt.scale.set(.5),en.addChild(pt),pt.visible=!1,sn=h.add.button(-200,285,"prev-btn",dr,this,0,1,2,0),sn.anchor.setTo(.5,0),en.addChild(sn),sn.visible=!1,on=h.add.button(200,285,"next-btn",vr,this,0,1,2,0),on.anchor.setTo(.5,0),en.addChild(on),en.visible=!1,St=h.add.sprite(h.camera.width/2,40,"checkpoint"),St.anchor.setTo(.5,.5),St.fixedToCamera=!0,St.visible=!1,gn=h.add.text(0,5,""),gn.anchor.setTo(.5,.5),St.addChild(gn),fn=h.add.sprite(-228,-25,"checkmark"),St.addChild(fn),fn.visible=!1,vt=h.add.sprite(-270,-31,"hidden"),St.addChild(vt),vt.visible=!1,X=h.add.sprite(-270,-31,"longhome"),St.addChild(X),X.visible=!1,ft=h.add.sprite(-270,-31,"quick"),St.addChild(ft),ft.visible=!1,lt=h.add.sprite(-270,-31,"clean"),St.addChild(lt),lt.visible=!1,W=h.add.sprite(-270,-31,"epic"),St.addChild(W),W.visible=!1;if(Gt){Ft.visible=!0,B=h.add.button(50,355,"prev-btn",or,this,0,1,2,0),j=h.add.button(610,355,"next-btn",ur,this,0,1,2,0),pn=h.add.group(),I=pn.create(170,360,"a"),V=pn.create(295,360,"c"),q=pn.create(415,360,"g"),H=pn.create(520,360,"u"),R=pn.create(495,305,"A"),pn.visible=!1,R.visible=!1,O=h.add.sprite(355,368,"player"),O.anchor.setTo(.5,.5);var p=h.add.sprite(0,0,"eyes");p.anchor.setTo(.5,.5),O.addChild(p),O.tint=qt,O.scale.x=-1,O.visible=!1,Ft.addChild(B),Ft.addChild(j),Ft.addChild(O),Ft.addChild(pn),B.visible=!1,J.visible=!1,bt.visible=!1,Ut.visible=!1,zt.visible=!1,an.visible=!1,Ln.visible=!1,Tt.y+=50,setTimeout(function(){hn=h.rnd.integerInRange(5,10)},500)}else kn?lr():(gt=!0,cr())}function nr(){h.physics.arcade.collide(wt,wt,kr,null,this),h.physics.arcade.overlap(D,P,xr,null,this),l||h.physics.arcade.collide(D,wt,Cr,null,this),h.physics.arcade.collide($,wt,_r,null,this),$.input.pointerDown()&&cr(),An.length-1>Fn&&(wt.getFirstAlive().kill(),Tr(),Ar(!0)),h.camera.x>=0&&h.camera.x<=175&&h.camera.y>=490?It.cameraOffset.x<175-h.camera.x-30?(It.cameraOffset.x+=30,On.getFirstAlive().frame=0):It.cameraOffset.x=175-h.camera.x:It.cameraOffset.x>=-305&&(It.cameraOffset.x-=30,On.getFirstAlive().frame=1);if(h.camera.y!==0){var e=440+(624-h.camera.y);e<505&&(It.cameraOffset.y=e)}Nt.forEachExists(function(e){var t={p:375,a:420,n:482,i:540,c:564,y:20};for(var n in t)e.key==="panic-"+n&&(e.x=h.rnd.realInRange(t[n]-2,t[n]+2)),e.y=h.rnd.realInRange(t.y-2,t.y+2),e.rotation=h.rnd.realInRange(-0.05,.05)});var t=h.rnd.integerInRange(0,300);t===10&&riboeyes.frame===0&&(riboeyes.frame=1),riboeyes.frame===1&&(wn<5?wn++:(wn=0,riboeyes.frame=0));if(hn>0&&$.frame===0)if(qn<h.rnd.integerInRange(3,10))qn++;else{qn=0,$.frame=1;if(!tn){var n=h.rnd.integerInRange(1,25);yt.play(n)}}$.frame===1&&(Hn<h.rnd.integerInRange(5,20)?Hn++:(hn--,Hn=0,$.frame=0)),O&&O.visible&&(rn?O.rotation<.2?O.rotation=Math.round((O.rotation+.01)*100)/100:rn=!1:O.rotation>-0.2?O.rotation=Math.floor((O.rotation-.01)*100)/100:rn=!0),St.visible&&(Pn>10?Pn--:Pn>0?(St.alpha-=.1,Pn--):(fn.visible=!1,vt.visible=!1,ft.visible=!1,lt.visible=!1,X.visible=!1,W.visible=!1,St.visible=!1,Pn=60,St.alpha=1));if(en.visible&&Vt.visible){for(var r=0;r<bn.length;r++)bn[r][0].y=bn[r][1][ln];ln++,ln>=Ct.length&&(ln=0)}D.frame=0,A.frame=0;if(Mn)D.rotation+=.5;else if(!jn){if(nn)h.physics.arcade.moveToPointer(D,60,h.input.activePointer,400);else{D.body.velocity.x=0,D.body.velocity.y=0;if(F.left.isDown||C.isDown)D.body.velocity.x=-300,D.frame=1,A.frame=1;else if(F.right.isDown||L.isDown)D.body.velocity.x=300,D.frame=1,A.frame=1;if(F.up.isDown||N.isDown)D.body.velocity.y=-300;else if(F.down.isDown||k.isDown)D.body.velocity.y=300}Math.abs(D.body.velocity.x)>150&&(D.frame=1,A.frame=1),D.body.velocity.y<-150?(D.frame=2,A.frame=2):D.body.velocity.y>150&&(D.frame=3,A.frame=3),D.body.velocity.x>0?(D.scale.x=-1,D.children[1]&&(D.children[1].frame=1,D.children[1].scale.x=-1)):D.body.velocity.x<0&&(D.scale.x=1,D.children[1]&&(D.children[1].frame=0,D.children[1].scale.x=1))}wt.forEachAlive(function(e){(Math.abs(e.body.velocity.x)<40||Math.abs(e.body.velocity.y)<40)&&e.body.velocity.set(h.rnd.integerInRange(-200,200),h.rnd.integerInRange(-200,200)),e.body.velocity.x>0&&e.frame===0?e.frame=1:e.body.velocity.x<0&&e.frame===1&&(e.frame=0)}),Et.forEachAlive(function(e){e.x<-15&&e.destroy()}),Tn<45&&(Et.addAll("x",-1,!0),Tn++),Jt.forEachAlive(function(e){e.scale.y<.08&&e.kill()})}function rr(){Un=!0,ot.stop(),Wt.stop(),h.input.keyboard.clearCaptures()}function ir(){h.debug.body(P),h.debug.cameraInfo(h.camera,32,32),h.debug.spriteCoords(D,32,500)}function sr(e){try{var t=window[e],n="__storage_test__";return t.setItem(n,n),t.removeItem(n),!0}catch(r){return!1}}function or(){st>0&&st--,st<Yn.length-1&&(j.visible=!0,J.visible=!1,bt.visible=!1),st===0&&(B.visible=!1,Tt.visible=!0),st===2?O.visible=!0:O.visible=!1,st===3||st===4?(pn.visible=!0,ar()):pn.visible=!1,yn.text=Yn[st]}function ur(){st++,st===Yn.length-1&&(j.visible=!1,J.visible=!0,bt.visible=!0),st>0&&(B.visible=!0,Tt.visible=!1),st===2?O.visible=!0:O.visible=!1,st===3||st===4?(pn.visible=!0,ar()):pn.visible=!1,yn.text=Yn[st],hn=h.rnd.integerInRange(5,10)}function ar(){st===3&&(I.x=170,I.y=360,V.x=295,V.y=360,q.x=415,q.y=360,H.visible=!0,R.visible=!1),st===4&&(I.x=180,I.y=325,V.x=165,V.y=325,q.x=150,q.y=325,H.visible=!1,R.visible=!0)}function fr(){kn?Qt.selectedProtein===null?alert("Please select a protein to build."):(t.proteinMenu=!1,t.$apply(),Zt=Qt.selectedProtein,g[x].proteinInProgress=Zt,Fn=275e10,Zn()):(Gt=!1,g[x].intro=!1,g[x].proteinInProgress="Insulin",g[x].remainingProteinLength=An.length,g.$save(),B.destroy(),j.destroy(),pn.forEachExists(function(e){e.destroy()}),pn.destroy(),Tt.y-=50,Tt.visible=!0,J.visible=!1,bt.visible=!0,Ut.visible=!0,kn=!0,lr())}function lr(){h.input.keyboard.clearCaptures(),t.proteinMenu=!0,t.$apply(),J.visible=!0,Ft.visible=!0,Ut.visible=!1,It.visible=!1,zt.visible=!1,an.visible=!1,yn.visible=!1,Ln.visible=!1}function cr(){l=!0,jn=!0,J.visible=!1,Ut.visible=!0,Ft.visible=!0,zt.visible=!0,It.visible=!1,an.visible=!0,yn.visible=!0,Ln.visible=!0,Ln.text=Zt,hn=h.rnd.integerInRange(3,5);if(Fn>=An.length-1||!Fn)Fn=An.length-1,g[x].remainingProteinLength=Fn,g.$save();gt&&(Dn=Math.floor((En-Fn)/Rn)),zt.scale.x=(En-Fn)/En,yn.boundsAlignH="center",yn.text="\n\nCurrently building:\n\n\n\nCheckpoint "+Dn+" of "+Math.floor(En/Rn)+"\n\n"+(En-Fn)+" of "+En+" amino acids collected!"}function hr(){g[x].intro=!1,g.$save(),rr(),window.location="#/user"}function pr(){!nn&&!F&&yr(),l=!1,gt&&(Tn-=45,gt=!1,Ar(!0)),Ft.visible=!1,It.visible=!0,Un&&(Un=!1,yr()),jn=!1,hn=h.rnd.integerInRange(3,5)}function dr(){mn.visible=!1,sn.visible=!1,un.visible=!0,on.visible=!0,Pt.visible=!1,pt.visible=!1,dt.visible=!1,ct.visible=!1,ht.visible=!1,Vt.visible=!0,Rt.text="\n\n\n\nYou built\n\n\n\nfrom "+En+" amino acids!"}function vr(){mn.visible=!0,on.visible=!1,un.visible=!1,sn.visible=!0,Pt.visible=!0,pt.visible=!0,dt.visible=!0,ct.visible=!0,ht.visible=!0,Vt.visible=!1,Rt.text="This Protein's Achievements"}function mr(){Wt.stop(),window.location.reload()}function gr(){rr(),window.location="#/menu"}function yr(){N=h.input.keyboard.addKey(Phaser.Keyboard.W),C=h.input.keyboard.addKey(Phaser.Keyboard.A),k=h.input.keyboard.addKey(Phaser.Keyboard.S),L=h.input.keyboard.addKey(Phaser.Keyboard.D),F=h.input.keyboard.createCursorKeys()}function br(e){for(var t=0;t<aminosArr.length;t++)if(aminosArr[t].code==e)return aminosArr[t].name}function wr(){for(var e=0;e<vn.length;e++)var t=Et.create(134+15*e,1144,vn[e])}function Er(e){for(var t=0;t<3;t++)var n=Mr(Sn,vn[e+t],50+15*t,24)}function Sr(){var e=Mr(On,An[0],340,4);dn.text=br(An[0]),e.then(function(e){e.y+=(60-e.height)/2,e.x+=(60-e.width)/2})}function xr(){Ht=h.time.now,Kt!==undefined&&Bn===!0&&(c&&(console.log("Entering Ribosome --------------------------------------------------------"),wt.forEachAlive(function(e){console.log("liveAmino = ",e.key)})),$t=Ht-mt,hn=h.rnd.integerInRange(3,5),jt.play(),Tr(!0),Kt.destroy(),Bn=!1,Yt=0)}function Tr(e){Tn-=45,Sn.forEachAlive(function(e){e.kill()}),cn++;var t=cn*3;c&&console.log("Building Codon -----------------------------------------------------------"),Er(t),c&&console.log("Building Protein ---------------------------------------------------------");var n=Mr(Jt,An[0],60,1024);n.then(function(e){e.scale.set(1),Jt.addAll("y",-5,!0),Jt.addAll("scale.x",-0.025,!0),Jt.addAll("scale.y",-0.025,!0)}),An.splice(0,1),e&&(Nr(),An.length===1&&(ot.stop(),it.play(),setTimeout(function(){Wt.play()},4e3),l=!0,jn=!0,en.visible=!0,un.text=Zt,Rt.text="\n\n\n\nYou built\n\n\n\nfrom "+En+" amino acids!",Nn.totalHiddenAminoAcids=Nn.totalHiddenAminoAcids+Nn.hiddenAminoAcids,Nn.totalCleanCollections=Nn.totalCleanCollections+Nn.cleanCollections,Nn.totalQuickCollections=Nn.totalQuickCollections+Nn.quickCollections,Nn.totalEpicCollections=Nn.totalEpicCollections+Nn.epicCollections,Nn.totalLongWayHomes=Nn.totalLongWayHomes+Nn.longWayHomes,mn.text=Nn.epicCollections+" - Epic Collections\n"+Nn.hiddenAminoAcids+" - Hidden Amino Acids\n"+Nn.longWayHomes+" - Long Way Homes\n"+Nn.quickCollections+" - Quick Collections\n"+Nn.cleanCollections+" - Clean Collections",Nn.hiddenAminoAcids=0,Nn.cleanCollections=0,Nn.quickCollections=0,Nn.epicCollections=0,Nn.longWayHomes=0,g[x].completedProteins=In+(Zt+","),g[x].achievements=Nn,g[x].remainingProteinLength=0,g.$save()),Fn=An.length-1,(En-Fn)%Rn===0&&(Dn++,gn.text="Checkpoint "+Dn+" of "+Math.floor(En/Rn)+"!",Bt.play(),fn.visible=!0,St.visible=!0,g[x].remainingProteinLength=Fn,g[x].achievements=Nn,g.$save()));var r=On.getFirstAlive();r.kill(),c&&console.log("Building Collection Icon -------------------------------------------------"),Sr()}function Nr(){Yt===0&&(Xt.play(),at+$t>14e3?(Nn.epicCollections++,gn.text="Epic Collection!",W.visible=!0,St.visible=!0):at>7e3?(Nn.hiddenAminoAcids++,gn.text="Hidden Amino!",vt.visible=!0,St.visible=!0):$t>7e3?(Nn.longWayHomes++,gn.text="Long Way Home!",X.visible=!0,St.visible=!0):at+$t<3e3?(Nn.quickCollections++,gn.text="Quick Collection!",ft.visible=!0,St.visible=!0):(Nn.cleanCollections++,gn.text="Clean Collection!",lt.visible=!0,St.visible=!0))}function Cr(e,t){An[0]===t.key&&Bn===!1?(mt=h.time.now,at=mt-Ht,Lr(e,t)):(Yt++,Or(e,t))}function kr(e,t){e.rotation=h.rnd.realInRange(-0.2,.2),t.rotation=h.rnd.realInRange(-0.2,.2)}function Lr(e,t){!Mn&&!Bn&&(c&&console.log("Good Amino Contact -------------------------------------------------------"),Bn=!0,t.kill(),rt.play(),Kt=h.add.sprite(0,-62,t.key),Kt.anchor.setTo(.5,.5),e.addChild(Kt),Ar(!1))}function Ar(e){var t=0,n="",r=!1;e?n=An[0]:n=An[1],wt.forEachAlive(function(e){c&&console.log("liveAmino = ",e.key),t++,e.key===n&&(r=!0,c&&console.log("The needed amino, "+An[1]+" is alive and onstage"))}),c&&console.log("there are "+t+" aminos live on stage");if((t<15||!r)&&An[1]!=="STOP"){var i="";if(r)while(i===""||i==="STOP")i=h.rnd.pick(An),c&&console.log("So we queued a "+i+" up");else i=n,c&&console.log("The needed amino was not here so we queued it, "+i+", up");var s=h.world.randomX,o=h.world.randomY;while(s>D.x-500&&s<D.x+500&&o>D.y-500&&o<D.y+500)s=h.world.randomX,o=h.world.randomY;var u=Mr(wt,i,s,o);u.then(function(e){c&&console.log(e.key+" placed on stage"),e.body.velocity.set(h.rnd.integerInRange(-200,200),h.rnd.integerInRange(-200,200)),e.rotation=h.rnd.realInRange(-0.2,.2),e.body.bounce.y=.6+Math.random()*.35,e.body.bounce.x=.6+Math.random()*.35,e.body.collideWorldBounds=!0,e.anchor.setTo(.5,.5)})}}function Or(e,t){c&&(console.log("Bad Amino Contact ----------------------------------------------------------"),wt.forEachAlive(function(e){console.log("liveAmino = ",e.key)})),Mn=!0,t.rotation=h.rnd.realInRange(-0.2,.2),e.body.velocity.x=0,e.body.velocity.y=0,setTimeout(function(){Mn=!1,e.rotation=0},1e3);if(Bn){_.play(),Bn=!1;var n=Mr(wt,Kt.key,e.body.x,e.body.y-60);n.then(function(e){c&&console.log(e.key+" placed on stage"),e.body.velocity.set(h.rnd.integerInRange(-200,200),-300),e.rotation=h.rnd.realInRange(-0.2,.2),e.body.bounce.y=.6+Math.random()*.35,e.body.bounce.x=.6+Math.random()*.35,e.body.collideWorldBounds=!0,e.anchor.setTo(.5,.5)}),Kt.destroy()}else z.play()}function Mr(t,n,r,i){var s=e.defer(),o=!1;t.forEachDead(function(e){e.key===n&&e.alive===!1&&!o&&(e.reset(r,i),o=!0,c&&console.log("revived "+e.key+" at "+r+"x"+i+" in "+t.name),s.resolve(e))});if(!o){var u=t.create(r,i,n);c&&console.log("spawned "+u.key+" at "+r+"x"+i+" in "+t.name),s.resolve(u)}return s.promise}function _r(){}var l=!1,c=!1,h=o,p=f.database().ref(),d=p.child("proteins"),v=p.child("aminos"),m=p.child("users"),g=r(m),y=n(m),b,w,E=!0,S=null,x=null,T="";sr("localStorage")?(c&&console.log("Local storage is available"),localStorage.getItem("proteins")&&localStorage.getItem("aminos")?(c&&console.log("Local storage has our data, use it"),b=JSON.parse(localStorage.proteins),aminosArr=JSON.parse(localStorage.aminos)):(c&&console.log("Local storage does not have our data, wipe & fill it"),localStorage.clear(),b=n(d),aminosArr=n(v),aminosArr.$loaded().then(function(e){b.$loaded().then(function(e){localStorage.proteins=JSON.stringify(b),localStorage.aminos=JSON.stringify(aminosArr)})}))):(c&&console.log("Local storage isn't available, boo"),b=n(d),aminosArr=n(v)),this.arrayOfProteins=b,this.arrayOfUsers=y,this.selectedProtein=null,this.proteinSearch="",t.proteinMenu=!1,f.auth().onAuthStateChanged(function(e){e===null?window.location="/":(a.menusLoadedSetter(!1),i.setUid(e.uid),S=e.uid,y.$loaded().then(function(e){var t=!0;for(var n in e)e[n].uid===S&&(t=!1,nn=e[n].mouse,Gt=e[n].intro,x=e[n].$id,T=e[n].username,xn=e[n].music,_n=e[n].effects,tn=e[n].ribosomeMuted,Rn=e[n].checkpoint,qt="0x"+e[n].color.slice(1),e[n].completedProteins&&(In=e[n].completedProteins),Nn=e[n].achievements,Gt?Zt="Insulin":e[n].proteinInProgress?(Zt=e[n].proteinInProgress,Fn=e[n].remainingProteinLength,Fn===0&&(Zt="Insulin",Fn=110,kn=!0),c&&console.log("Found a protein in progress: "+e[n].proteinInProgress)):(Zt="Insulin",Fn=110,kn=!0,c&&console.log("Didn't find a protein in progress")));t&&y.$add(s(S)),T===""?window.location="#/user":Zn()}))}.bind(this));var N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,et,tt,nt,rt,it,st=0,ot,ut,at,ft,lt,ct,ht,pt,dt,vt,mt,gt,yt,bt,wt,Et,St,xt,Tt,Nt,Ct=[],kt=[],Lt=[],At=[],Ot=[],Mt=[],_t=[],Dt=[],Pt,Ht,Bt,jt,Ft,It,qt,Rt,Ut,zt,Wt,Xt,Vt,$t,Jt,Kt,Qt=this,Gt=!0,Yt=0,Zt,en,tn,nn=!1,rn=!0,sn,on,un,an,fn,ln=0,cn=0,hn=0,pn,dn,vn=[],mn,gn,yn,bn,wn=0,En,Sn,xn=1,Tn=45,Nn={},Cn,kn,Ln,An=[],On,Mn=!1,_n=1,Dn=0,Pn=120,Hn=0,Bn=!1,jn=!0,Fn,In="",qn=0,Rn=10,Un=!1,zn=[94,74,94,94,94,94,94,94,94,94],Wn=[75,75,55,75,75,75,75,75,75,75],Xn=[45,45,45,25,45,45,45,45,45,45],Vn=[30,30,30,30,10,30,30,30,30,30],$n=[30,30,30,30,30,10,30,30,30,30],Jn=[48,48,48,48,48,48,28,48,48,48],Kn=[78,78,78,78,78,78,78,58,78,78],Qn=[133,133,133,133,133,133,133,133,113,133],Gn=[0,0,0,481,146,481,146,576,1024,576,1024,0,0,0],Yn=["","Those little colorful beings bouncing around in the background are amino acids, the building blocks of proteins.\n\nAs a ribosome, my job is to assemble those amino acids in a specific order to build a protein, but there's more to it than that, and that's where you come in.","You see, as a ribosome, I'm fixed in place in the wall of the rough endoplasmic reticulum that surrounds the nucleus of the cell.  I can't run off and grab the amino acids we need to build the protein.\n\nGrabbing the right amino acid is up to you, the transport RNA!","The long colorful chain at the bottom of the screen is a strand of messenger RNA, and it gives us our instructions for building the protein.\n\nHow does it do that? Well, the colored bars sticking up from the RNA's green backbone are called nucleotides, and they come in one of four types:\n\nAdenine  Cytosine  Guanine  Uracil","Every amino acid can be represented by three nucleotides in a specific order. This group of three nucleotides is called a codon, and every amino acid has at least one codon, though some have more.\n\nFor example:\n\nis a codon for Alanine","I'll read the DNA one codon at a time and tell you which amino acid to catch. Once you've caught the amino acid, bring it back to me and I'll add it to the protein we're building.\n\nBe careful not to run into any of the other amino acids floating about, as they'll make you spin out and drop any amino acid you're carrying!","Proteins can be very long, some contain thousands of amino acids! We'll start with a shorter one, but there will also be checkpoints along the way.\n\nOnce you've reached a checkpoint, you can restart from there later. You can change how often checkpoints happen in your user options.","You control your flight around the inside of the cell with either the W A S D keys or arrow keys, or with your mouse/touch.\n\nYou can switch your control type on your user option screen as well.\n\nAt any time during the game you can click/tap on me to autosave, pause and check your progress.","After completing a protein, or starting a new game you can choose your next protein to make.\n\nYou can only have one protein in progress at a time though, so starting a new protein will erase any progess you've made on an incomplete protein.",'That\'s the end of the introduction, you\'re now ready to start building your first protein!\n\nIf you\'d like to see this intro again, you can check off "Play Introduction" in your user options.\n\nClick "Start" to start the game, or you can click "Options" to edit your user options.'];Qt.hideCompleted=function(e){return In.indexOf(e)>-1?!1:!0}}])}),define("controllers/loginCtrl",["angular","angularRoute"],function(e,t){e.module("AminoApp.login",["ngRoute"]).config(["$routeProvider",function(e){e.when("/",{templateUrl:"../partials/login.html",controller:"loginCtrl",controllerAs:"login"})}]).controller("loginCtrl",["$scope","$firebaseArray","uid","userCreator","proteinPanic","menuSplash","fireconf",function(t,n,r,i,s,o,u){function b(){menuGroup=a.add.group(),menuGroup.name="menuGroup",menuGroup.fixedToCamera=!0,y=menuGroup.create(697,119,"orline"),d=a.add.button(827,430,"github-btn",S,this,0,1,2,0),v=a.add.button(827,480,"facebook-btn",w,this,0,1,2,0),m=a.add.button(827,529,"google-btn",x,this,0,1,2,0),g=a.add.button(827,577,"twitter-btn",E,this,0,1,2,0)}function w(){T("Facebook")}function E(){T("Twitter")}function S(){T("Github")}function x(){T("Google")}function T(e){var t=new u.auth[e+"AuthProvider"];u.auth().signInWithRedirect(t)}var a=s,f=u.database().ref(),l=f.child("users"),c=n(l),h=null,p;this.passReset=!1,this.username="",u.auth().onAuthStateChanged(function(t){t===null?o.menusLoadedGetter()===!1?(o.menusLoadedSetter(!0),o.hasTitleSetter(!0),p=o.menuStarter(),p.then(function(){b()})):(o.hasTitleSetter(!0),b()):(r.setUid(t.uid),h=t.uid,c.$loaded().then(e.bind(this,function(e){var t=!0;for(var n in e)e[n].uid===h&&(t=!1,this.username=e[n].username);t&&c.$add(i(h)),y.destroy(),d.destroy(),m.destroy(),g.destroy(),v.destroy(),this.username===""?window.location="#/user":window.location="#/menu"})))}.bind(this));var d,v,m,g,y;this.signUp=function(){this.email===undefined||this.email.indexOf("@")===-1||this.password.length<6?alert("You must provide a valid email address & a 6-character minimum password."):u.auth().createUserWithEmailAndPassword(this.email,this.password).catch(function(e){alert("Error creating user:\n"+e.message)})},this.logIn=function(){this.email===undefined||this.email.indexOf("@")===-1||this.email.indexOf(".")===-1||this.password.length<6?alert("You must provide a valid email address & password."):u.auth().signInWithEmailAndPassword(this.email,this.password).catch(function(e){alert("Login Failed!\n"+e.message),e.code==="auth/wrong-password"&&(this.passReset=!0,t.$digest())})},this.resetPass=function(){u.auth().sendPasswordResetEmail(this.email).then(function(){alert("Password reset email sent successfully!")},function(e){alert("Error sending password reset email:\n"+e)})}}])}),define("controllers/statsCtrl",["angular","angularRoute"],function(e,t){e.module("AminoApp.stats",["ngRoute"]).config(["$routeProvider",function(e){e.when("/stats",{templateUrl:"../partials/stats.html",controller:"statsCtrl",controllerAs:"stats"})}]).controller("statsCtrl",["$firebaseArray","uid","userCreator","proteinPanic","menuSplash","preload","fireconf",function(t,n,r,i,s,o,u){function g(e){try{var t=window[e],n="__storage_test__";return t.setItem(n,n),t.removeItem(n),!0}catch(r){return!1}}var a=i,f=u.database().ref(),l=f.child("proteins"),c=f.child("users"),h,p=t(c),d=null,v=65280,m=1;g("localStorage")?localStorage.getItem("proteins")?h=JSON.parse(localStorage.proteins):(localStorage.clear(),h=t(l),h.$loaded().then(function(e){localStorage.proteins=JSON.stringify(h)})):h=t(l),this.arrayOfUsers=p,this.username="",h.length!==0?this.proteinCount=h.length:h.$loaded().then(e.bind(this,function(e){this.proteinCount=e.length})),u.auth().onAuthStateChanged(function(t){t===null?window.location="/":(n.setUid(t.uid),d=t.uid,p.$loaded().then(e.bind(this,function(e){var t=!0;for(var n in e)e[n].uid===d&&(t=!1,m=e[n].music,this.username=e[n].username,v="0x"+e[n].color.slice(1));t&&p.$add(r(d)),this.username===""?window.location="#/user":s.menusLoadedGetter()===!1?(s.menusLoadedSetter(!0),s.hasTitleSetter(!1),s.trnaTintSetter(v),s.volumeSetter(m),s.menuStarter()):(s.hasTitleSetter(!1),s.trnaTintSetter(v),s.volumeSetter(m))})))}.bind(this)),this.completedCount=function(e){if(e){var t=e.split(",").length-1;if(t>0)return t}return 0},this.barWidth=function(e,t){var n=t/this.proteinCount*100+"%";return{"background-color":e,width:n}},this.userColor=function(e){return{"background-color":e}},this.mainMenu=function(){window.location="#/menu"}}])}),define("factories/proteinPanic",["angular"],function(e){e.module("AminoApp.proteinPanic",[]).factory("proteinPanic",function(){var e=new Phaser.Game(1024,576,Phaser.AUTO,"game-target");return e})}),define("app",["phaser","angular","angularfire","angularRoute","angularFilter","factories/uid","factories/creator","factories/preload","factories/fireconf","controllers/addCtrl","factories/menuSplash","controllers/menuCtrl","controllers/userCtrl","controllers/gameCtrl","controllers/loginCtrl","controllers/statsCtrl","factories/proteinPanic"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){return t.module("AminoApp",["ngRoute","firebase","AminoApp.uid","AminoApp.add","AminoApp.menu","AminoApp.user","AminoApp.game","AminoApp.login","AminoApp.stats","angular.filter","AminoApp.preload","AminoApp.fireconf","AminoApp.menuSplash","AminoApp.userCreator","AminoApp.proteinPanic"]).config(["$routeProvider",function(e){e.otherwise({redirectTo:"/"})}])}),require.config({paths:{angularFilter:"../lib/bower_components/angular-filter/dist/angular-filter.min",angularfire:"../lib/bower_components/angularfire/dist/angularfire.min",bootstrap:"../lib/bower_components/bootstrap/dist/js/bootstrap.min",angularRoute:"../lib/bower_components/angular-route/angular-route",phaser:"../lib/bower_components/phaser/build/phaser.min",jquery:"../lib/bower_components/jquery/dist/jquery.min",angular:"../lib/bower_components/angular/angular.min",firebase:"../lib/bower_components/firebase/firebase"},shim:{angularfire:["angular","firebase"],firebase:{exports:"firebase"},angular:{exports:"angular"},phaser:{exports:"Phaser"},angularFilter:["angular"],angularRoute:["angular"],bootstrap:["jquery"]},priority:["angular"]}),require(["angular","app"],function(e,t){var n=e.element(document.getElementsByTagName("body")[0]);e.element(n).ready(function(){e.bootstrap(document,["AminoApp"])})}),define("require-config",function(){});